==========================================
SLURM_JOB_ID = 150860
SLURM_NODELIST = gpu[12,20,22,24]
==========================================
Node IP: 10.151.0.12
Data directory: 
My CUDA device: 0
Train settings: {'average_reset_epoch_interval': 30, 'distributed_backend': 'nccl', 'fix_conv_weight_norm': False, 'num_epochs': 90, 'checkpoints': [], 'num_train_tracking_batches': 1, 'optimizer_batch_size': 128, 'optimizer_conv_learning_rate': 1.25, 'optimizer_decay_at_epochs': [60, 80], 'optimizer_decay_with_factor': 10.0, 'optimizer_learning_rate': 1.25, 'optimizer_momentum_type': 'nesterov', 'optimizer_momentum': 0.0, 'optimizer_reducer': 'SageReducer', 'optimizer_memory': True, 'optimizer_reducer_compression': 0.001, 'optimizer_reducer_beta': 0.9, 'optimizer_reducer_alpha': 0.5, 'optimizer_reducer_rank': 4, 'optimizer_reducer_thresh': 0.002938, 'optimizer_reducer_rmsratio': 0.8, 'optimizer_reducer_gamma': 0.5, 'optimizer_scale_lr_with_factor': 8.0, 'optimizer_scale_lr_with_warmup_epochs': 5, 'optimizer_mom_before_reduce': False, 'optimizer_wd_before_reduce': False, 'optimizer_weight_decay_conv': 0.0, 'optimizer_weight_decay_other': 0.0, 'optimizer_weight_decay_bn': 0.0, 'task': 'LanguageModeling', 'task_architecture': 'ResNet18', 'seed': 1, 'rank': 0, 'n_workers': 4, 'distributed_init_file': 'tcp://10.151.0.12:28631', 'log_verbosity': 2, 'wandb_key': None, 'proj_name': 'wikitext2', 'run_name': 'sage_0.002938_0.001_memTrue_1', 'entity': '0', 'use_wandb': 0, 'accordion_k_low': 0.1, 'accordion_k_high': 0.99, 'accordion_detection_threshold': 0.5, 'accordion_switch_freq': 10, 'using_ibex': False, 'wandbkey': None}
Device for training: cuda
Available devices: 1
Current cuda device: 0
Distributed init: rank 0/4 - tcp://10.151.0.12:28631
<gradient_reducers.SageReducer object at 0x2b0cabbaf990>
Total parameters to optimize: 28949319
Global batch Size: 512
[Iteration 0] [Rank 0] a = 1.0, b = 1.0, delta = 0.002938, c = 0.0, d = 1.8031512243863145e-05, m = 1.8031512243863145e-05
timer                          - epoch:  1.000, value:  0.026 (event:batch.forward)
timer                          - epoch:  1.000, value:  0.053 (event:batch.backward)
timer                          - epoch:  1.000, value:  0.003 (event:batch.evaluate)
timer                          - epoch:  0.007, value:  0.000 (event:batch.reporting.lr)
timer                          - epoch:  0.007, value:  0.001 (event:batch.accumulate)
timer                          - epoch: -1.000, value:  0.011 (event:reduce.heur_params)
timer                          - epoch: -1.000, value:  0.002 (event:reduce.threshold)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.memory)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.flatpack)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.flatput)
timer                          - epoch: -1.000, value:  0.024 (event:reduce.gather.context)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.pad)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.gather.tensors)
timer                          - epoch: -1.000, value:  0.006 (event:reduce.combine)
timer                          - epoch:  0.007, value:  0.044 (event:batch.reduce)
timer                          - epoch: -1.000, value:  0.000 (event:batch.reporting.compr_err)
timer                          - epoch:  0.007, value:  0.000 (event:batch.wd)
timer                          - epoch:  0.007, value:  0.001 (event:batch.mom)
timer                          - epoch:  0.007, value:  0.000 (event:batch.step)
timer                          - epoch:  0.007, value:  0.001 (event:batch.update_runavg)
timer                          - epoch:  0.007, value:  0.000 (event:batch.reporting.memory_norm)
timer                          - epoch:  0.007, value:  0.131 (event:batch)
timer                          - epoch:  1.000, value:  0.026 (event:batch.forward)
timer                          - epoch:  1.000, value:  0.052 (event:batch.backward)
timer                          - epoch:  1.000, value:  0.003 (event:batch.evaluate)
timer                          - epoch:  0.014, value:  0.001 (event:batch.accumulate)
timer                          - epoch: -1.000, value:  0.009 (event:reduce.heur_params.alpha)
timer                          - epoch: -1.000, value:  0.002 (event:reduce.heur_params.beta)
timer                          - epoch: -1.000, value:  0.011 (event:reduce.heur_params)
timer                          - epoch: -1.000, value:  0.002 (event:reduce.threshold)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.memory)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.flatput)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.pad)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.gather.tensors)
timer                          - epoch:  0.014, value:  0.028 (event:batch.reduce)
timer                          - epoch: -1.000, value:  0.000 (event:batch.reporting.compr_err)
timer                          - epoch:  0.014, value:  0.001 (event:batch.mom)
timer                          - epoch:  0.014, value:  0.000 (event:batch.step)
timer                          - epoch:  0.014, value:  0.000 (event:batch.reporting.memory_norm)
timer                          - epoch:  0.022, value:  0.001 (event:batch.accumulate)
timer                          - epoch: -1.000, value:  0.011 (event:reduce.heur_params)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.memory)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.flatpack)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.gather.tensors)
timer                          - epoch:  0.022, value:  0.001 (event:batch.update_runavg)
timer                          - epoch:  1.000, value:  0.051 (event:batch.backward)
timer                          - epoch: -1.000, value:  0.002 (event:reduce.threshold)
timer                          - epoch: -1.000, value:  0.001 (event:reduce.gather.context)
timer                          - epoch:  0.029, value:  0.000 (event:batch.reporting.memory_norm)
timer                          - epoch:  0.036, value:  0.000 (event:batch.reporting.lr)
timer                          - epoch:  0.036, value:  0.001 (event:batch.accumulate)
timer                          - epoch: -1.000, value:  0.009 (event:reduce.heur_params.alpha)
timer                          - epoch:  0.036, value:  0.001 (event:batch.mom)
timer                          - epoch:  0.036, value:  0.000 (event:batch.reporting.memory_norm)
timer                          - epoch:  0.036, value:  0.106 (event:batch)
timer                          - epoch: -1.000, value:  0.002 (event:reduce.threshold)
timer                          - epoch:  0.043, value:  0.022 (event:batch.reduce)
timer                          - epoch: -1.000, value:  0.000 (event:batch.reporting.compr_err)
timer                          - epoch:  0.043, value:  0.107 (event:batch)
timer                          - epoch:  0.050, value:  0.001 (event:batch.accumulate)
timer                          - epoch: -1.000, value:  0.009 (event:reduce.heur_params.alpha)
timer                          - epoch: -1.000, value:  0.000 (event:batch.reporting.compr_err)
timer                          - epoch:  0.050, value:  0.001 (event:batch.update_runavg)
timer                          - epoch: -1.000, value:  0.010 (event:reduce.heur_params)
timer                          - epoch:  0.058, value:  0.024 (event:batch.reduce)
timer                          - epoch:  0.058, value:  0.000 (event:batch.step)
timer                          - epoch:  0.058, value:  0.000 (event:batch.reporting.memory_norm)
timer                          - epoch:  1.000, value:  0.050 (event:batch.backward)
timer                          - epoch: -1.000, value:  0.009 (event:reduce.heur_params.alpha)
timer                          - epoch: -1.000, value:  0.003 (event:reduce.gather.context)
timer                          - epoch: -1.000, value:  0.002 (event:reduce.threshold)
[Iteration 10] [Rank 0] a = 0.9643427133560181, b = 0.9995023489737115, delta = 0.04564058780670166, c = 4.697865258937524e-06, d = 4.732408385841477e-06, m = 3.7369382741548485e-06
timer                          - epoch: -1.000, value:  0.000 (event:batch.reporting.compr_err)
timer                          - epoch:  0.079, value:  0.001 (event:batch.update_runavg)
timer                          - epoch:  0.079, value:  0.000 (event:batch.reporting.memory_norm)
timer                          - epoch:  1.000, value:  0.052 (event:batch.backward)
timer                          - epoch: -1.000, value:  0.002 (event:reduce.heur_params.beta)
timer                          - epoch:  0.086, value:  0.001 (event:batch.update_runavg)
timer                          - epoch:  0.094, value:  0.000 (event:batch.reporting.lr)
timer                          - epoch:  0.094, value:  0.001 (event:batch.accumulate)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.flatpack)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.pad)
timer                          - epoch:  0.101, value:  0.001 (event:batch.mom)
timer                          - epoch:  0.122, value:  0.001 (event:batch.mom)
timer                          - epoch:  0.129, value:  0.000 (event:batch.reporting.lr)
timer                          - epoch: -1.000, value:  0.009 (event:reduce.heur_params.alpha)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.flatput)
timer                          - epoch: -1.000, value:  0.005 (event:reduce.combine)
timer                          - epoch: -1.000, value:  0.002 (event:reduce.heur_params.beta)
[Iteration 20] [Rank 0] a = 0.9884520173072815, b = 0.9995000691279032, delta = 0.06416578590869904, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 3.2141557128725226e-06
timer                          - epoch:  0.144, value:  0.000 (event:batch.step)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.flatpack)
timer                          - epoch:  0.151, value:  0.001 (event:batch.update_runavg)
timer                          - epoch: -1.000, value:  0.011 (event:reduce.heur_params)
timer                          - epoch: -1.000, value:  0.002 (event:reduce.threshold)
timer                          - epoch:  0.165, value:  0.001 (event:batch.mom)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.gather.context)
timer                          - epoch:  0.180, value:  0.000 (event:batch.wd)
timer                          - epoch:  0.180, value:  0.106 (event:batch)
timer                          - epoch: -1.000, value:  0.009 (event:reduce.heur_params.alpha)
timer                          - epoch: -1.000, value:  0.002 (event:reduce.gather.context)
timer                          - epoch: -1.000, value:  0.011 (event:reduce.heur_params)
timer                          - epoch: -1.000, value:  0.002 (event:reduce.threshold)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.pad)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.gather.tensors)
[Iteration 30] [Rank 0] a = 0.7911650538444519, b = 0.9995051296947426, delta = 0.040854886174201965, c = 1.025930869047386e-05, d = 1.0362938071185715e-05, m = 3.23591098480896e-06
timer                          - epoch: -1.000, value:  0.000 (event:batch.reporting.compr_err)
timer                          - epoch:  1.000, value:  0.026 (event:batch.forward)
timer                          - epoch: -1.000, value:  0.009 (event:reduce.heur_params.alpha)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.gather.tensors)
timer                          - epoch:  0.281, value:  0.000 (event:batch.reporting.memory_norm)
[Iteration 40] [Rank 0] a = 0.9684531688690186, b = 0.9995000000416666, delta = 0.06106477975845337, c = 0.0, d = 0.0, m = 2.6749860468304597e-06
timer                          - epoch:  1.000, value:  0.026 (event:batch.forward)
timer                          - epoch: -1.000, value:  0.000 (event:batch.reporting.compr_err)
timer                          - epoch: -1.000, value:  0.009 (event:reduce.heur_params.alpha)
timer                          - epoch:  0.302, value:  0.000 (event:batch.wd)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.flatput)
timer                          - epoch:  0.317, value:  0.000 (event:batch.reporting.memory_norm)
timer                          - epoch:  0.324, value:  0.000 (event:batch.reporting.memory_norm)
timer                          - epoch: -1.000, value:  0.000 (event:batch.reporting.compr_err)
[Iteration 50] [Rank 0] a = 1.2972018718719482, b = 0.9995000000416666, delta = 0.057993803173303604, c = 0.0, d = 0.0, m = 2.4024406103591994e-06
timer                          - epoch: -1.000, value:  0.000 (event:batch.reporting.compr_err)
timer                          - epoch:  1.000, value:  0.052 (event:batch.backward)
timer                          - epoch:  0.388, value:  0.001 (event:batch.accumulate)
timer                          - epoch: -1.000, value:  0.002 (event:reduce.gather.context)
timer                          - epoch: -1.000, value:  0.011 (event:reduce.heur_params)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.flatput)
[Iteration 60] [Rank 0] a = 0.8256755471229553, b = 0.9995000345847849, delta = 0.04920695349574089, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 2.095238844993834e-06
timer                          - epoch:  0.439, value:  0.000 (event:batch.wd)
timer                          - epoch:  0.453, value:  0.001 (event:batch.mom)
timer                          - epoch: -1.000, value:  0.000 (event:batch.reporting.compr_err)
timer                          - epoch: -1.000, value:  0.002 (event:reduce.heur_params.beta)
timer                          - epoch: -1.000, value:  0.001 (event:reduce.pad)
[Iteration 70] [Rank 0] a = 0.9246065020561218, b = 0.9995000000416666, delta = 0.053331367671489716, c = 0.0, d = 0.0, m = 1.897925888060821e-06
timer                          - epoch:  0.511, value:  0.000 (event:batch.step)
timer                          - epoch:  0.518, value:  0.001 (event:batch.mom)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.pad)
timer                          - epoch:  1.000, value:  0.025 (event:batch.forward)
[Iteration 80] [Rank 0] a = 0.8483854532241821, b = 0.9995000000416666, delta = 0.06294117122888565, c = 0.0, d = 0.0, m = 1.726729886840781e-06
learning_rate                  - epoch:  0.590, value:  2.282 (weight:encoder.weight)
effective_lr                   - epoch:  0.590, value:  0.000 (weight:encoder.weight)
grad_norm                      - epoch:  0.590, value:  0.119 (weight:encoder.weight)
learning_rate                  - epoch:  0.590, value:  2.282 (weight:rnn.weight_ih_l0)
effective_lr                   - epoch:  0.590, value:  0.003 (weight:rnn.weight_ih_l0)
grad_norm                      - epoch:  0.590, value:  0.002 (weight:rnn.weight_ih_l0)
learning_rate                  - epoch:  0.590, value:  2.282 (weight:rnn.weight_hh_l0)
effective_lr                   - epoch:  0.590, value:  0.003 (weight:rnn.weight_hh_l0)
grad_norm                      - epoch:  0.590, value:  0.001 (weight:rnn.weight_hh_l0)
learning_rate                  - epoch:  0.590, value:  2.282 (weight:rnn.bias_ih_l0)
effective_lr                   - epoch:  0.590, value:  1.748 (weight:rnn.bias_ih_l0)
grad_norm                      - epoch:  0.590, value:  0.002 (weight:rnn.bias_ih_l0)
learning_rate                  - epoch:  0.590, value:  2.282 (weight:rnn.bias_hh_l0)
effective_lr                   - epoch:  0.590, value:  1.674 (weight:rnn.bias_hh_l0)
grad_norm                      - epoch:  0.590, value:  0.002 (weight:rnn.bias_hh_l0)
learning_rate                  - epoch:  0.590, value:  2.282 (weight:rnn.weight_ih_l1)
effective_lr                   - epoch:  0.590, value:  0.003 (weight:rnn.weight_ih_l1)
grad_norm                      - epoch:  0.590, value:  0.003 (weight:rnn.weight_ih_l1)
learning_rate                  - epoch:  0.590, value:  2.282 (weight:rnn.weight_hh_l1)
effective_lr                   - epoch:  0.590, value:  0.003 (weight:rnn.weight_hh_l1)
grad_norm                      - epoch:  0.590, value:  0.005 (weight:rnn.weight_hh_l1)
learning_rate                  - epoch:  0.590, value:  2.282 (weight:rnn.bias_ih_l1)
effective_lr                   - epoch:  0.590, value:  1.390 (weight:rnn.bias_ih_l1)
grad_norm                      - epoch:  0.590, value:  0.006 (weight:rnn.bias_ih_l1)
learning_rate                  - epoch:  0.590, value:  2.282 (weight:rnn.bias_hh_l1)
effective_lr                   - epoch:  0.590, value:  1.355 (weight:rnn.bias_hh_l1)
grad_norm                      - epoch:  0.590, value:  0.006 (weight:rnn.bias_hh_l1)
learning_rate                  - epoch:  0.590, value:  2.282 (weight:rnn.weight_ih_l2)
effective_lr                   - epoch:  0.590, value:  0.003 (weight:rnn.weight_ih_l2)
grad_norm                      - epoch:  0.590, value:  0.018 (weight:rnn.weight_ih_l2)
learning_rate                  - epoch:  0.590, value:  2.282 (weight:rnn.weight_hh_l2)
effective_lr                   - epoch:  0.590, value:  0.003 (weight:rnn.weight_hh_l2)
grad_norm                      - epoch:  0.590, value:  0.098 (weight:rnn.weight_hh_l2)
learning_rate                  - epoch:  0.590, value:  2.282 (weight:rnn.bias_ih_l2)
effective_lr                   - epoch:  0.590, value:  0.179 (weight:rnn.bias_ih_l2)
grad_norm                      - epoch:  0.590, value:  0.021 (weight:rnn.bias_ih_l2)
learning_rate                  - epoch:  0.590, value:  2.282 (weight:rnn.bias_hh_l2)
effective_lr                   - epoch:  0.590, value:  0.179 (weight:rnn.bias_hh_l2)
grad_norm                      - epoch:  0.590, value:  0.021 (weight:rnn.bias_hh_l2)
learning_rate                  - epoch:  0.590, value:  2.282 (weight:decoder.bias)
effective_lr                   - epoch:  0.590, value:  0.069 (weight:decoder.bias)
grad_norm                      - epoch:  0.590, value:  0.022 (weight:decoder.bias)
grad_norm                      - epoch:  0.590, value:  0.160 (weight:entire_model)
timer                          - epoch: -1.000, value:  0.000 (event:batch.reporting.compr_err)
timer                          - epoch:  0.619, value:  0.022 (event:batch.reduce)
timer                          - epoch: -1.000, value:  0.010 (event:reduce.heur_params)
timer                          - epoch: -1.000, value:  0.002 (event:reduce.heur_params.beta)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.memory)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.flatpack)
[Iteration 90] [Rank 0] a = 1.1896624565124512, b = 0.9995000000416666, delta = 0.05139460414648056, c = 0.0, d = 0.0, m = 1.695270381901664e-06
timer                          - epoch: -1.000, value:  0.000 (event:reduce.pad)
timer                          - epoch: -1.000, value:  0.002 (event:reduce.heur_params.beta)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.gather.tensors)
[Iteration 100] [Rank 0] a = 1.0249673128128052, b = 0.9995000000416666, delta = 0.06470561027526855, c = 0.0, d = 0.0, m = 1.5373401528046142e-06
timer                          - epoch:  0.755, value:  0.020 (event:batch.reduce)
timer                          - epoch:  0.784, value:  0.000 (event:batch.reporting.memory_norm)
[Iteration 110] [Rank 0] a = 1.2144523859024048, b = 0.9995000000416666, delta = 0.050602544099092484, c = 0.0, d = 0.0, m = 1.544171132409115e-06
timer                          - epoch:  0.799, value:  0.000 (event:batch.wd)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.flatpack)
[Iteration 120] [Rank 0] a = 0.9841738939285278, b = 0.9995000000416666, delta = 0.0649440735578537, c = 0.0, d = 0.0, m = 1.4165536834496842e-06
timer                          - epoch: -1.000, value:  0.000 (event:batch.reporting.compr_err)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.gather.tensors)
[Iteration 130] [Rank 0] a = 0.9493928551673889, b = 0.9995000345847849, delta = 0.05456395447254181, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 1.3129025103418243e-06
rel_compression_error          - epoch:  0.964, value:  1.000 (weight:encoder.weight)
rel_compression_error          - epoch:  0.964, value:  1.000 (weight:rnn.weight_ih_l0)
rel_compression_error          - epoch:  0.964, value:  1.000 (weight:rnn.weight_hh_l0)
rel_compression_error          - epoch:  0.964, value:  1.000 (weight:rnn.bias_ih_l0)
rel_compression_error          - epoch:  0.964, value:  1.000 (weight:rnn.bias_hh_l0)
rel_compression_error          - epoch:  0.964, value:  1.000 (weight:rnn.weight_ih_l1)
rel_compression_error          - epoch:  0.964, value:  1.000 (weight:rnn.weight_hh_l1)
rel_compression_error          - epoch:  0.964, value:  1.000 (weight:rnn.bias_ih_l1)
rel_compression_error          - epoch:  0.964, value:  1.000 (weight:rnn.bias_hh_l1)
rel_compression_error          - epoch:  0.964, value:  1.000 (weight:rnn.weight_ih_l2)
rel_compression_error          - epoch:  0.964, value:  1.000 (weight:rnn.weight_hh_l2)
rel_compression_error          - epoch:  0.964, value:  1.000 (weight:rnn.bias_ih_l2)
rel_compression_error          - epoch:  0.964, value:  1.000 (weight:rnn.bias_hh_l2)
rel_compression_error          - epoch:  0.964, value:  1.000 (weight:decoder.bias)
rel_compression_error          - epoch:  0.964, value:  1.000 (weight:entire_model)
cross_entropy                  - bits:16428224.000, epoch:  1.000, ratio_transmit_grad:  0.006, value:  7.887 (split:train)
last_cross_entropy             - bits:16428224.000, epoch:  1.000, ratio_transmit_grad:  0.006, value:  7.887 (split:train)
perplexity                     - bits:16428224.000, epoch:  1.000, ratio_transmit_grad:  0.006, value:4006.101 (split:train)
last_perplexity                - bits:16428224.000, epoch:  1.000, ratio_transmit_grad:  0.006, value:4006.101 (split:train)
last_cross_entropy             - bits:16428224.000, epoch:  1.000, ratio_transmit_grad:  0.006, value:  7.191 (split:test)
last_perplexity                - bits:16428224.000, epoch:  1.000, ratio_transmit_grad:  0.006, value:1330.494 (split:test)
runavg_cross_entropy           - bits:16428224.000, epoch:  1.000, ratio_transmit_grad:  0.006, value:  7.230 (split:test)
runavg_perplexity              - bits:16428224.000, epoch:  1.000, ratio_transmit_grad:  0.006, value:1382.282 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    138 |     0.10636s |  99.9%
- batch.accumulate               |    138 |     0.00084s |   0.8%
- batch.backward                 |    138 |     0.05168s |  48.7%
- batch.evaluate                 |    138 |     0.00276s |   2.6%
- batch.forward                  |    138 |     0.02553s |  24.1%
- batch.mom                      |    138 |     0.00126s |   1.2%
- batch.reduce                   |    138 |     0.02137s |  20.2%
- batch.reporting.compr_err      |    138 |     0.00003s |   0.0%
- batch.reporting.lr             |    138 |     0.00006s |   0.1%
- batch.reporting.memory_norm    |    138 |     0.00001s |   0.0%
- batch.step                     |    138 |     0.00048s |   0.5%
- batch.update_runavg            |    138 |     0.00130s |   1.2%
- batch.wd                       |    138 |     0.00001s |   0.0%
- reduce.combine                 |    138 |     0.00562s |   5.3%
- reduce.flatpack                |    138 |     0.00002s |   0.0%
- reduce.flatput                 |    138 |     0.00011s |   0.1%
- reduce.gather.context          |    138 |     0.00167s |   1.6%
- reduce.gather.tensors          |    138 |     0.00029s |   0.3%
- reduce.heur_params             |    138 |     0.01071s |  10.1%
- reduce.heur_params.alpha       |    137 |     0.00869s |   8.2%
- reduce.heur_params.beta        |    137 |     0.00194s |   1.8%
- reduce.memory                  |    138 |     0.00043s |   0.4%
- reduce.pad                     |    138 |     0.00030s |   0.3%
- reduce.threshold               |    138 |     0.00199s |   1.9%
-----------------------------------------------------------------

Data directory: 
My CUDA device: 0
Device for training: cuda
Available devices: 1
Current cuda device: 0
Distributed init: rank 3/4 - tcp://10.151.0.12:28631
<gradient_reducers.SageReducer object at 0x2b02ab165190>
Total parameters to optimize: 28949319
Global batch Size: 512
[Iteration 0] [Rank 3] a = 1.0, b = 1.0, delta = 0.002938, c = 0.0, d = 1.937869419311729e-05, m = 1.937869419311729e-05
[Iteration 10] [Rank 3] a = 0.9532236456871033, b = 0.999505388768131, delta = 0.026306914165616035, c = 1.0777455594033144e-05, d = 1.0811998720937098e-05, m = 9.449115350362976e-06
[Iteration 20] [Rank 3] a = 0.9672332406044006, b = 0.9995044561039332, delta = 0.029098663479089737, c = 8.912126741219716e-06, d = 8.946669868123668e-06, m = 1.0777455594033147e-05
[Iteration 30] [Rank 3] a = 1.0269935131072998, b = 0.9995016235682265, delta = 0.02330823242664337, c = 3.2470539289715243e-06, d = 3.281597055875477e-06, m = 1.1233202010282067e-05
Data directory: 
My CUDA device: 0
Device for training: cuda
Available devices: 1
Current cuda device: 0
Distributed init: rank 1/4 - tcp://10.151.0.12:28631
<gradient_reducers.SageReducer object at 0x2b35a86985d0>
Total parameters to optimize: 28949319
Global batch Size: 512
[Iteration 0] [Rank 1] a = 1.0, b = 1.0, delta = 0.002938, c = 0.0, d = 1.8031512243863145e-05, m = 1.8031512243863145e-05
[Iteration 10] [Rank 1] a = 1.0818912982940674, b = 0.9995212958743024, delta = 0.0087342020124197, c = 4.2591675472573294e-05, d = 4.2591675472573294e-05, m = 4.835095681274136e-05
[Iteration 20] [Rank 1] a = 0.9187170267105103, b = 0.9995712624970724, delta = 0.008329756557941437, c = 0.00014252494160570754, d = 0.0001434230629052103, m = 7.092361917703405e-05
[Iteration 30] [Rank 1] a = 0.963025689125061, b = 0.9995452342560311, delta = 0.007248902693390846, c = 9.04684493614513e-05, d = 9.084842375739478e-05, m = 8.288567585882564e-05
[Iteration 40] [Rank 3] a = 1.165895938873291, b = 0.9995000000416666, delta = 0.027905909344553947, c = 0.0, d = 0.0, m = 9.792555219625333e-06
[Iteration 50] [Rank 3] a = 0.922305703163147, b = 0.9995150262982251, delta = 0.022922703996300697, c = 3.0052520406438577e-05, d = 3.0225236040958337e-05, m = 9.271781650749102e-06
[Iteration 60] [Rank 3] a = 1.1983634233474731, b = 0.9995000000416666, delta = 0.03141294792294502, c = 0.0, d = 0.0, m = 8.97668274887628e-06
[Iteration 70] [Rank 3] a = 1.2297775745391846, b = 0.9995000000416666, delta = 0.03439662978053093, c = 0.0, d = 0.0, m = 8.616320809422488e-06
[Iteration 80] [Rank 3] a = 0.677458643913269, b = 0.9995305361586723, delta = 0.023259125649929047, c = 6.107224836618782e-05, d = 6.13831365083234e-05, m = 8.322334833711492e-06
[Iteration 90] [Rank 3] a = 1.1514863967895508, b = 0.9995000518563442, delta = 0.028893595561385155, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 7.591516428045536e-06
[Iteration 40] [Rank 1] a = 0.9732809066772461, b = 0.9995489130982915, delta = 0.006784490775316954, c = 9.782613539199316e-05, d = 9.875879981839987e-05, m = 8.481685679384857e-05
[Iteration 50] [Rank 1] a = 1.0740634202957153, b = 0.999503765241565, delta = 0.008092239499092102, c = 7.53040166506162e-06, d = 7.703117299581382e-06, m = 7.606328812628934e-05
[Iteration 60] [Rank 1] a = 1.1044907569885254, b = 0.9995019171847324, delta = 0.007480402942746878, c = 3.834287086338715e-06, d = 3.834287086338715e-06, m = 7.722257589570786e-05
[Iteration 70] [Rank 1] a = 0.9571208953857422, b = 0.9995081694891701, delta = 0.007563897408545017, c = 1.633889902556948e-05, d = 1.651161466008924e-05, m = 7.661616895005226e-05
[Iteration 80] [Rank 1] a = 1.0410016775131226, b = 0.9995011399645702, delta = 0.00997884664684534, c = 2.2798463756608576e-06, d = 2.31438950256481e-06, m = 6.895746338413943e-05
[Iteration 100] [Rank 3] a = 1.2618169784545898, b = 0.9995002073003761, delta = 0.029212869703769684, c = 4.1451752284742866e-07, d = 4.1451752284742866e-07, m = 7.770151486444498e-06
[Iteration 110] [Rank 3] a = 1.0047653913497925, b = 0.9995000691279032, delta = 0.0346880666911602, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 7.123975325092595e-06
[Iteration 120] [Rank 3] a = 1.2569581270217896, b = 0.9995000000416666, delta = 0.03934929892420769, c = 0.0, d = 0.0, m = 6.570331121441853e-06
[Iteration 130] [Rank 3] a = 0.9121822714805603, b = 0.9995009154343012, delta = 0.03021310828626156, c = 1.8307857259094765e-06, d = 1.8307857259094765e-06, m = 6.272609944971141e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    138 |     0.10637s |  99.9%
- batch.accumulate               |    138 |     0.00083s |   0.8%
[Iteration 90] [Rank 1] a = 1.0065419673919678, b = 0.9995116928872683, delta = 0.009390224702656269, c = 2.3385696913975765e-05, d = 2.3627498802303433e-05, m = 6.441040504743352e-05
[Iteration 100] [Rank 1] a = 1.090809941291809, b = 0.999502072628765, delta = 0.010823028162121773, c = 4.145175228474286e-06, d = 4.145175228474286e-06, m = 6.796890335646705e-05
[Iteration 110] [Rank 1] a = 1.2057099342346191, b = 0.9995010708783334, delta = 0.0100089805200696, c = 2.141673868045048e-06, d = 2.141673868045048e-06, m = 6.583390949012815e-05
[Iteration 120] [Rank 1] a = 0.9474439024925232, b = 0.9995112956414035, delta = 0.008823568001389503, c = 2.259120499518486e-05, d = 2.2729377502800672e-05, m = 6.457480724209355e-05
[Iteration 130] [Rank 1] a = 1.0131597518920898, b = 0.9995054923974864, delta = 0.009014866314828396, c = 1.098471435545686e-05, d = 1.1399231878304288e-05, m = 6.212963721263707e-05
--- Timer summary -----------------------------------------------
Data directory: 
My CUDA device: 0
Device for training: cuda
Available devices: 1
Current cuda device: 0
Distributed init: rank 2/4 - tcp://10.151.0.12:28631
<gradient_reducers.SageReducer object at 0x2af79bfcac90>
Total parameters to optimize: 28949319
Global batch Size: 512
[Iteration 0] [Rank 2] a = 1.0, b = 1.0, delta = 0.002938, c = 0.0, d = 1.8998719797173813e-05, m = 1.8998719797173813e-05
[Iteration 10] [Rank 2] a = 1.1221674680709839, b = 0.9995015026673124, delta = 0.02753489464521408, c = 3.0052520406438576e-06, d = 3.0052520406438576e-06, m = 6.685665198046784e-06
[Iteration 20] [Rank 2] a = 0.8136891722679138, b = 0.9995056478415194, delta = 0.04103976860642433, c = 1.129560249759243e-05, d = 1.129560249759243e-05, m = 5.702905760762043e-06
[Iteration 30] [Rank 2] a = 0.9733847975730896, b = 0.9995048188066767, delta = 0.03030315786600113, c = 9.637532406202717e-06, d = 9.672075533106669e-06, m = 6.13753364474096e-06
- batch.backward                 |    138 |     0.05172s |  48.8%
- batch.evaluate                 |    138 |     0.00277s |   2.6%
- batch.forward                  |    138 |     0.02540s |  24.0%
- batch.mom                      |    138 |     0.00126s |   1.2%
- batch.reduce                   |    138 |     0.02163s |  20.5%
- batch.reporting.compr_err      |    138 |     0.00001s |   0.0%
- batch.reporting.lr             |    138 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |    138 |     0.00001s |   0.0%
- batch.step                     |    138 |     0.00047s |   0.4%
- batch.update_runavg            |    138 |     0.00129s |   1.2%
- batch.wd                       |    138 |     0.00001s |   0.0%
- reduce.combine                 |    138 |     0.00535s |   5.1%
- reduce.flatpack                |    138 |     0.00002s |   0.0%
- reduce.flatput                 |    138 |     0.00013s |   0.1%
- reduce.gather.context          |    138 |     0.00245s |   2.3%
  Event                          |  Count | Average time |  Frac.
- batch                          |    138 |     0.10627s |  99.9%
- batch.accumulate               |    138 |     0.00083s |   0.8%
- batch.backward                 |    138 |     0.05169s |  48.8%
- batch.evaluate                 |    138 |     0.00278s |   2.6%
- batch.forward                  |    138 |     0.02541s |  24.0%
- batch.mom                      |    138 |     0.00126s |   1.2%
- batch.reduce                   |    138 |     0.02152s |  20.4%
- batch.reporting.compr_err      |    138 |     0.00001s |   0.0%
- batch.reporting.lr             |    138 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |    138 |     0.00001s |   0.0%
- batch.step                     |    138 |     0.00048s |   0.5%
- batch.update_runavg            |    138 |     0.00129s |   1.2%
- batch.wd                       |    138 |     0.00001s |   0.0%
- reduce.combine                 |    138 |     0.00534s |   5.1%
[Iteration 40] [Rank 2] a = 1.4521360397338867, b = 0.9995000000416666, delta = 0.04129010811448097, c = 0.0, d = 0.0, m = 6.294431734132397e-06
[Iteration 50] [Rank 2] a = 0.9406710267066956, b = 0.9995000000416666, delta = 0.03325410932302475, c = 0.0, d = 0.0, m = 5.314223013498244e-06
[Iteration 60] [Rank 2] a = 0.802357017993927, b = 0.9995000345847849, delta = 0.03783297911286354, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 4.697865258937525e-06
[Iteration 70] [Rank 2] a = 0.8834059834480286, b = 0.9995000000416666, delta = 0.033520836383104324, c = 0.0, d = 0.0, m = 5.057892215401256e-06
[Iteration 80] [Rank 2] a = 0.8053680658340454, b = 0.999501986270969, delta = 0.030322441831231117, c = 3.972459593954525e-06, d = 4.007002720858477e-06, m = 4.514914623853634e-06
[Iteration 90] [Rank 2] a = 1.0350764989852905, b = 0.9995000000416666, delta = 0.041168212890625, c = 0.0, d = 0.0, m = 4.229824869129032e-06
- reduce.gather.tensors          |    138 |     0.00031s |   0.3%
- reduce.heur_params             |    138 |     0.01034s |   9.8%
- reduce.heur_params.alpha       |    137 |     0.00821s |   7.8%
- reduce.flatpack                |    138 |     0.00002s |   0.0%
- reduce.flatput                 |    138 |     0.00017s |   0.2%
- reduce.gather.context          |    138 |     0.00166s |   1.6%
- reduce.gather.tensors          |    138 |     0.00043s |   0.4%
[Iteration 100] [Rank 2] a = 1.6745041608810425, b = 0.9995000000416666, delta = 0.041880346834659576, c = 0.0, d = 0.0, m = 5.009095412230565e-06
[Iteration 110] [Rank 2] a = 0.8430693745613098, b = 0.9995001382141396, delta = 0.03079371713101864, c = 2.763450152316191e-07, d = 2.763450152316191e-07, m = 5.0644580831974926e-06
[Iteration 120] [Rank 2] a = 0.9870977997779846, b = 0.9995000345847849, delta = 0.03557361662387848, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 4.653615798853954e-06
[Iteration 130] [Rank 2] a = 1.2978413105010986, b = 0.9995000000416666, delta = 0.038732584565877914, c = 0.0, d = 0.0, m = 4.4080721561326144e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    138 |     0.10637s |  99.9%
- batch.accumulate               |    138 |     0.00083s |   0.8%
- batch.backward                 |    138 |     0.05205s |  49.1%
- reduce.heur_params.beta        |    137 |     0.00206s |   1.9%
- reduce.memory                  |    138 |     0.00042s |   0.4%
- reduce.pad                     |    138 |     0.00028s |   0.3%
- reduce.threshold               |    138 |     0.00214s |   2.0%
-----------------------------------------------------------------

[Iteration 140] [Rank 3] a = 0.8935335874557495, b = 0.9995219521935635, delta = 0.02600880339741707, c = 4.3904314294923486e-05, d = 4.4387918071578816e-05, m = 6.402482826297105e-06
[Iteration 150] [Rank 3] a = 0.8027316927909851, b = 0.9995000863994624, delta = 0.031813595443964005, c = 1.7271563451976193e-07, d = 1.7271563451976193e-07, m = 5.994490711199788e-06
[Iteration 160] [Rank 3] a = 1.1741260290145874, b = 0.9995000000416666, delta = 0.033440202474594116, c = 0.0, d = 0.0, m = 6.3031551688466646e-06
- reduce.heur_params             |    138 |     0.01073s |  10.2%
- reduce.heur_params.alpha       |    137 |     0.00830s |   7.9%
- reduce.heur_params.beta        |    137 |     0.00228s |   2.2%
- reduce.memory                  |    138 |     0.00044s |   0.4%
- reduce.pad                     |    138 |     0.00016s |   0.2%
- reduce.threshold               |    138 |     0.00238s |   2.3%
-----------------------------------------------------------------

[Iteration 140] [Rank 1] a = 0.9636833667755127, b = 0.9995060278158224, delta = 0.009776824153959751, c = 1.2055551289479383e-05, d = 1.2228266923999145e-05, m = 5.986421887141203e-05
[Iteration 150] [Rank 1] a = 1.1576091051101685, b = 0.9995002591150537, delta = 0.011641277000308037, c = 5.181469035592857e-07, d = 5.181469035592857e-07, m = 5.689939288370443e-05
[Iteration 160] [Rank 1] a = 1.2147676944732666, b = 0.9995001036710213, delta = 0.011512826196849346, c = 2.0725876142371433e-07, d = 2.0725876142371433e-07, m = 5.7239034047765406e-05
- batch.evaluate                 |    138 |     0.00276s |   2.6%
- batch.forward                  |    138 |     0.02582s |  24.3%
- batch.mom                      |    138 |     0.00126s |   1.2%
- batch.reduce                   |    138 |     0.02086s |  19.7%
- batch.reporting.compr_err      |    138 |     0.00001s |   0.0%
- batch.reporting.lr             |    138 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |    138 |     0.00001s |   0.0%
- batch.step                     |    138 |     0.00048s |   0.5%
- batch.update_runavg            |    138 |     0.00130s |   1.2%
- batch.wd                       |    138 |     0.00001s |   0.0%
- reduce.combine                 |    138 |     0.00555s |   5.3%
- reduce.flatpack                |    138 |     0.00002s |   0.0%
- reduce.flatput                 |    138 |     0.00012s |   0.1%
- reduce.gather.context          |    138 |     0.00140s |   1.3%
- reduce.gather.tensors          |    138 |     0.00029s |   0.3%
[Iteration 170] [Rank 3] a = 1.0523654222488403, b = 0.9995000345847849, delta = 0.034253109246492386, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 5.952326183344213e-06
[Iteration 180] [Rank 3] a = 1.029092788696289, b = 0.9995000691279032, delta = 0.03375677019357681, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 5.6408353696139245e-06
[Iteration 190] [Rank 3] a = 1.081451177597046, b = 0.9995000000416666, delta = 0.035429541021585464, c = 0.0, d = 0.0, m = 5.367387017044496e-06
[Iteration 200] [Rank 3] a = 0.8263992667198181, b = 0.9995212267880644, delta = 0.028142085298895836, c = 4.2453502964957486e-05, d = 4.2798934233997006e-05, m = 5.404023012411853e-06
[Iteration 210] [Rank 3] a = 0.9739977717399597, b = 0.999500172757258, delta = 0.037378694862127304, c = 3.4543126903952387e-07, d = 3.4543126903952387e-07, m = 5.153638080267398e-06
[Iteration 170] [Rank 1] a = 1.2197306156158447, b = 0.9995001209425806, delta = 0.012464839033782482, c = 2.4180188832766673e-07, d = 2.4180188832766673e-07, m = 5.462702610304456e-05
[Iteration 180] [Rank 1] a = 1.0686291456222534, b = 0.9995002418434945, delta = 0.01147997472435236, c = 4.836037766553335e-07, d = 4.836037766553335e-07, m = 5.938116191593415e-05
[Iteration 190] [Rank 1] a = 1.1506681442260742, b = 0.9995001900288173, delta = 0.011290187947452068, c = 3.7997439594347627e-07, d = 4.1451752284742866e-07, m = 5.680680518278623e-05
[Iteration 200] [Rank 1] a = 0.9669181108474731, b = 0.999503057107638, delta = 0.01189431082457304, c = 6.114133461999572e-06, d = 6.148676588903524e-06, m = 5.4271033205869914e-05
[Iteration 210] [Rank 1] a = 0.9361177086830139, b = 0.9995098793735399, delta = 0.011296773329377174, c = 1.9758668589060766e-05, d = 1.9896841096676574e-05, m = 5.2478376784689896e-05
- reduce.heur_params             |    138 |     0.01045s |   9.9%
- reduce.heur_params.alpha       |    137 |     0.00836s |   7.9%
- reduce.heur_params.beta        |    137 |     0.00201s |   1.9%
[Iteration 220] [Rank 3] a = 1.108912467956543, b = 0.9995000345847849, delta = 0.039674676954746246, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 4.9460756006727106e-06
[Iteration 230] [Rank 3] a = 1.2257527112960815, b = 0.9995000000416666, delta = 0.041358642280101776, c = 0.0, d = 0.0, m = 4.8113641044790814e-06
[Iteration 240] [Rank 3] a = 1.1000146865844727, b = 0.9995000000416666, delta = 0.03584480285644531, c = 0.0, d = 0.0, m = 4.712341839092292e-06
[Iteration 250] [Rank 3] a = 0.7177302837371826, b = 0.9995006909040323, delta = 0.030825892463326454, c = 1.3817250761580955e-06, d = 1.3817250761580955e-06, m = 4.878838214629548e-06
[Iteration 260] [Rank 3] a = 1.1542009115219116, b = 0.9995000000416666, delta = 0.04278382658958435, c = 0.0, d = 0.0, m = 4.712953061493276e-06
[Iteration 270] [Rank 3] a = 1.021190881729126, b = 0.9995000000416666, delta = 0.04877700284123421, c = 0.0, d = 0.0, m = 4.558290631779491e-06
--- Timer summary -----------------------------------------------
[Iteration 220] [Rank 1] a = 1.0830814838409424, b = 0.9995020553572057, delta = 0.012540490366518497, c = 4.110632101570334e-06, d = 4.110632101570334e-06, m = 5.054269050640664e-05
[Iteration 230] [Rank 1] a = 1.0265015363693237, b = 0.9995020035425283, delta = 0.01145630981773138, c = 4.007002720858477e-06, d = 4.110632101570334e-06, m = 4.9657165529217716e-05
[Iteration 240] [Rank 1] a = 0.9057156443595886, b = 0.9995044215608146, delta = 0.01350573729723692, c = 8.84304048741181e-06, d = 8.84304048741181e-06, m = 4.797796661748467e-05
[Iteration 250] [Rank 1] a = 0.7539172172546387, b = 0.9996508843925003, delta = 0.011290856637060642, c = 0.000301768756632928, d = 0.00030401405988168497, m = 4.791131701578202e-05
[Iteration 260] [Rank 1] a = 0.9649406671524048, b = 0.9995010708783334, delta = 0.013166475109755993, c = 2.141673868045048e-06, d = 2.1762169949490005e-06, m = 4.680170178220833e-05
- reduce.memory                  |    138 |     0.00042s |   0.4%
- reduce.pad                     |    138 |     0.00029s |   0.3%
- reduce.threshold               |    138 |     0.00209s |   2.0%
-----------------------------------------------------------------

[Iteration 140] [Rank 2] a = 1.2612892389297485, b = 0.9995000000416666, delta = 0.03807978704571724, c = 0.0, d = 0.0, m = 4.20470700037259e-06
[Iteration 150] [Rank 2] a = 1.0621706247329712, b = 0.9995000000416666, delta = 0.03974614664912224, c = 0.0, d = 0.0, m = 3.933341218454024e-06
[Iteration 160] [Rank 2] a = 0.9827780723571777, b = 0.9995001382141396, delta = 0.04189874976873398, c = 2.763450152316191e-07, d = 2.763450152316191e-07, m = 3.755760474867621e-06
[Iteration 170] [Rank 2] a = 0.8627471923828125, b = 0.9995001209425806, delta = 0.03766069933772087, c = 2.4180188832766673e-07, d = 2.4180188832766673e-07, m = 3.5559220052062824e-06
  Event                          |  Count | Average time |  Frac.
- batch                          |    277 |     0.10648s |  96.0%
- batch.accumulate               |    277 |     0.00083s |   0.7%
- batch.backward                 |    277 |     0.05168s |  46.7%
- batch.evaluate                 |    277 |     0.00277s |   2.5%
- batch.forward                  |    277 |     0.02537s |  22.9%
- batch.mom                      |    277 |     0.00126s |   1.1%
- batch.reduce                   |    277 |     0.02181s |  19.7%
- batch.reporting.compr_err      |    277 |     0.00001s |   0.0%
- batch.reporting.lr             |    277 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |    277 |     0.00001s |   0.0%
- batch.step                     |    277 |     0.00047s |   0.4%
- batch.update_runavg            |    277 |     0.00129s |   1.2%
- batch.wd                       |    277 |     0.00001s |   0.0%
- epoch_metrics.collect          |      1 |     0.07486s | 100.0%
[Iteration 270] [Rank 1] a = 1.13243567943573, b = 0.9995004663737636, delta = 0.01411886140704155, c = 9.326644264067144e-07, d = 9.326644264067144e-07, m = 4.972119841397104e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    277 |     0.10638s |  96.0%
- batch.accumulate               |    277 |     0.00083s |   0.7%
- batch.backward                 |    277 |     0.05163s |  46.7%
- batch.evaluate                 |    277 |     0.00277s |   2.5%
- batch.forward                  |    277 |     0.02538s |  22.9%
- batch.mom                      |    277 |     0.00126s |   1.1%
- batch.reduce                   |    277 |     0.02172s |  19.7%
- batch.reporting.compr_err      |    277 |     0.00001s |   0.0%
- batch.reporting.lr             |    277 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |    277 |     0.00001s |   0.0%
[Iteration 180] [Rank 2] a = 0.9433534145355225, b = 0.9995000000416666, delta = 0.04391656816005707, c = 0.0, d = 0.0, m = 3.4659542966998882e-06
[Iteration 190] [Rank 2] a = 0.9367411732673645, b = 0.9995000518563442, delta = 0.04154129698872566, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 3.287926948240077e-06
[Iteration 200] [Rank 2] a = 0.9773507714271545, b = 0.9995000691279032, delta = 0.04683499038219452, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 3.243788658269162e-06
[Iteration 210] [Rank 2] a = 0.7753368616104126, b = 0.9995013817663982, delta = 0.040009573101997375, c = 2.763450152316191e-06, d = 2.763450152316191e-06, m = 3.1151024584284655e-06
[Iteration 220] [Rank 2] a = 0.8073722124099731, b = 0.9995007254471505, delta = 0.04471317678689957, c = 1.4508113299660003e-06, d = 1.4508113299660003e-06, m = 2.989934273962468e-06
- reduce.combine                 |    277 |     0.00529s |   4.8%
- reduce.flatpack                |    277 |     0.00002s |   0.0%
- reduce.flatput                 |    277 |     0.00012s |   0.1%
- reduce.gather.context          |    277 |     0.00277s |   2.5%
- reduce.gather.tensors          |    277 |     0.00030s |   0.3%
- batch.step                     |    277 |     0.00048s |   0.4%
- batch.update_runavg            |    277 |     0.00130s |   1.2%
- batch.wd                       |    277 |     0.00001s |   0.0%
- epoch_metrics.collect          |      1 |     0.07592s | 100.0%
[Iteration 230] [Rank 2] a = 0.9498544931411743, b = 0.9995000000416666, delta = 0.04724005609750748, c = 0.0, d = 0.0, m = 2.907604153768183e-06
[Iteration 240] [Rank 2] a = 1.1734009981155396, b = 0.999500172757258, delta = 0.049449559301137924, c = 3.4543126903952387e-07, d = 3.4543126903952387e-07, m = 2.8487329760002225e-06
[Iteration 250] [Rank 2] a = 1.0690356492996216, b = 0.9995000173132257, delta = 0.05004148930311203, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 2.7956537048880026e-06
[Iteration 260] [Rank 2] a = 0.8191120028495789, b = 0.9995002763866128, delta = 0.04481130465865135, c = 5.526900304632381e-07, d = 5.526900304632381e-07, m = 2.6952903425248667e-06
[Iteration 270] [Rank 2] a = 1.0217094421386719, b = 0.9995000173132257, delta = 0.0519682876765728, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 2.602971197437681e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- reduce.heur_params             |    277 |     0.01029s |   9.3%
- reduce.heur_params.alpha       |    276 |     0.00817s |   7.4%
- reduce.heur_params.beta        |    276 |     0.00205s |   1.9%
- reduce.memory                  |    277 |     0.00042s |   0.4%
- reduce.pad                     |    277 |     0.00028s |   0.2%
- reduce.threshold               |    277 |     0.00213s |   1.9%
- test.last                      |      1 |     0.41764s | 100.0%
- test.runavg                    |      1 |     0.44891s | 100.0%
-----------------------------------------------------------------
- reduce.combine                 |    277 |     0.00528s |   4.8%
- reduce.flatpack                |    277 |     0.00002s |   0.0%
- reduce.flatput                 |    277 |     0.00016s |   0.1%
- reduce.gather.context          |    277 |     0.00207s |   1.9%
- reduce.gather.tensors          |    277 |     0.00042s |   0.4%
- reduce.heur_params             |    277 |     0.01063s |   9.6%
- reduce.heur_params.alpha       |    276 |     0.00826s |   7.5%
- reduce.heur_params.beta        |    276 |     0.00225s |   2.0%
- reduce.memory                  |    277 |     0.00043s |   0.4%
- reduce.pad                     |    277 |     0.00016s |   0.1%
- reduce.threshold               |    277 |     0.00235s |   2.1%
- test.last                      |      1 |     0.41755s | 100.0%
- test.runavg                    |      1 |     0.44899s | 100.0%
-----------------------------------------------------------------
- batch                          |    277 |     0.10636s |  95.9%
- batch.accumulate               |    277 |     0.00083s |   0.8%
- batch.backward                 |    277 |     0.05200s |  47.0%
- batch.evaluate                 |    277 |     0.00275s |   2.5%
- batch.forward                  |    277 |     0.02578s |  23.3%
- batch.mom                      |    277 |     0.00126s |   1.1%
- batch.reduce                   |    277 |     0.02094s |  18.9%
- batch.reporting.compr_err      |    277 |     0.00001s |   0.0%
- batch.reporting.lr             |    277 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |    277 |     0.00001s |   0.0%
- batch.step                     |    277 |     0.00048s |   0.4%
- batch.update_runavg            |    277 |     0.00130s |   1.2%
- batch.wd                       |    277 |     0.00001s |   0.0%
- epoch_metrics.collect          |      1 |     0.10027s | 100.0%
- reduce.combine                 |    277 |     0.00549s |   5.0%
- reduce.flatpack                |    277 |     0.00002s |   0.0%
- reduce.flatput                 |    277 |     0.00012s |   0.1%
- reduce.gather.context          |    277 |     0.00158s |   1.4%
- reduce.gather.tensors          |    277 |     0.00029s |   0.3%
- reduce.heur_params             |    277 |     0.01043s |   9.4%
- reduce.heur_params.alpha       |    276 |     0.00835s |   7.6%
- reduce.heur_params.beta        |    276 |     0.00201s |   1.8%
- reduce.memory                  |    277 |     0.00042s |   0.4%
- reduce.pad                     |    277 |     0.00029s |   0.3%
- reduce.threshold               |    277 |     0.00208s |   1.9%
- test.last                      |      1 |     0.41756s | 100.0%
- test.runavg                    |      1 |     0.44898s | 100.0%
-----------------------------------------------------------------
[Iteration 140] [Rank 0] a = 0.9867528676986694, b = 0.9995000691279032, delta = 0.05432331562042236, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 1.2327731530545282e-06
timer                          - epoch: -1.000, value:  0.009 (event:reduce.heur_params.alpha)
[Iteration 150] [Rank 0] a = 1.2365593910217285, b = 0.9995000000416666, delta = 0.06370777636766434, c = 0.0, d = 0.0, m = 1.1744663147343813e-06
[Iteration 160] [Rank 0] a = 1.0524985790252686, b = 0.9995000000416666, delta = 0.06924444437026978, c = 0.0, d = 0.0, m = 1.1135330970901422e-06
[Iteration 170] [Rank 0] a = 0.9453504681587219, b = 0.9995000691279032, delta = 0.05080093443393707, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 1.10962219931819e-06
timer                          - epoch:  1.237, value:  0.000 (event:batch.step)
[Iteration 180] [Rank 0] a = 0.940666139125824, b = 0.9995000691279032, delta = 0.059463053941726685, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 1.0496530274681668e-06
timer                          - epoch: -1.000, value:  0.000 (event:batch.reporting.compr_err)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.memory)
[Iteration 190] [Rank 0] a = 0.8503487706184387, b = 0.9995000000416666, delta = 0.060145605355501175, c = 0.0, d = 0.0, m = 1.0207403573084157e-06
timer                          - epoch: -1.000, value:  0.002 (event:reduce.heur_params.beta)
[Iteration 200] [Rank 0] a = 1.565557599067688, b = 0.9995000000416666, delta = 0.08626106381416321, c = 0.0, d = 0.0, m = 9.778626471815386e-07
[Iteration 210] [Rank 0] a = 1.5560929775238037, b = 0.9995000000416666, delta = 0.08299101144075394, c = 0.0, d = 0.0, m = 9.721188983681016e-07
timer                          - epoch:  1.532, value:  0.001 (event:batch.update_runavg)
timer                          - epoch: -1.000, value:  0.005 (event:reduce.combine)
timer                          - epoch: -1.000, value:  0.000 (event:batch.reporting.compr_err)
[Iteration 220] [Rank 0] a = 0.9209612011909485, b = 0.9995000173132257, delta = 0.06136929243803024, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 9.286005291238974e-07
[Iteration 230] [Rank 0] a = 0.7529171705245972, b = 0.9995000518563442, delta = 0.06355912238359451, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 8.909435068993442e-07
[Iteration 240] [Rank 0] a = 1.157249927520752, b = 0.9995000000416666, delta = 0.08481034636497498, c = 0.0, d = 0.0, m = 8.661581571808484e-07
timer                          - epoch:  1.748, value:  0.000 (event:batch.reporting.lr)
timer                          - epoch:  2.000, value:  0.052 (event:batch.backward)
[Iteration 250] [Rank 0] a = 0.946523904800415, b = 0.9995000000416666, delta = 0.06866805255413055, c = 0.0, d = 0.0, m = 8.437606017853876e-07
[Iteration 260] [Rank 0] a = 1.1740429401397705, b = 0.9995000000416666, delta = 0.07853416353464127, c = 0.0, d = 0.0, m = 8.187118123672402e-07
timer                          - epoch: -1.000, value:  0.009 (event:reduce.heur_params.alpha)
[Iteration 270] [Rank 0] a = 1.0084706544876099, b = 0.9995000345847849, delta = 0.07177723944187164, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 7.91687679706452e-07
timer                          - epoch:  1.942, value:  0.000 (event:batch.step)
timer                          - epoch:  1.957, value:  0.001 (event:batch.update_runavg)
timer                          - epoch:  1.964, value:  0.001 (event:batch.mom)
cross_entropy                  - bits:26560256.000, epoch:  2.000, ratio_transmit_grad:  0.004, value:  7.301 (split:train)
last_cross_entropy             - bits:26560256.000, epoch:  2.000, ratio_transmit_grad:  0.004, value:  7.301 (split:train)
perplexity                     - bits:26560256.000, epoch:  2.000, ratio_transmit_grad:  0.004, value:1485.693 (split:train)
last_perplexity                - bits:26560256.000, epoch:  2.000, ratio_transmit_grad:  0.004, value:1485.693 (split:train)
timer                          - epoch:  2.000, value:  0.001 (event:epoch_metrics.collect)
last_cross_entropy             - bits:26560256.000, epoch:  2.000, ratio_transmit_grad:  0.004, value:  7.016 (split:test)
last_perplexity                - bits:26560256.000, epoch:  2.000, ratio_transmit_grad:  0.004, value:1115.735 (split:test)
timer                          - epoch:  1.000, value:  0.418 (event:test.last)
runavg_cross_entropy           - bits:26560256.000, epoch:  2.000, ratio_transmit_grad:  0.004, value:  7.058 (split:test)
runavg_perplexity              - bits:26560256.000, epoch:  2.000, ratio_transmit_grad:  0.004, value:1164.032 (split:test)
timer                          - epoch:  1.000, value:  0.449 (event:test.runavg)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    277 |     0.10614s |  95.7%
- batch.accumulate               |    277 |     0.00083s |   0.8%
- batch.backward                 |    277 |     0.05163s |  46.6%
- batch.evaluate                 |    277 |     0.00276s |   2.5%
- batch.forward                  |    277 |     0.02553s |  23.1%
- batch.mom                      |    277 |     0.00126s |   1.1%
- batch.reduce                   |    277 |     0.02125s |  19.2%
- batch.reporting.compr_err      |    277 |     0.00002s |   0.0%
- batch.reporting.lr             |    277 |     0.00003s |   0.0%
- batch.reporting.memory_norm    |    277 |     0.00001s |   0.0%
- batch.step                     |    277 |     0.00048s |   0.4%
- batch.update_runavg            |    277 |     0.00130s |   1.2%
- batch.wd                       |    277 |     0.00001s |   0.0%
- epoch_metrics.collect          |      1 |     0.00089s | 100.0%
- reduce.combine                 |    277 |     0.00573s |   5.2%
- reduce.flatpack                |    277 |     0.00002s |   0.0%
- reduce.flatput                 |    277 |     0.00011s |   0.1%
- reduce.gather.context          |    277 |     0.00144s |   1.3%
- reduce.gather.tensors          |    277 |     0.00028s |   0.3%
- reduce.heur_params             |    277 |     0.01074s |   9.7%
- reduce.heur_params.alpha       |    276 |     0.00872s |   7.9%
- reduce.heur_params.beta        |    276 |     0.00194s |   1.8%
- reduce.memory                  |    277 |     0.00043s |   0.4%
- reduce.pad                     |    277 |     0.00030s |   0.3%
- reduce.threshold               |    277 |     0.00199s |   1.8%
- test.last                      |      1 |     0.41752s | 100.0%
- test.runavg                    |      1 |     0.44919s | 100.0%
-----------------------------------------------------------------

[Iteration 280] [Rank 0] a = 0.9203598499298096, b = 0.9995000000416666, delta = 0.07544061541557312, c = 0.0, d = 0.0, m = 7.654806093626755e-07
timer                          - epoch:  2.036, value:  0.105 (event:batch)
timer                          - epoch:  2.050, value:  0.000 (event:batch.reporting.memory_norm)
[Iteration 290] [Rank 0] a = 1.1838935613632202, b = 0.9995000000416666, delta = 0.09171908348798752, c = 0.0, d = 0.0, m = 7.429739906936025e-07
timer                          - epoch: -1.000, value:  0.009 (event:reduce.heur_params.alpha)
timer                          - epoch: -1.000, value:  0.000 (event:batch.reporting.compr_err)
[Iteration 300] [Rank 0] a = 0.9156395196914673, b = 0.9995000173132257, delta = 0.0811658650636673, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 7.20929977443951e-07
[Iteration 310] [Rank 0] a = 0.9096989631652832, b = 0.9995000000416666, delta = 0.091225266456604, c = 0.0, d = 0.0, m = 7.138542656324836e-07
[Iteration 320] [Rank 0] a = 0.8631843328475952, b = 0.9995000863994624, delta = 0.07758820801973343, c = 1.7271563451976193e-07, d = 1.7271563451976193e-07, m = 6.921538699259257e-07
[Iteration 330] [Rank 0] a = 1.3842793703079224, b = 0.9995000000416666, delta = 0.09917325526475906, c = 0.0, d = 0.0, m = 6.851227435783921e-07
[Iteration 340] [Rank 0] a = 0.8446558713912964, b = 0.9995000000416666, delta = 0.08197646588087082, c = 0.0, d = 0.0, m = 6.769845076220355e-07
timer                          - epoch:  2.475, value:  0.001 (event:batch.accumulate)
[Iteration 350] [Rank 0] a = 1.0088878870010376, b = 0.9995000000416666, delta = 0.10110706835985184, c = 0.0, d = 0.0, m = 6.600591229196836e-07
[Iteration 360] [Rank 0] a = 1.1598879098892212, b = 0.9995000000416666, delta = 0.09433752298355103, c = 0.0, d = 0.0, m = 6.420619986856532e-07
[Iteration 370] [Rank 0] a = 1.1032037734985352, b = 0.9995000000416666, delta = 0.08644028007984161, c = 0.0, d = 0.0, m = 6.270834493210771e-07
timer                          - epoch: -1.000, value:  0.000 (event:reduce.gather.tensors)
[Iteration 380] [Rank 0] a = 1.1113511323928833, b = 0.9995000000416666, delta = 0.11238814145326614, c = 0.0, d = 0.0, m = 6.121658605130887e-07
[Iteration 390] [Rank 0] a = 0.905100405216217, b = 0.9995000000416666, delta = 0.09233462065458298, c = 0.0, d = 0.0, m = 5.96862827015608e-07
timer                          - epoch:  3.000, value:  0.026 (event:batch.forward)
timer                          - epoch: -1.000, value:  0.000 (event:reduce.pad)
timer                          - epoch:  2.863, value:  0.001 (event:batch.mom)
[Iteration 400] [Rank 0] a = 0.8476368188858032, b = 0.9995000518563442, delta = 0.08948294818401337, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 5.826676069285147e-07
[Iteration 410] [Rank 0] a = 1.2608681917190552, b = 0.9995000000416666, delta = 0.1159142330288887, c = 0.0, d = 0.0, m = 5.702557567963925e-07
cross_entropy                  - bits:30670144.000, epoch:  3.000, ratio_transmit_grad:  0.002, value:  7.225 (split:train)
last_cross_entropy             - bits:30670144.000, epoch:  3.000, ratio_transmit_grad:  0.002, value:  7.225 (split:train)
perplexity                     - bits:30670144.000, epoch:  3.000, ratio_transmit_grad:  0.002, value:1386.022 (split:train)
last_perplexity                - bits:30670144.000, epoch:  3.000, ratio_transmit_grad:  0.002, value:1386.022 (split:train)

[Iteration 280] [Rank 3] a = 1.0238442420959473, b = 0.9995000518563442, delta = 0.04191732034087181, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 4.422257819369339e-06
[Iteration 290] [Rank 3] a = 0.9133219718933105, b = 0.9995014853957532, delta = 0.037403590977191925, c = 2.970708913739905e-06, d = 2.970708913739905e-06, m = 4.3092254050422e-06
[Iteration 300] [Rank 3] a = 1.0346665382385254, b = 0.9995000173132257, delta = 0.045268405228853226, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 4.297119082364097e-06
[Iteration 310] [Rank 3] a = 0.7323554158210754, b = 0.9995018480984956, delta = 0.038029979914426804, c = 3.6961145787229056e-06, d = 3.7306577056268577e-06, m = 4.185160841610695e-06
[Iteration 320] [Rank 3] a = 0.9865410327911377, b = 0.9995001209425806, delta = 0.043049756437540054, c = 2.4180188832766673e-07, d = 2.4180188832766673e-07, m = 4.066081152853086e-06

[Iteration 280] [Rank 1] a = 0.9406751394271851, b = 0.9995021071718831, delta = 0.012375544756650925, c = 4.214261482282191e-06, d = 4.283347736090096e-06, m = 4.821114152296617e-05
[Iteration 290] [Rank 1] a = 1.2927896976470947, b = 0.9995014853957532, delta = 0.013921014033257961, c = 2.970708913739905e-06, d = 2.970708913739905e-06, m = 4.74424326471545e-05
[Iteration 300] [Rank 1] a = 0.9681959748268127, b = 0.9995017617406998, delta = 0.013865351676940918, c = 3.5233989442031435e-06, d = 3.5233989442031435e-06, m = 4.59516544409917e-05
[Iteration 310] [Rank 1] a = 0.85071861743927, b = 0.9995079276873405, delta = 0.013948562555015087, c = 1.5855295248914147e-05, d = 1.592438150272205e-05, m = 4.471491153011663e-05
[Iteration 320] [Rank 1] a = 1.1885294914245605, b = 0.9995000691279032, delta = 0.01453481987118721, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 4.37215908385905e-05
last_cross_entropy             - bits:30670144.000, epoch:  3.000, ratio_transmit_grad:  0.002, value:  6.946 (split:test)
last_perplexity                - bits:30670144.000, epoch:  3.000, ratio_transmit_grad:  0.002, value:1040.608 (split:test)
timer                          - epoch:  2.000, value:  0.413 (event:test.last)
runavg_cross_entropy           - bits:30670144.000, epoch:  3.000, ratio_transmit_grad:  0.002, value:  6.986 (split:test)
runavg_perplexity              - bits:30670144.000, epoch:  3.000, ratio_transmit_grad:  0.002, value:1083.297 (split:test)
timer                          - epoch:  2.000, value:  0.449 (event:test.runavg)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    416 |     0.10592s |  94.3%
- batch.accumulate               |    416 |     0.00083s |   0.7%
- batch.backward                 |    416 |     0.05167s |  46.1%
[Iteration 330] [Rank 3] a = 0.8280979990959167, b = 0.999500172757258, delta = 0.04271614924073219, c = 3.4543126903952387e-07, d = 3.4543126903952387e-07, m = 4.011698916359013e-06
[Iteration 340] [Rank 3] a = 0.8988161683082581, b = 0.9995002245719353, delta = 0.04542437940835953, c = 4.49060649751381e-07, d = 4.49060649751381e-07, m = 3.9700284061372355e-06
[Iteration 350] [Rank 3] a = 1.1647717952728271, b = 0.9995000173132257, delta = 0.053677093237638474, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 3.8929415126485565e-06
[Iteration 360] [Rank 3] a = 1.2034544944763184, b = 0.9995000000416666, delta = 0.05065108835697174, c = 0.0, d = 0.0, m = 3.798021587456168e-06
[Iteration 370] [Rank 3] a = 0.9586794376373291, b = 0.9995000345847849, delta = 0.05176696553826332, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 3.698256066374629e-06
[Iteration 330] [Rank 1] a = 0.8448059558868408, b = 0.9995058205571116, delta = 0.013221463188529015, c = 1.1641033766631954e-05, d = 1.1710120020439858e-05, m = 4.2873134122905566e-05
[Iteration 340] [Rank 1] a = 0.9344362616539001, b = 0.9995038688709202, delta = 0.014094987884163857, c = 7.737660426485335e-06, d = 7.772203553389287e-06, m = 4.234946838627614e-05
[Iteration 350] [Rank 1] a = 1.2261649370193481, b = 0.9995001209425806, delta = 0.015286174602806568, c = 2.4180188832766673e-07, d = 2.4180188832766673e-07, m = 4.155203560757805e-05
[Iteration 360] [Rank 1] a = 1.0316803455352783, b = 0.999500172757258, delta = 0.0158228762447834, c = 3.4543126903952387e-07, d = 3.4543126903952387e-07, m = 4.047574149687504e-05
[Iteration 370] [Rank 1] a = 1.1980539560317993, b = 0.9995001554856989, delta = 0.014762944541871548, c = 3.1088814213557147e-07, d = 3.1088814213557147e-07, m = 4.081880302141929e-05
- batch.evaluate                 |    416 |     0.00276s |   2.5%
- batch.forward                  |    416 |     0.02552s |  22.8%
- batch.mom                      |    416 |     0.00126s |   1.1%
- batch.reduce                   |    416 |     0.02100s |  18.7%
- batch.reporting.compr_err      |    416 |     0.00001s |   0.0%
- batch.reporting.lr             |    416 |     0.00003s |   0.0%
- batch.reporting.memory_norm    |    416 |     0.00001s |   0.0%
- batch.step                     |    416 |     0.00048s |   0.4%
- batch.update_runavg            |    416 |     0.00130s |   1.2%
- batch.wd                       |    416 |     0.00001s |   0.0%
- epoch_metrics.collect          |      2 |     0.00081s |   0.0%
- reduce.combine                 |    416 |     0.00563s |   5.0%
- reduce.flatpack                |    416 |     0.00002s |   0.0%
- reduce.flatput                 |    416 |     0.00010s |   0.1%
- reduce.gather.context          |    416 |     0.00133s |   1.2%
[Iteration 380] [Rank 3] a = 1.041347861289978, b = 0.9995000000416666, delta = 0.05126393586397171, c = 0.0, d = 0.0, m = 3.6188685311581572e-06
[Iteration 390] [Rank 3] a = 0.9112420082092285, b = 0.9995001209425806, delta = 0.04808228835463524, c = 2.4180188832766673e-07, d = 2.4180188832766673e-07, m = 3.5764946456590864e-06
[Iteration 400] [Rank 3] a = 1.3201169967651367, b = 0.9995000000416666, delta = 0.06341791898012161, c = 0.0, d = 0.0, m = 3.4907509514435435e-06
[Iteration 410] [Rank 3] a = 0.968359112739563, b = 0.9995003109297312, delta = 0.048596903681755066, c = 6.217762842711429e-07, d = 6.563194111750953e-07, m = 3.4219547734657417e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    416 |     0.10630s |  94.7%
- batch.accumulate               |    416 |     0.00082s |   0.7%
- batch.backward                 |    416 |     0.05163s |  46.0%
[Iteration 380] [Rank 1] a = 0.8804178833961487, b = 0.9995033507241443, delta = 0.012900440953671932, c = 6.701366619366763e-06, d = 6.701366619366763e-06, m = 4.0237574973725256e-05
[Iteration 390] [Rank 1] a = 0.9052905440330505, b = 0.9995069604800217, delta = 0.014258635230362415, c = 1.3920880142292812e-05, d = 1.3989966396100716e-05, m = 3.9362997426967605e-05
[Iteration 400] [Rank 1] a = 0.8637115955352783, b = 0.9995092921405239, delta = 0.014778759330511093, c = 1.8584202274326385e-05, d = 1.8618745401230337e-05, m = 3.8486470346052745e-05
[Iteration 410] [Rank 1] a = 0.8493552207946777, b = 0.9995043006599003, delta = 0.014363616704940796, c = 8.601238599084144e-06, d = 8.635781725988096e-06, m = 3.7838171405824565e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    416 |     0.10619s |  94.6%
- batch.accumulate               |    416 |     0.00083s |   0.7%
- reduce.gather.tensors          |    416 |     0.00026s |   0.2%
- reduce.heur_params             |    416 |     0.01073s |   9.6%
- reduce.heur_params.alpha       |    415 |     0.00873s |   7.8%
- batch.evaluate                 |    416 |     0.00276s |   2.5%
- batch.forward                  |    416 |     0.02537s |  22.6%
- batch.mom                      |    416 |     0.00126s |   1.1%
- batch.reduce                   |    416 |     0.02167s |  19.3%
- batch.reporting.compr_err      |    416 |     0.00001s |   0.0%
- batch.reporting.lr             |    416 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |    416 |     0.00001s |   0.0%
- batch.step                     |    416 |     0.00047s |   0.4%
- batch.update_runavg            |    416 |     0.00129s |   1.2%
- batch.wd                       |    416 |     0.00001s |   0.0%
- epoch_metrics.collect          |      2 |     0.03782s |   0.5%
- reduce.combine                 |    416 |     0.00524s |   4.7%
- reduce.flatpack                |    416 |     0.00002s |   0.0%
- reduce.flatput                 |    416 |     0.00012s |   0.1%
- reduce.gather.context          |    416 |     0.00273s |   2.4%
- batch.backward                 |    416 |     0.05162s |  46.0%
- batch.evaluate                 |    416 |     0.00277s |   2.5%
- batch.forward                  |    416 |     0.02539s |  22.6%
- batch.mom                      |    416 |     0.00126s |   1.1%
- batch.reduce                   |    416 |     0.02154s |  19.2%
- batch.reporting.compr_err      |    416 |     0.00001s |   0.0%
- batch.reporting.lr             |    416 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |    416 |     0.00001s |   0.0%
- batch.step                     |    416 |     0.00048s |   0.4%
- batch.update_runavg            |    416 |     0.00130s |   1.2%
- batch.wd                       |    416 |     0.00001s |   0.0%
- epoch_metrics.collect          |      2 |     0.03858s |   0.5%
- reduce.combine                 |    416 |     0.00525s |   4.7%
- reduce.flatpack                |    416 |     0.00002s |   0.0%
- reduce.flatput                 |    416 |     0.00016s |   0.1%
- reduce.heur_params.beta        |    415 |     0.00192s |   1.7%
- reduce.memory                  |    416 |     0.00043s |   0.4%
- reduce.pad                     |    416 |     0.00030s |   0.3%
- reduce.threshold               |    416 |     0.00198s |   1.8%
- test.last                      |      2 |     0.41544s |   5.1%
- test.runavg                    |      2 |     0.44931s |   5.5%
-----------------------------------------------------------------

[Iteration 420] [Rank 0] a = 0.9985089302062988, b = 0.9995000000416666, delta = 0.11495979130268097, c = 0.0, d = 0.0, m = 5.571207403274041e-07
[Iteration 430] [Rank 0] a = 0.8151450157165527, b = 0.9995000000416666, delta = 0.11209861934185028, c = 0.0, d = 0.0, m = 5.441945050529866e-07
timer                          - epoch:  3.137, value:  0.001 (event:batch.accumulate)
[Iteration 440] [Rank 0] a = 1.0915632247924805, b = 0.9995000000416666, delta = 0.13380981981754303, c = 0.0, d = 0.0, m = 5.32794442631938e-07
- reduce.gather.tensors          |    416 |     0.00028s |   0.3%
- reduce.heur_params             |    416 |     0.01027s |   9.2%
- reduce.heur_params.alpha       |    415 |     0.00816s |   7.3%
- reduce.heur_params.beta        |    415 |     0.00204s |   1.8%
- reduce.gather.context          |    416 |     0.00197s |   1.8%
- reduce.gather.tensors          |    416 |     0.00040s |   0.4%
- reduce.heur_params             |    416 |     0.01061s |   9.5%
- reduce.heur_params.alpha       |    415 |     0.00827s |   7.4%
timer                          - epoch:  3.187, value:  0.000 (event:batch.reporting.lr)
[Iteration 450] [Rank 0] a = 1.0071501731872559, b = 0.9995000000416666, delta = 0.11757448315620422, c = 0.0, d = 0.0, m = 5.209808186267955e-07
[Iteration 460] [Rank 0] a = 1.1135238409042358, b = 0.9995000000416666, delta = 0.12610653042793274, c = 0.0, d = 0.0, m = 5.182967652812134e-07
timer                          - epoch: -1.000, value:  0.011 (event:reduce.heur_params)
timer                          - epoch: -1.000, value:  0.005 (event:reduce.combine)
[Iteration 470] [Rank 0] a = 1.0807855129241943, b = 0.9995000000416666, delta = 0.12545621395111084, c = 0.0, d = 0.0, m = 5.072925876743937e-07
[Iteration 480] [Rank 0] a = 0.9206175208091736, b = 0.9995000345847849, delta = 0.11414789408445358, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 4.971768556259108e-07
timer                          - epoch:  4.000, value:  0.003 (event:batch.evaluate)

[Iteration 280] [Rank 2] a = 0.9443680047988892, b = 0.9995009672489787, delta = 0.04710191860795021, c = 1.934415106621334e-06, d = 1.934415106621334e-06, m = 2.5334494746033973e-06
[Iteration 290] [Rank 2] a = 0.9547604322433472, b = 0.9995000173132257, delta = 0.05223934352397919, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 2.498856922526122e-06
[Iteration 300] [Rank 2] a = 0.8825091123580933, b = 0.9995001900288173, delta = 0.05250946804881096, c = 3.7997439594347627e-07, d = 3.7997439594347627e-07, m = 2.4206583913125165e-06
[Iteration 310] [Rank 2] a = 1.0654703378677368, b = 0.9995000518563442, delta = 0.054433420300483704, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 2.5555249640068684e-06
[Iteration 320] [Rank 2] a = 1.1343505382537842, b = 0.9995000000416666, delta = 0.05963313207030296, c = 0.0, d = 0.0, m = 2.4839844184546173e-06
- reduce.memory                  |    416 |     0.00041s |   0.4%
- reduce.pad                     |    416 |     0.00027s |   0.2%
- reduce.threshold               |    416 |     0.00212s |   1.9%
- test.last                      |      2 |     0.41550s |   5.1%
- test.runavg                    |      2 |     0.44916s |   5.5%
-----------------------------------------------------------------

[Iteration 420] [Rank 3] a = 1.1158208847045898, b = 0.9995000173132257, delta = 0.05445681884884834, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 3.359052428315689e-06
[Iteration 430] [Rank 3] a = 0.9258236885070801, b = 0.9995000000416666, delta = 0.061075277626514435, c = 0.0, d = 0.0, m = 3.2858448185805993e-06
[Iteration 440] [Rank 3] a = 0.8733810782432556, b = 0.9995063905185666, delta = 0.04710456356406212, c = 1.2780956954462383e-05, d = 1.2884586335174241e-05, m = 3.2457223345103704e-06
- reduce.heur_params.beta        |    415 |     0.00224s |   2.0%
- reduce.memory                  |    416 |     0.00043s |   0.4%
- reduce.pad                     |    416 |     0.00016s |   0.1%
- reduce.threshold               |    416 |     0.00234s |   2.1%
- test.last                      |      2 |     0.41546s |   5.1%
- test.runavg                    |      2 |     0.44921s |   5.5%
-----------------------------------------------------------------

[Iteration 420] [Rank 1] a = 0.9842032194137573, b = 0.9995014853957532, delta = 0.01623094640672207, c = 2.970708913739905e-06, d = 2.970708913739905e-06, m = 3.7453446883247396e-05
[Iteration 430] [Rank 1] a = 1.0132286548614502, b = 0.999500656360914, delta = 0.015120245516300201, c = 1.3126388223501907e-06, d = 1.347181949254143e-06, m = 3.669786464597736e-05
[Iteration 440] [Rank 1] a = 1.0576545000076294, b = 0.9995003109297312, delta = 0.018233617767691612, c = 6.217762842711429e-07, d = 6.217762842711429e-07, m = 3.6013363847234e-05
timer                          - epoch:  3.511, value:  0.106 (event:batch)
[Iteration 490] [Rank 0] a = 0.8896788954734802, b = 0.9995000000416666, delta = 0.11537014693021774, c = 0.0, d = 0.0, m = 4.884581060980493e-07
[Iteration 500] [Rank 0] a = 0.8837388157844543, b = 0.9995001554856989, delta = 0.10595925897359848, c = 3.1088814213557147e-07, d = 3.1088814213557147e-07, m = 4.794668752297121e-07
timer                          - epoch: -1.000, value:  0.000 (event:reduce.gather.tensors)
[Iteration 510] [Rank 0] a = 0.6670819520950317, b = 0.9995000000416666, delta = 0.11424393206834793, c = 0.0, d = 0.0, m = 4.7015156089430475e-07
[Iteration 520] [Rank 0] a = 1.162595272064209, b = 0.9995000000416666, delta = 0.1539793312549591, c = 0.0, d = 0.0, m = 4.6152534813515056e-07
[Iteration 530] [Rank 0] a = 1.1442575454711914, b = 0.9995000000416666, delta = 0.1609063595533371, c = 0.0, d = 0.0, m = 4.5283372199324567e-07
timer                          - epoch:  4.000, value:  0.052 (event:batch.backward)
[Iteration 330] [Rank 2] a = 1.1546335220336914, b = 0.9995000000416666, delta = 0.06543249636888504, c = 0.0, d = 0.0, m = 2.4165578446764967e-06
[Iteration 340] [Rank 2] a = 0.6550328731536865, b = 0.9995106565937089, delta = 0.04220062866806984, c = 2.1313109299738623e-05, d = 2.145128180735443e-05, m = 2.412751309672541e-06
[Iteration 350] [Rank 2] a = 0.7920234203338623, b = 0.9995001209425806, delta = 0.051053594797849655, c = 2.4180188832766673e-07, d = 2.4180188832766673e-07, m = 2.345684985058986e-06
[Iteration 360] [Rank 2] a = 0.711332380771637, b = 0.999501571753549, delta = 0.04965618997812271, c = 3.1434245482596672e-06, d = 3.1434245482596672e-06, m = 2.2897021708716777e-06
[Iteration 370] [Rank 2] a = 0.703821063041687, b = 0.9995002936581718, delta = 0.05276734009385109, c = 5.872331573671905e-07, d = 5.872331573671905e-07, m = 2.2309645923062043e-06
[Iteration 450] [Rank 3] a = 0.935183048248291, b = 0.9995001209425806, delta = 0.050547435879707336, c = 2.4180188832766673e-07, d = 2.4180188832766673e-07, m = 3.2078386718211356e-06
[Iteration 460] [Rank 3] a = 1.011635661125183, b = 0.9995000000416666, delta = 0.0642349049448967, c = 0.0, d = 0.0, m = 3.1390036274628455e-06
[Iteration 470] [Rank 3] a = 0.9808556437492371, b = 0.9995000173132257, delta = 0.06410150974988937, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 3.0729448349800498e-06
[Iteration 480] [Rank 3] a = 0.7773913145065308, b = 0.9995004318306452, delta = 0.055225979536771774, c = 8.635781725988096e-07, d = 8.635781725988096e-07, m = 3.013654422863735e-06
[Iteration 490] [Rank 3] a = 1.1471439599990845, b = 0.9995000000416666, delta = 0.08233271539211273, c = 0.0, d = 0.0, m = 2.9529097057832832e-06
[Iteration 500] [Rank 3] a = 1.0624010562896729, b = 0.9995000000416666, delta = 0.07670502364635468, c = 0.0, d = 0.0, m = 2.8970031200067194e-06
[Iteration 450] [Rank 1] a = 1.0749938488006592, b = 0.9995006045462366, delta = 0.01827072724699974, c = 1.2090094416383336e-06, d = 1.2090094416383336e-06, m = 3.561610842235032e-05
[Iteration 460] [Rank 1] a = 1.0199000835418701, b = 0.9995006736324731, delta = 0.01928754709661007, c = 1.347181949254143e-06, d = 1.347181949254143e-06, m = 3.5003052528543415e-05
[Iteration 470] [Rank 1] a = 0.9010825157165527, b = 0.999501986270969, delta = 0.017300693318247795, c = 3.972459593954525e-06, d = 4.041545847762429e-06, m = 3.434158866035992e-05
[Iteration 480] [Rank 1] a = 1.1678929328918457, b = 0.9995002418434945, delta = 0.01984877698123455, c = 4.836037766553335e-07, d = 4.836037766553335e-07, m = 3.368924378776116e-05
[Iteration 490] [Rank 1] a = 0.702023983001709, b = 0.9996763426741463, delta = 0.014159312471747398, c = 0.0003526853256893539, d = 0.0003550342583188226, m = 3.4022376954170224e-05
[Iteration 540] [Rank 0] a = 1.0215078592300415, b = 0.9995000000416666, delta = 0.1556708961725235, c = 0.0, d = 0.0, m = 4.4471881494644964e-07
[Iteration 550] [Rank 0] a = 1.1116162538528442, b = 0.9995000000416666, delta = 0.16893929243087769, c = 0.0, d = 0.0, m = 4.36647693078093e-07
cross_entropy                  - bits:34297344.000, epoch:  4.000, ratio_transmit_grad:  0.001, value:  7.219 (split:train)
last_cross_entropy             - bits:34297344.000, epoch:  4.000, ratio_transmit_grad:  0.001, value:  7.219 (split:train)
perplexity                     - bits:34297344.000, epoch:  4.000, ratio_transmit_grad:  0.001, value:1387.531 (split:train)
last_perplexity                - bits:34297344.000, epoch:  4.000, ratio_transmit_grad:  0.001, value:1387.531 (split:train)
last_cross_entropy             - bits:34297344.000, epoch:  4.000, ratio_transmit_grad:  0.001, value:  6.913 (split:test)
[Iteration 380] [Rank 2] a = 0.9776386618614197, b = 0.9995001554856989, delta = 0.0522674135863781, c = 3.1088814213557147e-07, d = 3.4543126903952387e-07, m = 2.179571576826808e-06
[Iteration 390] [Rank 2] a = 0.892819344997406, b = 0.9995000518563442, delta = 0.06696604192256927, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 2.124976550948248e-06
[Iteration 400] [Rank 2] a = 1.0259766578674316, b = 0.9995000000416666, delta = 0.07499033957719803, c = 0.0, d = 0.0, m = 2.0742243209981742e-06
[Iteration 410] [Rank 2] a = 1.0312594175338745, b = 0.9995000173132257, delta = 0.06538280844688416, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 2.029891973197704e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    416 |     0.10613s |  94.5%
- batch.accumulate               |    416 |     0.00083s |   0.7%
[Iteration 510] [Rank 3] a = 0.940998375415802, b = 0.9995000000416666, delta = 0.07745851576328278, c = 0.0, d = 0.0, m = 2.8509909533741506e-06
[Iteration 520] [Rank 3] a = 0.9684873819351196, b = 0.9995000000416666, delta = 0.07874778658151627, c = 0.0, d = 0.0, m = 2.7987225966787663e-06
[Iteration 530] [Rank 3] a = 0.6548495292663574, b = 0.999504922436032, delta = 0.0636364221572876, c = 9.84479116762643e-06, d = 9.913877421434335e-06, m = 2.7654017414068076e-06
[Iteration 540] [Rank 3] a = 0.8414517641067505, b = 0.9995002418434945, delta = 0.06601027399301529, c = 4.836037766553335e-07, d = 4.836037766553335e-07, m = 2.724948293678327e-06
[Iteration 550] [Rank 3] a = 0.9793794751167297, b = 0.9995001036710213, delta = 0.07472535222768784, c = 2.0725876142371433e-07, d = 2.0725876142371433e-07, m = 2.6761833054009407e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
[Iteration 500] [Rank 1] a = 0.9122982025146484, b = 0.9995008463480648, delta = 0.01728884130716324, c = 1.692613218293667e-06, d = 1.692613218293667e-06, m = 3.339355094612886e-05
[Iteration 510] [Rank 1] a = 1.2002040147781372, b = 0.9995002073003761, delta = 0.020075678825378418, c = 4.1451752284742866e-07, d = 4.1451752284742866e-07, m = 3.2807993868002016e-05
[Iteration 520] [Rank 1] a = 0.9034784436225891, b = 0.9995005872746774, delta = 0.01756679266691208, c = 1.174466314734381e-06, d = 1.2090094416383336e-06, m = 3.224816376642187e-05
[Iteration 530] [Rank 1] a = 0.9108833074569702, b = 0.9995018308269366, delta = 0.017726866528391838, c = 3.661571451818953e-06, d = 3.6961145787229056e-06, m = 3.261261497551232e-05
[Iteration 540] [Rank 1] a = 0.9227062463760376, b = 0.9995017962838182, delta = 0.019505836069583893, c = 3.592485198011048e-06, d = 3.592485198011048e-06, m = 3.2182381929793765e-05
last_perplexity                - bits:34297344.000, epoch:  4.000, ratio_transmit_grad:  0.001, value:1006.788 (split:test)
timer                          - epoch:  3.000, value:  0.420 (event:test.last)
- batch.backward                 |    416 |     0.05198s |  46.3%
- batch.evaluate                 |    416 |     0.00275s |   2.5%
- batch.forward                  |    416 |     0.02577s |  23.0%
- batch.mom                      |    416 |     0.00126s |   1.1%
- batch.reduce                   |    416 |     0.02073s |  18.5%
- batch.reporting.compr_err      |    416 |     0.00001s |   0.0%
- batch.reporting.lr             |    416 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |    416 |     0.00001s |   0.0%
- batch.step                     |    416 |     0.00048s |   0.4%
- batch.update_runavg            |    416 |     0.00130s |   1.2%
- batch.wd                       |    416 |     0.00001s |   0.0%
- epoch_metrics.collect          |      2 |     0.05155s |   0.6%
- reduce.combine                 |    416 |     0.00547s |   4.9%
- reduce.flatpack                |    416 |     0.00002s |   0.0%
- reduce.flatput                 |    416 |     0.00011s |   0.1%
- batch                          |    555 |     0.10623s |  94.1%
- batch.accumulate               |    555 |     0.00082s |   0.7%
- batch.backward                 |    555 |     0.05170s |  45.8%
- batch.evaluate                 |    555 |     0.00277s |   2.5%
- batch.forward                  |    555 |     0.02537s |  22.5%
- batch.mom                      |    555 |     0.00126s |   1.1%
- batch.reduce                   |    555 |     0.02151s |  19.1%
- batch.reporting.compr_err      |    555 |     0.00001s |   0.0%
- batch.reporting.lr             |    555 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |    555 |     0.00001s |   0.0%
- batch.step                     |    555 |     0.00047s |   0.4%
- batch.update_runavg            |    555 |     0.00129s |   1.1%
- batch.wd                       |    555 |     0.00001s |   0.0%
- epoch_metrics.collect          |      3 |     0.02544s |   0.2%
- reduce.combine                 |    555 |     0.00520s |   4.6%
[Iteration 550] [Rank 1] a = 0.9823171496391296, b = 0.9995008808911828, delta = 0.01936616748571396, c = 1.7616994721015717e-06, d = 1.7616994721015717e-06, m = 3.1622884809010493e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    555 |     0.10612s |  94.0%
- batch.accumulate               |    555 |     0.00083s |   0.7%
- batch.backward                 |    555 |     0.05170s |  45.8%
- batch.evaluate                 |    555 |     0.00277s |   2.5%
- batch.forward                  |    555 |     0.02539s |  22.5%
- batch.mom                      |    555 |     0.00126s |   1.1%
- batch.reduce                   |    555 |     0.02139s |  19.0%
- batch.reporting.compr_err      |    555 |     0.00001s |   0.0%
- batch.reporting.lr             |    555 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |    555 |     0.00001s |   0.0%
runavg_cross_entropy           - bits:34297344.000, epoch:  4.000, ratio_transmit_grad:  0.001, value:  6.963 (split:test)
- reduce.gather.context          |    416 |     0.00147s |   1.3%
- reduce.gather.tensors          |    416 |     0.00027s |   0.2%
- reduce.heur_params             |    416 |     0.01041s |   9.3%
- reduce.heur_params.alpha       |    415 |     0.00835s |   7.5%
- reduce.heur_params.beta        |    415 |     0.00199s |   1.8%
- reduce.flatpack                |    555 |     0.00002s |   0.0%
- reduce.flatput                 |    555 |     0.00012s |   0.1%
- reduce.gather.context          |    555 |     0.00274s |   2.4%
- batch.step                     |    555 |     0.00048s |   0.4%
- batch.update_runavg            |    555 |     0.00129s |   1.1%
- batch.wd                       |    555 |     0.00001s |   0.0%
- epoch_metrics.collect          |      3 |     0.02604s |   0.2%
- reduce.memory                  |    416 |     0.00042s |   0.4%
- reduce.pad                     |    416 |     0.00029s |   0.3%
- reduce.threshold               |    416 |     0.00206s |   1.8%
- test.last                      |      2 |     0.41547s |   5.1%
- test.runavg                    |      2 |     0.44920s |   5.5%
-----------------------------------------------------------------

[Iteration 420] [Rank 2] a = 0.8831542134284973, b = 0.9995000173132257, delta = 0.07175903022289276, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 1.9830708649444742e-06
[Iteration 430] [Rank 2] a = 0.8342515826225281, b = 0.9995000000416666, delta = 0.07069162279367447, c = 0.0, d = 0.0, m = 1.93962462692007e-06
[Iteration 440] [Rank 2] a = 1.1092321872711182, b = 0.9995000000416666, delta = 0.06798055768013, c = 0.0, d = 0.0, m = 2.060211618657039e-06
[Iteration 450] [Rank 2] a = 0.9101057052612305, b = 0.9995000000416666, delta = 0.07679433375597, c = 0.0, d = 0.0, m = 2.0149902052975116e-06
- reduce.gather.tensors          |    555 |     0.00027s |   0.2%
- reduce.heur_params             |    555 |     0.01021s |   9.1%
- reduce.heur_params.alpha       |    554 |     0.00813s |   7.2%
- reduce.heur_params.beta        |    554 |     0.00200s |   1.8%
- reduce.memory                  |    555 |     0.00041s |   0.4%
- reduce.pad                     |    555 |     0.00027s |   0.2%
- reduce.threshold               |    555 |     0.00208s |   1.8%
- test.last                      |      3 |     0.41697s |   3.9%
- test.runavg                    |      3 |     0.44833s |   4.2%
-----------------------------------------------------------------
- reduce.combine                 |    555 |     0.00521s |   4.6%
- reduce.flatpack                |    555 |     0.00002s |   0.0%
- reduce.flatput                 |    555 |     0.00016s |   0.1%
- reduce.gather.context          |    555 |     0.00191s |   1.7%
- reduce.gather.tensors          |    555 |     0.00039s |   0.3%
- reduce.heur_params             |    555 |     0.01058s |   9.4%
- reduce.heur_params.alpha       |    554 |     0.00826s |   7.3%
- reduce.heur_params.beta        |    554 |     0.00223s |   2.0%
- reduce.memory                  |    555 |     0.00043s |   0.4%
- reduce.pad                     |    555 |     0.00015s |   0.1%
- reduce.threshold               |    555 |     0.00234s |   2.1%
- test.last                      |      3 |     0.41693s |   3.9%
- test.runavg                    |      3 |     0.44838s |   4.2%
-----------------------------------------------------------------
[Iteration 460] [Rank 2] a = 0.9327561259269714, b = 0.9995000000416666, delta = 0.07275871187448502, c = 0.0, d = 0.0, m = 1.9725549148515075e-06
[Iteration 470] [Rank 2] a = 1.1510837078094482, b = 0.9995000000416666, delta = 0.08940690755844116, c = 0.0, d = 0.0, m = 1.9309681279281553e-06
[Iteration 480] [Rank 2] a = 0.7408202886581421, b = 0.9995003109297312, delta = 0.06643524020910263, c = 6.217762842711429e-07, d = 6.217762842711429e-07, m = 1.893624054476955e-06
[Iteration 490] [Rank 2] a = 0.7738375663757324, b = 0.9995002418434945, delta = 0.06765275448560715, c = 4.836037766553335e-07, d = 4.836037766553335e-07, m = 1.85913782395895e-06
[Iteration 500] [Rank 2] a = 1.0645701885223389, b = 0.9995000000416666, delta = 0.08824077248573303, c = 0.0, d = 0.0, m = 1.822442974701134e-06
[Iteration 510] [Rank 2] a = 1.0956283807754517, b = 0.9995000000416666, delta = 0.09055467694997787, c = 0.0, d = 0.0, m = 1.7880631110302215e-06
[Iteration 520] [Rank 2] a = 1.3755946159362793, b = 0.9995000000416666, delta = 0.11727725714445114, c = 0.0, d = 0.0, m = 1.756395345129753e-06
[Iteration 530] [Rank 2] a = 0.6941454410552979, b = 0.9995001900288173, delta = 0.07782808691263199, c = 3.7997439594347627e-07, d = 3.7997439594347627e-07, m = 1.7242289615616886e-06
[Iteration 540] [Rank 2] a = 1.0583279132843018, b = 0.9995000000416666, delta = 0.10052499920129776, c = 0.0, d = 0.0, m = 1.6924216667581524e-06
[Iteration 550] [Rank 2] a = 1.2789775133132935, b = 0.9995000000416666, delta = 0.12090611457824707, c = 0.0, d = 0.0, m = 1.6620823602134014e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    555 |     0.10604s |  93.9%
- batch.accumulate               |    555 |     0.00083s |   0.7%
- batch.backward                 |    555 |     0.05198s |  46.1%
- batch.evaluate                 |    555 |     0.00275s |   2.4%
- batch.forward                  |    555 |     0.02577s |  22.8%
- batch.mom                      |    555 |     0.00126s |   1.1%
- batch.reduce                   |    555 |     0.02061s |  18.3%
- batch.reporting.compr_err      |    555 |     0.00001s |   0.0%
- batch.reporting.lr             |    555 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |    555 |     0.00001s |   0.0%
- batch.step                     |    555 |     0.00048s |   0.4%
- batch.update_runavg            |    555 |     0.00130s |   1.2%
- batch.wd                       |    555 |     0.00001s |   0.0%
- epoch_metrics.collect          |      3 |     0.04370s |   0.4%
- reduce.combine                 |    555 |     0.00554s |   4.9%
- reduce.flatpack                |    555 |     0.00002s |   0.0%
- reduce.flatput                 |    555 |     0.00011s |   0.1%
- reduce.gather.context          |    555 |     0.00135s |   1.2%
- reduce.gather.tensors          |    555 |     0.00025s |   0.2%
- reduce.heur_params             |    555 |     0.01038s |   9.2%
- reduce.heur_params.alpha       |    554 |     0.00835s |   7.4%
- reduce.heur_params.beta        |    554 |     0.00196s |   1.7%
- reduce.memory                  |    555 |     0.00042s |   0.4%
- reduce.pad                     |    555 |     0.00029s |   0.3%
- reduce.threshold               |    555 |     0.00203s |   1.8%
- test.last                      |      3 |     0.41696s |   3.9%
- test.runavg                    |      3 |     0.44836s |   4.2%
-----------------------------------------------------------------
runavg_perplexity              - bits:34297344.000, epoch:  4.000, ratio_transmit_grad:  0.001, value:1058.372 (split:test)
timer                          - epoch:  3.000, value:  0.447 (event:test.runavg)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    555 |     0.10591s |  93.8%
- batch.accumulate               |    555 |     0.00083s |   0.7%
- batch.backward                 |    555 |     0.05167s |  45.8%
- batch.evaluate                 |    555 |     0.00276s |   2.4%
- batch.forward                  |    555 |     0.02552s |  22.6%
- batch.mom                      |    555 |     0.00126s |   1.1%
- batch.reduce                   |    555 |     0.02101s |  18.6%
- batch.reporting.compr_err      |    555 |     0.00001s |   0.0%
- batch.reporting.lr             |    555 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |    555 |     0.00001s |   0.0%
- batch.step                     |    555 |     0.00048s |   0.4%
- batch.update_runavg            |    555 |     0.00130s |   1.2%
- batch.wd                       |    555 |     0.00001s |   0.0%
- epoch_metrics.collect          |      3 |     0.00095s |   0.0%
- reduce.combine                 |    555 |     0.00558s |   4.9%
- reduce.flatpack                |    555 |     0.00002s |   0.0%
- reduce.flatput                 |    555 |     0.00010s |   0.1%
- reduce.gather.context          |    555 |     0.00148s |   1.3%
- reduce.gather.tensors          |    555 |     0.00025s |   0.2%
- reduce.heur_params             |    555 |     0.01070s |   9.5%
- reduce.heur_params.alpha       |    554 |     0.00872s |   7.7%
- reduce.heur_params.beta        |    554 |     0.00190s |   1.7%
- reduce.memory                  |    555 |     0.00042s |   0.4%
- reduce.pad                     |    555 |     0.00030s |   0.3%
- reduce.threshold               |    555 |     0.00195s |   1.7%
- test.last                      |      3 |     0.41693s |   3.9%
- test.runavg                    |      3 |     0.44844s |   4.2%
-----------------------------------------------------------------

timer                          - epoch: -1.000, value:  0.009 (event:reduce.heur_params.alpha)
[Iteration 560] [Rank 0] a = 0.7452059984207153, b = 0.9995007254471505, delta = 0.12665924429893494, c = 1.4508113299660003e-06, d = 1.4508113299660003e-06, m = 4.3145042819250484e-07
timer                          - epoch: -1.000, value:  0.011 (event:reduce.heur_params)
timer                          - epoch:  4.094, value:  0.108 (event:batch)
[Iteration 570] [Rank 0] a = 0.9476377964019775, b = 0.9995000000416666, delta = 0.15018586814403534, c = 0.0, d = 0.0, m = 4.2395487450595304e-07
[Iteration 580] [Rank 0] a = 1.1191542148590088, b = 0.9995000000416666, delta = 0.19313350319862366, c = 0.0, d = 0.0, m = 4.1808479929190025e-07
timer                          - epoch: -1.000, value:  0.002 (event:reduce.heur_params.beta)
[Iteration 590] [Rank 0] a = 1.3615666627883911, b = 0.9995000000416666, delta = 0.196977436542511, c = 0.0, d = 0.0, m = 4.110106064104806e-07
[Iteration 600] [Rank 0] a = 1.0491514205932617, b = 0.9995000000416666, delta = 0.16788268089294434, c = 0.0, d = 0.0, m = 4.0417182760165397e-07
learning_rate                  - epoch:  4.367, value:  8.892 (weight:encoder.weight)
effective_lr                   - epoch:  4.367, value:  0.000 (weight:encoder.weight)
grad_norm                      - epoch:  4.367, value:  0.177 (weight:encoder.weight)
learning_rate                  - epoch:  4.367, value:  8.892 (weight:rnn.weight_ih_l0)
effective_lr                   - epoch:  4.367, value:  0.010 (weight:rnn.weight_ih_l0)
grad_norm                      - epoch:  4.367, value:  0.003 (weight:rnn.weight_ih_l0)
learning_rate                  - epoch:  4.367, value:  8.892 (weight:rnn.weight_hh_l0)
effective_lr                   - epoch:  4.367, value:  0.010 (weight:rnn.weight_hh_l0)
grad_norm                      - epoch:  4.367, value:  0.002 (weight:rnn.weight_hh_l0)
learning_rate                  - epoch:  4.367, value:  8.892 (weight:rnn.bias_ih_l0)
effective_lr                   - epoch:  4.367, value:  6.804 (weight:rnn.bias_ih_l0)
grad_norm                      - epoch:  4.367, value:  0.003 (weight:rnn.bias_ih_l0)
learning_rate                  - epoch:  4.367, value:  8.892 (weight:rnn.bias_hh_l0)
effective_lr                   - epoch:  4.367, value:  6.515 (weight:rnn.bias_hh_l0)
grad_norm                      - epoch:  4.367, value:  0.003 (weight:rnn.bias_hh_l0)
learning_rate                  - epoch:  4.367, value:  8.892 (weight:rnn.weight_ih_l1)
effective_lr                   - epoch:  4.367, value:  0.010 (weight:rnn.weight_ih_l1)
grad_norm                      - epoch:  4.367, value:  0.006 (weight:rnn.weight_ih_l1)
learning_rate                  - epoch:  4.367, value:  8.892 (weight:rnn.weight_hh_l1)
effective_lr                   - epoch:  4.367, value:  0.010 (weight:rnn.weight_hh_l1)
grad_norm                      - epoch:  4.367, value:  0.011 (weight:rnn.weight_hh_l1)
learning_rate                  - epoch:  4.367, value:  8.892 (weight:rnn.bias_ih_l1)
effective_lr                   - epoch:  4.367, value:  3.926 (weight:rnn.bias_ih_l1)
grad_norm                      - epoch:  4.367, value:  0.009 (weight:rnn.bias_ih_l1)
learning_rate                  - epoch:  4.367, value:  8.892 (weight:rnn.bias_hh_l1)
effective_lr                   - epoch:  4.367, value:  3.954 (weight:rnn.bias_hh_l1)
grad_norm                      - epoch:  4.367, value:  0.009 (weight:rnn.bias_hh_l1)
learning_rate                  - epoch:  4.367, value:  8.892 (weight:rnn.weight_ih_l2)
effective_lr                   - epoch:  4.367, value:  0.010 (weight:rnn.weight_ih_l2)
grad_norm                      - epoch:  4.367, value:  0.036 (weight:rnn.weight_ih_l2)
learning_rate                  - epoch:  4.367, value:  8.892 (weight:rnn.weight_hh_l2)
effective_lr                   - epoch:  4.367, value:  0.009 (weight:rnn.weight_hh_l2)
grad_norm                      - epoch:  4.367, value:  0.145 (weight:rnn.weight_hh_l2)
learning_rate                  - epoch:  4.367, value:  8.892 (weight:rnn.bias_ih_l2)
effective_lr                   - epoch:  4.367, value:  0.228 (weight:rnn.bias_ih_l2)
grad_norm                      - epoch:  4.367, value:  0.031 (weight:rnn.bias_ih_l2)
learning_rate                  - epoch:  4.367, value:  8.892 (weight:rnn.bias_hh_l2)
effective_lr                   - epoch:  4.367, value:  0.228 (weight:rnn.bias_hh_l2)
grad_norm                      - epoch:  4.367, value:  0.031 (weight:rnn.bias_hh_l2)
learning_rate                  - epoch:  4.367, value:  8.892 (weight:decoder.bias)
effective_lr                   - epoch:  4.367, value:  0.041 (weight:decoder.bias)
grad_norm                      - epoch:  4.367, value:  0.035 (weight:decoder.bias)
grad_norm                      - epoch:  4.367, value:  0.240 (weight:entire_model)
[Iteration 610] [Rank 0] a = 0.8983162641525269, b = 0.9995000000416666, delta = 0.17773640155792236, c = 0.0, d = 0.0, m = 3.975569040729853e-07
timer                          - epoch:  4.396, value:  0.001 (event:batch.accumulate)
timer                          - epoch: -1.000, value:  0.005 (event:reduce.combine)
[Iteration 620] [Rank 0] a = 0.6767147183418274, b = 0.9995000173132257, delta = 0.16086825728416443, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 3.9126627156586466e-07
[Iteration 630] [Rank 0] a = 1.0468416213989258, b = 0.9995000000416666, delta = 0.19647099077701569, c = 0.0, d = 0.0, m = 3.8522976865786674e-07
[Iteration 640] [Rank 0] a = 1.2585511207580566, b = 0.9995000000416666, delta = 0.22753481566905975, c = 0.0, d = 0.0, m = 3.7965105934219286e-07
[Iteration 650] [Rank 0] a = 0.9396123290061951, b = 0.9995000000416666, delta = 0.16363584995269775, c = 0.0, d = 0.0, m = 3.738192458346323e-07
[Iteration 660] [Rank 0] a = 0.9618247151374817, b = 0.9995000000416666, delta = 0.21632227301597595, c = 0.0, d = 0.0, m = 3.684774399391367e-07
[Iteration 670] [Rank 0] a = 0.9174502491950989, b = 0.9995000000416666, delta = 0.17948122322559357, c = 0.0, d = 0.0, m = 3.629859728759604e-07

[Iteration 560] [Rank 3] a = 1.1379913091659546, b = 0.9995000000416666, delta = 0.09058953821659088, c = 0.0, d = 0.0, m = 2.629156819379433e-06
[Iteration 570] [Rank 3] a = 1.09013831615448, b = 0.9995000000416666, delta = 0.09524183720350266, c = 0.0, d = 0.0, m = 2.5959976562213727e-06
[Iteration 580] [Rank 3] a = 0.7932194471359253, b = 0.9995016235682265, delta = 0.07368379086256027, c = 3.2470539289715243e-06, d = 3.2470539289715243e-06, m = 2.5571426646110002e-06
[Iteration 590] [Rank 3] a = 1.0511887073516846, b = 0.9995000000416666, delta = 0.09470085799694061, c = 0.0, d = 0.0, m = 2.513874599219951e-06
[Iteration 600] [Rank 3] a = 1.267471432685852, b = 0.9995000000416666, delta = 0.09072569012641907, c = 0.0, d = 0.0, m = 2.4796907221584318e-06
[Iteration 610] [Rank 3] a = 1.0737305879592896, b = 0.9995000000416666, delta = 0.10189476609230042, c = 0.0, d = 0.0, m = 2.4418768203527186e-06

[Iteration 560] [Rank 1] a = 0.8866947293281555, b = 0.9995011572361292, delta = 0.01830286905169487, c = 2.31438950256481e-06, d = 2.31438950256481e-06, m = 3.1130192076800423e-05
[Iteration 570] [Rank 1] a = 0.9941043257713318, b = 0.9995005700031182, delta = 0.02206316404044628, c = 1.1399231878304288e-06, d = 1.1399231878304288e-06, m = 3.062916679111195e-05
[Iteration 580] [Rank 1] a = 1.0066888332366943, b = 0.9995008636196238, delta = 0.01946946233510971, c = 1.7271563451976192e-06, d = 1.8653288528134288e-06, m = 3.017505635230615e-05
[Iteration 590] [Rank 1] a = 0.9671558141708374, b = 0.999502072628765, delta = 0.018808450549840927, c = 4.145175228474286e-06, d = 4.145175228474286e-06, m = 2.9738125347866088e-05
[Iteration 600] [Rank 1] a = 1.1170896291732788, b = 0.9995011399645702, delta = 0.021662477403879166, c = 2.2798463756608576e-06, d = 2.2798463756608576e-06, m = 2.9269696132841557e-05
[Iteration 680] [Rank 0] a = 0.68182373046875, b = 0.9995000173132257, delta = 0.16475705802440643, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 3.5770650650025456e-07
[Iteration 690] [Rank 0] a = 0.9763011336326599, b = 0.9995000000416666, delta = 0.20382075011730194, c = 0.0, d = 0.0, m = 3.52529856623261e-07
cross_entropy                  - bits:35643008.000, epoch:  5.000, ratio_transmit_grad:  0.001, value:  7.282 (split:train)
last_cross_entropy             - bits:35643008.000, epoch:  5.000, ratio_transmit_grad:  0.001, value:  7.282 (split:train)
perplexity                     - bits:35643008.000, epoch:  5.000, ratio_transmit_grad:  0.001, value:1636.162 (split:train)
last_perplexity                - bits:35643008.000, epoch:  5.000, ratio_transmit_grad:  0.001, value:1636.162 (split:train)
timer                          - epoch:  5.000, value:  0.001 (event:epoch_metrics.collect)
[Iteration 620] [Rank 3] a = 1.2561267614364624, b = 0.9995000000416666, delta = 0.09499529004096985, c = 0.0, d = 0.0, m = 2.4088963827738516e-06
[Iteration 630] [Rank 3] a = 1.2597907781600952, b = 0.9995000000416666, delta = 0.10366155207157135, c = 0.0, d = 0.0, m = 2.372581806683512e-06
[Iteration 640] [Rank 3] a = 0.9462072849273682, b = 0.9995000345847849, delta = 0.08986158668994904, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 2.336268612585098e-06
[Iteration 650] [Rank 3] a = 0.9279816150665283, b = 0.9995000345847849, delta = 0.0967339500784874, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 2.3078098593450084e-06
[Iteration 660] [Rank 3] a = 1.0328543186187744, b = 0.9995000000416666, delta = 0.11453339457511902, c = 0.0, d = 0.0, m = 2.274411451004259e-06
[Iteration 670] [Rank 3] a = 1.4058173894882202, b = 0.9995000000416666, delta = 0.11642587929964066, c = 0.0, d = 0.0, m = 2.2477228120422782e-06
[Iteration 610] [Rank 1] a = 1.138488531112671, b = 0.9995000000416666, delta = 0.020560692995786667, c = 0.0, d = 0.0, m = 2.8874548897157525e-05
[Iteration 620] [Rank 1] a = 0.9996914863586426, b = 0.9995003627444087, delta = 0.021319210529327393, c = 7.254056649830001e-07, d = 7.254056649830001e-07, m = 2.8422819066612555e-05
[Iteration 630] [Rank 1] a = 1.103171944618225, b = 0.9995015544819897, delta = 0.02180384285748005, c = 3.1088814213557147e-06, d = 3.1088814213557147e-06, m = 2.8040862269608938e-05
[Iteration 640] [Rank 1] a = 1.0243747234344482, b = 0.9995021417150015, delta = 0.021189009770751, c = 4.283347736090096e-06, d = 4.317890862994048e-06, m = 2.779083476988329e-05
[Iteration 650] [Rank 1] a = 0.9349044561386108, b = 0.9995022626159158, delta = 0.02065163291990757, c = 4.525149624417762e-06, d = 4.559692751321715e-06, m = 2.7424165186683837e-05
last_cross_entropy             - bits:35643008.000, epoch:  5.000, ratio_transmit_grad:  0.001, value:  7.232 (split:test)
last_perplexity                - bits:35643008.000, epoch:  5.000, ratio_transmit_grad:  0.001, value:1384.819 (split:test)
runavg_cross_entropy           - bits:35643008.000, epoch:  5.000, ratio_transmit_grad:  0.001, value:  7.304 (split:test)
runavg_perplexity              - bits:35643008.000, epoch:  5.000, ratio_transmit_grad:  0.001, value:1488.553 (split:test)
timer                          - epoch:  4.000, value:  0.436 (event:test.runavg)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    694 |     0.10583s |  93.5%
- batch.accumulate               |    694 |     0.00083s |   0.7%
- batch.backward                 |    694 |     0.05168s |  45.7%
- batch.evaluate                 |    694 |     0.00276s |   2.4%
[Iteration 680] [Rank 3] a = 0.9624934196472168, b = 0.9995000863994624, delta = 0.09642881155014038, c = 1.7271563451976193e-07, d = 1.7271563451976193e-07, m = 2.2165933958528855e-06
[Iteration 690] [Rank 3] a = 0.9317930936813354, b = 0.9995000000416666, delta = 0.0928911492228508, c = 0.0, d = 0.0, m = 2.194263404228779e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    694 |     0.10613s |  93.8%
- batch.accumulate               |    694 |     0.00082s |   0.7%
- batch.backward                 |    694 |     0.05173s |  45.7%
- batch.evaluate                 |    694 |     0.00277s |   2.5%
- batch.forward                  |    694 |     0.02533s |  22.4%
- batch.mom                      |    694 |     0.00126s |   1.1%
- batch.reduce                   |    694 |     0.02139s |  18.9%
- batch.reporting.compr_err      |    694 |     0.00001s |   0.0%
[Iteration 660] [Rank 1] a = 1.1552797555923462, b = 0.9995008981627422, delta = 0.020794957876205444, c = 1.796242599005524e-06, d = 1.796242599005524e-06, m = 2.710940418710915e-05
[Iteration 670] [Rank 1] a = 1.1671488285064697, b = 0.999500172757258, delta = 0.021148348227143288, c = 3.4543126903952387e-07, d = 3.4543126903952387e-07, m = 2.687336868966729e-05
[Iteration 680] [Rank 1] a = 1.0475378036499023, b = 0.9995000691279032, delta = 0.0234889704734087, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 2.656549065752204e-05
[Iteration 690] [Rank 1] a = 0.79481041431427, b = 0.9995080658598146, delta = 0.01876896433532238, c = 1.6131640264145764e-05, d = 1.637344215247343e-05, m = 2.62339301968696e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    694 |     0.10602s |  93.7%
- batch.accumulate               |    694 |     0.00083s |   0.7%
- batch.forward                  |    694 |     0.02551s |  22.6%
- batch.mom                      |    694 |     0.00126s |   1.1%
- batch.reduce                   |    694 |     0.02091s |  18.5%
- batch.reporting.compr_err      |    694 |     0.00001s |   0.0%
- batch.reporting.lr             |    694 |     0.00003s |   0.0%
- batch.reporting.memory_norm    |    694 |     0.00001s |   0.0%
- batch.step                     |    694 |     0.00048s |   0.4%
- batch.update_runavg            |    694 |     0.00130s |   1.2%
- batch.wd                       |    694 |     0.00001s |   0.0%
- epoch_metrics.collect          |      4 |     0.00090s |   0.0%
- reduce.combine                 |    694 |     0.00554s |   4.9%
- reduce.flatpack                |    694 |     0.00002s |   0.0%
- reduce.flatput                 |    694 |     0.00010s |   0.1%
- reduce.gather.context          |    694 |     0.00148s |   1.3%
- reduce.gather.tensors          |    694 |     0.00024s |   0.2%
- batch.reporting.lr             |    694 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |    694 |     0.00001s |   0.0%
- batch.step                     |    694 |     0.00047s |   0.4%
- batch.update_runavg            |    694 |     0.00129s |   1.1%
- batch.wd                       |    694 |     0.00001s |   0.0%
- epoch_metrics.collect          |      4 |     0.01976s |   0.2%
- reduce.combine                 |    694 |     0.00519s |   4.6%
- reduce.flatpack                |    694 |     0.00002s |   0.0%
- reduce.flatput                 |    694 |     0.00011s |   0.1%
- reduce.gather.context          |    694 |     0.00272s |   2.4%
- reduce.gather.tensors          |    694 |     0.00026s |   0.2%
- reduce.heur_params             |    694 |     0.01016s |   9.0%
- reduce.heur_params.alpha       |    693 |     0.00811s |   7.2%
- reduce.heur_params.beta        |    693 |     0.00197s |   1.7%
- reduce.memory                  |    694 |     0.00041s |   0.4%
- batch.backward                 |    694 |     0.05177s |  45.8%
- batch.evaluate                 |    694 |     0.00276s |   2.4%
- batch.forward                  |    694 |     0.02536s |  22.4%
- batch.mom                      |    694 |     0.00126s |   1.1%
- batch.reduce                   |    694 |     0.02122s |  18.8%
- batch.reporting.compr_err      |    694 |     0.00001s |   0.0%
- batch.reporting.lr             |    694 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |    694 |     0.00001s |   0.0%
- batch.step                     |    694 |     0.00048s |   0.4%
- batch.update_runavg            |    694 |     0.00129s |   1.1%
- batch.wd                       |    694 |     0.00001s |   0.0%
- epoch_metrics.collect          |      4 |     0.02014s |   0.2%
- reduce.combine                 |    694 |     0.00522s |   4.6%
- reduce.flatpack                |    694 |     0.00002s |   0.0%
- reduce.flatput                 |    694 |     0.00016s |   0.1%
- reduce.heur_params             |    694 |     0.01067s |   9.4%
- reduce.heur_params.alpha       |    693 |     0.00871s |   7.7%
- reduce.heur_params.beta        |    693 |     0.00188s |   1.7%
- reduce.memory                  |    694 |     0.00042s |   0.4%
- reduce.pad                     |    694 |     0.00029s |   0.3%
- reduce.threshold               |    694 |     0.00193s |   1.7%
- test.last                      |      4 |     0.41363s |   3.4%
- test.runavg                    |      4 |     0.44526s |   3.7%
-----------------------------------------------------------------

timer                          - epoch: -1.000, value:  0.011 (event:reduce.heur_params)
[Iteration 700] [Rank 0] a = 0.8007115721702576, b = 0.9995000000416666, delta = 0.2036326825618744, c = 0.0, d = 0.0, m = 3.4750090003805046e-07
timer                          - epoch: -1.000, value:  0.000 (event:reduce.pad)
- reduce.pad                     |    694 |     0.00027s |   0.2%
- reduce.threshold               |    694 |     0.00205s |   1.8%
- test.last                      |      4 |     0.41366s |   3.4%
- reduce.gather.context          |    694 |     0.00175s |   1.5%
- reduce.gather.tensors          |    694 |     0.00038s |   0.3%
- reduce.heur_params             |    694 |     0.01058s |   9.4%
- reduce.heur_params.alpha       |    693 |     0.00826s |   7.3%
[Iteration 710] [Rank 0] a = 1.0656459331512451, b = 0.9995000000416666, delta = 0.23303522169589996, c = 0.0, d = 0.0, m = 3.43390746775157e-07
[Iteration 720] [Rank 0] a = 0.8626493215560913, b = 0.9995000000416666, delta = 0.17743831872940063, c = 0.0, d = 0.0, m = 3.386280457103143e-07
- test.runavg                    |      4 |     0.44514s |   3.7%
-----------------------------------------------------------------

[Iteration 700] [Rank 3] a = 1.0624417066574097, b = 0.9995000000416666, delta = 0.10508003830909729, c = 0.0, d = 0.0, m = 2.1883391193689316e-06
[Iteration 710] [Rank 3] a = 0.948390007019043, b = 0.9995000000416666, delta = 0.10757789015769958, c = 0.0, d = 0.0, m = 2.157657959115935e-06
[Iteration 720] [Rank 3] a = 0.7245209217071533, b = 0.9995007945333871, delta = 0.08115603029727936, c = 1.5889838375818099e-06, d = 1.5889838375818099e-06, m = 2.1305587426057743e-06
[Iteration 730] [Rank 3] a = 0.7900362610816956, b = 0.9995000173132257, delta = 0.09617355465888977, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 2.1018382237495198e-06
[Iteration 740] [Rank 3] a = 0.8482789397239685, b = 0.9995000000416666, delta = 0.09314750134944916, c = 0.0, d = 0.0, m = 2.089323083276981e-06
- reduce.heur_params.beta        |    693 |     0.00223s |   2.0%
- reduce.memory                  |    694 |     0.00043s |   0.4%
- reduce.pad                     |    694 |     0.00015s |   0.1%
- reduce.threshold               |    694 |     0.00234s |   2.1%
- test.last                      |      4 |     0.41363s |   3.4%
- test.runavg                    |      4 |     0.44518s |   3.7%
-----------------------------------------------------------------

[Iteration 700] [Rank 1] a = 0.9509561657905579, b = 0.9995038861424795, delta = 0.022279804572463036, c = 7.772203553389287e-06, d = 7.875832934101144e-06, m = 2.589753906918564e-05
[Iteration 710] [Rank 1] a = 1.0009944438934326, b = 0.9995003454728494, delta = 0.021653631702065468, c = 6.908625380790477e-07, d = 6.908625380790477e-07, m = 2.5646984253803638e-05
[Iteration 720] [Rank 1] a = 1.1912343502044678, b = 0.9995000691279032, delta = 0.02486805059015751, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 2.5362847761510252e-05
timer                          - epoch: -1.000, value:  0.002 (event:reduce.heur_params.beta)
timer                          - epoch:  6.000, value:  0.052 (event:batch.backward)
[Iteration 730] [Rank 0] a = 0.9981259703636169, b = 0.9995000000416666, delta = 0.2372463196516037, c = 0.0, d = 0.0, m = 3.339956511041541e-07
timer                          - epoch: -1.000, value:  0.000 (event:reduce.memory)
[Iteration 740] [Rank 0] a = 0.8036176562309265, b = 0.9995000518563442, delta = 0.1579800695180893, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 3.305604762158267e-07
[Iteration 750] [Rank 0] a = 0.8889955878257751, b = 0.9995000000416666, delta = 0.1773301064968109, c = 0.0, d = 0.0, m = 3.261588720052298e-07
[Iteration 760] [Rank 0] a = 0.8262290358543396, b = 0.9995000000416666, delta = 0.2001267373561859, c = 0.0, d = 0.0, m = 3.2187294727454345e-07
timer                          - epoch:  5.496, value:  0.105 (event:batch)
[Iteration 750] [Rank 3] a = 1.0270206928253174, b = 0.9995000000416666, delta = 0.10289819538593292, c = 0.0, d = 0.0, m = 2.0616405247522706e-06
[Iteration 760] [Rank 3] a = 0.8147202730178833, b = 0.9995000691279032, delta = 0.0911032110452652, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 2.0362742088190605e-06
[Iteration 770] [Rank 3] a = 1.0868600606918335, b = 0.9995000000416666, delta = 0.12032458931207657, c = 0.0, d = 0.0, m = 2.0098633889900195e-06
[Iteration 780] [Rank 3] a = 0.7956215143203735, b = 0.9995013644948391, delta = 0.08730947971343994, c = 2.7289070254122384e-06, d = 2.8325364061240955e-06, m = 1.9903652417474537e-06
[Iteration 790] [Rank 3] a = 0.959592342376709, b = 0.9995000000416666, delta = 0.1194964200258255, c = 0.0, d = 0.0, m = 1.9658139792432567e-06
[Iteration 800] [Rank 3] a = 0.7476445436477661, b = 0.9995002763866128, delta = 0.09029682725667953, c = 5.526900304632381e-07, d = 5.526900304632381e-07, m = 1.946058857263114e-06
[Iteration 730] [Rank 1] a = 1.1805084943771362, b = 0.9995001382141396, delta = 0.025131816044449806, c = 2.763450152316191e-07, d = 2.763450152316191e-07, m = 2.504901226813758e-05
[Iteration 740] [Rank 1] a = 0.9854527115821838, b = 0.9995005872746774, delta = 0.023103492334485054, c = 1.174466314734381e-06, d = 1.2090094416383336e-06, m = 2.4756560251174942e-05
[Iteration 750] [Rank 1] a = 0.9063615202903748, b = 0.9995027980342502, delta = 0.02341568097472191, c = 5.595986558440287e-06, d = 5.595986558440287e-06, m = 2.444692064756838e-05
[Iteration 760] [Rank 1] a = 1.1451563835144043, b = 0.9995000173132257, delta = 0.02364652417600155, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 2.421141836142631e-05
[Iteration 770] [Rank 1] a = 0.9973695874214172, b = 0.9995003972875268, delta = 0.022691387683153152, c = 7.944919187909049e-07, d = 7.944919187909049e-07, m = 2.3932876173220952e-05
[Iteration 770] [Rank 0] a = 0.9318786263465881, b = 0.9995000345847849, delta = 0.18036338686943054, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 3.1805662502095884e-07
[Iteration 780] [Rank 0] a = 0.9388675093650818, b = 0.9995000000416666, delta = 0.22076526284217834, c = 0.0, d = 0.0, m = 3.149130135161872e-07
timer                          - epoch:  5.612, value:  0.020 (event:batch.reduce)
[Iteration 790] [Rank 0] a = 1.027417540550232, b = 0.9995000000416666, delta = 0.2285391390323639, c = 0.0, d = 0.0, m = 3.1093181233393453e-07
timer                          - epoch: -1.000, value:  0.010 (event:reduce.heur_params)
[Iteration 800] [Rank 0] a = 1.1281023025512695, b = 0.9995000000416666, delta = 0.21983632445335388, c = 0.0, d = 0.0, m = 3.0705001692402273e-07
[Iteration 810] [Rank 0] a = 0.7562270760536194, b = 0.9995000000416666, delta = 0.20352467894554138, c = 0.0, d = 0.0, m = 3.0351950963941546e-07

[Iteration 560] [Rank 2] a = 0.8851224184036255, b = 0.9995000000416666, delta = 0.10549341142177582, c = 0.0, d = 0.0, m = 1.633440410887785e-06
[Iteration 570] [Rank 2] a = 1.0847796201705933, b = 0.9995000000416666, delta = 0.10479237139225006, c = 0.0, d = 0.0, m = 1.605257219608362e-06
[Iteration 580] [Rank 2] a = 0.9640269875526428, b = 0.9995000000416666, delta = 0.1037413477897644, c = 0.0, d = 0.0, m = 1.5784009174632119e-06
[Iteration 590] [Rank 2] a = 1.1984665393829346, b = 0.9995000000416666, delta = 0.11027013510465622, c = 0.0, d = 0.0, m = 1.5546160564997015e-06
[Iteration 600] [Rank 2] a = 0.9952508807182312, b = 0.9995000345847849, delta = 0.11050817370414734, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 1.5303007551043766e-06
[Iteration 610] [Rank 2] a = 1.0662837028503418, b = 0.9995000000416666, delta = 0.11741916835308075, c = 0.0, d = 0.0, m = 1.5053114516278794e-06
[Iteration 810] [Rank 3] a = 0.9933533072471619, b = 0.9995000345847849, delta = 0.10701131075620651, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 1.9233408612513835e-06
[Iteration 820] [Rank 3] a = 0.9757863283157349, b = 0.9995000000416666, delta = 0.13013628125190735, c = 0.0, d = 0.0, m = 1.9027330426034564e-06
[Iteration 830] [Rank 3] a = 0.8689189553260803, b = 0.9995003800159677, delta = 0.10222272574901581, c = 7.599487918869525e-07, d = 7.944919187909049e-07, m = 1.8809584746135312e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    833 |     0.10614s |  93.6%
- batch.accumulate               |    833 |     0.00082s |   0.7%
- batch.backward                 |    833 |     0.05170s |  45.6%
- batch.evaluate                 |    833 |     0.00277s |   2.4%
- batch.forward                  |    833 |     0.02537s |  22.4%
[Iteration 780] [Rank 1] a = 1.017033338546753, b = 0.9995007427187096, delta = 0.022922247648239136, c = 1.4853544568699526e-06, d = 1.4853544568699526e-06, m = 2.3756781209397316e-05
[Iteration 790] [Rank 1] a = 1.080688714981079, b = 0.9995000691279032, delta = 0.024397801607847214, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 2.3490243368853302e-05
[Iteration 800] [Rank 1] a = 1.0369541645050049, b = 0.9995015544819897, delta = 0.023117471486330032, c = 3.1088814213557147e-06, d = 3.1088814213557147e-06, m = 2.3267750032474848e-05
[Iteration 810] [Rank 1] a = 1.0500754117965698, b = 0.9995003282012903, delta = 0.023380188271403313, c = 6.563194111750953e-07, d = 6.563194111750953e-07, m = 2.3007554027843566e-05
[Iteration 820] [Rank 1] a = 0.9910573959350586, b = 0.9995008981627422, delta = 0.023712843656539917, c = 1.796242599005524e-06, d = 1.796242599005524e-06, m = 2.376701769245396e-05
[Iteration 820] [Rank 0] a = 0.8828826546669006, b = 0.9995000173132257, delta = 0.21325121819972992, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 2.9986463513333724e-07
[Iteration 830] [Rank 0] a = 0.806067168712616, b = 0.9995000000416666, delta = 0.20229622721672058, c = 0.0, d = 0.0, m = 2.963392920556893e-07
timer                          - epoch:  6.000, value:  0.025 (event:batch.forward)
cross_entropy                  - bits:38294144.000, epoch:  6.000, ratio_transmit_grad:  0.001, value:  7.242 (split:train)
last_cross_entropy             - bits:38294144.000, epoch:  6.000, ratio_transmit_grad:  0.001, value:  7.242 (split:train)
perplexity                     - bits:38294144.000, epoch:  6.000, ratio_transmit_grad:  0.001, value:1407.792 (split:train)
last_perplexity                - bits:38294144.000, epoch:  6.000, ratio_transmit_grad:  0.001, value:1407.792 (split:train)
[Iteration 620] [Rank 2] a = 0.9752702116966248, b = 0.9995001382141396, delta = 0.10291051864624023, c = 2.763450152316191e-07, d = 2.763450152316191e-07, m = 1.4819613316829266e-06
[Iteration 630] [Rank 2] a = 0.901948094367981, b = 0.9995000000416666, delta = 0.11566148698329926, c = 0.0, d = 0.0, m = 1.4670153958353627e-06
[Iteration 640] [Rank 2] a = 1.203324556350708, b = 0.9995000000416666, delta = 0.14731375873088837, c = 0.0, d = 0.0, m = 1.4441290402061062e-06
[Iteration 650] [Rank 2] a = 1.2547950744628906, b = 0.9995000000416666, delta = 0.1312592774629593, c = 0.0, d = 0.0, m = 1.4228478462818452e-06
[Iteration 660] [Rank 2] a = 0.8532078266143799, b = 0.9995000000416666, delta = 0.11334045976400375, c = 0.0, d = 0.0, m = 1.4013221602564013e-06
[Iteration 670] [Rank 2] a = 0.7259698510169983, b = 0.9995003282012903, delta = 0.09700680524110794, c = 6.563194111750953e-07, d = 6.563194111750953e-07, m = 1.3814676758085846e-06
- batch.mom                      |    833 |     0.00126s |   1.1%
- batch.reduce                   |    833 |     0.02140s |  18.9%
- batch.reporting.compr_err      |    833 |     0.00001s |   0.0%
- batch.reporting.lr             |    833 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |    833 |     0.00001s |   0.0%
- batch.step                     |    833 |     0.00047s |   0.4%
- batch.update_runavg            |    833 |     0.00129s |   1.1%
- batch.wd                       |    833 |     0.00001s |   0.0%
- epoch_metrics.collect          |      5 |     0.01600s |   0.1%
- reduce.combine                 |    833 |     0.00524s |   4.6%
- reduce.flatpack                |    833 |     0.00002s |   0.0%
- reduce.flatput                 |    833 |     0.00011s |   0.1%
- reduce.gather.context          |    833 |     0.00273s |   2.4%
- reduce.gather.tensors          |    833 |     0.00026s |   0.2%
- reduce.heur_params             |    833 |     0.01014s |   8.9%
[Iteration 830] [Rank 1] a = 0.9333609342575073, b = 0.9995009499774195, delta = 0.022426612675189972, c = 1.8998719797173813e-06, d = 1.8998719797173813e-06, m = 2.349859599059576e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    833 |     0.10603s |  93.5%
- batch.accumulate               |    833 |     0.00083s |   0.7%
- batch.backward                 |    833 |     0.05173s |  45.7%
- batch.evaluate                 |    833 |     0.00277s |   2.4%
- batch.forward                  |    833 |     0.02540s |  22.4%
- batch.mom                      |    833 |     0.00126s |   1.1%
- batch.reduce                   |    833 |     0.02122s |  18.7%
- batch.reporting.compr_err      |    833 |     0.00001s |   0.0%
- batch.reporting.lr             |    833 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |    833 |     0.00001s |   0.0%
last_cross_entropy             - bits:38294144.000, epoch:  6.000, ratio_transmit_grad:  0.001, value:  6.923 (split:test)
last_perplexity                - bits:38294144.000, epoch:  6.000, ratio_transmit_grad:  0.001, value:1016.917 (split:test)
runavg_cross_entropy           - bits:38294144.000, epoch:  6.000, ratio_transmit_grad:  0.001, value:  7.004 (split:test)
runavg_perplexity              - bits:38294144.000, epoch:  6.000, ratio_transmit_grad:  0.001, value:1102.738 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    833 |     0.10583s |  93.3%
- batch.accumulate               |    833 |     0.00083s |   0.7%
- batch.backward                 |    833 |     0.05169s |  45.6%
- batch.evaluate                 |    833 |     0.00276s |   2.4%
- batch.forward                  |    833 |     0.02551s |  22.5%
- batch.mom                      |    833 |     0.00126s |   1.1%
[Iteration 680] [Rank 2] a = 0.861159086227417, b = 0.9995000000416666, delta = 0.13200800120830536, c = 0.0, d = 0.0, m = 1.3611818068539797e-06
[Iteration 690] [Rank 2] a = 0.8360355496406555, b = 0.9995000000416666, delta = 0.12389469146728516, c = 0.0, d = 0.0, m = 1.3424828842339209e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    694 |     0.10591s |  93.6%
- batch.accumulate               |    694 |     0.00083s |   0.7%
- batch.backward                 |    694 |     0.05199s |  46.0%
- batch.evaluate                 |    694 |     0.00275s |   2.4%
- batch.forward                  |    694 |     0.02577s |  22.8%
- batch.mom                      |    694 |     0.00126s |   1.1%
- batch.reduce                   |    694 |     0.02047s |  18.1%
- batch.reporting.compr_err      |    694 |     0.00001s |   0.0%
- batch.reporting.lr             |    694 |     0.00002s |   0.0%
- reduce.heur_params.alpha       |    832 |     0.00811s |   7.2%
- reduce.heur_params.beta        |    832 |     0.00195s |   1.7%
- reduce.memory                  |    833 |     0.00041s |   0.4%
- batch.step                     |    833 |     0.00048s |   0.4%
- batch.update_runavg            |    833 |     0.00129s |   1.1%
- batch.wd                       |    833 |     0.00001s |   0.0%
- batch.reduce                   |    833 |     0.02091s |  18.5%
- batch.reporting.compr_err      |    833 |     0.00001s |   0.0%
- batch.reporting.lr             |    833 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |    833 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |    694 |     0.00001s |   0.0%
- batch.step                     |    694 |     0.00048s |   0.4%
- batch.update_runavg            |    694 |     0.00130s |   1.2%
- batch.wd                       |    694 |     0.00001s |   0.0%
- epoch_metrics.collect          |      4 |     0.03369s |   0.3%
- reduce.combine                 |    694 |     0.00551s |   4.9%
- reduce.flatpack                |    694 |     0.00002s |   0.0%
- reduce.flatput                 |    694 |     0.00011s |   0.1%
- reduce.gather.context          |    694 |     0.00129s |   1.1%
- reduce.gather.tensors          |    694 |     0.00024s |   0.2%
- reduce.heur_params             |    694 |     0.01036s |   9.2%
- reduce.heur_params.alpha       |    693 |     0.00835s |   7.4%
- reduce.heur_params.beta        |    693 |     0.00194s |   1.7%
- reduce.memory                  |    694 |     0.00042s |   0.4%
- reduce.pad                     |    694 |     0.00029s |   0.3%
- reduce.pad                     |    833 |     0.00027s |   0.2%
- reduce.threshold               |    833 |     0.00203s |   1.8%
- test.last                      |      5 |     0.41504s |   3.2%
- test.runavg                    |      5 |     0.44532s |   3.5%
-----------------------------------------------------------------
- epoch_metrics.collect          |      5 |     0.01677s |   0.1%
- reduce.combine                 |    833 |     0.00526s |   4.6%
- reduce.flatpack                |    833 |     0.00002s |   0.0%
- reduce.flatput                 |    833 |     0.00016s |   0.1%
- reduce.gather.context          |    833 |     0.00172s |   1.5%
- reduce.gather.tensors          |    833 |     0.00037s |   0.3%
- reduce.heur_params             |    833 |     0.01057s |   9.3%
- reduce.heur_params.alpha       |    832 |     0.00825s |   7.3%
- reduce.heur_params.beta        |    832 |     0.00223s |   2.0%
- reduce.memory                  |    833 |     0.00043s |   0.4%
- reduce.pad                     |    833 |     0.00015s |   0.1%
- reduce.threshold               |    833 |     0.00234s |   2.1%
- test.last                      |      5 |     0.41503s |   3.2%
- test.runavg                    |      5 |     0.44535s |   3.5%
-----------------------------------------------------------------
- batch.step                     |    833 |     0.00048s |   0.4%
- batch.update_runavg            |    833 |     0.00130s |   1.1%
- batch.wd                       |    833 |     0.00001s |   0.0%
- epoch_metrics.collect          |      5 |     0.00615s |   0.0%
- reduce.combine                 |    833 |     0.00551s |   4.9%
- reduce.flatpack                |    833 |     0.00002s |   0.0%
- reduce.flatput                 |    833 |     0.00010s |   0.1%
- reduce.gather.context          |    833 |     0.00154s |   1.4%
- reduce.gather.tensors          |    833 |     0.00024s |   0.2%
- reduce.heur_params             |    833 |     0.01064s |   9.4%
- reduce.heur_params.alpha       |    832 |     0.00870s |   7.7%
- reduce.heur_params.beta        |    832 |     0.00187s |   1.6%
- reduce.memory                  |    833 |     0.00042s |   0.4%
- reduce.pad                     |    833 |     0.00029s |   0.3%
- reduce.threshold               |    833 |     0.00192s |   1.7%
- reduce.threshold               |    694 |     0.00201s |   1.8%
- test.last                      |      4 |     0.41366s |   3.4%
- test.runavg                    |      4 |     0.44516s |   3.7%
- test.last                      |      5 |     0.41503s |   3.2%
- test.runavg                    |      5 |     0.44541s |   3.5%
-----------------------------------------------------------------
-----------------------------------------------------------------

[Iteration 700] [Rank 2] a = 0.987148642539978, b = 0.9995000173132257, delta = 0.13074113428592682, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 1.3242189005562206e-06
[Iteration 710] [Rank 2] a = 1.2353267669677734, b = 0.9995000000416666, delta = 0.13978508114814758, c = 0.0, d = 0.0, m = 1.306614423283957e-06
[Iteration 720] [Rank 2] a = 1.0988032817840576, b = 0.9995000000416666, delta = 0.13021503388881683, c = 0.0, d = 0.0, m = 1.2887796306745036e-06
[Iteration 730] [Rank 2] a = 0.8618558049201965, b = 0.9995000000416666, delta = 0.13302108645439148, c = 0.0, d = 0.0, m = 1.276961584576612e-06
[Iteration 740] [Rank 2] a = 1.2922594547271729, b = 0.9995000000416666, delta = 0.1377069354057312, c = 0.0, d = 0.0, m = 1.2607075897307505e-06
[Iteration 750] [Rank 2] a = 0.8253767490386963, b = 0.9995000691279032, delta = 0.12792186439037323, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 1.2441045226339575e-06
[Iteration 760] [Rank 2] a = 0.8974857926368713, b = 0.9995000691279032, delta = 0.11633313447237015, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 1.2288002475911864e-06
[Iteration 770] [Rank 2] a = 1.242040991783142, b = 0.9995000000416666, delta = 0.15037785470485687, c = 0.0, d = 0.0, m = 1.2129969102433264e-06
[Iteration 780] [Rank 2] a = 1.035737156867981, b = 0.9995000518563442, delta = 0.1199268326163292, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 1.1992789833555272e-06
[Iteration 790] [Rank 2] a = 1.0002411603927612, b = 0.9995000000416666, delta = 0.1225118339061737, c = 0.0, d = 0.0, m = 1.184161098770633e-06
[Iteration 800] [Rank 2] a = 0.8795623183250427, b = 0.9995000345847849, delta = 0.14015379548072815, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 1.170930064539467e-06
[Iteration 810] [Rank 2] a = 0.7986201047897339, b = 0.9995000173132257, delta = 0.1245022639632225, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 1.1567901153938846e-06
[Iteration 820] [Rank 2] a = 0.8751124739646912, b = 0.9995000000416666, delta = 0.1295011043548584, c = 0.0, d = 0.0, m = 1.1461922815072698e-06
[Iteration 830] [Rank 2] a = 0.7136465907096863, b = 0.9995021244434424, delta = 0.1079726442694664, c = 4.248804609186144e-06, d = 4.317890862994048e-06, m = 1.138426734679352e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    833 |     0.10592s |  93.4%
- batch.accumulate               |    833 |     0.00083s |   0.7%
- batch.backward                 |    833 |     0.05201s |  45.9%
- batch.evaluate                 |    833 |     0.00275s |   2.4%
- batch.forward                  |    833 |     0.02577s |  22.7%
- batch.mom                      |    833 |     0.00126s |   1.1%
- batch.reduce                   |    833 |     0.02046s |  18.1%
- batch.reporting.compr_err      |    833 |     0.00001s |   0.0%
- batch.reporting.lr             |    833 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |    833 |     0.00001s |   0.0%
- batch.step                     |    833 |     0.00048s |   0.4%
- batch.update_runavg            |    833 |     0.00130s |   1.1%
- batch.wd                       |    833 |     0.00001s |   0.0%
- epoch_metrics.collect          |      5 |     0.02773s |   0.2%
- reduce.combine                 |    833 |     0.00550s |   4.9%
- reduce.flatpack                |    833 |     0.00002s |   0.0%
- reduce.flatput                 |    833 |     0.00011s |   0.1%
- reduce.gather.context          |    833 |     0.00130s |   1.1%
- reduce.gather.tensors          |    833 |     0.00024s |   0.2%
- reduce.heur_params             |    833 |     0.01037s |   9.2%
- reduce.heur_params.alpha       |    832 |     0.00836s |   7.4%
- reduce.heur_params.beta        |    832 |     0.00193s |   1.7%
- reduce.memory                  |    833 |     0.00042s |   0.4%
- reduce.pad                     |    833 |     0.00029s |   0.3%
- reduce.threshold               |    833 |     0.00199s |   1.8%
- test.last                      |      5 |     0.41504s |   3.2%
- test.runavg                    |      5 |     0.44533s |   3.5%
-----------------------------------------------------------------

[Iteration 840] [Rank 0] a = 1.3497346639633179, b = 0.9995000000416666, delta = 0.25945067405700684, c = 0.0, d = 0.0, m = 2.9289778591211144e-07
[Iteration 850] [Rank 0] a = 1.2625988721847534, b = 0.9995000000416666, delta = 0.2591490149497986, c = 0.0, d = 0.0, m = 2.8945597879211013e-07
timer                          - epoch:  6.158, value:  0.000 (event:batch.step)
[Iteration 860] [Rank 0] a = 1.0201760530471802, b = 0.9995000000416666, delta = 0.2449493557214737, c = 0.0, d = 0.0, m = 2.8609412073412976e-07
[Iteration 870] [Rank 0] a = 0.762204110622406, b = 0.9995000000416666, delta = 0.2338373363018036, c = 0.0, d = 0.0, m = 2.82809458039134e-07
[Iteration 880] [Rank 0] a = 0.7030947804450989, b = 0.9995012781370434, delta = 0.174029141664505, c = 2.5561913908924768e-06, d = 2.5561913908924768e-06, m = 2.836770977867159e-07
[Iteration 890] [Rank 0] a = 1.4812347888946533, b = 0.9995000000416666, delta = 0.312557190656662, c = 0.0, d = 0.0, m = 2.804932919754172e-07
[Iteration 900] [Rank 0] a = 0.8048295378684998, b = 0.9995000000416666, delta = 0.21037833392620087, c = 0.0, d = 0.0, m = 2.775718521471881e-07
[Iteration 910] [Rank 0] a = 0.9024298787117004, b = 0.9995000000416666, delta = 0.20848721265792847, c = 0.0, d = 0.0, m = 2.745249602465603e-07
[Iteration 920] [Rank 0] a = 0.8141636848449707, b = 0.9995000345847849, delta = 0.20744654536247253, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 2.716192454271709e-07
timer                          - epoch:  7.000, value:  0.003 (event:batch.evaluate)
[Iteration 930] [Rank 0] a = 1.0177081823349, b = 0.9995000000416666, delta = 0.26291126012802124, c = 0.0, d = 0.0, m = 2.694438105010778e-07
[Iteration 940] [Rank 0] a = 1.3799396753311157, b = 0.9995000000416666, delta = 0.2849090099334717, c = 0.0, d = 0.0, m = 2.6658043313124705e-07
timer                          - epoch:  6.827, value:  0.020 (event:batch.reduce)
[Iteration 950] [Rank 0] a = 1.0811275243759155, b = 0.9995000000416666, delta = 0.2669476270675659, c = 0.0, d = 0.0, m = 2.6377727400263243e-07
[Iteration 960] [Rank 0] a = 1.2449607849121094, b = 0.9995000000416666, delta = 0.30368852615356445, c = 0.0, d = 0.0, m = 2.610324532533855e-07
[Iteration 970] [Rank 0] a = 1.0576204061508179, b = 0.9995000000416666, delta = 0.25114232301712036, c = 0.0, d = 0.0, m = 2.584508928498613e-07
cross_entropy                  - bits:39672000.000, epoch:  7.000, ratio_transmit_grad:  0.001, value:  7.235 (split:train)
last_cross_entropy             - bits:39672000.000, epoch:  7.000, ratio_transmit_grad:  0.001, value:  7.235 (split:train)
perplexity                     - bits:39672000.000, epoch:  7.000, ratio_transmit_grad:  0.001, value:1412.754 (split:train)
last_perplexity                - bits:39672000.000, epoch:  7.000, ratio_transmit_grad:  0.001, value:1412.754 (split:train)
last_cross_entropy             - bits:39672000.000, epoch:  7.000, ratio_transmit_grad:  0.001, value:  7.700 (split:test)
last_perplexity                - bits:39672000.000, epoch:  7.000, ratio_transmit_grad:  0.001, value:2213.735 (split:test)
runavg_cross_entropy           - bits:39672000.000, epoch:  7.000, ratio_transmit_grad:  0.001, value:  7.902 (split:test)
runavg_perplexity              - bits:39672000.000, epoch:  7.000, ratio_transmit_grad:  0.001, value:2708.642 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    972 |     0.10579s |  93.2%
- batch.accumulate               |    972 |     0.00083s |   0.7%
- batch.backward                 |    972 |     0.05171s |  45.6%
- batch.evaluate                 |    972 |     0.00276s |   2.4%
- batch.forward                  |    972 |     0.02551s |  22.5%
- batch.mom                      |    972 |     0.00126s |   1.1%
- batch.reduce                   |    972 |     0.02084s |  18.4%
- batch.reporting.compr_err      |    972 |     0.00001s |   0.0%
- batch.reporting.lr             |    972 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |    972 |     0.00001s |   0.0%
- batch.step                     |    972 |     0.00048s |   0.4%
- batch.update_runavg            |    972 |     0.00130s |   1.1%
- batch.wd                       |    972 |     0.00001s |   0.0%
- epoch_metrics.collect          |      6 |     0.00524s |   0.0%
- reduce.combine                 |    972 |     0.00550s |   4.9%
- reduce.flatpack                |    972 |     0.00002s |   0.0%
- reduce.flatput                 |    972 |     0.00009s |   0.1%
- reduce.gather.context          |    972 |     0.00151s |   1.3%
- reduce.gather.tensors          |    972 |     0.00023s |   0.2%
- reduce.heur_params             |    972 |     0.01064s |   9.4%
- reduce.heur_params.alpha       |    971 |     0.00871s |   7.7%
- reduce.heur_params.beta        |    971 |     0.00186s |   1.6%
- reduce.memory                  |    972 |     0.00042s |   0.4%
- reduce.pad                     |    972 |     0.00029s |   0.3%
- reduce.threshold               |    972 |     0.00191s |   1.7%
- test.last                      |      6 |     0.41479s |   3.1%
- test.runavg                    |      6 |     0.44594s |   3.3%
-----------------------------------------------------------------

[Iteration 980] [Rank 0] a = 1.534329891204834, b = 0.9995000000416666, delta = 0.3133813440799713, c = 0.0, d = 0.0, m = 2.56344509542074e-07
[Iteration 990] [Rank 0] a = 1.0775407552719116, b = 0.9995000000416666, delta = 0.22971563041210175, c = 0.0, d = 0.0, m = 2.5480348906951884e-07
[Iteration 1000] [Rank 0] a = 1.1475704908370972, b = 0.9995000000416666, delta = 0.25639352202415466, c = 0.0, d = 0.0, m = 2.5225799966822493e-07
[Iteration 1010] [Rank 0] a = 0.8687009811401367, b = 0.9995000173132257, delta = 0.21800462901592255, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 2.49797033427099e-07
[Iteration 1020] [Rank 0] a = 0.9855775237083435, b = 0.9995000000416666, delta = 0.24686752259731293, c = 0.0, d = 0.0, m = 2.473842741642518e-07
timer                          - epoch: -1.000, value:  0.002 (event:reduce.threshold)
[Iteration 1030] [Rank 0] a = 1.013021469116211, b = 0.9995000000416666, delta = 0.26765933632850647, c = 0.0, d = 0.0, m = 2.4498481466702336e-07
[Iteration 1040] [Rank 0] a = 0.8141480088233948, b = 0.9995000345847849, delta = 0.23265260457992554, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 2.4269781957301535e-07
[Iteration 1050] [Rank 0] a = 1.061449408531189, b = 0.9995000000416666, delta = 0.2533110976219177, c = 0.0, d = 0.0, m = 2.407830139851155e-07
[Iteration 1060] [Rank 0] a = 0.9010058045387268, b = 0.9995000000416666, delta = 0.26036563515663147, c = 0.0, d = 0.0, m = 2.388391884706842e-07
[Iteration 1070] [Rank 0] a = 1.1876541376113892, b = 0.9995000000416666, delta = 0.2774493992328644, c = 0.0, d = 0.0, m = 2.366091306885116e-07
[Iteration 1080] [Rank 0] a = 1.1767257452011108, b = 0.9995000000416666, delta = 0.2742898762226105, c = 0.0, d = 0.0, m = 2.344522868587418e-07
timer                          - epoch: -1.000, value:  0.002 (event:reduce.threshold)
[Iteration 1090] [Rank 0] a = 0.9081838726997375, b = 0.9995000000416666, delta = 0.27672895789146423, c = 0.0, d = 0.0, m = 2.3230331997644352e-07
[Iteration 1100] [Rank 0] a = 1.044006586074829, b = 0.9995000000416666, delta = 0.2697872221469879, c = 0.0, d = 0.0, m = 2.3019338973142588e-07
[Iteration 1110] [Rank 0] a = 1.2533257007598877, b = 0.9995000000416666, delta = 0.28742411732673645, c = 0.0, d = 0.0, m = 2.2827690164610232e-07
cross_entropy                  - bits:45935872.000, epoch:  8.000, ratio_transmit_grad:  0.002, value:  7.190 (split:train)
last_cross_entropy             - bits:45935872.000, epoch:  8.000, ratio_transmit_grad:  0.002, value:  7.190 (split:train)
perplexity                     - bits:45935872.000, epoch:  8.000, ratio_transmit_grad:  0.002, value:1340.820 (split:train)
last_perplexity                - bits:45935872.000, epoch:  8.000, ratio_transmit_grad:  0.002, value:1340.820 (split:train)

[Iteration 840] [Rank 3] a = 1.0593233108520508, b = 0.9995000000416666, delta = 0.11507598310709, c = 0.0, d = 0.0, m = 1.8590034764243567e-06
[Iteration 850] [Rank 3] a = 0.9663735032081604, b = 0.9995000000416666, delta = 0.1249372661113739, c = 0.0, d = 0.0, m = 1.8372397296435862e-06
[Iteration 860] [Rank 3] a = 1.0877898931503296, b = 0.9995000000416666, delta = 0.12811541557312012, c = 0.0, d = 0.0, m = 1.8184689547602145e-06
[Iteration 870] [Rank 3] a = 0.849595308303833, b = 0.9995002591150537, delta = 0.11573834717273712, c = 5.181469035592857e-07, d = 5.181469035592857e-07, m = 1.7982255569219381e-06
[Iteration 880] [Rank 3] a = 0.7674999833106995, b = 0.9995006736324731, delta = 0.11202966421842575, c = 1.347181949254143e-06, d = 1.347181949254143e-06, m = 1.7793435210309447e-06
[Iteration 890] [Rank 3] a = 0.9274404644966125, b = 0.9995000000416666, delta = 0.11346568912267685, c = 0.0, d = 0.0, m = 1.7680575785126234e-06

[Iteration 840] [Rank 1] a = 1.1368666887283325, b = 0.9995002245719353, delta = 0.024623041972517967, c = 4.49060649751381e-07, d = 4.49060649751381e-07, m = 2.3247647627978016e-05
[Iteration 850] [Rank 1] a = 0.894655704498291, b = 0.999502677133336, delta = 0.02287178672850132, c = 5.35418467011262e-06, d = 5.423270923920525e-06, m = 2.298826829409736e-05
[Iteration 860] [Rank 1] a = 1.1129075288772583, b = 0.9995000345847849, delta = 0.024332843720912933, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 2.2754492482408047e-05
[Iteration 870] [Rank 1] a = 1.081669807434082, b = 0.9995001209425806, delta = 0.024167072027921677, c = 2.4180188832766673e-07, d = 2.4180188832766673e-07, m = 2.2609765481282602e-05
[Iteration 880] [Rank 1] a = 1.074450969696045, b = 0.999501209050807, delta = 0.021708492189645767, c = 2.418018883276667e-06, d = 2.418018883276667e-06, m = 2.2511297058033698e-05
[Iteration 900] [Rank 3] a = 1.164966344833374, b = 0.9995000000416666, delta = 0.13722531497478485, c = 0.0, d = 0.0, m = 1.748664329873664e-06
[Iteration 910] [Rank 3] a = 0.9227625727653503, b = 0.9995000000416666, delta = 0.1270870864391327, c = 0.0, d = 0.0, m = 1.7344744829500472e-06
[Iteration 920] [Rank 3] a = 1.0210930109024048, b = 0.9995000000416666, delta = 0.1464422643184662, c = 0.0, d = 0.0, m = 1.7157169817820859e-06
[Iteration 930] [Rank 3] a = 1.2019699811935425, b = 0.9995000000416666, delta = 0.12891699373722076, c = 0.0, d = 0.0, m = 1.7095694041101065e-06
[Iteration 940] [Rank 3] a = 1.1117488145828247, b = 0.9995000000416666, delta = 0.12489184737205505, c = 0.0, d = 0.0, m = 1.6961005690437992e-06
[Iteration 950] [Rank 3] a = 0.9984363913536072, b = 0.9995000000416666, delta = 0.15410646796226501, c = 0.0, d = 0.0, m = 1.6783019753912925e-06
[Iteration 890] [Rank 1] a = 1.0596740245819092, b = 0.9995008290765055, delta = 0.024495551362633705, c = 1.6580700913897147e-06, d = 1.7271563451976192e-06, m = 2.231113816156638e-05
[Iteration 900] [Rank 1] a = 0.8925582766532898, b = 0.9995079104157811, delta = 0.021238572895526886, c = 1.582075212201019e-05, d = 1.592438150272205e-05, m = 2.2108598023523516e-05
[Iteration 910] [Rank 1] a = 1.074622392654419, b = 0.9995001209425806, delta = 0.02636517956852913, c = 2.4180188832766673e-07, d = 2.4180188832766673e-07, m = 2.190929106078245e-05
[Iteration 920] [Rank 1] a = 0.8841227889060974, b = 0.9995113992707598, delta = 0.021691951900720596, c = 2.2798463756608576e-05, d = 2.3109351898744148e-05, m = 2.171187425657131e-05
[Iteration 930] [Rank 1] a = 0.9997128248214722, b = 0.9995009845205379, delta = 0.025840213522315025, c = 1.968958233525286e-06, d = 1.968958233525286e-06, m = 2.150704799396746e-05
[Iteration 960] [Rank 3] a = 0.9898878931999207, b = 0.9995000000416666, delta = 0.14654815196990967, c = 0.0, d = 0.0, m = 1.6610535248267874e-06
[Iteration 970] [Rank 3] a = 1.0383514165878296, b = 0.9995000000416666, delta = 0.12534897029399872, c = 0.0, d = 0.0, m = 1.645014141262267e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    972 |     0.10607s |  93.4%
- batch.accumulate               |    972 |     0.00082s |   0.7%
- batch.backward                 |    972 |     0.05173s |  45.6%
- batch.evaluate                 |    972 |     0.00277s |   2.4%
- batch.forward                  |    972 |     0.02537s |  22.4%
- batch.mom                      |    972 |     0.00126s |   1.1%
- batch.reduce                   |    972 |     0.02129s |  18.8%
- batch.reporting.compr_err      |    972 |     0.00001s |   0.0%
- batch.reporting.lr             |    972 |     0.00002s |   0.0%
[Iteration 940] [Rank 1] a = 0.9502918124198914, b = 0.9995003454728494, delta = 0.024457048624753952, c = 6.908625380790477e-07, d = 6.908625380790477e-07, m = 2.1394236090873392e-05
[Iteration 950] [Rank 1] a = 0.9951891899108887, b = 0.9995000691279032, delta = 0.02529143914580345, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 2.1234324817872598e-05
[Iteration 960] [Rank 1] a = 1.0059640407562256, b = 0.9995000863994624, delta = 0.0245310477912426, c = 1.7271563451976193e-07, d = 2.4180188832766673e-07, m = 2.102274574185096e-05
[Iteration 970] [Rank 1] a = 1.019779086112976, b = 0.9995002418434945, delta = 0.024702049791812897, c = 4.836037766553335e-07, d = 4.836037766553335e-07, m = 2.0849000511284584e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    972 |     0.10598s |  93.3%
- batch.accumulate               |    972 |     0.00083s |   0.7%
- batch.reporting.memory_norm    |    972 |     0.00001s |   0.0%
- batch.step                     |    972 |     0.00047s |   0.4%
- batch.update_runavg            |    972 |     0.00129s |   1.1%
- batch.wd                       |    972 |     0.00001s |   0.0%
- epoch_metrics.collect          |      6 |     0.01372s |   0.1%
- reduce.combine                 |    972 |     0.00521s |   4.6%
- reduce.flatpack                |    972 |     0.00002s |   0.0%
- reduce.flatput                 |    972 |     0.00011s |   0.1%
- reduce.gather.context          |    972 |     0.00272s |   2.4%
- reduce.gather.tensors          |    972 |     0.00025s |   0.2%
- reduce.heur_params             |    972 |     0.01010s |   8.9%
- reduce.heur_params.alpha       |    971 |     0.00809s |   7.1%
- reduce.heur_params.beta        |    971 |     0.00193s |   1.7%
- reduce.memory                  |    972 |     0.00041s |   0.4%
- reduce.pad                     |    972 |     0.00027s |   0.2%
- batch.backward                 |    972 |     0.05174s |  45.6%
- batch.evaluate                 |    972 |     0.00277s |   2.4%
- batch.forward                  |    972 |     0.02540s |  22.4%
- batch.mom                      |    972 |     0.00126s |   1.1%
- batch.reduce                   |    972 |     0.02116s |  18.7%
- batch.reporting.compr_err      |    972 |     0.00001s |   0.0%
- batch.reporting.lr             |    972 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |    972 |     0.00001s |   0.0%
- batch.step                     |    972 |     0.00048s |   0.4%
- batch.update_runavg            |    972 |     0.00129s |   1.1%
- batch.wd                       |    972 |     0.00001s |   0.0%
- epoch_metrics.collect          |      6 |     0.01433s |   0.1%
- reduce.combine                 |    972 |     0.00524s |   4.6%
- reduce.flatpack                |    972 |     0.00002s |   0.0%
- reduce.flatput                 |    972 |     0.00016s |   0.1%
- reduce.threshold               |    972 |     0.00201s |   1.8%
- test.last                      |      6 |     0.41481s |   3.1%
- test.runavg                    |      6 |     0.44586s |   3.3%
- reduce.gather.context          |    972 |     0.00170s |   1.5%
- reduce.gather.tensors          |    972 |     0.00037s |   0.3%
- reduce.heur_params             |    972 |     0.01056s |   9.3%
- reduce.heur_params.alpha       |    971 |     0.00825s |   7.3%
-----------------------------------------------------------------

[Iteration 980] [Rank 3] a = 0.9366155862808228, b = 0.9995000000416666, delta = 0.1296875774860382, c = 0.0, d = 0.0, m = 1.6457106239653637e-06
[Iteration 990] [Rank 3] a = 0.9547578692436218, b = 0.9995000518563442, delta = 0.12068726867437363, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 1.6293131996684616e-06
[Iteration 1000] [Rank 3] a = 0.9345647692680359, b = 0.9995000000416666, delta = 0.13566625118255615, c = 0.0, d = 0.0, m = 1.6165217149737708e-06
[Iteration 1010] [Rank 3] a = 1.120478630065918, b = 0.9995000000416666, delta = 0.12424717098474503, c = 0.0, d = 0.0, m = 1.618675209767303e-06
[Iteration 1020] [Rank 3] a = 1.1667956113815308, b = 0.9995000000416666, delta = 0.12223223596811295, c = 0.0, d = 0.0, m = 1.6033965428326255e-06
[Iteration 1030] [Rank 3] a = 1.0671957731246948, b = 0.9995000000416666, delta = 0.11653353273868561, c = 0.0, d = 0.0, m = 1.5881797298750244e-06
- reduce.heur_params.beta        |    971 |     0.00223s |   2.0%
- reduce.memory                  |    972 |     0.00043s |   0.4%
- reduce.pad                     |    972 |     0.00015s |   0.1%
- reduce.threshold               |    972 |     0.00234s |   2.1%
- test.last                      |      6 |     0.41479s |   3.1%
- test.runavg                    |      6 |     0.44588s |   3.3%
-----------------------------------------------------------------

[Iteration 980] [Rank 1] a = 0.9260851144790649, b = 0.99950322982323, delta = 0.025009609758853912, c = 6.4595647310390965e-06, d = 6.528650984847001e-06, m = 2.072154504694932e-05
[Iteration 990] [Rank 1] a = 1.0575834512710571, b = 0.9995001382141396, delta = 0.028545159846544266, c = 2.763450152316191e-07, d = 2.763450152316191e-07, m = 2.0562850708940867e-05
[Iteration 1000] [Rank 1] a = 1.022999882698059, b = 0.999500414559086, delta = 0.026088347658514977, c = 8.290350456948573e-07, d = 8.290350456948573e-07, m = 2.0380651925041716e-05
[Iteration 1040] [Rank 3] a = 1.2727242708206177, b = 0.9995000000416666, delta = 0.16025462746620178, c = 0.0, d = 0.0, m = 1.5741843807142173e-06
[Iteration 1050] [Rank 3] a = 1.1347416639328003, b = 0.9995000000416666, delta = 0.1561082899570465, c = 0.0, d = 0.0, m = 1.5613098957615159e-06
[Iteration 1060] [Rank 3] a = 0.9437371492385864, b = 0.9995000000416666, delta = 0.12868493795394897, c = 0.0, d = 0.0, m = 1.5466595539106136e-06
[Iteration 1070] [Rank 3] a = 0.7231171727180481, b = 0.9995000691279032, delta = 0.10837315022945404, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 1.5419587404520586e-06
[Iteration 1080] [Rank 3] a = 1.2315959930419922, b = 0.9995000000416666, delta = 0.14456193149089813, c = 0.0, d = 0.0, m = 1.527918235811732e-06
[Iteration 1090] [Rank 3] a = 1.0813710689544678, b = 0.9995000000416666, delta = 0.134693443775177, c = 0.0, d = 0.0, m = 1.5143250903411862e-06
[Iteration 1010] [Rank 1] a = 0.8696933388710022, b = 0.9995154926303288, delta = 0.023341787979006767, c = 3.0985184832845293e-05, d = 3.146878860950062e-05, m = 2.0235336406505996e-05
[Iteration 1020] [Rank 1] a = 0.9874254465103149, b = 0.9995001900288173, delta = 0.025889016687870026, c = 3.7997439594347627e-07, d = 3.7997439594347627e-07, m = 2.022244643783596e-05
[Iteration 1030] [Rank 1] a = 0.7249030470848083, b = 0.9998238763596726, delta = 0.019703326746821404, c = 0.0006477527157029151, d = 0.0006497907601902483, m = 2.0680544570401545e-05
[Iteration 1040] [Rank 1] a = 0.8831438422203064, b = 0.9995002073003761, delta = 0.023987451568245888, c = 4.1451752284742866e-07, d = 4.1451752284742866e-07, m = 2.0493365392884496e-05
[Iteration 1050] [Rank 1] a = 0.8336470723152161, b = 1.0002068387313223, delta = 0.017647437751293182, c = 0.0014136774685442515, d = 0.001409566836442681, m = 2.2221024939695687e-05
[Iteration 1100] [Rank 3] a = 1.0852360725402832, b = 0.9995000000416666, delta = 0.13252529501914978, c = 0.0, d = 0.0, m = 1.5017004778662814e-06
[Iteration 1110] [Rank 3] a = 1.140549898147583, b = 0.9995000000416666, delta = 0.1309424191713333, c = 0.0, d = 0.0, m = 1.4890543957552537e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1111 |     0.10601s |  93.3%
- batch.accumulate               |   1111 |     0.00082s |   0.7%
- batch.backward                 |   1111 |     0.05169s |  45.5%
- batch.evaluate                 |   1111 |     0.00277s |   2.4%
- batch.forward                  |   1111 |     0.02538s |  22.3%
- batch.mom                      |   1111 |     0.00126s |   1.1%
- batch.reduce                   |   1111 |     0.02127s |  18.7%
- batch.reporting.compr_err      |   1111 |     0.00001s |   0.0%
- batch.reporting.lr             |   1111 |     0.00002s |   0.0%
[Iteration 1060] [Rank 1] a = 0.9104030132293701, b = 0.9995015372104309, delta = 0.020556189119815826, c = 3.074338294451762e-06, d = 3.1434245482596672e-06, m = 2.2021650365535804e-05
[Iteration 1070] [Rank 1] a = 0.9002391695976257, b = 0.9995049569791503, delta = 0.020255206152796745, c = 9.913877421434335e-06, d = 9.98296367524224e-06, m = 2.184038384560782e-05
[Iteration 1080] [Rank 1] a = 0.9896416664123535, b = 0.9995004318306452, delta = 0.0230425912886858, c = 8.635781725988096e-07, d = 8.635781725988096e-07, m = 2.165959507681509e-05
[Iteration 1090] [Rank 1] a = 1.1572731733322144, b = 0.9995005700031182, delta = 0.024667182937264442, c = 1.1399231878304288e-06, d = 1.1399231878304288e-06, m = 2.1587016349093525e-05
[Iteration 1100] [Rank 1] a = 1.0688283443450928, b = 0.9995000518563442, delta = 0.023585179820656776, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 2.1400235787851593e-05
- batch.reporting.memory_norm    |   1111 |     0.00001s |   0.0%
- batch.step                     |   1111 |     0.00047s |   0.4%
- batch.update_runavg            |   1111 |     0.00129s |   1.1%
- batch.wd                       |   1111 |     0.00001s |   0.0%
- epoch_metrics.collect          |      7 |     0.01550s |   0.1%
- reduce.combine                 |   1111 |     0.00519s |   4.6%
- reduce.flatpack                |   1111 |     0.00002s |   0.0%
- reduce.flatput                 |   1111 |     0.00011s |   0.1%
- reduce.gather.context          |   1111 |     0.00275s |   2.4%
- reduce.gather.tensors          |   1111 |     0.00026s |   0.2%
- reduce.heur_params             |   1111 |     0.01008s |   8.9%
- reduce.heur_params.alpha       |   1110 |     0.00809s |   7.1%
- reduce.heur_params.beta        |   1110 |     0.00192s |   1.7%
- reduce.memory                  |   1111 |     0.00041s |   0.4%
- reduce.pad                     |   1111 |     0.00027s |   0.2%
[Iteration 1110] [Rank 1] a = 1.0243196487426758, b = 0.9995005181884409, delta = 0.022189844399690628, c = 1.0362938071185715e-06, d = 1.0362938071185715e-06, m = 2.1226083006125607e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1111 |     0.10592s |  93.2%
- batch.accumulate               |   1111 |     0.00083s |   0.7%
- batch.backward                 |   1111 |     0.05171s |  45.5%
- batch.evaluate                 |   1111 |     0.00277s |   2.4%
- batch.forward                  |   1111 |     0.02540s |  22.4%
- batch.mom                      |   1111 |     0.00126s |   1.1%
- batch.reduce                   |   1111 |     0.02113s |  18.6%
- batch.reporting.compr_err      |   1111 |     0.00001s |   0.0%
- batch.reporting.lr             |   1111 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1111 |     0.00001s |   0.0%
- reduce.threshold               |   1111 |     0.00199s |   1.8%
- test.last                      |      7 |     0.41425s |   3.0%
- batch.step                     |   1111 |     0.00048s |   0.4%
- batch.update_runavg            |   1111 |     0.00129s |   1.1%
- batch.wd                       |   1111 |     0.00001s |   0.0%
- test.runavg                    |      7 |     0.44591s |   3.3%
-----------------------------------------------------------------
- epoch_metrics.collect          |      7 |     0.01600s |   0.1%
- reduce.combine                 |   1111 |     0.00522s |   4.6%
- reduce.flatpack                |   1111 |     0.00002s |   0.0%
- reduce.flatput                 |   1111 |     0.00016s |   0.1%
- reduce.gather.context          |   1111 |     0.00169s |   1.5%
- reduce.gather.tensors          |   1111 |     0.00037s |   0.3%
- reduce.heur_params             |   1111 |     0.01056s |   9.3%
- reduce.heur_params.alpha       |   1110 |     0.00825s |   7.3%
- reduce.heur_params.beta        |   1110 |     0.00222s |   2.0%
- reduce.memory                  |   1111 |     0.00043s |   0.4%
- reduce.pad                     |   1111 |     0.00015s |   0.1%
- reduce.threshold               |   1111 |     0.00233s |   2.1%
- test.last                      |      7 |     0.41424s |   3.0%
- test.runavg                    |      7 |     0.44592s |   3.3%
-----------------------------------------------------------------

[Iteration 840] [Rank 2] a = 1.0926803350448608, b = 0.9995000000416666, delta = 0.14970768988132477, c = 0.0, d = 0.0, m = 1.1248901504382187e-06
[Iteration 850] [Rank 2] a = 1.1858550310134888, b = 0.9995000000416666, delta = 0.18213732540607452, c = 0.0, d = 0.0, m = 1.1117122910052242e-06
[Iteration 860] [Rank 2] a = 0.7395171523094177, b = 0.9995011745076885, delta = 0.11296667903661728, c = 2.348932629468762e-06, d = 2.418018883276667e-06, m = 1.102772275503992e-06
[Iteration 870] [Rank 2] a = 0.8780852556228638, b = 0.9995000000416666, delta = 0.15206453204154968, c = 0.0, d = 0.0, m = 1.0901112849700772e-06
[Iteration 880] [Rank 2] a = 1.0795271396636963, b = 0.9995000000416666, delta = 0.1680523306131363, c = 0.0, d = 0.0, m = 1.078717942544309e-06
[Iteration 890] [Rank 2] a = 0.8827869892120361, b = 0.9995001209425806, delta = 0.12838029861450195, c = 2.4180188832766673e-07, d = 2.4180188832766673e-07, m = 1.0672314224601568e-06
[Iteration 900] [Rank 2] a = 1.0786679983139038, b = 0.9995000000416666, delta = 0.17304985225200653, c = 0.0, d = 0.0, m = 1.0563449229573787e-06
[Iteration 910] [Rank 2] a = 1.2816588878631592, b = 0.9995000000416666, delta = 0.18239545822143555, c = 0.0, d = 0.0, m = 1.0450907395463599e-06
[Iteration 920] [Rank 2] a = 1.2773903608322144, b = 0.9995000000416666, delta = 0.17221134901046753, c = 0.0, d = 0.0, m = 1.0340809466545814e-06
[Iteration 930] [Rank 2] a = 0.9955164194107056, b = 0.9995000000416666, delta = 0.15028983354568481, c = 0.0, d = 0.0, m = 1.0245691797268949e-06
[Iteration 940] [Rank 2] a = 1.2629787921905518, b = 0.9995000000416666, delta = 0.15784643590450287, c = 0.0, d = 0.0, m = 1.0152595757519756e-06
[Iteration 950] [Rank 2] a = 0.892580509185791, b = 0.9995000000416666, delta = 0.15158019959926605, c = 0.0, d = 0.0, m = 1.004583870433869e-06
[Iteration 960] [Rank 2] a = 0.9527248740196228, b = 0.9995000000416666, delta = 0.19029895961284637, c = 0.0, d = 0.0, m = 9.941662891878392e-07
[Iteration 970] [Rank 2] a = 1.001575231552124, b = 0.9995000000416666, delta = 0.17379513382911682, c = 0.0, d = 0.0, m = 9.83998857016809e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |    972 |     0.10585s |  93.2%
- batch.accumulate               |    972 |     0.00083s |   0.7%
- batch.backward                 |    972 |     0.05203s |  45.8%
- batch.evaluate                 |    972 |     0.00275s |   2.4%
- batch.forward                  |    972 |     0.02577s |  22.7%
- batch.mom                      |    972 |     0.00126s |   1.1%
- batch.reduce                   |    972 |     0.02035s |  17.9%
- batch.reporting.compr_err      |    972 |     0.00001s |   0.0%
- batch.reporting.lr             |    972 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |    972 |     0.00001s |   0.0%
- batch.step                     |    972 |     0.00048s |   0.4%
- batch.update_runavg            |    972 |     0.00130s |   1.1%
- batch.wd                       |    972 |     0.00001s |   0.0%
- epoch_metrics.collect          |      6 |     0.02372s |   0.2%
- reduce.combine                 |    972 |     0.00550s |   4.8%
- reduce.flatpack                |    972 |     0.00002s |   0.0%
- reduce.flatput                 |    972 |     0.00010s |   0.1%
- reduce.gather.context          |    972 |     0.00123s |   1.1%
- reduce.gather.tensors          |    972 |     0.00023s |   0.2%
- reduce.heur_params             |    972 |     0.01037s |   9.1%
- reduce.heur_params.alpha       |    971 |     0.00838s |   7.4%
- reduce.heur_params.beta        |    971 |     0.00192s |   1.7%
- reduce.memory                  |    972 |     0.00042s |   0.4%
- reduce.pad                     |    972 |     0.00029s |   0.3%
- reduce.threshold               |    972 |     0.00198s |   1.7%
- test.last                      |      6 |     0.41481s |   3.1%
- test.runavg                    |      6 |     0.44587s |   3.3%
-----------------------------------------------------------------

[Iteration 980] [Rank 2] a = 1.0755281448364258, b = 0.9995000000416666, delta = 0.15357345342636108, c = 0.0, d = 0.0, m = 9.779120493135207e-07
[Iteration 990] [Rank 2] a = 1.0604864358901978, b = 0.9995000000416666, delta = 0.16490978002548218, c = 0.0, d = 0.0, m = 9.681138311103652e-07
[Iteration 1000] [Rank 2] a = 1.0425430536270142, b = 0.9995000000416666, delta = 0.14473608136177063, c = 0.0, d = 0.0, m = 9.588219590672487e-07
[Iteration 1010] [Rank 2] a = 1.4525063037872314, b = 0.9995000000416666, delta = 0.18227271735668182, c = 0.0, d = 0.0, m = 9.536089731842826e-07
[Iteration 1020] [Rank 2] a = 0.9049142599105835, b = 0.9995000000416666, delta = 0.15287619829177856, c = 0.0, d = 0.0, m = 9.443028550599546e-07
[Iteration 1030] [Rank 2] a = 0.8789136409759521, b = 0.9995006390893548, delta = 0.13232170045375824, c = 1.2780956954462384e-06, d = 1.2780956954462384e-06, m = 9.366849649406358e-07
[Iteration 1040] [Rank 2] a = 1.0345845222473145, b = 0.9995000000416666, delta = 0.14470747113227844, c = 0.0, d = 0.0, m = 9.277533958766603e-07
[Iteration 1050] [Rank 2] a = 1.0851335525512695, b = 0.9995000000416666, delta = 0.18742577731609344, c = 0.0, d = 0.0, m = 9.194519268678085e-07
[Iteration 1060] [Rank 2] a = 0.7875491380691528, b = 0.9995000000416666, delta = 0.1573820412158966, c = 0.0, d = 0.0, m = 9.109162560279759e-07
[Iteration 1070] [Rank 2] a = 0.9996817111968994, b = 0.9995000000416666, delta = 0.17488449811935425, c = 0.0, d = 0.0, m = 9.027012472341906e-07
[Iteration 1080] [Rank 2] a = 1.0554020404815674, b = 0.9995000000416666, delta = 0.17270518839359283, c = 0.0, d = 0.0, m = 8.944464987682977e-07
[Iteration 1090] [Rank 2] a = 0.8191426992416382, b = 0.9995000000416666, delta = 0.16676095128059387, c = 0.0, d = 0.0, m = 8.876095505274057e-07
[Iteration 1100] [Rank 2] a = 1.281538963317871, b = 0.9995000000416666, delta = 0.2108086496591568, c = 0.0, d = 0.0, m = 8.795477017487737e-07
[Iteration 1110] [Rank 2] a = 0.9463321566581726, b = 0.9995000000416666, delta = 0.1599946767091751, c = 0.0, d = 0.0, m = 8.737763234759428e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1111 |     0.10579s |  93.1%
- batch.accumulate               |   1111 |     0.00083s |   0.7%
- batch.backward                 |   1111 |     0.05205s |  45.8%
- batch.evaluate                 |   1111 |     0.00275s |   2.4%
- batch.forward                  |   1111 |     0.02577s |  22.7%
- batch.mom                      |   1111 |     0.00126s |   1.1%
- batch.reduce                   |   1111 |     0.02027s |  17.9%
- batch.reporting.compr_err      |   1111 |     0.00001s |   0.0%
- batch.reporting.lr             |   1111 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1111 |     0.00001s |   0.0%
- batch.step                     |   1111 |     0.00048s |   0.4%
- batch.update_runavg            |   1111 |     0.00130s |   1.1%
- batch.wd                       |   1111 |     0.00001s |   0.0%
- epoch_metrics.collect          |      7 |     0.02421s |   0.2%
- reduce.combine                 |   1111 |     0.00549s |   4.8%
- reduce.flatpack                |   1111 |     0.00002s |   0.0%
- reduce.flatput                 |   1111 |     0.00010s |   0.1%
- reduce.gather.context          |   1111 |     0.00117s |   1.0%
- reduce.gather.tensors          |   1111 |     0.00024s |   0.2%
- reduce.heur_params             |   1111 |     0.01036s |   9.1%
- reduce.heur_params.alpha       |   1110 |     0.00838s |   7.4%
- reduce.heur_params.beta        |   1110 |     0.00191s |   1.7%
- reduce.memory                  |   1111 |     0.00042s |   0.4%
- reduce.pad                     |   1111 |     0.00029s |   0.3%
- reduce.threshold               |   1111 |     0.00197s |   1.7%
- test.last                      |      7 |     0.41426s |   3.0%
- test.runavg                    |      7 |     0.44592s |   3.3%
-----------------------------------------------------------------

last_cross_entropy             - bits:45935872.000, epoch:  8.000, ratio_transmit_grad:  0.002, value:  6.924 (split:test)
last_perplexity                - bits:45935872.000, epoch:  8.000, ratio_transmit_grad:  0.002, value:1017.510 (split:test)
runavg_cross_entropy           - bits:45935872.000, epoch:  8.000, ratio_transmit_grad:  0.002, value:  6.985 (split:test)
runavg_perplexity              - bits:45935872.000, epoch:  8.000, ratio_transmit_grad:  0.002, value:1081.968 (split:test)
timer                          - epoch:  7.000, value:  0.446 (event:test.runavg)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1111 |     0.10574s |  93.1%
- batch.accumulate               |   1111 |     0.00083s |   0.7%
- batch.backward                 |   1111 |     0.05169s |  45.5%
- batch.evaluate                 |   1111 |     0.00276s |   2.4%
- batch.forward                  |   1111 |     0.02551s |  22.5%
- batch.mom                      |   1111 |     0.00126s |   1.1%
- batch.reduce                   |   1111 |     0.02082s |  18.3%
- batch.reporting.compr_err      |   1111 |     0.00001s |   0.0%
- batch.reporting.lr             |   1111 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1111 |     0.00001s |   0.0%
- batch.step                     |   1111 |     0.00048s |   0.4%
- batch.update_runavg            |   1111 |     0.00130s |   1.1%
- batch.wd                       |   1111 |     0.00001s |   0.0%
- epoch_metrics.collect          |      7 |     0.00460s |   0.0%
- reduce.combine                 |   1111 |     0.00549s |   4.8%
- reduce.flatpack                |   1111 |     0.00002s |   0.0%
- reduce.flatput                 |   1111 |     0.00009s |   0.1%
- reduce.gather.context          |   1111 |     0.00152s |   1.3%
- reduce.gather.tensors          |   1111 |     0.00024s |   0.2%
- reduce.heur_params             |   1111 |     0.01063s |   9.4%
- reduce.heur_params.alpha       |   1110 |     0.00871s |   7.7%
- reduce.heur_params.beta        |   1110 |     0.00185s |   1.6%
- reduce.memory                  |   1111 |     0.00042s |   0.4%
- reduce.pad                     |   1111 |     0.00029s |   0.3%
- reduce.threshold               |   1111 |     0.00190s |   1.7%
- test.last                      |      7 |     0.41425s |   3.0%
- test.runavg                    |      7 |     0.44597s |   3.3%
-----------------------------------------------------------------

rel_compression_error          - epoch:  8.022, value:  1.000 (weight:encoder.weight)
rel_compression_error          - epoch:  8.022, value:  1.000 (weight:rnn.weight_ih_l0)
rel_compression_error          - epoch:  8.022, value:  1.000 (weight:rnn.weight_hh_l0)
rel_compression_error          - epoch:  8.022, value:  1.000 (weight:rnn.bias_ih_l0)
rel_compression_error          - epoch:  8.022, value:  1.000 (weight:rnn.bias_hh_l0)
rel_compression_error          - epoch:  8.022, value:  1.000 (weight:rnn.weight_ih_l1)
rel_compression_error          - epoch:  8.022, value:  1.000 (weight:rnn.weight_hh_l1)
rel_compression_error          - epoch:  8.022, value:  1.000 (weight:rnn.bias_ih_l1)
rel_compression_error          - epoch:  8.022, value:  1.000 (weight:rnn.bias_hh_l1)
rel_compression_error          - epoch:  8.022, value:  1.000 (weight:rnn.weight_ih_l2)
rel_compression_error          - epoch:  8.022, value:  1.000 (weight:rnn.weight_hh_l2)
rel_compression_error          - epoch:  8.022, value:  1.000 (weight:rnn.bias_ih_l2)
rel_compression_error          - epoch:  8.022, value:  1.000 (weight:rnn.bias_hh_l2)
rel_compression_error          - epoch:  8.022, value:  1.000 (weight:decoder.bias)
rel_compression_error          - epoch:  8.022, value:  1.000 (weight:entire_model)
[Iteration 1120] [Rank 0] a = 1.1544262170791626, b = 0.9995000000416666, delta = 0.29330986738204956, c = 0.0, d = 0.0, m = 2.2624053321036547e-07
[Iteration 1130] [Rank 0] a = 0.9495120644569397, b = 0.9995003454728494, delta = 0.2230599969625473, c = 6.908625380790477e-07, d = 6.908625380790477e-07, m = 2.2506481180833457e-07
[Iteration 1140] [Rank 0] a = 0.8050746321678162, b = 0.9995000000416666, delta = 0.24721349775791168, c = 0.0, d = 0.0, m = 2.2412162004378684e-07
[Iteration 1150] [Rank 0] a = 1.1647148132324219, b = 0.9995000000416666, delta = 0.3258167505264282, c = 0.0, d = 0.0, m = 2.2220444100509536e-07
[Iteration 1160] [Rank 0] a = 0.9092632532119751, b = 0.9995000000416666, delta = 0.2357054203748703, c = 0.0, d = 0.0, m = 2.2029053539781633e-07
[Iteration 1170] [Rank 0] a = 1.2425349950790405, b = 0.9995000000416666, delta = 0.2949749827384949, c = 0.0, d = 0.0, m = 2.1846831584173584e-07
timer                          - epoch: -1.000, value:  0.009 (event:reduce.heur_params.alpha)
[Iteration 1180] [Rank 0] a = 1.0783783197402954, b = 0.9995000000416666, delta = 0.2848823070526123, c = 0.0, d = 0.0, m = 2.16618457113186e-07
[Iteration 1190] [Rank 0] a = 0.7800382375717163, b = 0.9995000863994624, delta = 0.2213636189699173, c = 1.7271563451976193e-07, d = 1.7271563451976193e-07, m = 2.1497368313358217e-07
[Iteration 1200] [Rank 0] a = 0.9877294301986694, b = 0.9995000000416666, delta = 0.24818633496761322, c = 0.0, d = 0.0, m = 2.1321248937468803e-07
[Iteration 1210] [Rank 0] a = 0.7446315884590149, b = 0.9995014853957532, delta = 0.20146504044532776, c = 2.970708913739905e-06, d = 3.1088814213557147e-06, m = 2.1527413603974397e-07
[Iteration 1220] [Rank 0] a = 0.9514297842979431, b = 0.9995000000416666, delta = 0.24523770809173584, c = 0.0, d = 0.0, m = 2.1351103910248153e-07
[Iteration 1230] [Rank 0] a = 1.0593379735946655, b = 0.9995000000416666, delta = 0.274119108915329, c = 0.0, d = 0.0, m = 2.1177658711952068e-07
timer                          - epoch: -1.000, value:  0.000 (event:reduce.pad)
[Iteration 1240] [Rank 0] a = 1.0798835754394531, b = 0.9995000000416666, delta = 0.2947632074356079, c = 0.0, d = 0.0, m = 2.1007008762621267e-07
timer                          - epoch:  8.928, value:  0.000 (event:batch.wd)
timer                          - epoch:  8.964, value:  0.000 (event:batch.reporting.memory_norm)
[Iteration 1250] [Rank 0] a = 0.8345781564712524, b = 0.9995000000416666, delta = 0.2591765820980072, c = 0.0, d = 0.0, m = 2.0847370753384637e-07
cross_entropy                  - bits:47164352.000, epoch:  9.000, ratio_transmit_grad:  0.000, value:  7.161 (split:train)
last_cross_entropy             - bits:47164352.000, epoch:  9.000, ratio_transmit_grad:  0.000, value:  7.161 (split:train)
perplexity                     - bits:47164352.000, epoch:  9.000, ratio_transmit_grad:  0.000, value:1298.412 (split:train)
last_perplexity                - bits:47164352.000, epoch:  9.000, ratio_transmit_grad:  0.000, value:1298.412 (split:train)
last_cross_entropy             - bits:47164352.000, epoch:  9.000, ratio_transmit_grad:  0.000, value:  6.949 (split:test)
last_perplexity                - bits:47164352.000, epoch:  9.000, ratio_transmit_grad:  0.000, value:1043.920 (split:test)
runavg_cross_entropy           - bits:47164352.000, epoch:  9.000, ratio_transmit_grad:  0.000, value:  7.011 (split:test)
runavg_perplexity              - bits:47164352.000, epoch:  9.000, ratio_transmit_grad:  0.000, value:1110.472 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1250 |     0.10570s |  93.0%
- batch.accumulate               |   1250 |     0.00083s |   0.7%
- batch.backward                 |   1250 |     0.05170s |  45.5%
- batch.evaluate                 |   1250 |     0.00276s |   2.4%
- batch.forward                  |   1250 |     0.02551s |  22.5%
- batch.mom                      |   1250 |     0.00126s |   1.1%
- batch.reduce                   |   1250 |     0.02077s |  18.3%
- batch.reporting.compr_err      |   1250 |     0.00001s |   0.0%
- batch.reporting.lr             |   1250 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1250 |     0.00001s |   0.0%
- batch.step                     |   1250 |     0.00048s |   0.4%
- batch.update_runavg            |   1250 |     0.00130s |   1.1%
- batch.wd                       |   1250 |     0.00001s |   0.0%
- epoch_metrics.collect          |      8 |     0.00724s |   0.1%
- reduce.combine                 |   1250 |     0.00548s |   4.8%
- reduce.flatpack                |   1250 |     0.00002s |   0.0%
- reduce.flatput                 |   1250 |     0.00009s |   0.1%
- reduce.gather.context          |   1250 |     0.00148s |   1.3%
- reduce.gather.tensors          |   1250 |     0.00023s |   0.2%
- reduce.heur_params             |   1250 |     0.01064s |   9.4%
- reduce.heur_params.alpha       |   1249 |     0.00871s |   7.7%
- reduce.heur_params.beta        |   1249 |     0.00185s |   1.6%
- reduce.memory                  |   1250 |     0.00042s |   0.4%
- reduce.pad                     |   1250 |     0.00029s |   0.3%
- reduce.threshold               |   1250 |     0.00190s |   1.7%
- test.last                      |      8 |     0.41425s |   3.0%
- test.runavg                    |      8 |     0.44632s |   3.2%
-----------------------------------------------------------------

[Iteration 1120] [Rank 1] a = 0.8975933790206909, b = 0.999500759990269, delta = 0.020900366827845573, c = 1.519897583773905e-06, d = 1.519897583773905e-06, m = 2.1087485057820122e-05
[Iteration 1130] [Rank 1] a = 0.9519365429878235, b = 0.9995014335810758, delta = 0.02099066600203514, c = 2.867079533028048e-06, d = 2.936165786835953e-06, m = 2.09086706733354e-05
[Iteration 1140] [Rank 1] a = 0.9351969957351685, b = 0.9995044906470516, delta = 0.022834094241261482, c = 8.98121299502762e-06, d = 9.050299248835525e-06, m = 2.074561507203092e-05
[Iteration 1150] [Rank 1] a = 1.036620855331421, b = 0.9995001554856989, delta = 0.02574649080634117, c = 3.1088814213557147e-07, d = 3.1088814213557147e-07, m = 2.0657420128064037e-05
[Iteration 1160] [Rank 1] a = 0.9104357361793518, b = 0.9995125219221165, delta = 0.019889991730451584, c = 2.504376700536548e-05, d = 2.5561913908924766e-05, m = 2.0530816073480644e-05
[Iteration 1170] [Rank 1] a = 1.0480475425720215, b = 0.9995000691279032, delta = 0.02307126112282276, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 2.0376197042184113e-05
[Iteration 1180] [Rank 1] a = 0.8731815814971924, b = 0.999500414559086, delta = 0.02300272323191166, c = 8.290350456948573e-07, d = 8.290350456948573e-07, m = 2.022817432408392e-05
[Iteration 1190] [Rank 1] a = 1.004011869430542, b = 0.9995000518563442, delta = 0.02524525672197342, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 2.0065177207970142e-05
[Iteration 1200] [Rank 1] a = 0.9409247040748596, b = 0.9995012781370434, delta = 0.021304788067936897, c = 2.5561913908924768e-06, d = 2.659820771604334e-06, m = 1.9943608061161107e-05
[Iteration 1210] [Rank 1] a = 1.0095585584640503, b = 0.9995001382141396, delta = 0.024031847715377808, c = 2.763450152316191e-07, d = 2.763450152316191e-07, m = 1.979284089792206e-05
[Iteration 1220] [Rank 1] a = 0.8196945190429688, b = 0.9995203632100903, delta = 0.021768799051642418, c = 4.072634661975986e-05, d = 4.110632101570334e-05, m = 1.9683895874558678e-05
[Iteration 1230] [Rank 1] a = 0.9802709817886353, b = 0.9995004663737636, delta = 0.022385086864233017, c = 9.326644264067144e-07, d = 9.326644264067144e-07, m = 1.9563840863557886e-05
[Iteration 1240] [Rank 1] a = 1.0396314859390259, b = 0.9995001382141396, delta = 0.022260580211877823, c = 2.763450152316191e-07, d = 2.763450152316191e-07, m = 1.9450341258911705e-05
[Iteration 1250] [Rank 1] a = 0.9313324093818665, b = 0.9995016062966674, delta = 0.02426229976117611, c = 3.212510802067572e-06, d = 3.2470539289715243e-06, m = 1.9367041755424753e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1250 |     0.10586s |  93.2%
- batch.accumulate               |   1250 |     0.00083s |   0.7%
- batch.backward                 |   1250 |     0.05167s |  45.5%
- batch.evaluate                 |   1250 |     0.00276s |   2.4%
- batch.forward                  |   1250 |     0.02542s |  22.4%
- batch.mom                      |   1250 |     0.00126s |   1.1%
- batch.reduce                   |   1250 |     0.02110s |  18.6%
- batch.reporting.compr_err      |   1250 |     0.00001s |   0.0%
- batch.reporting.lr             |   1250 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   1250 |     0.00001s |   0.0%
- batch.step                     |   1250 |     0.00048s |   0.4%
- batch.update_runavg            |   1250 |     0.00129s |   1.1%
- batch.wd                       |   1250 |     0.00001s |   0.0%
- epoch_metrics.collect          |      8 |     0.01408s |   0.1%
- reduce.combine                 |   1250 |     0.00522s |   4.6%
- reduce.flatpack                |   1250 |     0.00002s |   0.0%
- reduce.flatput                 |   1250 |     0.00016s |   0.1%
- reduce.gather.context          |   1250 |     0.00166s |   1.5%
- reduce.gather.tensors          |   1250 |     0.00037s |   0.3%
- reduce.heur_params             |   1250 |     0.01056s |   9.3%
- reduce.heur_params.alpha       |   1249 |     0.00825s |   7.3%
- reduce.heur_params.beta        |   1249 |     0.00223s |   2.0%
- reduce.memory                  |   1250 |     0.00043s |   0.4%
- reduce.pad                     |   1250 |     0.00015s |   0.1%
- reduce.threshold               |   1250 |     0.00233s |   2.1%
- test.last                      |      8 |     0.41425s |   3.0%
- test.runavg                    |      8 |     0.44628s |   3.2%
-----------------------------------------------------------------

[Iteration 1260] [Rank 1] a = 1.0265734195709229, b = 0.9995005354599998, delta = 0.02243865467607975, c = 1.070836934022524e-06, d = 1.070836934022524e-06, m = 1.9563901235938646e-05
[Iteration 1270] [Rank 1] a = 1.0301538705825806, b = 0.9995001554856989, delta = 0.023986300453543663, c = 3.1088814213557147e-07, d = 3.1088814213557147e-07, m = 1.9424869466610538e-05
[Iteration 1280] [Rank 1] a = 1.0174635648727417, b = 0.9995002936581718, delta = 0.021827934309840202, c = 5.872331573671905e-07, d = 5.872331573671905e-07, m = 1.9329319903217964e-05
[Iteration 1290] [Rank 1] a = 0.9692414402961731, b = 0.9995427298798514, delta = 0.019601771607995033, c = 8.54596959603782e-05, d = 8.780862858984697e-05, m = 1.9286918108469385e-05
[Iteration 1300] [Rank 1] a = 1.0018279552459717, b = 0.9995003627444087, delta = 0.02261178009212017, c = 7.254056649830001e-07, d = 7.254056649830001e-07, m = 1.914437974659365e-05
[Iteration 1310] [Rank 1] a = 1.0466245412826538, b = 0.9995000345847849, delta = 0.025046732276678085, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 1.902335581826864e-05
[Iteration 1320] [Rank 1] a = 0.9258775115013123, b = 0.9995016235682265, delta = 0.021569749340415, c = 3.2470539289715243e-06, d = 3.281597055875477e-06, m = 1.8978427998175065e-05
[Iteration 1330] [Rank 1] a = 0.9216983318328857, b = 0.9995893112776998, delta = 0.019310807809233665, c = 0.0001786225092203378, d = 0.00018366580574831484, m = 1.908737443391613e-05
[Iteration 1340] [Rank 1] a = 1.063858151435852, b = 0.9995002936581718, delta = 0.022764911875128746, c = 5.872331573671905e-07, d = 5.872331573671905e-07, m = 1.8956654975224508e-05
[Iteration 1350] [Rank 1] a = 1.022182822227478, b = 0.999501468124194, delta = 0.01971481554210186, c = 2.936165786835953e-06, d = 3.03979516754781e-06, m = 1.900235053294028e-05
[Iteration 1360] [Rank 1] a = 0.9141649007797241, b = 0.9995008636196238, delta = 0.020090362057089806, c = 1.7271563451976192e-06, d = 1.7271563451976192e-06, m = 1.8891359454188087e-05
[Iteration 1370] [Rank 1] a = 1.0536750555038452, b = 0.9995001382141396, delta = 0.023707464337348938, c = 2.763450152316191e-07, d = 2.763450152316191e-07, m = 1.8960296552441225e-05
[Iteration 1380] [Rank 1] a = 1.0095549821853638, b = 0.9995008463480648, delta = 0.022638000547885895, c = 1.692613218293667e-06, d = 1.692613218293667e-06, m = 1.9822802243935404e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1389 |     0.10582s |  93.1%
- batch.accumulate               |   1389 |     0.00083s |   0.7%
- batch.backward                 |   1389 |     0.05165s |  45.4%
- batch.evaluate                 |   1389 |     0.00277s |   2.4%
- batch.forward                  |   1389 |     0.02543s |  22.4%
- batch.mom                      |   1389 |     0.00126s |   1.1%
- batch.reduce                   |   1389 |     0.02106s |  18.5%
- batch.reporting.compr_err      |   1389 |     0.00001s |   0.0%
- batch.reporting.lr             |   1389 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   1389 |     0.00001s |   0.0%
- batch.step                     |   1389 |     0.00048s |   0.4%
- batch.update_runavg            |   1389 |     0.00129s |   1.1%
- batch.wd                       |   1389 |     0.00001s |   0.0%
- epoch_metrics.collect          |      9 |     0.01269s |   0.1%
- reduce.combine                 |   1389 |     0.00523s |   4.6%
- reduce.flatpack                |   1389 |     0.00002s |   0.0%
- reduce.flatput                 |   1389 |     0.00016s |   0.1%
- reduce.gather.context          |   1389 |     0.00161s |   1.4%
- reduce.gather.tensors          |   1389 |     0.00037s |   0.3%
- reduce.heur_params             |   1389 |     0.01056s |   9.3%
- reduce.heur_params.alpha       |   1388 |     0.00825s |   7.3%
- reduce.heur_params.beta        |   1388 |     0.00223s |   2.0%
- reduce.memory                  |   1389 |     0.00043s |   0.4%
- reduce.pad                     |   1389 |     0.00015s |   0.1%
- reduce.threshold               |   1389 |     0.00233s |   2.1%
- test.last                      |      9 |     0.41364s |   2.9%
- test.runavg                    |      9 |     0.44687s |   3.2%
-----------------------------------------------------------------

[Iteration 1120] [Rank 3] a = 1.0978611707687378, b = 0.9995000000416666, delta = 0.16454485058784485, c = 0.0, d = 0.0, m = 1.475956014670393e-06
[Iteration 1130] [Rank 3] a = 1.1265064477920532, b = 0.9995000000416666, delta = 0.13973723351955414, c = 0.0, d = 0.0, m = 1.4633946794659358e-06
[Iteration 1140] [Rank 3] a = 0.8514165282249451, b = 0.9995000863994624, delta = 0.11729680001735687, c = 1.7271563451976193e-07, d = 1.7271563451976193e-07, m = 1.4529305402055058e-06
[Iteration 1150] [Rank 3] a = 1.1168855428695679, b = 0.9995000000416666, delta = 0.1352560967206955, c = 0.0, d = 0.0, m = 1.4415077944836147e-06
[Iteration 1160] [Rank 3] a = 0.9823219776153564, b = 0.9995000000416666, delta = 0.12026938796043396, c = 0.0, d = 0.0, m = 1.4367679570989325e-06
[Iteration 1170] [Rank 3] a = 1.1385564804077148, b = 0.9995000000416666, delta = 0.15148092806339264, c = 0.0, d = 0.0, m = 1.4244983759110674e-06
[Iteration 1180] [Rank 3] a = 1.1284681558609009, b = 0.9995000000416666, delta = 0.13328422605991364, c = 0.0, d = 0.0, m = 1.4145132601202717e-06
[Iteration 1190] [Rank 3] a = 1.2016899585723877, b = 0.9995000000416666, delta = 0.16427664458751678, c = 0.0, d = 0.0, m = 1.4026655779420195e-06
[Iteration 1200] [Rank 3] a = 1.0218567848205566, b = 0.9995000000416666, delta = 0.1298491656780243, c = 0.0, d = 0.0, m = 1.393114816586043e-06
[Iteration 1210] [Rank 3] a = 0.9690738320350647, b = 0.9995000000416666, delta = 0.13854797184467316, c = 0.0, d = 0.0, m = 1.3818106495525726e-06
[Iteration 1220] [Rank 3] a = 0.8721088767051697, b = 0.9995000000416666, delta = 0.1249084398150444, c = 0.0, d = 0.0, m = 1.3713989161909026e-06
[Iteration 1230] [Rank 3] a = 0.9167470932006836, b = 0.9995000000416666, delta = 0.15169140696525574, c = 0.0, d = 0.0, m = 1.3620542947123842e-06
[Iteration 1240] [Rank 3] a = 0.917771577835083, b = 0.9995000000416666, delta = 0.13809818029403687, c = 0.0, d = 0.0, m = 1.351579865491713e-06
[Iteration 1250] [Rank 3] a = 0.9575302600860596, b = 0.9995000000416666, delta = 0.1449194997549057, c = 0.0, d = 0.0, m = 1.3417699165817415e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1250 |     0.10595s |  93.2%
- batch.accumulate               |   1250 |     0.00082s |   0.7%
- batch.backward                 |   1250 |     0.05167s |  45.5%
- batch.evaluate                 |   1250 |     0.00277s |   2.4%
- batch.forward                  |   1250 |     0.02539s |  22.3%
- batch.mom                      |   1250 |     0.00126s |   1.1%
- batch.reduce                   |   1250 |     0.02123s |  18.7%
- batch.reporting.compr_err      |   1250 |     0.00001s |   0.0%
- batch.reporting.lr             |   1250 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1250 |     0.00001s |   0.0%
- batch.step                     |   1250 |     0.00047s |   0.4%
- batch.update_runavg            |   1250 |     0.00129s |   1.1%
- batch.wd                       |   1250 |     0.00001s |   0.0%
- epoch_metrics.collect          |      8 |     0.01370s |   0.1%
- reduce.combine                 |   1250 |     0.00520s |   4.6%
- reduce.flatpack                |   1250 |     0.00002s |   0.0%
- reduce.flatput                 |   1250 |     0.00010s |   0.1%
- reduce.gather.context          |   1250 |     0.00274s |   2.4%
- reduce.gather.tensors          |   1250 |     0.00025s |   0.2%
- reduce.heur_params             |   1250 |     0.01007s |   8.9%
- reduce.heur_params.alpha       |   1249 |     0.00809s |   7.1%
- reduce.heur_params.beta        |   1249 |     0.00191s |   1.7%
- reduce.memory                  |   1250 |     0.00041s |   0.4%
- reduce.pad                     |   1250 |     0.00027s |   0.2%
- reduce.threshold               |   1250 |     0.00198s |   1.7%
- test.last                      |      8 |     0.41426s |   3.0%
- test.runavg                    |      8 |     0.44627s |   3.2%
-----------------------------------------------------------------

[Iteration 1260] [Rank 3] a = 0.9798237085342407, b = 0.9995000000416666, delta = 0.1427781581878662, c = 0.0, d = 0.0, m = 1.333238688671977e-06
[Iteration 1270] [Rank 3] a = 1.2166646718978882, b = 0.9995000000416666, delta = 0.16575948894023895, c = 0.0, d = 0.0, m = 1.3247058155408716e-06
[Iteration 1280] [Rank 3] a = 0.8849724531173706, b = 0.9995000518563442, delta = 0.13477683067321777, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 1.3144994591623482e-06
[Iteration 1290] [Rank 3] a = 1.0080405473709106, b = 0.9995000000416666, delta = 0.15274469554424286, c = 0.0, d = 0.0, m = 1.304611759552991e-06
[Iteration 1300] [Rank 3] a = 1.2538801431655884, b = 0.9995000000416666, delta = 0.16076625883579254, c = 0.0, d = 0.0, m = 1.2957522514732401e-06
[Iteration 1310] [Rank 3] a = 0.8855370879173279, b = 0.9995000173132257, delta = 0.1425967663526535, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 1.2859212550880954e-06
[Iteration 1320] [Rank 3] a = 1.0296493768692017, b = 0.9995000000416666, delta = 0.17431670427322388, c = 0.0, d = 0.0, m = 1.278252590799323e-06
[Iteration 1330] [Rank 3] a = 1.0943022966384888, b = 0.9995000000416666, delta = 0.15584473311901093, c = 0.0, d = 0.0, m = 1.2700503390674076e-06
[Iteration 1340] [Rank 3] a = 0.8734593987464905, b = 0.9995000000416666, delta = 0.1502676010131836, c = 0.0, d = 0.0, m = 1.2625628799927841e-06
[Iteration 1350] [Rank 3] a = 1.0686218738555908, b = 0.9995000000416666, delta = 0.15720434486865997, c = 0.0, d = 0.0, m = 1.2532686220015774e-06
[Iteration 1360] [Rank 3] a = 0.8708137273788452, b = 0.9995000000416666, delta = 0.14624883234500885, c = 0.0, d = 0.0, m = 1.2457606890717827e-06
[Iteration 1370] [Rank 3] a = 0.8165624737739563, b = 0.9995006045462366, delta = 0.1330285668373108, c = 1.2090094416383336e-06, d = 1.2090094416383336e-06, m = 1.2375560228069543e-06
[Iteration 1380] [Rank 3] a = 0.9611956477165222, b = 0.9995000000416666, delta = 0.1639985591173172, c = 0.0, d = 0.0, m = 1.228594719238475e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1389 |     0.10591s |  93.1%
- batch.accumulate               |   1389 |     0.00082s |   0.7%
- batch.backward                 |   1389 |     0.05165s |  45.4%
- batch.evaluate                 |   1389 |     0.00277s |   2.4%
- batch.forward                  |   1389 |     0.02541s |  22.4%
- batch.mom                      |   1389 |     0.00126s |   1.1%
- batch.reduce                   |   1389 |     0.02120s |  18.7%
- batch.reporting.compr_err      |   1389 |     0.00001s |   0.0%
- batch.reporting.lr             |   1389 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1389 |     0.00001s |   0.0%
- batch.step                     |   1389 |     0.00047s |   0.4%
- batch.update_runavg            |   1389 |     0.00129s |   1.1%
- batch.wd                       |   1389 |     0.00001s |   0.0%
- epoch_metrics.collect          |      9 |     0.01238s |   0.1%
- reduce.combine                 |   1389 |     0.00521s |   4.6%
- reduce.flatpack                |   1389 |     0.00002s |   0.0%
- reduce.flatput                 |   1389 |     0.00010s |   0.1%
- reduce.gather.context          |   1389 |     0.00272s |   2.4%
- reduce.gather.tensors          |   1389 |     0.00026s |   0.2%
- reduce.heur_params             |   1389 |     0.01006s |   8.9%
- reduce.heur_params.alpha       |   1388 |     0.00809s |   7.1%
- reduce.heur_params.beta        |   1388 |     0.00190s |   1.7%
- reduce.memory                  |   1389 |     0.00041s |   0.4%
- reduce.pad                     |   1389 |     0.00027s |   0.2%
- reduce.threshold               |   1389 |     0.00197s |   1.7%
- test.last                      |      9 |     0.41366s |   2.9%
- test.runavg                    |      9 |     0.44686s |   3.2%
-----------------------------------------------------------------

[Iteration 1120] [Rank 2] a = 0.8756324648857117, b = 0.9995000000416666, delta = 0.16843411326408386, c = 0.0, d = 0.0, m = 8.659817086367283e-07
[Iteration 1130] [Rank 2] a = 0.9027643799781799, b = 0.9995000000416666, delta = 0.16321636736392975, c = 0.0, d = 0.0, m = 8.584165559349995e-07
[Iteration 1140] [Rank 2] a = 0.885006844997406, b = 0.9995000000416666, delta = 0.16551700234413147, c = 0.0, d = 0.0, m = 8.510142833217355e-07
[Iteration 1150] [Rank 2] a = 1.2155470848083496, b = 0.9995000000416666, delta = 0.22136437892913818, c = 0.0, d = 0.0, m = 8.446109647766556e-07
[Iteration 1160] [Rank 2] a = 1.1114630699157715, b = 0.9995000000416666, delta = 0.23982691764831543, c = 0.0, d = 0.0, m = 8.374551188333734e-07
[Iteration 1170] [Rank 2] a = 1.06101655960083, b = 0.9995000000416666, delta = 0.19952979683876038, c = 0.0, d = 0.0, m = 8.303624929285692e-07
[Iteration 1180] [Rank 2] a = 1.0659290552139282, b = 0.9995000000416666, delta = 0.15801885724067688, c = 0.0, d = 0.0, m = 8.260516426938376e-07
[Iteration 1190] [Rank 2] a = 1.1041055917739868, b = 0.9995000000416666, delta = 0.19413399696350098, c = 0.0, d = 0.0, m = 8.191738675694628e-07
[Iteration 1200] [Rank 2] a = 1.1089967489242554, b = 0.9995000000416666, delta = 0.17692816257476807, c = 0.0, d = 0.0, m = 8.124393885561549e-07
[Iteration 1210] [Rank 2] a = 1.307041883468628, b = 0.9995000000416666, delta = 0.22864678502082825, c = 0.0, d = 0.0, m = 8.06101375974974e-07
[Iteration 1220] [Rank 2] a = 0.8474056124687195, b = 0.9995007772618281, delta = 0.15094409883022308, c = 1.5544407106778574e-06, d = 1.5544407106778574e-06, m = 8.009139415650213e-07
[Iteration 1230] [Rank 2] a = 1.133149266242981, b = 0.9995000000416666, delta = 0.19459301233291626, c = 0.0, d = 0.0, m = 7.944077357034046e-07
[Iteration 1240] [Rank 2] a = 0.8906184434890747, b = 0.9995000345847849, delta = 0.17466549575328827, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 7.880620539119249e-07
[Iteration 1250] [Rank 2] a = 0.8163115382194519, b = 0.9995000173132257, delta = 0.16307225823402405, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 7.92034414159048e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1250 |     0.10573s |  93.0%
- batch.accumulate               |   1250 |     0.00083s |   0.7%
- batch.backward                 |   1250 |     0.05204s |  45.8%
- batch.evaluate                 |   1250 |     0.00275s |   2.4%
- batch.forward                  |   1250 |     0.02577s |  22.7%
- batch.mom                      |   1250 |     0.00126s |   1.1%
- batch.reduce                   |   1250 |     0.02022s |  17.8%
- batch.reporting.compr_err      |   1250 |     0.00001s |   0.0%
- batch.reporting.lr             |   1250 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1250 |     0.00001s |   0.0%
- batch.step                     |   1250 |     0.00048s |   0.4%
- batch.update_runavg            |   1250 |     0.00130s |   1.1%
- batch.wd                       |   1250 |     0.00001s |   0.0%
- epoch_metrics.collect          |      8 |     0.02167s |   0.2%
- reduce.combine                 |   1250 |     0.00548s |   4.8%
- reduce.flatpack                |   1250 |     0.00002s |   0.0%
- reduce.flatput                 |   1250 |     0.00010s |   0.1%
- reduce.gather.context          |   1250 |     0.00116s |   1.0%
- reduce.gather.tensors          |   1250 |     0.00023s |   0.2%
- reduce.heur_params             |   1250 |     0.01036s |   9.1%
- reduce.heur_params.alpha       |   1249 |     0.00838s |   7.4%
- reduce.heur_params.beta        |   1249 |     0.00190s |   1.7%
- reduce.memory                  |   1250 |     0.00042s |   0.4%
- reduce.pad                     |   1250 |     0.00029s |   0.3%
- reduce.threshold               |   1250 |     0.00196s |   1.7%
- test.last                      |      8 |     0.41427s |   3.0%
- test.runavg                    |      8 |     0.44627s |   3.2%
-----------------------------------------------------------------

[Iteration 1260] [Rank 2] a = 0.9882111549377441, b = 0.9995000000416666, delta = 0.17539097368717194, c = 0.0, d = 0.0, m = 7.858081985462149e-07
[Iteration 1270] [Rank 2] a = 0.8515918850898743, b = 0.9995000000416666, delta = 0.16288374364376068, c = 0.0, d = 0.0, m = 7.797614901662445e-07
[Iteration 1280] [Rank 2] a = 0.8299297094345093, b = 0.9995000000416666, delta = 0.18002554774284363, c = 0.0, d = 0.0, m = 7.737013248463706e-07
[Iteration 1290] [Rank 2] a = 0.9571800231933594, b = 0.9995000000416666, delta = 0.18874892592430115, c = 0.0, d = 0.0, m = 7.680026115601427e-07
[Iteration 1300] [Rank 2] a = 1.1337274312973022, b = 0.9995000000416666, delta = 0.1927131563425064, c = 0.0, d = 0.0, m = 7.621525424888179e-07
[Iteration 1310] [Rank 2] a = 0.9401811361312866, b = 0.9995004836453225, delta = 0.15838812291622162, c = 9.67207553310667e-07, d = 9.67207553310667e-07, m = 7.571031338353675e-07
[Iteration 1320] [Rank 2] a = 1.0476700067520142, b = 0.9995000000416666, delta = 0.20923201739788055, c = 0.0, d = 0.0, m = 7.5137184591837e-07
[Iteration 1330] [Rank 2] a = 1.2311375141143799, b = 0.9995000000416666, delta = 0.22288572788238525, c = 0.0, d = 0.0, m = 7.457526307926903e-07
[Iteration 1340] [Rank 2] a = 1.025310754776001, b = 0.9995000000416666, delta = 0.2013060301542282, c = 0.0, d = 0.0, m = 7.407324065995927e-07
[Iteration 1350] [Rank 2] a = 1.0309569835662842, b = 0.9995000000416666, delta = 0.1989092379808426, c = 0.0, d = 0.0, m = 7.353006983744349e-07
[Iteration 1360] [Rank 2] a = 1.112571358680725, b = 0.9995000000416666, delta = 0.2135089933872223, c = 0.0, d = 0.0, m = 7.299234288249564e-07
[Iteration 1370] [Rank 2] a = 1.0986202955245972, b = 0.9995000000416666, delta = 0.20612330734729767, c = 0.0, d = 0.0, m = 7.248513624360357e-07
[Iteration 1380] [Rank 2] a = 1.2731437683105469, b = 0.9995000000416666, delta = 0.22201980650424957, c = 0.0, d = 0.0, m = 7.197276853977733e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1389 |     0.10568s |  92.9%
- batch.accumulate               |   1389 |     0.00083s |   0.7%
- batch.backward                 |   1389 |     0.05205s |  45.8%
- batch.evaluate                 |   1389 |     0.00275s |   2.4%
- batch.forward                  |   1389 |     0.02576s |  22.7%
- batch.mom                      |   1389 |     0.00126s |   1.1%
- batch.reduce                   |   1389 |     0.02017s |  17.8%
- batch.reporting.compr_err      |   1389 |     0.00001s |   0.0%
- batch.reporting.lr             |   1389 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1389 |     0.00001s |   0.0%
- batch.step                     |   1389 |     0.00048s |   0.4%
- batch.update_runavg            |   1389 |     0.00130s |   1.1%
- batch.wd                       |   1389 |     0.00001s |   0.0%
- epoch_metrics.collect          |      9 |     0.01956s |   0.1%
- reduce.combine                 |   1389 |     0.00547s |   4.8%
- reduce.flatpack                |   1389 |     0.00002s |   0.0%
- reduce.flatput                 |   1389 |     0.00010s |   0.1%
- reduce.gather.context          |   1389 |     0.00113s |   1.0%
- reduce.gather.tensors          |   1389 |     0.00024s |   0.2%
- reduce.heur_params             |   1389 |     0.01035s |   9.1%
- reduce.heur_params.alpha       |   1388 |     0.00838s |   7.4%
- reduce.heur_params.beta        |   1388 |     0.00189s |   1.7%
- reduce.memory                  |   1389 |     0.00042s |   0.4%
- reduce.pad                     |   1389 |     0.00029s |   0.3%
- reduce.threshold               |   1389 |     0.00195s |   1.7%
- test.last                      |      9 |     0.41366s |   2.9%
- test.runavg                    |      9 |     0.44686s |   3.2%
-----------------------------------------------------------------

[Iteration 1390] [Rank 2] a = 0.9728823304176331, b = 0.9995000000416666, delta = 0.18761834502220154, c = 0.0, d = 0.0, m = 7.145535108082853e-07

[Iteration 1260] [Rank 0] a = 1.064760446548462, b = 0.9995000000416666, delta = 0.28937679529190063, c = 0.0, d = 0.0, m = 2.123813345649042e-07
timer                          - epoch: -1.000, value:  0.002 (event:reduce.heur_params.beta)
[Iteration 1270] [Rank 0] a = 0.8593065738677979, b = 0.9995000000416666, delta = 0.22794251143932343, c = 0.0, d = 0.0, m = 2.1071035632285143e-07
[Iteration 1280] [Rank 0] a = 0.9627728462219238, b = 0.9995000000416666, delta = 0.2718701660633087, c = 0.0, d = 0.0, m = 2.0906546673407038e-07
[Iteration 1290] [Rank 0] a = 1.1820088624954224, b = 0.9995000000416666, delta = 0.2551768124103546, c = 0.0, d = 0.0, m = 2.080347108274447e-07
[Iteration 1300] [Rank 0] a = 0.7491228580474854, b = 0.9995000000416666, delta = 0.246229887008667, c = 0.0, d = 0.0, m = 2.064356738495243e-07
[Iteration 1310] [Rank 0] a = 1.0650815963745117, b = 0.9995000000416666, delta = 0.2846182584762573, c = 0.0, d = 0.0, m = 2.04861031028399e-07
rel_compression_error          - epoch:  9.475, value:  1.000 (weight:encoder.weight)
rel_compression_error          - epoch:  9.475, value:  1.000 (weight:rnn.weight_ih_l0)
rel_compression_error          - epoch:  9.475, value:  1.000 (weight:rnn.weight_hh_l0)
rel_compression_error          - epoch:  9.475, value:  1.000 (weight:rnn.bias_ih_l0)
rel_compression_error          - epoch:  9.475, value:  1.000 (weight:rnn.bias_hh_l0)
rel_compression_error          - epoch:  9.475, value:  1.000 (weight:rnn.weight_ih_l1)
rel_compression_error          - epoch:  9.475, value:  1.000 (weight:rnn.weight_hh_l1)
rel_compression_error          - epoch:  9.475, value:  1.000 (weight:rnn.bias_ih_l1)
rel_compression_error          - epoch:  9.475, value:  1.000 (weight:rnn.bias_hh_l1)
rel_compression_error          - epoch:  9.475, value:  1.000 (weight:rnn.weight_ih_l2)
rel_compression_error          - epoch:  9.475, value:  1.000 (weight:rnn.weight_hh_l2)
rel_compression_error          - epoch:  9.475, value:  1.000 (weight:rnn.bias_ih_l2)
rel_compression_error          - epoch:  9.475, value:  1.000 (weight:rnn.bias_hh_l2)
rel_compression_error          - epoch:  9.475, value:  1.000 (weight:decoder.bias)
rel_compression_error          - epoch:  9.475, value:  1.000 (weight:entire_model)
[Iteration 1320] [Rank 0] a = 0.8215261697769165, b = 0.9995000000416666, delta = 0.25631624460220337, c = 0.0, d = 0.0, m = 2.0333637759662002e-07
[Iteration 1330] [Rank 0] a = 0.8346007466316223, b = 0.9995000000416666, delta = 0.2611131966114044, c = 0.0, d = 0.0, m = 2.018086812961195e-07
[Iteration 1340] [Rank 0] a = 0.9469416737556458, b = 0.9995000000416666, delta = 0.26734137535095215, c = 0.0, d = 0.0, m = 2.0030376942963091e-07
timer                          - epoch: -1.000, value:  0.000 (event:reduce.gather.tensors)
[Iteration 1350] [Rank 0] a = 0.9387581944465637, b = 0.9995000000416666, delta = 0.28052181005477905, c = 0.0, d = 0.0, m = 1.9884670461290824e-07
[Iteration 1360] [Rank 0] a = 0.9109041094779968, b = 0.9995000000416666, delta = 0.30346912145614624, c = 0.0, d = 0.0, m = 1.9746181286756127e-07
[Iteration 1370] [Rank 0] a = 1.192671775817871, b = 0.9995000000416666, delta = 0.3106236755847931, c = 0.0, d = 0.0, m = 1.9609712377349583e-07
[Iteration 1380] [Rank 0] a = 1.4459259510040283, b = 0.9995000000416666, delta = 0.31383606791496277, c = 0.0, d = 0.0, m = 1.9537752660881495e-07
cross_entropy                  - bits:54469824.000, epoch: 10.000, ratio_transmit_grad:  0.003, value:  7.164 (split:train)
last_cross_entropy             - bits:54469824.000, epoch: 10.000, ratio_transmit_grad:  0.003, value:  7.164 (split:train)
perplexity                     - bits:54469824.000, epoch: 10.000, ratio_transmit_grad:  0.003, value:1348.444 (split:train)
last_perplexity                - bits:54469824.000, epoch: 10.000, ratio_transmit_grad:  0.003, value:1348.444 (split:train)
last_cross_entropy             - bits:54469824.000, epoch: 10.000, ratio_transmit_grad:  0.003, value:  6.830 (split:test)
last_perplexity                - bits:54469824.000, epoch: 10.000, ratio_transmit_grad:  0.003, value:926.544 (split:test)
runavg_cross_entropy           - bits:54469824.000, epoch: 10.000, ratio_transmit_grad:  0.003, value:  6.883 (split:test)
runavg_perplexity              - bits:54469824.000, epoch: 10.000, ratio_transmit_grad:  0.003, value:977.121 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1389 |     0.10567s |  92.9%
- batch.accumulate               |   1389 |     0.00083s |   0.7%
- batch.backward                 |   1389 |     0.05170s |  45.5%
- batch.evaluate                 |   1389 |     0.00276s |   2.4%
- batch.forward                  |   1389 |     0.02551s |  22.4%
- batch.mom                      |   1389 |     0.00126s |   1.1%
- batch.reduce                   |   1389 |     0.02074s |  18.3%
- batch.reporting.compr_err      |   1389 |     0.00001s |   0.0%
- batch.reporting.lr             |   1389 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1389 |     0.00001s |   0.0%
- batch.step                     |   1389 |     0.00048s |   0.4%
- batch.update_runavg            |   1389 |     0.00130s |   1.1%
- batch.wd                       |   1389 |     0.00001s |   0.0%
- epoch_metrics.collect          |      9 |     0.00651s |   0.0%
- reduce.combine                 |   1389 |     0.00547s |   4.8%
- reduce.flatpack                |   1389 |     0.00002s |   0.0%
- reduce.flatput                 |   1389 |     0.00009s |   0.1%
- reduce.gather.context          |   1389 |     0.00146s |   1.3%
- reduce.gather.tensors          |   1389 |     0.00024s |   0.2%
- reduce.heur_params             |   1389 |     0.01064s |   9.4%
- reduce.heur_params.alpha       |   1388 |     0.00872s |   7.7%
- reduce.heur_params.beta        |   1388 |     0.00184s |   1.6%
- reduce.memory                  |   1389 |     0.00042s |   0.4%
- reduce.pad                     |   1389 |     0.00029s |   0.3%
- reduce.threshold               |   1389 |     0.00189s |   1.7%
- test.last                      |      9 |     0.41365s |   2.9%
- test.runavg                    |      9 |     0.44690s |   3.2%
-----------------------------------------------------------------

[Iteration 1390] [Rank 0] a = 1.0886201858520508, b = 0.9995000000416666, delta = 0.2832777202129364, c = 0.0, d = 0.0, m = 1.939729433837336e-07
[Iteration 1400] [Rank 0] a = 1.0411787033081055, b = 0.9995000000416666, delta = 0.2893448770046234, c = 0.0, d = 0.0, m = 1.9261306736165412e-07
timer                          - epoch: -1.000, value:  0.000 (event:reduce.flatput)
[Iteration 1410] [Rank 0] a = 1.004846453666687, b = 0.9995000000416666, delta = 0.29038116335868835, c = 0.0, d = 0.0, m = 1.9124798538176997e-07
[Iteration 1420] [Rank 0] a = 1.4546598196029663, b = 0.9995000000416666, delta = 0.38618984818458557, c = 0.0, d = 0.0, m = 1.9002366151175028e-07
[Iteration 1430] [Rank 0] a = 0.8988434076309204, b = 0.9995000000416666, delta = 0.2637735903263092, c = 0.0, d = 0.0, m = 1.8869575332508536e-07
timer                          - epoch: -1.000, value:  0.009 (event:reduce.heur_params.alpha)
[Iteration 1440] [Rank 0] a = 0.9431182146072388, b = 0.9995000173132257, delta = 0.26969730854034424, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 1.8741024714441438e-07
[Iteration 1450] [Rank 0] a = 1.0346192121505737, b = 0.9995000000416666, delta = 0.3363475203514099, c = 0.0, d = 0.0, m = 1.8619007271937492e-07
[Iteration 1460] [Rank 0] a = 0.9167956709861755, b = 0.9995000000416666, delta = 0.2971418797969818, c = 0.0, d = 0.0, m = 1.849156711264976e-07
timer                          - epoch: -1.000, value:  0.000 (event:reduce.flatpack)
[Iteration 1470] [Rank 0] a = 1.0734457969665527, b = 0.9995000000416666, delta = 0.2854829728603363, c = 0.0, d = 0.0, m = 1.839169068060887e-07
[Iteration 1480] [Rank 0] a = 1.531736969947815, b = 0.9995000000416666, delta = 0.3524932563304901, c = 0.0, d = 0.0, m = 1.832581688618199e-07
[Iteration 1390] [Rank 3] a = 1.2517422437667847, b = 0.9995000000416666, delta = 0.17554880678653717, c = 0.0, d = 0.0, m = 1.2207804280887106e-06
[Iteration 1400] [Rank 3] a = 1.252353549003601, b = 0.9995000000416666, delta = 0.1680133193731308, c = 0.0, d = 0.0, m = 1.2205484733235947e-06
[Iteration 1410] [Rank 3] a = 0.9483738541603088, b = 0.9995000518563442, delta = 0.13918651640415192, c = 1.0362938071185717e-07, d = 1.3817250761580954e-07, m = 1.212167530490645e-06
[Iteration 1420] [Rank 3] a = 1.0042517185211182, b = 0.9995000000416666, delta = 0.1584916114807129, c = 0.0, d = 0.0, m = 1.2040747092234847e-06
[Iteration 1430] [Rank 3] a = 0.9667255878448486, b = 0.9995000000416666, delta = 0.1573106348514557, c = 0.0, d = 0.0, m = 1.1957329078876891e-06
[Iteration 1440] [Rank 3] a = 0.6084848046302795, b = 0.9995131436982532, delta = 0.11873330920934677, c = 2.6287319573907767e-05, d = 2.659820771604334e-05, m = 1.2077868882225805e-06

[Iteration 1390] [Rank 1] a = 0.9965049028396606, b = 0.9995003282012903, delta = 0.0185064896941185, c = 6.563194111750953e-07, d = 6.563194111750953e-07, m = 2.0244730862886217e-05
[Iteration 1400] [Rank 1] a = 1.0150368213653564, b = 0.999500759990269, delta = 0.019656522199511528, c = 1.519897583773905e-06, d = 1.519897583773905e-06, m = 2.0242272365716197e-05
[Iteration 1410] [Rank 1] a = 1.1098705530166626, b = 0.9995002073003761, delta = 0.021561864763498306, c = 4.1451752284742866e-07, d = 4.1451752284742866e-07, m = 2.0144518499148177e-05
[Iteration 1420] [Rank 1] a = 0.8692613840103149, b = 0.9995029189351645, delta = 0.01704113371670246, c = 5.837788446767953e-06, d = 5.94141782747981e-06, m = 2.0711120563180328e-05
[Iteration 1430] [Rank 1] a = 1.0445442199707031, b = 0.9995000518563442, delta = 0.017741847783327103, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 2.0603683753561043e-05
[Iteration 1490] [Rank 0] a = 1.1376069784164429, b = 0.9995000000416666, delta = 0.29863569140434265, c = 0.0, d = 0.0, m = 1.9625407646102083e-07
timer                          - epoch: -1.000, value:  0.004 (event:reduce.gather.context)
[Iteration 1500] [Rank 0] a = 0.8347955346107483, b = 0.9995000000416666, delta = 0.24242445826530457, c = 0.0, d = 0.0, m = 1.9494658761051437e-07
[Iteration 1510] [Rank 0] a = 0.8348472714424133, b = 0.9995000000416666, delta = 0.25362682342529297, c = 0.0, d = 0.0, m = 1.936564050320199e-07
[Iteration 1520] [Rank 0] a = 0.9211375117301941, b = 0.9995000000416666, delta = 0.2492733746767044, c = 0.0, d = 0.0, m = 1.923831873789494e-07
cross_entropy                  - bits:64908288.000, epoch: 11.000, ratio_transmit_grad:  0.004, value:  7.145 (split:train)
last_cross_entropy             - bits:64908288.000, epoch: 11.000, ratio_transmit_grad:  0.004, value:  7.145 (split:train)
[Iteration 1450] [Rank 3] a = 1.254555106163025, b = 0.9995000000416666, delta = 0.16055351495742798, c = 0.0, d = 0.0, m = 1.1995820961841888e-06
[Iteration 1460] [Rank 3] a = 0.9756250381469727, b = 0.9995000000416666, delta = 0.16289953887462616, c = 0.0, d = 0.0, m = 1.1914896216275003e-06
[Iteration 1470] [Rank 3] a = 1.051596760749817, b = 0.9995000000416666, delta = 0.17414341866970062, c = 0.0, d = 0.0, m = 1.1836480704240119e-06
[Iteration 1480] [Rank 3] a = 1.0909026861190796, b = 0.9995000000416666, delta = 0.15088598430156708, c = 0.0, d = 0.0, m = 1.176775409645585e-06
[Iteration 1490] [Rank 3] a = 1.0717864036560059, b = 0.9995000000416666, delta = 0.15749448537826538, c = 0.0, d = 0.0, m = 1.1717093515542548e-06
[Iteration 1500] [Rank 3] a = 0.9998288154602051, b = 0.9995000000416666, delta = 0.15640655159950256, c = 0.0, d = 0.0, m = 1.164018227049909e-06
[Iteration 1440] [Rank 1] a = 1.1851485967636108, b = 0.9995000863994624, delta = 0.02069723978638649, c = 1.7271563451976193e-07, d = 1.7271563451976193e-07, m = 2.04986729801261e-05
[Iteration 1450] [Rank 1] a = 1.1256613731384277, b = 0.9995000691279032, delta = 0.02077595144510269, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 2.041217884174204e-05
[Iteration 1460] [Rank 1] a = 0.7920148372650146, b = 0.9995360112430942, delta = 0.017769914120435715, c = 7.202241959474073e-05, d = 7.264419587901187e-05, m = 2.0349708346997206e-05
[Iteration 1470] [Rank 1] a = 1.0930315256118774, b = 0.9995000345847849, delta = 0.02188708260655403, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 2.0224707267875164e-05
[Iteration 1480] [Rank 1] a = 0.9963732361793518, b = 0.9995010536067743, delta = 0.020663686096668243, c = 2.1071307411410955e-06, d = 2.1071307411410955e-06, m = 2.012033349505188e-05
perplexity                     - bits:64908288.000, epoch: 11.000, ratio_transmit_grad:  0.004, value:1278.971 (split:train)
last_perplexity                - bits:64908288.000, epoch: 11.000, ratio_transmit_grad:  0.004, value:1278.971 (split:train)
last_cross_entropy             - bits:64908288.000, epoch: 11.000, ratio_transmit_grad:  0.004, value:  6.870 (split:test)
last_perplexity                - bits:64908288.000, epoch: 11.000, ratio_transmit_grad:  0.004, value:964.713 (split:test)
runavg_cross_entropy           - bits:64908288.000, epoch: 11.000, ratio_transmit_grad:  0.004, value:  6.942 (split:test)
runavg_perplexity              - bits:64908288.000, epoch: 11.000, ratio_transmit_grad:  0.004, value:1036.489 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1528 |     0.10565s |  92.9%
- batch.accumulate               |   1528 |     0.00083s |   0.7%
[Iteration 1510] [Rank 3] a = 1.02956223487854, b = 0.9995000000416666, delta = 0.16518384218215942, c = 0.0, d = 0.0, m = 1.1564517654290784e-06
[Iteration 1520] [Rank 3] a = 1.1436965465545654, b = 0.9995000000416666, delta = 0.14468933641910553, c = 0.0, d = 0.0, m = 1.151324009464739e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1528 |     0.10588s |  93.1%
- batch.accumulate               |   1528 |     0.00082s |   0.7%
- batch.backward                 |   1528 |     0.05164s |  45.4%
- batch.evaluate                 |   1528 |     0.00277s |   2.4%
- batch.forward                  |   1528 |     0.02541s |  22.4%
- batch.mom                      |   1528 |     0.00126s |   1.1%
- batch.reduce                   |   1528 |     0.02117s |  18.6%
- batch.reporting.compr_err      |   1528 |     0.00001s |   0.0%
- batch.reporting.lr             |   1528 |     0.00002s |   0.0%
[Iteration 1490] [Rank 1] a = 1.032579779624939, b = 0.9995016408397858, delta = 0.018044497817754745, c = 3.281597055875477e-06, d = 3.281597055875477e-06, m = 2.0407087794820645e-05
[Iteration 1500] [Rank 1] a = 0.9093364477157593, b = 0.9995003454728494, delta = 0.018196314573287964, c = 6.908625380790477e-07, d = 6.908625380790477e-07, m = 2.0799887265704734e-05
[Iteration 1510] [Rank 1] a = 0.8449887037277222, b = 0.999509309412083, delta = 0.016924338415265083, c = 1.8618745401230337e-05, d = 1.892963354336591e-05, m = 2.0728413724824445e-05
[Iteration 1520] [Rank 1] a = 1.2051819562911987, b = 0.9995000863994624, delta = 0.02042480558156967, c = 1.7271563451976193e-07, d = 1.7271563451976193e-07, m = 2.065270194455133e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1528 |     0.10579s |  93.0%
- batch.accumulate               |   1528 |     0.00083s |   0.7%
- batch.backward                 |   1528 |     0.05170s |  45.5%
- batch.evaluate                 |   1528 |     0.00276s |   2.4%
- batch.forward                  |   1528 |     0.02551s |  22.4%
- batch.mom                      |   1528 |     0.00126s |   1.1%
- batch.reduce                   |   1528 |     0.02073s |  18.2%
- batch.reporting.compr_err      |   1528 |     0.00001s |   0.0%
- batch.reporting.lr             |   1528 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1528 |     0.00001s |   0.0%
- batch.step                     |   1528 |     0.00048s |   0.4%
- batch.update_runavg            |   1528 |     0.00130s |   1.1%
- batch.wd                       |   1528 |     0.00001s |   0.0%
- epoch_metrics.collect          |     10 |     0.00593s |   0.0%
- reduce.combine                 |   1528 |     0.00547s |   4.8%
- reduce.flatpack                |   1528 |     0.00002s |   0.0%
- reduce.flatput                 |   1528 |     0.00009s |   0.1%
- batch.reporting.memory_norm    |   1528 |     0.00001s |   0.0%
- batch.step                     |   1528 |     0.00047s |   0.4%
- batch.update_runavg            |   1528 |     0.00129s |   1.1%
- batch.wd                       |   1528 |     0.00001s |   0.0%
- epoch_metrics.collect          |     10 |     0.01137s |   0.1%
- reduce.combine                 |   1528 |     0.00521s |   4.6%
- reduce.flatpack                |   1528 |     0.00002s |   0.0%
- reduce.flatput                 |   1528 |     0.00010s |   0.1%
- reduce.gather.context          |   1528 |     0.00270s |   2.4%
- reduce.gather.tensors          |   1528 |     0.00026s |   0.2%
- reduce.heur_params             |   1528 |     0.01005s |   8.8%
- reduce.heur_params.alpha       |   1527 |     0.00809s |   7.1%
- reduce.heur_params.beta        |   1527 |     0.00189s |   1.7%
- reduce.memory                  |   1528 |     0.00041s |   0.4%
- reduce.pad                     |   1528 |     0.00027s |   0.2%
- batch.backward                 |   1528 |     0.05165s |  45.4%
- batch.evaluate                 |   1528 |     0.00276s |   2.4%
- batch.forward                  |   1528 |     0.02544s |  22.4%
- batch.mom                      |   1528 |     0.00126s |   1.1%
- batch.reduce                   |   1528 |     0.02103s |  18.5%
- batch.reporting.compr_err      |   1528 |     0.00001s |   0.0%
- batch.reporting.lr             |   1528 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   1528 |     0.00001s |   0.0%
- batch.step                     |   1528 |     0.00048s |   0.4%
- batch.update_runavg            |   1528 |     0.00129s |   1.1%
- batch.wd                       |   1528 |     0.00001s |   0.0%
- epoch_metrics.collect          |     10 |     0.01164s |   0.1%
- reduce.combine                 |   1528 |     0.00524s |   4.6%
- reduce.flatpack                |   1528 |     0.00002s |   0.0%
- reduce.flatput                 |   1528 |     0.00016s |   0.1%
- reduce.gather.context          |   1528 |     0.00145s |   1.3%
- reduce.gather.tensors          |   1528 |     0.00024s |   0.2%
- reduce.heur_params             |   1528 |     0.01063s |   9.4%
- reduce.heur_params.alpha       |   1527 |     0.00872s |   7.7%
- reduce.heur_params.beta        |   1527 |     0.00184s |   1.6%
- reduce.memory                  |   1528 |     0.00042s |   0.4%
- reduce.pad                     |   1528 |     0.00029s |   0.3%
- reduce.threshold               |   1528 |     0.00189s |   1.7%
- test.last                      |     10 |     0.41390s |   2.9%
- test.runavg                    |     10 |     0.44697s |   3.1%
-----------------------------------------------------------------

[Iteration 1530] [Rank 0] a = 1.000746488571167, b = 0.9995000000416666, delta = 0.26315340399742126, c = 0.0, d = 0.0, m = 1.911266022229798e-07
[Iteration 1540] [Rank 0] a = 1.0327014923095703, b = 0.9995000000416666, delta = 0.3111906349658966, c = 0.0, d = 0.0, m = 1.8988632576468663e-07
- reduce.threshold               |   1528 |     0.00196s |   1.7%
- test.last                      |     10 |     0.41392s |   2.9%
- test.runavg                    |     10 |     0.44693s |   3.1%
- reduce.gather.context          |   1528 |     0.00157s |   1.4%
- reduce.gather.tensors          |   1528 |     0.00038s |   0.3%
- reduce.heur_params             |   1528 |     0.01056s |   9.3%
[Iteration 1550] [Rank 0] a = 0.8948938846588135, b = 0.9995000000416666, delta = 0.27986180782318115, c = 0.0, d = 0.0, m = 1.8866204255537207e-07
-----------------------------------------------------------------

[Iteration 1530] [Rank 3] a = 1.0171908140182495, b = 0.9995000000416666, delta = 0.16706711053848267, c = 0.0, d = 0.0, m = 1.143826493483195e-06
[Iteration 1540] [Rank 3] a = 0.9866313338279724, b = 0.9995000173132257, delta = 0.13614672422409058, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 1.1378609115973578e-06
[Iteration 1550] [Rank 3] a = 0.9732134342193604, b = 0.9995000173132257, delta = 0.13430695235729218, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 1.1369833472428595e-06
[Iteration 1560] [Rank 3] a = 0.931554913520813, b = 0.9995000000416666, delta = 0.15090560913085938, c = 0.0, d = 0.0, m = 1.1297217903270841e-06
[Iteration 1570] [Rank 3] a = 1.150650143623352, b = 0.9995000000416666, delta = 0.15580467879772186, c = 0.0, d = 0.0, m = 1.1234761738748878e-06
- reduce.heur_params.alpha       |   1527 |     0.00824s |   7.3%
- reduce.heur_params.beta        |   1527 |     0.00223s |   2.0%
- reduce.memory                  |   1528 |     0.00043s |   0.4%
- reduce.pad                     |   1528 |     0.00015s |   0.1%
- reduce.threshold               |   1528 |     0.00234s |   2.1%
- test.last                      |     10 |     0.41391s |   2.9%
- test.runavg                    |     10 |     0.44694s |   3.1%
-----------------------------------------------------------------

[Iteration 1530] [Rank 1] a = 1.0453733205795288, b = 0.9995001554856989, delta = 0.017627814784646034, c = 3.1088814213557147e-07, d = 3.7997439594347627e-07, m = 2.203206210104143e-05
[Iteration 1540] [Rank 1] a = 0.9291859865188599, b = 0.9995014853957532, delta = 0.015974000096321106, c = 2.970708913739905e-06, d = 3.0052520406438576e-06, m = 2.1985276855444054e-05
timer                          - epoch: -1.000, value:  0.000 (event:reduce.flatput)
[Iteration 1560] [Rank 0] a = 0.9866786599159241, b = 0.9995000000416666, delta = 0.2958376705646515, c = 0.0, d = 0.0, m = 1.8745344522958492e-07
[Iteration 1570] [Rank 0] a = 0.965369701385498, b = 0.9995000000416666, delta = 0.2885444760322571, c = 0.0, d = 0.0, m = 1.862602342478562e-07
[Iteration 1580] [Rank 0] a = 1.032843828201294, b = 0.9995000000416666, delta = 0.29962393641471863, c = 0.0, d = 0.0, m = 1.8508211764919802e-07
[Iteration 1590] [Rank 0] a = 0.6859437823295593, b = 0.9995000000416666, delta = 0.27408820390701294, c = 0.0, d = 0.0, m = 1.8391881081293656e-07
[Iteration 1600] [Rank 0] a = 1.029363751411438, b = 0.9995000000416666, delta = 0.27450770139694214, c = 0.0, d = 0.0, m = 1.8281318816813866e-07
[Iteration 1610] [Rank 0] a = 1.0461658239364624, b = 0.9995000000416666, delta = 0.3354242146015167, c = 0.0, d = 0.0, m = 1.8167840736014275e-07
[Iteration 1580] [Rank 3] a = 0.8165463805198669, b = 0.9995012608654843, delta = 0.12880639731884003, c = 2.5216482639885243e-06, d = 2.5216482639885243e-06, m = 1.117986882067262e-06
[Iteration 1590] [Rank 3] a = 1.0798414945602417, b = 0.9995000000416666, delta = 0.15885764360427856, c = 0.0, d = 0.0, m = 1.110981649073064e-06
[Iteration 1600] [Rank 3] a = 0.995367705821991, b = 0.9995000000416666, delta = 0.16947907209396362, c = 0.0, d = 0.0, m = 1.104236534551768e-06
[Iteration 1610] [Rank 3] a = 0.8888810873031616, b = 0.9995008636196238, delta = 0.13683144748210907, c = 1.7271563451976192e-06, d = 1.796242599005524e-06, m = 1.0985400500746075e-06
[Iteration 1620] [Rank 3] a = 1.2291520833969116, b = 0.9995000000416666, delta = 0.17240530252456665, c = 0.0, d = 0.0, m = 1.0919762195800322e-06
[Iteration 1630] [Rank 3] a = 0.9473268389701843, b = 0.9995000000416666, delta = 0.15861032903194427, c = 0.0, d = 0.0, m = 1.08879681851949e-06
[Iteration 1550] [Rank 1] a = 1.0956960916519165, b = 0.9995005700031182, delta = 0.015167227946221828, c = 1.1399231878304288e-06, d = 1.1399231878304288e-06, m = 2.4285288133772408e-05
[Iteration 1560] [Rank 1] a = 0.8927894234657288, b = 0.9998479701900382, delta = 0.013484355993568897, c = 0.0006959403777339287, d = 0.0007026072012263915, m = 2.483188331535574e-05
[Iteration 1570] [Rank 1] a = 1.0073448419570923, b = 0.9995009845205379, delta = 0.012959767132997513, c = 1.968958233525286e-06, d = 1.968958233525286e-06, m = 2.701424240996429e-05
[Iteration 1580] [Rank 1] a = 1.0209918022155762, b = 0.9995010881498926, delta = 0.011615307070314884, c = 2.1762169949490005e-06, d = 2.2107601218529526e-06, m = 2.933082905617652e-05
[Iteration 1590] [Rank 1] a = 0.982758104801178, b = 0.9995084458341187, delta = 0.009467954747378826, c = 1.6891589056032716e-05, d = 1.7098847817456432e-05, m = 3.743100613250158e-05
[Iteration 1620] [Rank 0] a = 1.2133564949035645, b = 0.9995000000416666, delta = 0.35539865493774414, c = 0.0, d = 0.0, m = 1.8055762754916102e-07
[Iteration 1630] [Rank 0] a = 0.8828616142272949, b = 0.9995000000416666, delta = 0.2848424017429352, c = 0.0, d = 0.0, m = 1.7945059120612508e-07
[Iteration 1640] [Rank 0] a = 1.1889914274215698, b = 0.9995000000416666, delta = 0.343057245016098, c = 0.0, d = 0.0, m = 1.7835704707933578e-07
[Iteration 1650] [Rank 0] a = 0.8633947372436523, b = 0.9995000000416666, delta = 0.31239238381385803, c = 0.0, d = 0.0, m = 1.7742320784101615e-07
[Iteration 1660] [Rank 0] a = 0.9867517352104187, b = 0.9995000000416666, delta = 0.3196490406990051, c = 0.0, d = 0.0, m = 1.76355036812473e-07
cross_entropy                  - bits:148660160.000, epoch: 12.000, ratio_transmit_grad:  0.033, value:  7.045 (split:train)
last_cross_entropy             - bits:148660160.000, epoch: 12.000, ratio_transmit_grad:  0.033, value:  7.045 (split:train)
[Iteration 1640] [Rank 3] a = 0.9295435547828674, b = 0.9995000173132257, delta = 0.15466301143169403, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 1.0821829092822622e-06
[Iteration 1650] [Rank 3] a = 0.9833921194076538, b = 0.9995000000416666, delta = 0.15582820773124695, c = 0.0, d = 0.0, m = 1.0756700426323443e-06
[Iteration 1660] [Rank 3] a = 0.9340917468070984, b = 0.9995001554856989, delta = 0.1408511847257614, c = 3.1088814213557147e-07, d = 3.1088814213557147e-07, m = 1.0695475457816783e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1667 |     0.10592s |  93.1%
- batch.accumulate               |   1667 |     0.00082s |   0.7%
- batch.backward                 |   1667 |     0.05163s |  45.4%
- batch.evaluate                 |   1667 |     0.00277s |   2.4%
- batch.forward                  |   1667 |     0.02542s |  22.3%
[Iteration 1600] [Rank 1] a = 1.0522540807724, b = 0.9995002591150537, delta = 0.01006297767162323, c = 5.181469035592857e-07, d = 5.181469035592857e-07, m = 3.722374690999492e-05
[Iteration 1610] [Rank 1] a = 0.9560654759407043, b = 0.9995011745076885, delta = 0.008883454836905003, c = 2.348932629468762e-06, d = 2.4525620101806193e-06, m = 4.176885861856203e-05
[Iteration 1620] [Rank 1] a = 0.9758189916610718, b = 0.9995174615881021, delta = 0.007225444540381432, c = 3.4923101299895864e-05, d = 3.5441248203455146e-05, m = 4.829397644194755e-05
[Iteration 1630] [Rank 1] a = 0.9324229955673218, b = 0.9995103802487598, delta = 0.00773261021822691, c = 2.0760419269275383e-05, d = 2.0898591776891195e-05, m = 4.804277574582057e-05
[Iteration 1640] [Rank 1] a = 0.938784658908844, b = 0.9995008981627422, delta = 0.008331160061061382, c = 1.796242599005524e-06, d = 1.8307857259094765e-06, m = 4.780949793910051e-05
perplexity                     - bits:148660160.000, epoch: 12.000, ratio_transmit_grad:  0.033, value:1149.605 (split:train)
last_perplexity                - bits:148660160.000, epoch: 12.000, ratio_transmit_grad:  0.033, value:1149.605 (split:train)
timer                          - epoch: 12.000, value:  0.001 (event:epoch_metrics.collect)
last_cross_entropy             - bits:148660160.000, epoch: 12.000, ratio_transmit_grad:  0.033, value:  6.783 (split:test)
last_perplexity                - bits:148660160.000, epoch: 12.000, ratio_transmit_grad:  0.033, value:884.361 (split:test)
runavg_cross_entropy           - bits:148660160.000, epoch: 12.000, ratio_transmit_grad:  0.033, value:  6.829 (split:test)
runavg_perplexity              - bits:148660160.000, epoch: 12.000, ratio_transmit_grad:  0.033, value:925.767 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch.mom                      |   1667 |     0.00126s |   1.1%
- batch.reduce                   |   1667 |     0.02122s |  18.6%
- batch.reporting.compr_err      |   1667 |     0.00001s |   0.0%
- batch.reporting.lr             |   1667 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1667 |     0.00001s |   0.0%
- batch.step                     |   1667 |     0.00047s |   0.4%
- batch.update_runavg            |   1667 |     0.00129s |   1.1%
- batch.wd                       |   1667 |     0.00001s |   0.0%
- epoch_metrics.collect          |     11 |     0.01040s |   0.1%
- reduce.combine                 |   1667 |     0.00521s |   4.6%
- reduce.flatpack                |   1667 |     0.00002s |   0.0%
- reduce.flatput                 |   1667 |     0.00010s |   0.1%
- reduce.gather.context          |   1667 |     0.00272s |   2.4%
- reduce.gather.tensors          |   1667 |     0.00031s |   0.3%
- reduce.heur_params             |   1667 |     0.01003s |   8.8%
[Iteration 1650] [Rank 1] a = 1.0519466400146484, b = 0.9995002073003761, delta = 0.00861417967826128, c = 4.1451752284742866e-07, d = 4.1451752284742866e-07, m = 4.760122393047407e-05
[Iteration 1660] [Rank 1] a = 0.968486487865448, b = 0.9995008463480648, delta = 0.008680598810315132, c = 1.692613218293667e-06, d = 1.692613218293667e-06, m = 4.739601924430334e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1667 |     0.10583s |  93.0%
- batch.accumulate               |   1667 |     0.00083s |   0.7%
- batch.backward                 |   1667 |     0.05166s |  45.4%
- batch.evaluate                 |   1667 |     0.00277s |   2.4%
- batch.forward                  |   1667 |     0.02544s |  22.4%
- batch.mom                      |   1667 |     0.00126s |   1.1%
- batch.reduce                   |   1667 |     0.02106s |  18.5%
- batch                          |   1667 |     0.10569s |  92.9%
- batch.accumulate               |   1667 |     0.00083s |   0.7%
- batch.backward                 |   1667 |     0.05170s |  45.4%
- batch.evaluate                 |   1667 |     0.00275s |   2.4%
- batch.forward                  |   1667 |     0.02551s |  22.4%
- batch.mom                      |   1667 |     0.00126s |   1.1%
- batch.reduce                   |   1667 |     0.02077s |  18.3%
- batch.reporting.compr_err      |   1667 |     0.00001s |   0.0%
- batch.reporting.lr             |   1667 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1667 |     0.00001s |   0.0%
- batch.step                     |   1667 |     0.00048s |   0.4%
- batch.update_runavg            |   1667 |     0.00130s |   1.1%
- batch.wd                       |   1667 |     0.00001s |   0.0%
- epoch_metrics.collect          |     11 |     0.00548s |   0.0%
- reduce.combine                 |   1667 |     0.00547s |   4.8%
- reduce.heur_params.alpha       |   1666 |     0.00808s |   7.1%
- reduce.heur_params.beta        |   1666 |     0.00188s |   1.7%
- reduce.memory                  |   1667 |     0.00041s |   0.4%
- reduce.pad                     |   1667 |     0.00027s |   0.2%
- batch.reporting.compr_err      |   1667 |     0.00001s |   0.0%
- batch.reporting.lr             |   1667 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   1667 |     0.00001s |   0.0%
- batch.step                     |   1667 |     0.00048s |   0.4%
- batch.update_runavg            |   1667 |     0.00129s |   1.1%
- reduce.flatpack                |   1667 |     0.00002s |   0.0%
- reduce.flatput                 |   1667 |     0.00009s |   0.1%
- reduce.threshold               |   1667 |     0.00195s |   1.7%
- test.last                      |     11 |     0.41410s |   2.9%
- test.runavg                    |     11 |     0.44642s |   3.1%
-----------------------------------------------------------------
- batch.wd                       |   1667 |     0.00001s |   0.0%
- epoch_metrics.collect          |     11 |     0.01290s |   0.1%
- reduce.combine                 |   1667 |     0.00524s |   4.6%
- reduce.flatpack                |   1667 |     0.00002s |   0.0%
- reduce.flatput                 |   1667 |     0.00016s |   0.1%
- reduce.gather.context          |   1667 |     0.00152s |   1.3%
- reduce.gather.tensors          |   1667 |     0.00044s |   0.4%
- reduce.heur_params             |   1667 |     0.01056s |   9.3%
- reduce.heur_params.alpha       |   1666 |     0.00824s |   7.2%
- reduce.heur_params.beta        |   1666 |     0.00224s |   2.0%
- reduce.memory                  |   1667 |     0.00043s |   0.4%
- reduce.pad                     |   1667 |     0.00015s |   0.1%
- reduce.threshold               |   1667 |     0.00235s |   2.1%
- test.last                      |     11 |     0.41410s |   2.9%
- test.runavg                    |     11 |     0.44643s |   3.1%
- reduce.gather.context          |   1667 |     0.00145s |   1.3%
- reduce.gather.tensors          |   1667 |     0.00030s |   0.3%
- reduce.heur_params             |   1667 |     0.01063s |   9.3%
- reduce.heur_params.alpha       |   1666 |     0.00872s |   7.7%
- reduce.heur_params.beta        |   1666 |     0.00183s |   1.6%
- reduce.memory                  |   1667 |     0.00042s |   0.4%
- reduce.pad                     |   1667 |     0.00029s |   0.3%
- reduce.threshold               |   1667 |     0.00188s |   1.7%
- test.last                      |     11 |     0.41410s |   2.9%
- test.runavg                    |     11 |     0.44645s |   3.1%
-----------------------------------------------------------------
-----------------------------------------------------------------
[Iteration 1400] [Rank 2] a = 1.2679439783096313, b = 0.9995000000416666, delta = 0.20536409318447113, c = 0.0, d = 0.0, m = 7.10562722516062e-07
[Iteration 1410] [Rank 2] a = 1.1099673509597778, b = 0.9995000000416666, delta = 0.22904042899608612, c = 0.0, d = 0.0, m = 7.056247673654278e-07
[Iteration 1420] [Rank 2] a = 0.812981128692627, b = 0.9995004836453225, delta = 0.174596905708313, c = 9.67207553310667e-07, d = 9.67207553310667e-07, m = 7.013883466289494e-07
[Iteration 1430] [Rank 2] a = 0.9729276895523071, b = 0.9995000000416666, delta = 0.2232992947101593, c = 0.0, d = 0.0, m = 6.964869605588659e-07
[Iteration 1440] [Rank 2] a = 1.019439697265625, b = 0.9995000000416666, delta = 0.20730097591876984, c = 0.0, d = 0.0, m = 6.918453751387708e-07
[Iteration 1450] [Rank 2] a = 0.8604297637939453, b = 0.9995000345847849, delta = 0.19105076789855957, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 6.87124928896469e-07
[Iteration 1460] [Rank 2] a = 1.5001686811447144, b = 0.9995000000416666, delta = 0.2185540646314621, c = 0.0, d = 0.0, m = 6.939598341943227e-07
[Iteration 1470] [Rank 2] a = 1.0323249101638794, b = 0.9995000000416666, delta = 0.21414530277252197, c = 0.0, d = 0.0, m = 6.892422282514653e-07
[Iteration 1480] [Rank 2] a = 0.904026210308075, b = 0.9995000000416666, delta = 0.18556632101535797, c = 0.0, d = 0.0, m = 6.847282758401952e-07
[Iteration 1490] [Rank 2] a = 1.1253008842468262, b = 0.9995000000416666, delta = 0.23680274188518524, c = 0.0, d = 0.0, m = 6.80135866210147e-07
[Iteration 1500] [Rank 2] a = 0.766132116317749, b = 0.9995000000416666, delta = 0.188301220536232, c = 0.0, d = 0.0, m = 6.757197149592598e-07
[Iteration 1510] [Rank 2] a = 1.152848720550537, b = 0.9995000000416666, delta = 0.1847529411315918, c = 0.0, d = 0.0, m = 6.717049336147769e-07
[Iteration 1520] [Rank 2] a = 1.1763043403625488, b = 0.9995000000416666, delta = 0.23130884766578674, c = 0.0, d = 0.0, m = 6.673114384081736e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1528 |     0.10565s |  92.9%
- batch.accumulate               |   1528 |     0.00083s |   0.7%
- batch.backward                 |   1528 |     0.05206s |  45.8%
- batch.evaluate                 |   1528 |     0.00275s |   2.4%
- batch.forward                  |   1528 |     0.02576s |  22.7%
- batch.mom                      |   1528 |     0.00126s |   1.1%
- batch.reduce                   |   1528 |     0.02014s |  17.7%
- batch.reporting.compr_err      |   1528 |     0.00001s |   0.0%
- batch.reporting.lr             |   1528 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1528 |     0.00001s |   0.0%
- batch.step                     |   1528 |     0.00048s |   0.4%
- batch.update_runavg            |   1528 |     0.00130s |   1.1%
- batch.wd                       |   1528 |     0.00001s |   0.0%
- epoch_metrics.collect          |     10 |     0.01798s |   0.1%
- reduce.combine                 |   1528 |     0.00547s |   4.8%
- reduce.flatpack                |   1528 |     0.00002s |   0.0%
- reduce.flatput                 |   1528 |     0.00010s |   0.1%
- reduce.gather.context          |   1528 |     0.00111s |   1.0%
- reduce.gather.tensors          |   1528 |     0.00024s |   0.2%
- reduce.heur_params             |   1528 |     0.01034s |   9.1%
- reduce.heur_params.alpha       |   1527 |     0.00838s |   7.4%
- reduce.heur_params.beta        |   1527 |     0.00188s |   1.7%
- reduce.memory                  |   1528 |     0.00042s |   0.4%
- reduce.pad                     |   1528 |     0.00028s |   0.3%
- reduce.threshold               |   1528 |     0.00194s |   1.7%
- test.last                      |     10 |     0.41392s |   2.9%
- test.runavg                    |     10 |     0.44694s |   3.1%
-----------------------------------------------------------------

[Iteration 1530] [Rank 2] a = 0.7992289066314697, b = 0.9995000000416666, delta = 0.19216027855873108, c = 0.0, d = 0.0, m = 6.629527745387538e-07
[Iteration 1540] [Rank 2] a = 1.0647647380828857, b = 0.9995000000416666, delta = 0.2043052613735199, c = 0.0, d = 0.0, m = 6.586506799603063e-07
[Iteration 1550] [Rank 2] a = 1.3006502389907837, b = 0.9995000000416666, delta = 0.24276718497276306, c = 0.0, d = 0.0, m = 6.546713187244871e-07
[Iteration 1560] [Rank 2] a = 0.9732465147972107, b = 0.9995000000416666, delta = 0.2450861781835556, c = 0.0, d = 0.0, m = 6.504995249638587e-07
[Iteration 1570] [Rank 2] a = 1.1148393154144287, b = 0.9995000000416666, delta = 0.20957347750663757, c = 0.0, d = 0.0, m = 6.465347571507415e-07
[Iteration 1580] [Rank 2] a = 0.8835335373878479, b = 0.9995000000416666, delta = 0.2225172221660614, c = 0.0, d = 0.0, m = 6.424890510674401e-07
[Iteration 1590] [Rank 2] a = 0.9253352284431458, b = 0.9995000000416666, delta = 0.23051811754703522, c = 0.0, d = 0.0, m = 6.394929351533705e-07
[Iteration 1600] [Rank 2] a = 1.0193811655044556, b = 0.9995000000416666, delta = 0.22122274339199066, c = 0.0, d = 0.0, m = 6.355417527063214e-07
[Iteration 1610] [Rank 2] a = 0.9666686654090881, b = 0.9995000000416666, delta = 0.21270787715911865, c = 0.0, d = 0.0, m = 6.319826954482258e-07
[Iteration 1620] [Rank 2] a = 0.8428654670715332, b = 0.9995000000416666, delta = 0.1956610530614853, c = 0.0, d = 0.0, m = 6.282331426621958e-07
[Iteration 1630] [Rank 2] a = 0.9387789368629456, b = 0.9995000345847849, delta = 0.19963519275188446, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 6.244236729057187e-07
[Iteration 1640] [Rank 2] a = 1.0601917505264282, b = 0.9995000000416666, delta = 0.22506892681121826, c = 0.0, d = 0.0, m = 6.206395817404822e-07
[Iteration 1650] [Rank 2] a = 1.1603517532348633, b = 0.9995000000416666, delta = 0.22266875207424164, c = 0.0, d = 0.0, m = 6.187843598936346e-07
[Iteration 1660] [Rank 2] a = 0.832482099533081, b = 0.9995000345847849, delta = 0.1922498643398285, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 6.151005806370853e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1667 |     0.10569s |  92.9%
- batch.accumulate               |   1667 |     0.00083s |   0.7%
- batch.backward                 |   1667 |     0.05207s |  45.8%
- batch.evaluate                 |   1667 |     0.00275s |   2.4%
- batch.forward                  |   1667 |     0.02576s |  22.6%
- batch.mom                      |   1667 |     0.00126s |   1.1%
- batch.reduce                   |   1667 |     0.02018s |  17.7%
- batch.reporting.compr_err      |   1667 |     0.00001s |   0.0%
- batch.reporting.lr             |   1667 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1667 |     0.00001s |   0.0%
- batch.step                     |   1667 |     0.00048s |   0.4%
- batch.update_runavg            |   1667 |     0.00130s |   1.1%
- batch.wd                       |   1667 |     0.00001s |   0.0%
- epoch_metrics.collect          |     11 |     0.01870s |   0.1%
- reduce.combine                 |   1667 |     0.00547s |   4.8%
- reduce.flatpack                |   1667 |     0.00002s |   0.0%
- reduce.flatput                 |   1667 |     0.00010s |   0.1%
- reduce.gather.context          |   1667 |     0.00110s |   1.0%
- reduce.gather.tensors          |   1667 |     0.00030s |   0.3%
- reduce.heur_params             |   1667 |     0.01034s |   9.1%
- reduce.heur_params.alpha       |   1666 |     0.00838s |   7.4%
- reduce.heur_params.beta        |   1666 |     0.00188s |   1.6%
- reduce.memory                  |   1667 |     0.00042s |   0.4%
- reduce.pad                     |   1667 |     0.00028s |   0.3%
- reduce.threshold               |   1667 |     0.00193s |   1.7%
- test.last                      |     11 |     0.41412s |   2.9%
- test.runavg                    |     11 |     0.44642s |   3.1%
-----------------------------------------------------------------

[Iteration 1670] [Rank 2] a = 0.8893004059791565, b = 0.9995000000416666, delta = 0.22212503850460052, c = 0.0, d = 0.0, m = 6.11419547838539e-07

[Iteration 1670] [Rank 1] a = 1.0262068510055542, b = 0.9995002936581718, delta = 0.008553767576813698, c = 5.872331573671905e-07, d = 5.872331573671905e-07, m = 4.7235958574159e-05
[Iteration 1680] [Rank 1] a = 1.2326560020446777, b = 0.9995000173132257, delta = 0.009516440331935883, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 4.699885240719008e-05
[Iteration 1690] [Rank 1] a = 1.0372205972671509, b = 0.999501658111345, delta = 0.009601978585124016, c = 3.3161401827794293e-06, d = 3.3506833096833814e-06, m = 4.6783303137818574e-05
[Iteration 1700] [Rank 1] a = 1.0174064636230469, b = 0.9995012435939251, delta = 0.009482289664447308, c = 2.4871051370845718e-06, d = 2.4871051370845718e-06, m = 4.6588260425000516e-05
[Iteration 1710] [Rank 1] a = 1.0486825704574585, b = 0.9995013126801616, delta = 0.008468317799270153, c = 2.6252776447003814e-06, d = 2.7289070254122384e-06, m = 4.660386672856589e-05

[Iteration 1670] [Rank 0] a = 1.0662403106689453, b = 0.9995000000416666, delta = 0.27712738513946533, c = 0.0, d = 0.0, m = 1.7546502762462556e-07
[Iteration 1680] [Rank 0] a = 0.9599891901016235, b = 0.9995000000416666, delta = 0.3286582827568054, c = 0.0, d = 0.0, m = 1.7442121425386634e-07
[Iteration 1690] [Rank 0] a = 0.9193811416625977, b = 0.9995000000416666, delta = 0.29882845282554626, c = 0.0, d = 0.0, m = 1.7338974639902385e-07
[Iteration 1700] [Rank 0] a = 0.9551033973693848, b = 0.9995000000416666, delta = 0.30331358313560486, c = 0.0, d = 0.0, m = 1.7239071386693316e-07
[Iteration 1710] [Rank 0] a = 1.00863516330719, b = 0.9995000000416666, delta = 0.29571884870529175, c = 0.0, d = 0.0, m = 1.7138317024409894e-07
[Iteration 1720] [Rank 0] a = 0.9345380663871765, b = 0.9995000000416666, delta = 0.3003406822681427, c = 0.0, d = 0.0, m = 1.7038733543733486e-07

[Iteration 1670] [Rank 3] a = 1.07912278175354, b = 0.9995000000416666, delta = 0.17599283158779144, c = 0.0, d = 0.0, m = 1.0631675743089599e-06
[Iteration 1680] [Rank 3] a = 0.9643896818161011, b = 0.9995000000416666, delta = 0.1710415482521057, c = 0.0, d = 0.0, m = 1.057295041916811e-06
[Iteration 1690] [Rank 3] a = 0.94572913646698, b = 0.9995000000416666, delta = 0.13998262584209442, c = 0.0, d = 0.0, m = 1.0726141380678494e-06
[Iteration 1700] [Rank 3] a = 1.0940496921539307, b = 0.9995000000416666, delta = 0.17625361680984497, c = 0.0, d = 0.0, m = 1.0663286599645134e-06
[Iteration 1710] [Rank 3] a = 1.0015169382095337, b = 0.9995000000416666, delta = 0.15194927155971527, c = 0.0, d = 0.0, m = 1.060136842111891e-06
[Iteration 1720] [Rank 3] a = 1.1282974481582642, b = 0.9995000000416666, delta = 0.14747467637062073, c = 0.0, d = 0.0, m = 1.0544986973579013e-06
[Iteration 1720] [Rank 1] a = 0.9089723825454712, b = 0.9995136100303562, delta = 0.008161324076354504, c = 2.721998400031448e-05, d = 2.7703587776969815e-05, m = 4.638475567946189e-05
[Iteration 1730] [Rank 1] a = 0.9800653457641602, b = 0.9995028843920462, delta = 0.008959144353866577, c = 5.768702192960048e-06, d = 5.803245319864001e-06, m = 4.6139679659683846e-05
[Iteration 1740] [Rank 1] a = 0.9805363416671753, b = 0.9995013817663982, delta = 0.009192651137709618, c = 2.763450152316191e-06, d = 2.7979932792201435e-06, m = 4.595253719931691e-05
[Iteration 1750] [Rank 1] a = 1.0273656845092773, b = 0.9995011226930111, delta = 0.008567830547690392, c = 2.245303248756905e-06, d = 2.245303248756905e-06, m = 4.645510030787676e-05
[Iteration 1760] [Rank 1] a = 1.0819175243377686, b = 0.9995003282012903, delta = 0.00874124001711607, c = 6.563194111750953e-07, d = 6.563194111750953e-07, m = 4.625067727667829e-05
[Iteration 1730] [Rank 0] a = 1.072891354560852, b = 0.9995000000416666, delta = 0.34323129057884216, c = 0.0, d = 0.0, m = 1.6942296211124046e-07
[Iteration 1740] [Rank 0] a = 1.064741611480713, b = 0.9995000000416666, delta = 0.34013909101486206, c = 0.0, d = 0.0, m = 1.684498262002052e-07
[Iteration 1750] [Rank 0] a = 1.1020829677581787, b = 0.9995000000416666, delta = 0.3277457058429718, c = 0.0, d = 0.0, m = 1.6748780549089506e-07
[Iteration 1760] [Rank 0] a = 1.194657802581787, b = 0.9995000000416666, delta = 0.3805391788482666, c = 0.0, d = 0.0, m = 1.6657594189004268e-07
[Iteration 1770] [Rank 0] a = 1.291253685951233, b = 0.9995000000416666, delta = 0.3475797772407532, c = 0.0, d = 0.0, m = 1.6573289062839354e-07
timer                          - epoch: 12.755, value:  0.106 (event:batch)
[Iteration 1780] [Rank 0] a = 1.0574743747711182, b = 0.9995000000416666, delta = 0.338453084230423, c = 0.0, d = 0.0, m = 1.6538419040426923e-07
[Iteration 1730] [Rank 3] a = 1.1070866584777832, b = 0.9995000000416666, delta = 0.16894350945949554, c = 0.0, d = 0.0, m = 1.0484268060542182e-06
[Iteration 1740] [Rank 3] a = 1.0781428813934326, b = 0.9995000000416666, delta = 0.1453876942396164, c = 0.0, d = 0.0, m = 1.0428413268648697e-06
[Iteration 1750] [Rank 3] a = 0.9726586937904358, b = 0.9995000000416666, delta = 0.1505274772644043, c = 0.0, d = 0.0, m = 1.0379509302824399e-06
[Iteration 1760] [Rank 3] a = 0.9386041164398193, b = 0.9995000345847849, delta = 0.16168078780174255, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 1.0320960619979334e-06
[Iteration 1770] [Rank 3] a = 0.9211306571960449, b = 0.9995002418434945, delta = 0.14772555232048035, c = 4.836037766553335e-07, d = 4.836037766553335e-07, m = 1.026658400743331e-06
[Iteration 1780] [Rank 3] a = 1.036836862564087, b = 0.9995000000416666, delta = 0.15689915418624878, c = 0.0, d = 0.0, m = 1.0217278956615998e-06
[Iteration 1770] [Rank 1] a = 0.9577890634536743, b = 0.999501986270969, delta = 0.0093089509755373, c = 3.972459593954525e-06, d = 3.972459593954525e-06, m = 4.602704893302861e-05
[Iteration 1780] [Rank 1] a = 0.9351916313171387, b = 0.9995093957698794, delta = 0.008828752674162388, c = 1.8791461035750097e-05, d = 1.8895090416461957e-05, m = 4.583777902915954e-05
[Iteration 1790] [Rank 1] a = 0.7883294820785522, b = 0.9995116238010311, delta = 0.008511006832122803, c = 2.3247524406359956e-05, d = 2.3662041929207385e-05, m = 4.566103770519307e-05
[Iteration 1800] [Rank 1] a = 0.9793466925621033, b = 0.9995002591150537, delta = 0.009883051738142967, c = 5.181469035592857e-07, d = 5.526900304632381e-07, m = 4.545443951223473e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1806 |     0.10580s |  92.9%
- batch.accumulate               |   1806 |     0.00083s |   0.7%
[Iteration 1790] [Rank 0] a = 1.2818922996520996, b = 0.9995000000416666, delta = 0.37608951330184937, c = 0.0, d = 0.0, m = 1.6446077225572502e-07
[Iteration 1800] [Rank 0] a = 0.9649262428283691, b = 0.9995000000416666, delta = 0.2976495027542114, c = 0.0, d = 0.0, m = 1.6354760861188422e-07
cross_entropy                  - bits:154278016.000, epoch: 13.000, ratio_transmit_grad:  0.002, value:  6.993 (split:train)
last_cross_entropy             - bits:154278016.000, epoch: 13.000, ratio_transmit_grad:  0.002, value:  6.993 (split:train)
perplexity                     - bits:154278016.000, epoch: 13.000, ratio_transmit_grad:  0.002, value:1092.031 (split:train)
last_perplexity                - bits:154278016.000, epoch: 13.000, ratio_transmit_grad:  0.002, value:1092.031 (split:train)
last_cross_entropy             - bits:154278016.000, epoch: 13.000, ratio_transmit_grad:  0.002, value:  6.730 (split:test)
[Iteration 1790] [Rank 3] a = 1.041744351387024, b = 0.9995000000416666, delta = 0.17488418519496918, c = 0.0, d = 0.0, m = 1.0160423926857697e-06
[Iteration 1800] [Rank 3] a = 0.9337178468704224, b = 0.9995000000416666, delta = 0.16642853617668152, c = 0.0, d = 0.0, m = 1.0106118265942015e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1806 |     0.10589s |  93.0%
- batch.accumulate               |   1806 |     0.00082s |   0.7%
- batch.backward                 |   1806 |     0.05164s |  45.4%
- batch.evaluate                 |   1806 |     0.00277s |   2.4%
- batch.forward                  |   1806 |     0.02541s |  22.3%
- batch.mom                      |   1806 |     0.00126s |   1.1%
- batch.reduce                   |   1806 |     0.02119s |  18.6%
- batch.reporting.compr_err      |   1806 |     0.00001s |   0.0%
- batch.reporting.lr             |   1806 |     0.00002s |   0.0%
- batch.backward                 |   1806 |     0.05166s |  45.4%
- batch.evaluate                 |   1806 |     0.00277s |   2.4%
- batch.forward                  |   1806 |     0.02544s |  22.4%
- batch.mom                      |   1806 |     0.00126s |   1.1%
- batch.reduce                   |   1806 |     0.02103s |  18.5%
- batch.reporting.compr_err      |   1806 |     0.00001s |   0.0%
- batch.reporting.lr             |   1806 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   1806 |     0.00001s |   0.0%
- batch.step                     |   1806 |     0.00048s |   0.4%
- batch.update_runavg            |   1806 |     0.00129s |   1.1%
- batch.wd                       |   1806 |     0.00001s |   0.0%
- epoch_metrics.collect          |     12 |     0.01188s |   0.1%
- reduce.combine                 |   1806 |     0.00525s |   4.6%
- reduce.flatpack                |   1806 |     0.00002s |   0.0%
- reduce.flatput                 |   1806 |     0.00016s |   0.1%
last_perplexity                - bits:154278016.000, epoch: 13.000, ratio_transmit_grad:  0.002, value:838.893 (split:test)
runavg_cross_entropy           - bits:154278016.000, epoch: 13.000, ratio_transmit_grad:  0.002, value:  6.770 (split:test)
runavg_perplexity              - bits:154278016.000, epoch: 13.000, ratio_transmit_grad:  0.002, value:872.984 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1806 |     0.10567s |  92.8%
- batch.accumulate               |   1806 |     0.00083s |   0.7%
- batch.backward                 |   1806 |     0.05171s |  45.4%
- batch.evaluate                 |   1806 |     0.00275s |   2.4%
- batch.forward                  |   1806 |     0.02551s |  22.4%
- batch.mom                      |   1806 |     0.00126s |   1.1%
- batch.reduce                   |   1806 |     0.02075s |  18.2%
- batch.reporting.memory_norm    |   1806 |     0.00001s |   0.0%
- batch.step                     |   1806 |     0.00047s |   0.4%
- batch.update_runavg            |   1806 |     0.00129s |   1.1%
- batch.wd                       |   1806 |     0.00001s |   0.0%
- epoch_metrics.collect          |     12 |     0.01169s |   0.1%
- reduce.combine                 |   1806 |     0.00522s |   4.6%
- reduce.flatpack                |   1806 |     0.00002s |   0.0%
- reduce.flatput                 |   1806 |     0.00010s |   0.1%
- reduce.gather.context          |   1806 |     0.00270s |   2.4%
- reduce.gather.tensors          |   1806 |     0.00031s |   0.3%
- reduce.heur_params             |   1806 |     0.01002s |   8.8%
- reduce.heur_params.alpha       |   1805 |     0.00808s |   7.1%
- reduce.heur_params.beta        |   1805 |     0.00187s |   1.6%
- reduce.memory                  |   1806 |     0.00041s |   0.4%
- reduce.pad                     |   1806 |     0.00027s |   0.2%
- reduce.gather.context          |   1806 |     0.00147s |   1.3%
- reduce.gather.tensors          |   1806 |     0.00043s |   0.4%
- reduce.heur_params             |   1806 |     0.01057s |   9.3%
- batch.reporting.compr_err      |   1806 |     0.00001s |   0.0%
- batch.reporting.lr             |   1806 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1806 |     0.00001s |   0.0%
- batch.step                     |   1806 |     0.00048s |   0.4%
- batch.update_runavg            |   1806 |     0.00130s |   1.1%
- reduce.threshold               |   1806 |     0.00194s |   1.7%
- test.last                      |     12 |     0.41463s |   2.8%
- test.runavg                    |     12 |     0.44686s |   3.1%
- reduce.heur_params.alpha       |   1805 |     0.00824s |   7.2%
- reduce.heur_params.beta        |   1805 |     0.00225s |   2.0%
- reduce.memory                  |   1806 |     0.00043s |   0.4%
- reduce.pad                     |   1806 |     0.00015s |   0.1%
- reduce.threshold               |   1806 |     0.00236s |   2.1%
- test.last                      |     12 |     0.41462s |   2.8%
- test.runavg                    |     12 |     0.44687s |   3.1%
-----------------------------------------------------------------

[Iteration 1810] [Rank 1] a = 0.9068012833595276, b = 0.9995096203001503, delta = 0.010687305592000484, c = 1.9240521685501478e-05, d = 1.9344151066213337e-05, m = 4.525281235447939e-05
[Iteration 1820] [Rank 1] a = 0.9492104053497314, b = 0.9995020553572057, delta = 0.009877127595245838, c = 4.110632101570334e-06, d = 4.110632101570334e-06, m = 4.511742110911063e-05
- batch.wd                       |   1806 |     0.00001s |   0.0%
- epoch_metrics.collect          |     12 |     0.00709s |   0.0%
- reduce.combine                 |   1806 |     0.00548s |   4.8%
- reduce.flatpack                |   1806 |     0.00002s |   0.0%
- reduce.flatput                 |   1806 |     0.00009s |   0.1%
- reduce.gather.context          |   1806 |     0.00143s |   1.3%
- reduce.gather.tensors          |   1806 |     0.00030s |   0.3%
- reduce.heur_params             |   1806 |     0.01063s |   9.3%
- reduce.heur_params.alpha       |   1805 |     0.00872s |   7.7%
- reduce.heur_params.beta        |   1805 |     0.00183s |   1.6%
- reduce.memory                  |   1806 |     0.00042s |   0.4%
- reduce.pad                     |   1806 |     0.00029s |   0.3%
- reduce.threshold               |   1806 |     0.00188s |   1.7%
- test.last                      |     12 |     0.41462s |   2.8%
- test.runavg                    |     12 |     0.44689s |   3.1%
-----------------------------------------------------------------

[Iteration 1810] [Rank 3] a = 0.9077346920967102, b = 0.9995000000416666, delta = 0.1575692594051361, c = 0.0, d = 0.0, m = 1.0103340082691636e-06
[Iteration 1820] [Rank 3] a = 1.1210802793502808, b = 0.9995000000416666, delta = 0.16434094309806824, c = 0.0, d = 0.0, m = 1.004861648260885e-06
[Iteration 1830] [Rank 3] a = 0.927807092666626, b = 0.9995000000416666, delta = 0.15106897056102753, c = 0.0, d = 0.0, m = 9.993735999361397e-07
[Iteration 1840] [Rank 3] a = 1.193569302558899, b = 0.9995000000416666, delta = 0.1706724613904953, c = 0.0, d = 0.0, m = 9.94320436730663e-07
[Iteration 1850] [Rank 3] a = 0.9185389876365662, b = 0.9995000000416666, delta = 0.1576932668685913, c = 0.0, d = 0.0, m = 9.889859590896588e-07
[Iteration 1860] [Rank 3] a = 1.2197542190551758, b = 0.9995000000416666, delta = 0.1762242466211319, c = 0.0, d = 0.0, m = 9.842470968344873e-07
[Iteration 1830] [Rank 1] a = 0.9457628726959229, b = 0.9995115201716749, delta = 0.009441624395549297, c = 2.304026564493624e-05, d = 2.3385696913975765e-05, m = 4.4914422487545854e-05
[Iteration 1840] [Rank 1] a = 0.9717105031013489, b = 0.9995051296947426, delta = 0.008800478652119637, c = 1.025930869047386e-05, d = 1.0604739959513383e-05, m = 4.480018400549178e-05
[Iteration 1850] [Rank 1] a = 1.072078824043274, b = 0.9995003282012903, delta = 0.009658373892307281, c = 6.563194111750953e-07, d = 6.563194111750953e-07, m = 4.459125783967475e-05
[Iteration 1860] [Rank 1] a = 0.9256891012191772, b = 0.9995004318306452, delta = 0.011038172990083694, c = 8.635781725988096e-07, d = 8.635781725988096e-07, m = 4.436826134326545e-05
[Iteration 1870] [Rank 1] a = 1.066599726676941, b = 0.9995001382141396, delta = 0.010592673905193806, c = 2.763450152316191e-07, d = 2.763450152316191e-07, m = 4.4201004861116215e-05
-----------------------------------------------------------------

[Iteration 1810] [Rank 0] a = 1.103583574295044, b = 0.9995000000416666, delta = 0.2891325354576111, c = 0.0, d = 0.0, m = 1.626826777271184e-07
[Iteration 1820] [Rank 0] a = 1.0331100225448608, b = 0.9995000000416666, delta = 0.331922709941864, c = 0.0, d = 0.0, m = 1.6178930772312544e-07
[Iteration 1830] [Rank 0] a = 0.9916907548904419, b = 0.9995000000416666, delta = 0.3444460332393646, c = 0.0, d = 0.0, m = 1.609056959933432e-07
[Iteration 1840] [Rank 0] a = 0.8659499287605286, b = 0.9995000000416666, delta = 0.32685568928718567, c = 0.0, d = 0.0, m = 1.6003168352189647e-07
[Iteration 1850] [Rank 0] a = 0.9233701229095459, b = 0.9995000000416666, delta = 0.34483957290649414, c = 0.0, d = 0.0, m = 1.5916711472923362e-07
[Iteration 1860] [Rank 0] a = 1.3590742349624634, b = 0.9995000000416666, delta = 0.3913958668708801, c = 0.0, d = 0.0, m = 1.5831183737980194e-07
[Iteration 1870] [Rank 3] a = 0.9876745939254761, b = 0.9995000173132257, delta = 0.1613965928554535, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 9.79245029922841e-07
[Iteration 1880] [Rank 3] a = 1.1450778245925903, b = 0.9995000000416666, delta = 0.16315802931785583, c = 0.0, d = 0.0, m = 9.805583524915147e-07
[Iteration 1890] [Rank 3] a = 1.2302048206329346, b = 0.9995000000416666, delta = 0.17940303683280945, c = 0.0, d = 0.0, m = 9.75372956656023e-07
[Iteration 1900] [Rank 3] a = 0.834455668926239, b = 0.9995000173132257, delta = 0.14219342172145844, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 9.70478338604046e-07
[Iteration 1910] [Rank 3] a = 1.0135070085525513, b = 0.9995000000416666, delta = 0.16912074387073517, c = 0.0, d = 0.0, m = 9.653999590195138e-07
[Iteration 1920] [Rank 3] a = 1.0314942598342896, b = 0.9995000000416666, delta = 0.1661522090435028, c = 0.0, d = 0.0, m = 9.60464360916611e-07
[Iteration 1880] [Rank 1] a = 0.9613493084907532, b = 0.9995016408397858, delta = 0.011122914031147957, c = 3.281597055875477e-06, d = 3.3161401827794293e-06, m = 4.407609335343474e-05
[Iteration 1890] [Rank 1] a = 1.0806964635849, b = 0.9995002245719353, delta = 0.011290338821709156, c = 4.49060649751381e-07, d = 4.49060649751381e-07, m = 4.390922815062802e-05
[Iteration 1900] [Rank 1] a = 0.9787611961364746, b = 0.9995009845205379, delta = 0.01096210815012455, c = 1.968958233525286e-06, d = 1.968958233525286e-06, m = 4.3706631665997663e-05
[Iteration 1910] [Rank 1] a = 0.9462480545043945, b = 0.9995012608654843, delta = 0.010806821286678314, c = 2.5216482639885243e-06, d = 2.5216482639885243e-06, m = 4.353137144077265e-05
[Iteration 1920] [Rank 1] a = 1.0506036281585693, b = 0.9995002591150537, delta = 0.011198988184332848, c = 5.181469035592857e-07, d = 5.181469035592857e-07, m = 4.3335800239642256e-05
[Iteration 1870] [Rank 0] a = 0.8751654028892517, b = 0.9995000000416666, delta = 0.3239469826221466, c = 0.0, d = 0.0, m = 1.574657024926838e-07
[Iteration 1880] [Rank 0] a = 0.9789638519287109, b = 0.9995000000416666, delta = 0.3197833001613617, c = 0.0, d = 0.0, m = 1.5662856425508315e-07
[Iteration 1890] [Rank 0] a = 1.0910104513168335, b = 0.9995000000416666, delta = 0.3371942937374115, c = 0.0, d = 0.0, m = 1.5580027993855707e-07
[Iteration 1900] [Rank 0] a = 1.016374111175537, b = 0.9995000000416666, delta = 0.34775909781455994, c = 0.0, d = 0.0, m = 1.550352229061143e-07
[Iteration 1910] [Rank 0] a = 1.1037211418151855, b = 0.9995000000416666, delta = 0.37721121311187744, c = 0.0, d = 0.0, m = 1.542239449212576e-07
[Iteration 1920] [Rank 0] a = 1.0922541618347168, b = 0.9995000000416666, delta = 0.32791227102279663, c = 0.0, d = 0.0, m = 1.5342111334956964e-07
[Iteration 1930] [Rank 3] a = 1.161007285118103, b = 0.9995000000416666, delta = 0.1793709248304367, c = 0.0, d = 0.0, m = 9.573866435901758e-07
[Iteration 1940] [Rank 3] a = 1.0369842052459717, b = 0.9995000000416666, delta = 0.1696702539920807, c = 0.0, d = 0.0, m = 9.524542033862078e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1945 |     0.10588s |  93.0%
- batch.accumulate               |   1945 |     0.00082s |   0.7%
- batch.backward                 |   1945 |     0.05164s |  45.4%
- batch.evaluate                 |   1945 |     0.00277s |   2.4%
- batch.forward                  |   1945 |     0.02540s |  22.3%
- batch.mom                      |   1945 |     0.00126s |   1.1%
- batch.reduce                   |   1945 |     0.02117s |  18.6%
- batch.reporting.compr_err      |   1945 |     0.00001s |   0.0%
- batch.reporting.lr             |   1945 |     0.00002s |   0.0%
[Iteration 1930] [Rank 1] a = 0.9993534684181213, b = 0.9995064941479221, delta = 0.010852435603737831, c = 1.2988215715886097e-05, d = 1.3471819492541431e-05, m = 4.3181055276873985e-05
[Iteration 1940] [Rank 1] a = 1.0391408205032349, b = 0.9995006045462366, delta = 0.011701438575983047, c = 1.2090094416383336e-06, d = 1.2090094416383336e-06, m = 4.298992693772362e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1945 |     0.10578s |  92.9%
- batch.accumulate               |   1945 |     0.00083s |   0.7%
- batch.backward                 |   1945 |     0.05166s |  45.4%
- batch.evaluate                 |   1945 |     0.00277s |   2.4%
- batch.forward                  |   1945 |     0.02543s |  22.3%
- batch.mom                      |   1945 |     0.00126s |   1.1%
- batch.reduce                   |   1945 |     0.02103s |  18.5%
[Iteration 1930] [Rank 0] a = 0.962323784828186, b = 0.9995000000416666, delta = 0.30934005975723267, c = 0.0, d = 0.0, m = 1.5264448569209075e-07
[Iteration 1940] [Rank 0] a = 0.9774934649467468, b = 0.9995000000416666, delta = 0.3368737995624542, c = 0.0, d = 0.0, m = 1.5219619849696153e-07
cross_entropy                  - bits:157144384.000, epoch: 14.000, ratio_transmit_grad:  0.001, value:  6.905 (split:train)
last_cross_entropy             - bits:157144384.000, epoch: 14.000, ratio_transmit_grad:  0.001, value:  6.905 (split:train)
perplexity                     - bits:157144384.000, epoch: 14.000, ratio_transmit_grad:  0.001, value:999.912 (split:train)
last_perplexity                - bits:157144384.000, epoch: 14.000, ratio_transmit_grad:  0.001, value:999.912 (split:train)
last_cross_entropy             - bits:157144384.000, epoch: 14.000, ratio_transmit_grad:  0.001, value:  6.653 (split:test)
- batch.reporting.memory_norm    |   1945 |     0.00001s |   0.0%
- batch.step                     |   1945 |     0.00047s |   0.4%
- batch.update_runavg            |   1945 |     0.00129s |   1.1%
- batch.wd                       |   1945 |     0.00001s |   0.0%
- epoch_metrics.collect          |     13 |     0.01092s |   0.1%
- reduce.combine                 |   1945 |     0.00523s |   4.6%
- reduce.flatpack                |   1945 |     0.00002s |   0.0%
- reduce.flatput                 |   1945 |     0.00010s |   0.1%
- reduce.gather.context          |   1945 |     0.00270s |   2.4%
- reduce.gather.tensors          |   1945 |     0.00030s |   0.3%
- reduce.heur_params             |   1945 |     0.01002s |   8.8%
- reduce.heur_params.alpha       |   1944 |     0.00808s |   7.1%
- reduce.heur_params.beta        |   1944 |     0.00187s |   1.6%
- reduce.memory                  |   1945 |     0.00041s |   0.4%
- reduce.pad                     |   1945 |     0.00027s |   0.2%
- batch.reporting.compr_err      |   1945 |     0.00001s |   0.0%
- batch.reporting.lr             |   1945 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   1945 |     0.00001s |   0.0%
- batch.step                     |   1945 |     0.00048s |   0.4%
- batch.update_runavg            |   1945 |     0.00129s |   1.1%
last_perplexity                - bits:157144384.000, epoch: 14.000, ratio_transmit_grad:  0.001, value:776.626 (split:test)
runavg_cross_entropy           - bits:157144384.000, epoch: 14.000, ratio_transmit_grad:  0.001, value:  6.707 (split:test)
- reduce.threshold               |   1945 |     0.00194s |   1.7%
- test.last                      |     13 |     0.41483s |   2.8%
- batch.wd                       |   1945 |     0.00001s |   0.0%
- epoch_metrics.collect          |     13 |     0.01110s |   0.1%
- reduce.combine                 |   1945 |     0.00526s |   4.6%
- reduce.flatpack                |   1945 |     0.00002s |   0.0%
- reduce.flatput                 |   1945 |     0.00017s |   0.1%
- reduce.gather.context          |   1945 |     0.00144s |   1.3%
- reduce.gather.tensors          |   1945 |     0.00043s |   0.4%
- reduce.heur_params             |   1945 |     0.01057s |   9.3%
- reduce.heur_params.alpha       |   1944 |     0.00824s |   7.2%
- reduce.heur_params.beta        |   1944 |     0.00226s |   2.0%
- reduce.memory                  |   1945 |     0.00043s |   0.4%
- reduce.pad                     |   1945 |     0.00015s |   0.1%
- reduce.threshold               |   1945 |     0.00237s |   2.1%
- test.last                      |     13 |     0.41483s |   2.8%
- test.runavg                    |     13 |     0.44706s |   3.0%
runavg_perplexity              - bits:157144384.000, epoch: 14.000, ratio_transmit_grad:  0.001, value:820.201 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1945 |     0.10565s |  92.8%
- batch.accumulate               |   1945 |     0.00083s |   0.7%
- batch.backward                 |   1945 |     0.05171s |  45.4%
- batch.evaluate                 |   1945 |     0.00275s |   2.4%
- batch.forward                  |   1945 |     0.02551s |  22.4%
- batch.mom                      |   1945 |     0.00126s |   1.1%
- batch.reduce                   |   1945 |     0.02073s |  18.2%
- batch.reporting.compr_err      |   1945 |     0.00001s |   0.0%
- batch.reporting.lr             |   1945 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1945 |     0.00001s |   0.0%
- batch.step                     |   1945 |     0.00048s |   0.4%
- test.runavg                    |     13 |     0.44706s |   3.0%
-----------------------------------------------------------------
-----------------------------------------------------------------
- batch.update_runavg            |   1945 |     0.00130s |   1.1%
- batch.wd                       |   1945 |     0.00001s |   0.0%
- epoch_metrics.collect          |     13 |     0.00660s |   0.0%
- reduce.combine                 |   1945 |     0.00548s |   4.8%
- reduce.flatpack                |   1945 |     0.00002s |   0.0%
- reduce.flatput                 |   1945 |     0.00009s |   0.1%
- reduce.gather.context          |   1945 |     0.00142s |   1.2%
- reduce.gather.tensors          |   1945 |     0.00029s |   0.3%
- reduce.heur_params             |   1945 |     0.01063s |   9.3%
- reduce.heur_params.alpha       |   1944 |     0.00872s |   7.7%
- reduce.heur_params.beta        |   1944 |     0.00183s |   1.6%
- reduce.memory                  |   1945 |     0.00042s |   0.4%
- reduce.pad                     |   1945 |     0.00029s |   0.3%
- reduce.threshold               |   1945 |     0.00188s |   1.6%
- test.last                      |     13 |     0.41483s |   2.8%
- test.runavg                    |     13 |     0.44709s |   3.0%
-----------------------------------------------------------------
[Iteration 1680] [Rank 2] a = 0.9904003143310547, b = 0.9995000000416666, delta = 0.21929310262203217, c = 0.0, d = 0.0, m = 6.079261548640846e-07
[Iteration 1690] [Rank 2] a = 1.0607733726501465, b = 0.9995000000416666, delta = 0.21200290322303772, c = 0.0, d = 0.0, m = 6.044127964719941e-07
[Iteration 1700] [Rank 2] a = 0.8310919404029846, b = 0.9995000000416666, delta = 0.20236140489578247, c = 0.0, d = 0.0, m = 6.009610549492426e-07
[Iteration 1710] [Rank 2] a = 1.1957839727401733, b = 0.9995000000416666, delta = 0.2479628622531891, c = 0.0, d = 0.0, m = 6.012038434089988e-07
[Iteration 1720] [Rank 2] a = 1.0759048461914062, b = 0.9995000000416666, delta = 0.2526404857635498, c = 0.0, d = 0.0, m = 5.977105032381156e-07
[Iteration 1730] [Rank 2] a = 1.0046570301055908, b = 0.9995000000416666, delta = 0.20444367825984955, c = 0.0, d = 0.0, m = 5.946167257984217e-07
[Iteration 1740] [Rank 2] a = 0.8521280884742737, b = 0.9995000000416666, delta = 0.20316120982170105, c = 0.0, d = 0.0, m = 5.912013511528248e-07
[Iteration 1750] [Rank 2] a = 1.1701991558074951, b = 0.9995000000416666, delta = 0.2527869939804077, c = 0.0, d = 0.0, m = 5.878249870685711e-07
[Iteration 1760] [Rank 2] a = 1.1748406887054443, b = 0.9995000000416666, delta = 0.24869219958782196, c = 0.0, d = 0.0, m = 5.845850471275342e-07
[Iteration 1770] [Rank 2] a = 0.9169088006019592, b = 0.9995000000416666, delta = 0.21534983813762665, c = 0.0, d = 0.0, m = 5.812841716496824e-07
[Iteration 1780] [Rank 2] a = 1.2228494882583618, b = 0.9995000000416666, delta = 0.27439093589782715, c = 0.0, d = 0.0, m = 5.782531080934504e-07
[Iteration 1790] [Rank 2] a = 0.9946825504302979, b = 0.9995000000416666, delta = 0.22903510928153992, c = 0.0, d = 0.0, m = 5.750244475234143e-07
[Iteration 1800] [Rank 2] a = 0.9309154152870178, b = 0.9995000000416666, delta = 0.2290063500404358, c = 0.0, d = 0.0, m = 5.718316410407747e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1806 |     0.10567s |  92.8%
- batch.accumulate               |   1806 |     0.00083s |   0.7%
- batch.backward                 |   1806 |     0.05207s |  45.8%
- batch.evaluate                 |   1806 |     0.00275s |   2.4%
- batch.forward                  |   1806 |     0.02576s |  22.6%
- batch.mom                      |   1806 |     0.00126s |   1.1%
- batch.reduce                   |   1806 |     0.02015s |  17.7%
- batch.reporting.compr_err      |   1806 |     0.00001s |   0.0%
- batch.reporting.lr             |   1806 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1806 |     0.00001s |   0.0%
- batch.step                     |   1806 |     0.00048s |   0.4%
- batch.update_runavg            |   1806 |     0.00130s |   1.1%
- batch.wd                       |   1806 |     0.00001s |   0.0%
- epoch_metrics.collect          |     12 |     0.01737s |   0.1%
- reduce.combine                 |   1806 |     0.00547s |   4.8%
- reduce.flatpack                |   1806 |     0.00002s |   0.0%
- reduce.flatput                 |   1806 |     0.00010s |   0.1%
- reduce.gather.context          |   1806 |     0.00110s |   1.0%
- reduce.gather.tensors          |   1806 |     0.00030s |   0.3%
- reduce.heur_params             |   1806 |     0.01032s |   9.1%
- reduce.heur_params.alpha       |   1805 |     0.00838s |   7.4%
- reduce.heur_params.beta        |   1805 |     0.00187s |   1.6%
- reduce.memory                  |   1806 |     0.00042s |   0.4%
- reduce.pad                     |   1806 |     0.00028s |   0.3%
- reduce.threshold               |   1806 |     0.00193s |   1.7%
- test.last                      |     12 |     0.41464s |   2.8%
- test.runavg                    |     12 |     0.44686s |   3.1%
-----------------------------------------------------------------

[Iteration 1810] [Rank 2] a = 0.8944420218467712, b = 0.9995000000416666, delta = 0.1965663880109787, c = 0.0, d = 0.0, m = 5.691127981409311e-07
[Iteration 1820] [Rank 2] a = 0.9498057961463928, b = 0.9995000000416666, delta = 0.2211841344833374, c = 0.0, d = 0.0, m = 5.65987521929284e-07
[Iteration 1830] [Rank 2] a = 1.0743083953857422, b = 0.9995000000416666, delta = 0.2532038986682892, c = 0.0, d = 0.0, m = 5.630661745359703e-07
[Iteration 1840] [Rank 2] a = 0.8752777576446533, b = 0.9995000345847849, delta = 0.20602475106716156, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 5.601953269116791e-07
[Iteration 1850] [Rank 2] a = 0.800423800945282, b = 0.9995002245719353, delta = 0.20277844369411469, c = 4.49060649751381e-07, d = 4.49060649751381e-07, m = 5.57467469948603e-07
[Iteration 1860] [Rank 2] a = 1.009757399559021, b = 0.9995000000416666, delta = 0.21550965309143066, c = 0.0, d = 0.0, m = 5.548988601792881e-07
[Iteration 1870] [Rank 2] a = 1.1244179010391235, b = 0.9995000000416666, delta = 0.23890313506126404, c = 0.0, d = 0.0, m = 5.519330725781162e-07
[Iteration 1880] [Rank 2] a = 1.1115074157714844, b = 0.9995000000416666, delta = 0.2493089884519577, c = 0.0, d = 0.0, m = 5.489988191353829e-07
[Iteration 1890] [Rank 2] a = 1.0992541313171387, b = 0.9995000000416666, delta = 0.23639743030071259, c = 0.0, d = 0.0, m = 5.461321338167441e-07
[Iteration 1900] [Rank 2] a = 0.8985137939453125, b = 0.9995000000416666, delta = 0.2242547571659088, c = 0.0, d = 0.0, m = 5.433319503182952e-07
[Iteration 1910] [Rank 2] a = 0.985528826713562, b = 0.9995000000416666, delta = 0.23832306265830994, c = 0.0, d = 0.0, m = 5.405972246554174e-07
[Iteration 1920] [Rank 2] a = 1.2497717142105103, b = 0.9995000000416666, delta = 0.2676343619823456, c = 0.0, d = 0.0, m = 5.396891555274969e-07
[Iteration 1930] [Rank 2] a = 1.0459052324295044, b = 0.9995000000416666, delta = 0.2277534157037735, c = 0.0, d = 0.0, m = 5.368942867780019e-07
[Iteration 1940] [Rank 2] a = 0.8979315757751465, b = 0.9995000000416666, delta = 0.24605505168437958, c = 0.0, d = 0.0, m = 5.341282162639473e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   1945 |     0.10565s |  92.8%
- batch.accumulate               |   1945 |     0.00083s |   0.7%
- batch.backward                 |   1945 |     0.05208s |  45.7%
- batch.evaluate                 |   1945 |     0.00275s |   2.4%
- batch.forward                  |   1945 |     0.02576s |  22.6%
- batch.mom                      |   1945 |     0.00126s |   1.1%
- batch.reduce                   |   1945 |     0.02013s |  17.7%
- batch.reporting.compr_err      |   1945 |     0.00001s |   0.0%
- batch.reporting.lr             |   1945 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   1945 |     0.00001s |   0.0%
- batch.step                     |   1945 |     0.00048s |   0.4%
- batch.update_runavg            |   1945 |     0.00130s |   1.1%
- batch.wd                       |   1945 |     0.00001s |   0.0%
- epoch_metrics.collect          |     13 |     0.01627s |   0.1%
- reduce.combine                 |   1945 |     0.00547s |   4.8%
- reduce.flatpack                |   1945 |     0.00002s |   0.0%
- reduce.flatput                 |   1945 |     0.00010s |   0.1%
- reduce.gather.context          |   1945 |     0.00110s |   1.0%
- reduce.gather.tensors          |   1945 |     0.00029s |   0.3%
- reduce.heur_params             |   1945 |     0.01031s |   9.1%
- reduce.heur_params.alpha       |   1944 |     0.00837s |   7.4%
- reduce.heur_params.beta        |   1944 |     0.00186s |   1.6%
- reduce.memory                  |   1945 |     0.00042s |   0.4%
- reduce.pad                     |   1945 |     0.00029s |   0.3%
- reduce.threshold               |   1945 |     0.00192s |   1.7%
- test.last                      |     13 |     0.41484s |   2.8%
- test.runavg                    |     13 |     0.44706s |   3.0%
-----------------------------------------------------------------

[Iteration 1950] [Rank 2] a = 1.2690385580062866, b = 0.9995000000416666, delta = 0.22711201012134552, c = 0.0, d = 0.0, m = 5.345243471195906e-07
[Iteration 1960] [Rank 2] a = 1.0240631103515625, b = 0.9995000000416666, delta = 0.24650061130523682, c = 0.0, d = 0.0, m = 5.317985727844576e-07

[Iteration 1950] [Rank 0] a = 0.757270336151123, b = 0.9995000345847849, delta = 0.27500224113464355, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 1.514515159079499e-07
[Iteration 1960] [Rank 0] a = 0.9660804867744446, b = 0.9995000000416666, delta = 0.36935436725616455, c = 0.0, d = 0.0, m = 1.5067919813177474e-07
[Iteration 1970] [Rank 0] a = 0.9042443037033081, b = 0.9995000000416666, delta = 0.33224961161613464, c = 0.0, d = 0.0, m = 1.499147171671285e-07
[Iteration 1980] [Rank 0] a = 1.0194239616394043, b = 0.9995000000416666, delta = 0.3724227845668793, c = 0.0, d = 0.0, m = 1.4915795433438178e-07
timer                          - epoch: 14.288, value:  0.106 (event:batch)
[Iteration 1990] [Rank 0] a = 0.9493978023529053, b = 0.9995000000416666, delta = 0.32095596194267273, c = 0.0, d = 0.0, m = 1.4842614297504482e-07
[Iteration 2000] [Rank 0] a = 1.2654383182525635, b = 0.9995000000416666, delta = 0.41955405473709106, c = 0.0, d = 0.0, m = 1.4768438314008707e-07
[Iteration 2010] [Rank 0] a = 0.7236409187316895, b = 0.9995000000416666, delta = 0.29883402585983276, c = 0.0, d = 0.0, m = 1.4708741704552254e-07
timer                          - epoch: -1.000, value:  0.000 (event:reduce.pad)
[Iteration 2020] [Rank 0] a = 0.9456318616867065, b = 0.9995000000416666, delta = 0.34883663058280945, c = 0.0, d = 0.0, m = 1.4635962181026515e-07
[Iteration 2030] [Rank 0] a = 1.3043792247772217, b = 0.9995000000416666, delta = 0.4060961604118347, c = 0.0, d = 0.0, m = 1.4563899344093838e-07
[Iteration 2040] [Rank 0] a = 1.1356786489486694, b = 0.9995000000416666, delta = 0.3949929475784302, c = 0.0, d = 0.0, m = 1.44925426594094e-07
[Iteration 2050] [Rank 0] a = 0.8294007182121277, b = 0.9995000000416666, delta = 0.3398177921772003, c = 0.0, d = 0.0, m = 1.4423566007091654e-07
[Iteration 2060] [Rank 0] a = 0.9023154973983765, b = 0.9995000000416666, delta = 0.35517022013664246, c = 0.0, d = 0.0, m = 1.4390455487498145e-07
[Iteration 2070] [Rank 0] a = 0.9439986944198608, b = 0.9995000000416666, delta = 0.3355562090873718, c = 0.0, d = 0.0, m = 1.4320969946756964e-07
[Iteration 2080] [Rank 0] a = 0.908176064491272, b = 0.9995000000416666, delta = 0.32555511593818665, c = 0.0, d = 0.0, m = 1.4252152215153136e-07
cross_entropy                  - bits:162878400.000, epoch: 15.000, ratio_transmit_grad:  0.002, value:  6.850 (split:train)
last_cross_entropy             - bits:162878400.000, epoch: 15.000, ratio_transmit_grad:  0.002, value:  6.850 (split:train)
perplexity                     - bits:162878400.000, epoch: 15.000, ratio_transmit_grad:  0.002, value:946.633 (split:train)
last_perplexity                - bits:162878400.000, epoch: 15.000, ratio_transmit_grad:  0.002, value:946.633 (split:train)
last_cross_entropy             - bits:162878400.000, epoch: 15.000, ratio_transmit_grad:  0.002, value:  6.536 (split:test)
last_perplexity                - bits:162878400.000, epoch: 15.000, ratio_transmit_grad:  0.002, value:691.474 (split:test)
runavg_cross_entropy           - bits:162878400.000, epoch: 15.000, ratio_transmit_grad:  0.002, value:  6.610 (split:test)
runavg_perplexity              - bits:162878400.000, epoch: 15.000, ratio_transmit_grad:  0.002, value:744.347 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2084 |     0.10564s |  92.8%
- batch.accumulate               |   2084 |     0.00083s |   0.7%
- batch.backward                 |   2084 |     0.05171s |  45.4%
- batch.evaluate                 |   2084 |     0.00275s |   2.4%
- batch.forward                  |   2084 |     0.02551s |  22.4%
- batch.mom                      |   2084 |     0.00126s |   1.1%
- batch.reduce                   |   2084 |     0.02072s |  18.2%

[Iteration 1950] [Rank 1] a = 0.9712178111076355, b = 0.9995174097734236, delta = 0.012382746674120426, c = 3.481947191918401e-05, d = 3.513036006131958e-05, m = 4.280516651522218e-05
[Iteration 1960] [Rank 1] a = 1.0448057651519775, b = 0.9995003282012903, delta = 0.012693962082266808, c = 6.563194111750953e-07, d = 6.908625380790477e-07, m = 4.264880110263431e-05
[Iteration 1970] [Rank 1] a = 0.8858738541603088, b = 0.9995384292614594, delta = 0.010671273805201054, c = 7.685845736129406e-05, d = 7.858561370649168e-05, m = 4.259128990748362e-05
[Iteration 1980] [Rank 1] a = 1.093936800956726, b = 0.9995001036710213, delta = 0.01130808424204588, c = 2.0725876142371433e-07, d = 2.0725876142371433e-07, m = 4.245289266236207e-05
[Iteration 1990] [Rank 1] a = 1.0087177753448486, b = 0.9995029707498422, delta = 0.013050736859440804, c = 5.94141782747981e-06, d = 5.94141782747981e-06, m = 4.239919860171828e-05
- batch.reporting.compr_err      |   2084 |     0.00001s |   0.0%
- batch.reporting.lr             |   2084 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2084 |     0.00001s |   0.0%

[Iteration 1950] [Rank 3] a = 0.9387933015823364, b = 0.9995000000416666, delta = 0.1555674970149994, c = 0.0, d = 0.0, m = 9.492720394440845e-07
[Iteration 1960] [Rank 3] a = 1.1046552658081055, b = 0.9995000000416666, delta = 0.17136122286319733, c = 0.0, d = 0.0, m = 9.445017447542196e-07
[Iteration 1970] [Rank 3] a = 1.1734650135040283, b = 0.9995000000416666, delta = 0.18166583776474, c = 0.0, d = 0.0, m = 9.400777915413534e-07
[Iteration 1980] [Rank 3] a = 1.0249046087265015, b = 0.9995000000416666, delta = 0.18365643918514252, c = 0.0, d = 0.0, m = 9.353323206097969e-07
[Iteration 1990] [Rank 3] a = 1.0798569917678833, b = 0.9995000000416666, delta = 0.17413437366485596, c = 0.0, d = 0.0, m = 9.332716636953332e-07
[Iteration 2000] [Rank 3] a = 0.9338405728340149, b = 0.9995000000416666, delta = 0.16916406154632568, c = 0.0, d = 0.0, m = 9.312833918478365e-07
[Iteration 2000] [Rank 1] a = 1.0048197507858276, b = 0.9995019171847324, delta = 0.011744196526706219, c = 3.834287086338715e-06, d = 4.007002720858477e-06, m = 4.225573881612612e-05
[Iteration 2010] [Rank 1] a = 0.9837733507156372, b = 0.9995013299517208, delta = 0.01052001304924488, c = 2.659820771604334e-06, d = 2.659820771604334e-06, m = 4.233905201788593e-05
[Iteration 2020] [Rank 1] a = 1.0874067544937134, b = 0.9995001554856989, delta = 0.011135353706777096, c = 3.1088814213557147e-07, d = 3.1088814213557147e-07, m = 4.2217820047155174e-05
[Iteration 2030] [Rank 1] a = 1.0256731510162354, b = 0.9995006218177959, delta = 0.010089024901390076, c = 1.2435525685422859e-06, d = 1.2435525685422859e-06, m = 4.20924073828316e-05
[Iteration 2040] [Rank 1] a = 1.0277963876724243, b = 0.999500656360914, delta = 0.00994377862662077, c = 1.3126388223501907e-06, d = 1.347181949254143e-06, m = 4.213532031635671e-05
- batch.step                     |   2084 |     0.00048s |   0.4%
- batch.update_runavg            |   2084 |     0.00130s |   1.1%
- batch.wd                       |   2084 |     0.00001s |   0.0%
- epoch_metrics.collect          |     14 |     0.00618s |   0.0%
- reduce.combine                 |   2084 |     0.00549s |   4.8%
- reduce.flatpack                |   2084 |     0.00002s |   0.0%
- reduce.flatput                 |   2084 |     0.00009s |   0.1%
- reduce.gather.context          |   2084 |     0.00141s |   1.2%
- reduce.gather.tensors          |   2084 |     0.00029s |   0.3%
- reduce.heur_params             |   2084 |     0.01063s |   9.3%
- reduce.heur_params.alpha       |   2083 |     0.00872s |   7.7%
- reduce.heur_params.beta        |   2083 |     0.00182s |   1.6%
- reduce.memory                  |   2084 |     0.00042s |   0.4%
- reduce.pad                     |   2084 |     0.00029s |   0.3%
- reduce.threshold               |   2084 |     0.00187s |   1.6%
[Iteration 2010] [Rank 3] a = 0.8714525699615479, b = 0.9995000000416666, delta = 0.17767055332660675, c = 0.0, d = 0.0, m = 9.2792354971577e-07
[Iteration 2020] [Rank 3] a = 1.049972414970398, b = 0.9995000000416666, delta = 0.18547287583351135, c = 0.0, d = 0.0, m = 9.233834180401411e-07
[Iteration 2030] [Rank 3] a = 0.9978559613227844, b = 0.9995000000416666, delta = 0.1676095873117447, c = 0.0, d = 0.0, m = 9.188709867616608e-07
[Iteration 2040] [Rank 3] a = 1.1135483980178833, b = 0.9995000000416666, delta = 0.17568561434745789, c = 0.0, d = 0.0, m = 9.146735670735934e-07
[Iteration 2050] [Rank 3] a = 0.9319846034049988, b = 0.9995000173132257, delta = 0.16570255160331726, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 9.105507620357305e-07
[Iteration 2060] [Rank 3] a = 0.9291952252388, b = 0.9995001209425806, delta = 0.15625202655792236, c = 2.4180188832766673e-07, d = 2.4180188832766673e-07, m = 9.065685270425939e-07
[Iteration 2050] [Rank 1] a = 1.0158565044403076, b = 0.9995002763866128, delta = 0.010605907067656517, c = 5.526900304632381e-07, d = 5.526900304632381e-07, m = 4.19798023373122e-05
[Iteration 2060] [Rank 1] a = 0.9860872030258179, b = 0.9995097757441841, delta = 0.010408123955130577, c = 1.955140982763705e-05, d = 1.9896841096676574e-05, m = 4.1832296533337885e-05
[Iteration 2070] [Rank 1] a = 0.9722640514373779, b = 0.9995105529643529, delta = 0.010404619388282299, c = 2.1105850538314907e-05, d = 2.16930836956821e-05, m = 4.172879783658968e-05
[Iteration 2080] [Rank 1] a = 0.9571995139122009, b = 0.999501209050807, delta = 0.010808734223246574, c = 2.418018883276667e-06, d = 2.4525620101806193e-06, m = 4.157403926979884e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2084 |     0.10577s |  92.9%
- batch.accumulate               |   2084 |     0.00083s |   0.7%
- test.last                      |     14 |     0.41434s |   2.8%
- test.runavg                    |     14 |     0.44690s |   3.0%
-----------------------------------------------------------------

[Iteration 2090] [Rank 0] a = 0.9189210534095764, b = 0.9995000000416666, delta = 0.3224673271179199, c = 0.0, d = 0.0, m = 1.4187296693024612e-07
timer                          - epoch: 15.043, value:  0.000 (event:batch.reporting.lr)
[Iteration 2100] [Rank 0] a = 1.0814558267593384, b = 0.9995000000416666, delta = 0.42717963457107544, c = 0.0, d = 0.0, m = 1.4119770292772233e-07
[Iteration 2110] [Rank 0] a = 1.1214419603347778, b = 0.9995000000416666, delta = 0.37156131863594055, c = 0.0, d = 0.0, m = 1.4052883649983164e-07
[Iteration 2120] [Rank 0] a = 1.1792749166488647, b = 0.9995000000416666, delta = 0.39576196670532227, c = 0.0, d = 0.0, m = 1.3986627715754108e-07
[Iteration 2070] [Rank 3] a = 0.9756996631622314, b = 0.9995000000416666, delta = 0.17004089057445526, c = 0.0, d = 0.0, m = 9.043760907094175e-07
[Iteration 2080] [Rank 3] a = 0.973831295967102, b = 0.9995000173132257, delta = 0.15784403681755066, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 9.001630124336547e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2084 |     0.10586s |  92.9%
- batch.accumulate               |   2084 |     0.00082s |   0.7%
- batch.backward                 |   2084 |     0.05165s |  45.4%
- batch.evaluate                 |   2084 |     0.00277s |   2.4%
- batch.forward                  |   2084 |     0.02540s |  22.3%
- batch.mom                      |   2084 |     0.00126s |   1.1%
- batch.reduce                   |   2084 |     0.02115s |  18.6%
- batch.reporting.compr_err      |   2084 |     0.00001s |   0.0%
- batch.backward                 |   2084 |     0.05167s |  45.4%
- batch.evaluate                 |   2084 |     0.00277s |   2.4%
- batch.forward                  |   2084 |     0.02542s |  22.3%
- batch.mom                      |   2084 |     0.00126s |   1.1%
- batch.reduce                   |   2084 |     0.02101s |  18.5%
- batch.reporting.compr_err      |   2084 |     0.00001s |   0.0%
- batch.reporting.lr             |   2084 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   2084 |     0.00001s |   0.0%
- batch.step                     |   2084 |     0.00048s |   0.4%
- batch.update_runavg            |   2084 |     0.00129s |   1.1%
- batch.wd                       |   2084 |     0.00001s |   0.0%
- epoch_metrics.collect          |     14 |     0.01044s |   0.1%
- reduce.combine                 |   2084 |     0.00526s |   4.6%
- reduce.flatpack                |   2084 |     0.00002s |   0.0%
- reduce.flatput                 |   2084 |     0.00017s |   0.1%
[Iteration 2130] [Rank 0] a = 0.8976885676383972, b = 0.9995000000416666, delta = 0.3658434748649597, c = 0.0, d = 0.0, m = 1.392099361103447e-07
[Iteration 2140] [Rank 0] a = 1.1154783964157104, b = 0.9995000000416666, delta = 0.367819219827652, c = 0.0, d = 0.0, m = 1.386403967705111e-07
[Iteration 2150] [Rank 0] a = 1.237108588218689, b = 0.9995000000416666, delta = 0.4057669937610626, c = 0.0, d = 0.0, m = 1.382367440210244e-07
[Iteration 2160] [Rank 0] a = 0.8382571339607239, b = 0.9995000000416666, delta = 0.3654269576072693, c = 0.0, d = 0.0, m = 1.3759705524721125e-07
[Iteration 2170] [Rank 0] a = 0.9315822720527649, b = 0.9995000000416666, delta = 0.3403712213039398, c = 0.0, d = 0.0, m = 1.369632595067819e-07
[Iteration 2180] [Rank 0] a = 1.04964280128479, b = 0.9995000000416666, delta = 0.3908251225948334, c = 0.0, d = 0.0, m = 1.363511139459548e-07
[Iteration 2190] [Rank 0] a = 0.8700299859046936, b = 0.9995000000416666, delta = 0.3352797031402588, c = 0.0, d = 0.0, m = 1.3574455620403076e-07
- batch.reporting.lr             |   2084 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2084 |     0.00001s |   0.0%
- batch.step                     |   2084 |     0.00047s |   0.4%
- batch.update_runavg            |   2084 |     0.00129s |   1.1%
- batch.wd                       |   2084 |     0.00001s |   0.0%
- epoch_metrics.collect          |     14 |     0.01020s |   0.1%
- reduce.combine                 |   2084 |     0.00523s |   4.6%
- reduce.flatpack                |   2084 |     0.00002s |   0.0%
- reduce.flatput                 |   2084 |     0.00010s |   0.1%
- reduce.gather.context          |   2084 |     0.00269s |   2.4%
- reduce.gather.tensors          |   2084 |     0.00030s |   0.3%
- reduce.heur_params             |   2084 |     0.01001s |   8.8%
- reduce.heur_params.alpha       |   2083 |     0.00807s |   7.1%
- reduce.heur_params.beta        |   2083 |     0.00186s |   1.6%
- reduce.memory                  |   2084 |     0.00041s |   0.4%
- reduce.gather.context          |   2084 |     0.00141s |   1.2%
- reduce.gather.tensors          |   2084 |     0.00042s |   0.4%
- reduce.heur_params             |   2084 |     0.01058s |   9.3%
- reduce.heur_params.alpha       |   2083 |     0.00823s |   7.2%
[Iteration 2200] [Rank 0] a = 1.0690876245498657, b = 0.9995000000416666, delta = 0.41709402203559875, c = 0.0, d = 0.0, m = 1.3512781583054583e-07
[Iteration 2210] [Rank 0] a = 0.9379733800888062, b = 0.9995000000416666, delta = 0.3678715229034424, c = 0.0, d = 0.0, m = 1.3456352420793455e-07
[Iteration 2220] [Rank 0] a = 1.0393491983413696, b = 0.9995000000416666, delta = 0.39547696709632874, c = 0.0, d = 0.0, m = 1.33988761043472e-07
cross_entropy                  - bits:171001984.000, epoch: 16.000, ratio_transmit_grad:  0.003, value:  6.797 (split:train)
last_cross_entropy             - bits:171001984.000, epoch: 16.000, ratio_transmit_grad:  0.003, value:  6.797 (split:train)
perplexity                     - bits:171001984.000, epoch: 16.000, ratio_transmit_grad:  0.003, value:898.500 (split:train)
last_perplexity                - bits:171001984.000, epoch: 16.000, ratio_transmit_grad:  0.003, value:898.500 (split:train)
- reduce.pad                     |   2084 |     0.00027s |   0.2%
- reduce.threshold               |   2084 |     0.00193s |   1.7%
- test.last                      |     14 |     0.41434s |   2.8%
- test.runavg                    |     14 |     0.44687s |   3.0%
- reduce.heur_params.beta        |   2083 |     0.00227s |   2.0%
- reduce.memory                  |   2084 |     0.00043s |   0.4%
- reduce.pad                     |   2084 |     0.00014s |   0.1%
- reduce.threshold               |   2084 |     0.00238s |   2.1%
- test.last                      |     14 |     0.41434s |   2.8%
- test.runavg                    |     14 |     0.44688s |   3.0%
-----------------------------------------------------------------

[Iteration 2090] [Rank 1] a = 0.9468355774879456, b = 0.9995023489737115, delta = 0.009947879239916801, c = 4.697865258937524e-06, d = 4.8014946396493814e-06, m = 4.160930264403654e-05
[Iteration 2100] [Rank 1] a = 1.0374480485916138, b = 0.999501105421452, delta = 0.01078413613140583, c = 2.2107601218529526e-06, d = 2.2107601218529526e-06, m = 4.146679605490812e-05
[Iteration 2110] [Rank 1] a = 1.027292251586914, b = 0.9995009499774195, delta = 0.012324342504143715, c = 1.8998719797173813e-06, d = 1.934415106621334e-06, m = 4.1294074610253815e-05
last_cross_entropy             - bits:171001984.000, epoch: 16.000, ratio_transmit_grad:  0.003, value:  6.496 (split:test)
last_perplexity                - bits:171001984.000, epoch: 16.000, ratio_transmit_grad:  0.003, value:664.411 (split:test)
-----------------------------------------------------------------

[Iteration 2090] [Rank 3] a = 0.8350278735160828, b = 0.9995000863994624, delta = 0.16054598987102509, c = 1.7271563451976193e-07, d = 1.7271563451976193e-07, m = 8.963701892914672e-07
[Iteration 2100] [Rank 3] a = 1.0085798501968384, b = 0.9995000000416666, delta = 0.1792297661304474, c = 0.0, d = 0.0, m = 8.921695565521531e-07
[Iteration 2110] [Rank 3] a = 1.1057100296020508, b = 0.9995000000416666, delta = 0.18406248092651367, c = 0.0, d = 0.0, m = 8.893668831628222e-07
[Iteration 2120] [Rank 3] a = 0.8859952688217163, b = 0.9995000000416666, delta = 0.17279009521007538, c = 0.0, d = 0.0, m = 8.85336596711814e-07
[Iteration 2130] [Rank 3] a = 1.1652770042419434, b = 0.9995000000416666, delta = 0.19199952483177185, c = 0.0, d = 0.0, m = 8.818304301745263e-07
[Iteration 2140] [Rank 3] a = 0.8592170476913452, b = 0.9995000000416666, delta = 0.1553049385547638, c = 0.0, d = 0.0, m = 8.810514124105714e-07
[Iteration 2120] [Rank 1] a = 1.0162312984466553, b = 0.999501001792097, delta = 0.010751877911388874, c = 2.0035013604292384e-06, d = 2.072587614237143e-06, m = 4.122597606207932e-05
[Iteration 2130] [Rank 1] a = 0.9919617176055908, b = 0.9995215376761355, delta = 0.010042975656688213, c = 4.307527924922862e-05, d = 4.442246119848277e-05, m = 4.1102041623163446e-05
[Iteration 2140] [Rank 1] a = 0.9721816778182983, b = 0.9995035234397361, delta = 0.010930466465651989, c = 7.046797888406287e-06, d = 7.115884142214192e-06, m = 4.1069406174808376e-05
[Iteration 2150] [Rank 1] a = 1.0257307291030884, b = 0.9995009845205379, delta = 0.01275181770324707, c = 1.968958233525286e-06, d = 1.968958233525286e-06, m = 4.0958432751798924e-05
[Iteration 2160] [Rank 1] a = 0.9163625836372375, b = 0.9995051987809795, delta = 0.011984448879957199, c = 1.039748119808967e-05, d = 1.0639283086417335e-05, m = 4.081542984337663e-05
[Iteration 2150] [Rank 3] a = 1.172102928161621, b = 0.9995000000416666, delta = 0.17735010385513306, c = 0.0, d = 0.0, m = 8.774211179224771e-07
[Iteration 2160] [Rank 3] a = 0.9092077612876892, b = 0.9995019344562915, delta = 0.14640657603740692, c = 3.868830213242668e-06, d = 3.937916467050572e-06, m = 8.752150982749221e-07
[Iteration 2170] [Rank 3] a = 0.8230009078979492, b = 0.9995000000416666, delta = 0.16327492892742157, c = 0.0, d = 0.0, m = 8.711996179175544e-07
[Iteration 2180] [Rank 3] a = 1.00706148147583, b = 0.9995000345847849, delta = 0.1627964824438095, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 8.718932306568455e-07
[Iteration 2190] [Rank 3] a = 1.2129639387130737, b = 0.9995000000416666, delta = 0.20026895403862, c = 0.0, d = 0.0, m = 8.680083956293947e-07
[Iteration 2200] [Rank 3] a = 1.0400480031967163, b = 0.9995000000416666, delta = 0.17869120836257935, c = 0.0, d = 0.0, m = 8.64457052701773e-07
[Iteration 2170] [Rank 1] a = 0.9264813661575317, b = 0.9995073922690032, delta = 0.01146107167005539, c = 1.4784458314891622e-05, d = 1.492263082250743e-05, m = 4.072127095993387e-05
[Iteration 2180] [Rank 1] a = 0.9514275193214417, b = 0.999769747282062, delta = 0.00971250981092453, c = 0.0005394945559859284, d = 0.0005421543767575327, m = 4.1106368530320887e-05
[Iteration 2190] [Rank 1] a = 0.9912959337234497, b = 0.9995058551002302, delta = 0.01029895804822445, c = 1.1710120020439858e-05, d = 1.1848292528055668e-05, m = 4.0957774533873643e-05
[Iteration 2200] [Rank 1] a = 1.0461421012878418, b = 0.9995004663737636, delta = 0.010204090736806393, c = 9.326644264067144e-07, d = 9.67207553310667e-07, m = 4.118152804165698e-05
[Iteration 2210] [Rank 1] a = 0.9619267582893372, b = 0.9995276345366562, delta = 0.00999614130705595, c = 5.5269003046323816e-05, d = 5.5959865584402864e-05, m = 4.1056107714089094e-05
[Iteration 2210] [Rank 3] a = 1.2083723545074463, b = 0.9995000000416666, delta = 0.18225888907909393, c = 0.0, d = 0.0, m = 8.615783895849224e-07
[Iteration 2220] [Rank 3] a = 1.1199709177017212, b = 0.9995000000416666, delta = 0.1803511083126068, c = 0.0, d = 0.0, m = 8.688817323801013e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2223 |     0.10587s |  92.9%
- batch.accumulate               |   2223 |     0.00082s |   0.7%
- batch.backward                 |   2223 |     0.05168s |  45.4%
- batch.evaluate                 |   2223 |     0.00277s |   2.4%
- batch.forward                  |   2223 |     0.02539s |  22.3%
- batch.mom                      |   2223 |     0.00126s |   1.1%
- batch.reduce                   |   2223 |     0.02115s |  18.6%
- batch.reporting.compr_err      |   2223 |     0.00001s |   0.0%
- batch.reporting.lr             |   2223 |     0.00002s |   0.0%
[Iteration 2220] [Rank 1] a = 1.0570489168167114, b = 0.9995007081755914, delta = 0.013432972133159637, c = 1.4162682030620478e-06, d = 1.4853544568699526e-06, m = 4.089406975372314e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2223 |     0.10579s |  92.9%
- batch.accumulate               |   2223 |     0.00083s |   0.7%
- batch.backward                 |   2223 |     0.05170s |  45.4%
- batch.evaluate                 |   2223 |     0.00277s |   2.4%
- batch.forward                  |   2223 |     0.02542s |  22.3%
- batch.mom                      |   2223 |     0.00126s |   1.1%
- batch.reduce                   |   2223 |     0.02101s |  18.4%
- batch.reporting.compr_err      |   2223 |     0.00001s |   0.0%
- batch.reporting.lr             |   2223 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   2223 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   2223 |     0.00001s |   0.0%
- batch.step                     |   2223 |     0.00047s |   0.4%
- batch.update_runavg            |   2223 |     0.00129s |   1.1%
- batch.wd                       |   2223 |     0.00001s |   0.0%
- epoch_metrics.collect          |     15 |     0.00957s |   0.1%
- reduce.combine                 |   2223 |     0.00524s |   4.6%
- reduce.flatpack                |   2223 |     0.00002s |   0.0%
- reduce.flatput                 |   2223 |     0.00010s |   0.1%
- reduce.gather.context          |   2223 |     0.00269s |   2.4%
- reduce.gather.tensors          |   2223 |     0.00029s |   0.3%
- reduce.heur_params             |   2223 |     0.01001s |   8.8%
- reduce.heur_params.alpha       |   2222 |     0.00808s |   7.1%
- reduce.heur_params.beta        |   2222 |     0.00186s |   1.6%
- reduce.memory                  |   2223 |     0.00041s |   0.4%
- reduce.pad                     |   2223 |     0.00027s |   0.2%
- batch.step                     |   2223 |     0.00048s |   0.4%
- batch.update_runavg            |   2223 |     0.00129s |   1.1%
- batch.wd                       |   2223 |     0.00001s |   0.0%
- reduce.threshold               |   2223 |     0.00193s |   1.7%
- test.last                      |     15 |     0.41483s |   2.8%
- epoch_metrics.collect          |     15 |     0.01139s |   0.1%
- reduce.combine                 |   2223 |     0.00526s |   4.6%
- reduce.flatpack                |   2223 |     0.00002s |   0.0%
- reduce.flatput                 |   2223 |     0.00017s |   0.2%
- reduce.gather.context          |   2223 |     0.00138s |   1.2%
- reduce.gather.tensors          |   2223 |     0.00042s |   0.4%
- reduce.heur_params             |   2223 |     0.01059s |   9.3%
- reduce.heur_params.alpha       |   2222 |     0.00823s |   7.2%
- reduce.heur_params.beta        |   2222 |     0.00228s |   2.0%
- reduce.memory                  |   2223 |     0.00043s |   0.4%
- reduce.pad                     |   2223 |     0.00014s |   0.1%
- reduce.threshold               |   2223 |     0.00239s |   2.1%
- test.last                      |     15 |     0.41482s |   2.8%
- test.runavg                    |     15 |     0.44688s |   3.0%
-----------------------------------------------------------------
- test.runavg                    |     15 |     0.44688s |   3.0%
-----------------------------------------------------------------
[Iteration 1970] [Rank 2] a = 0.9041430354118347, b = 0.9995000000416666, delta = 0.22884239256381989, c = 0.0, d = 0.0, m = 5.291004572452163e-07
[Iteration 1980] [Rank 2] a = 1.1647827625274658, b = 0.9995000000416666, delta = 0.26927268505096436, c = 0.0, d = 0.0, m = 5.264295816407477e-07
[Iteration 1990] [Rank 2] a = 1.1482497453689575, b = 0.9995000000416666, delta = 0.2723708152770996, c = 0.0, d = 0.0, m = 5.238375844354762e-07
[Iteration 2000] [Rank 2] a = 1.0164591073989868, b = 0.9995000000416666, delta = 0.2208758294582367, c = 0.0, d = 0.0, m = 5.212369683847762e-07
[Iteration 2010] [Rank 2] a = 0.9177388548851013, b = 0.9995000345847849, delta = 0.22467193007469177, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 5.186793933325434e-07
[Iteration 2020] [Rank 2] a = 0.9993122220039368, b = 0.9995000000416666, delta = 0.2537444531917572, c = 0.0, d = 0.0, m = 5.161813124687583e-07
[Iteration 2030] [Rank 2] a = 0.9893484711647034, b = 0.9995000000416666, delta = 0.2458834946155548, c = 0.0, d = 0.0, m = 5.13707831121111e-07
[Iteration 2040] [Rank 2] a = 1.0482600927352905, b = 0.9995000000416666, delta = 0.2578999996185303, c = 0.0, d = 0.0, m = 5.1122473849132e-07
[Iteration 2050] [Rank 2] a = 1.0445408821105957, b = 0.9995000000416666, delta = 0.22763198614120483, c = 0.0, d = 0.0, m = 5.091195432372379e-07
[Iteration 2060] [Rank 2] a = 1.1287143230438232, b = 0.9995000000416666, delta = 0.30678266286849976, c = 0.0, d = 0.0, m = 5.069844957387937e-07
[Iteration 2070] [Rank 2] a = 0.9264370203018188, b = 0.9995000000416666, delta = 0.25291287899017334, c = 0.0, d = 0.0, m = 5.045364778936041e-07
[Iteration 2080] [Rank 2] a = 0.99519282579422, b = 0.9995000000416666, delta = 0.24849651753902435, c = 0.0, d = 0.0, m = 5.02145185954571e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2084 |     0.10563s |  92.7%
- batch.accumulate               |   2084 |     0.00083s |   0.7%
- batch.backward                 |   2084 |     0.05209s |  45.7%
- batch.evaluate                 |   2084 |     0.00275s |   2.4%
- batch.forward                  |   2084 |     0.02576s |  22.6%
- batch.mom                      |   2084 |     0.00126s |   1.1%
- batch.reduce                   |   2084 |     0.02011s |  17.7%
- batch.reporting.compr_err      |   2084 |     0.00001s |   0.0%
- batch.reporting.lr             |   2084 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2084 |     0.00001s |   0.0%
- batch.step                     |   2084 |     0.00048s |   0.4%
- batch.update_runavg            |   2084 |     0.00130s |   1.1%
- batch.wd                       |   2084 |     0.00001s |   0.0%
- epoch_metrics.collect          |     14 |     0.01533s |   0.1%
- reduce.combine                 |   2084 |     0.00548s |   4.8%
- reduce.flatpack                |   2084 |     0.00002s |   0.0%
- reduce.flatput                 |   2084 |     0.00010s |   0.1%
- reduce.gather.context          |   2084 |     0.00110s |   1.0%
- reduce.gather.tensors          |   2084 |     0.00028s |   0.2%
- reduce.heur_params             |   2084 |     0.01030s |   9.1%
- reduce.heur_params.alpha       |   2083 |     0.00837s |   7.4%
- reduce.heur_params.beta        |   2083 |     0.00186s |   1.6%
- reduce.memory                  |   2084 |     0.00042s |   0.4%
- reduce.pad                     |   2084 |     0.00029s |   0.3%
- reduce.threshold               |   2084 |     0.00191s |   1.7%
- test.last                      |     14 |     0.41435s |   2.8%
- test.runavg                    |     14 |     0.44688s |   3.0%
-----------------------------------------------------------------

[Iteration 2090] [Rank 2] a = 0.8976377844810486, b = 0.9995000000416666, delta = 0.23424477875232697, c = 0.0, d = 0.0, m = 4.997437264330283e-07
[Iteration 2100] [Rank 2] a = 0.8984284996986389, b = 0.9995000000416666, delta = 0.2476765662431717, c = 0.0, d = 0.0, m = 4.984995753107258e-07
[Iteration 2110] [Rank 2] a = 0.9507205486297607, b = 0.9995000000416666, delta = 0.24296969175338745, c = 0.0, d = 0.0, m = 4.961381372467242e-07
[Iteration 2120] [Rank 2] a = 0.9274352788925171, b = 0.9995000000416666, delta = 0.23183947801589966, c = 0.0, d = 0.0, m = 4.938478251336854e-07
[Iteration 2130] [Rank 2] a = 1.1656306982040405, b = 0.9995000000416666, delta = 0.28589361906051636, c = 0.0, d = 0.0, m = 4.915465885666123e-07
[Iteration 2140] [Rank 2] a = 1.001736044883728, b = 0.9995000000416666, delta = 0.2606222331523895, c = 0.0, d = 0.0, m = 4.892507147293091e-07
[Iteration 2150] [Rank 2] a = 1.1244521141052246, b = 0.9995000000416666, delta = 0.24623249471187592, c = 0.0, d = 0.0, m = 4.930144100192175e-07
[Iteration 2160] [Rank 2] a = 0.9973670840263367, b = 0.9995000000416666, delta = 0.22161859273910522, c = 0.0, d = 0.0, m = 4.907329921107529e-07
[Iteration 2170] [Rank 2] a = 0.9145105481147766, b = 0.9995000173132257, delta = 0.21535488963127136, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 4.886476141627271e-07
[Iteration 2180] [Rank 2] a = 0.9985779523849487, b = 0.9995000000416666, delta = 0.22978009283542633, c = 0.0, d = 0.0, m = 4.864071390863276e-07
[Iteration 2190] [Rank 2] a = 0.7798506617546082, b = 0.9995000863994624, delta = 0.2149392068386078, c = 1.7271563451976193e-07, d = 3.1088814213557147e-07, m = 4.84329008895215e-07
[Iteration 2200] [Rank 2] a = 1.0999996662139893, b = 0.9995000000416666, delta = 0.22705614566802979, c = 0.0, d = 0.0, m = 4.825208708141822e-07
[Iteration 2210] [Rank 2] a = 1.0133928060531616, b = 0.9995000000416666, delta = 0.24357399344444275, c = 0.0, d = 0.0, m = 4.803385059529691e-07
[Iteration 2220] [Rank 2] a = 0.807889997959137, b = 0.9995004491022043, delta = 0.2022889107465744, c = 8.98121299502762e-07, d = 8.98121299502762e-07, m = 4.785801701762799e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2223 |     0.10565s |  92.7%
- batch.accumulate               |   2223 |     0.00083s |   0.7%
- batch.backward                 |   2223 |     0.05210s |  45.7%
- batch.evaluate                 |   2223 |     0.00275s |   2.4%
- batch.forward                  |   2223 |     0.02576s |  22.6%
- batch.mom                      |   2223 |     0.00126s |   1.1%
- batch.reduce                   |   2223 |     0.02012s |  17.7%
- batch.reporting.compr_err      |   2223 |     0.00001s |   0.0%
- batch.reporting.lr             |   2223 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2223 |     0.00001s |   0.0%
- batch.step                     |   2223 |     0.00048s |   0.4%
- batch.update_runavg            |   2223 |     0.00130s |   1.1%
- batch.wd                       |   2223 |     0.00001s |   0.0%
- epoch_metrics.collect          |     15 |     0.01606s |   0.1%
- reduce.combine                 |   2223 |     0.00548s |   4.8%
- reduce.flatpack                |   2223 |     0.00002s |   0.0%
- reduce.flatput                 |   2223 |     0.00010s |   0.1%
- reduce.gather.context          |   2223 |     0.00112s |   1.0%
- reduce.gather.tensors          |   2223 |     0.00028s |   0.2%
- reduce.heur_params             |   2223 |     0.01030s |   9.0%
- reduce.heur_params.alpha       |   2222 |     0.00837s |   7.3%
- reduce.heur_params.beta        |   2222 |     0.00185s |   1.6%
- reduce.memory                  |   2223 |     0.00042s |   0.4%
- reduce.pad                     |   2223 |     0.00028s |   0.3%
- reduce.threshold               |   2223 |     0.00191s |   1.7%
- test.last                      |     15 |     0.41483s |   2.8%
- test.runavg                    |     15 |     0.44688s |   3.0%
-----------------------------------------------------------------

[Iteration 2230] [Rank 2] a = 0.9546220898628235, b = 0.9995000000416666, delta = 0.2306853085756302, c = 0.0, d = 0.0, m = 4.7643503270350404e-07
[Iteration 2240] [Rank 2] a = 1.105311632156372, b = 0.9995000000416666, delta = 0.2622753977775574, c = 0.0, d = 0.0, m = 4.7430903969724123e-07
runavg_cross_entropy           - bits:171001984.000, epoch: 16.000, ratio_transmit_grad:  0.003, value:  6.582 (split:test)
runavg_perplexity              - bits:171001984.000, epoch: 16.000, ratio_transmit_grad:  0.003, value:723.734 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2223 |     0.10566s |  92.7%
- batch.accumulate               |   2223 |     0.00083s |   0.7%
- batch.backward                 |   2223 |     0.05172s |  45.4%
- batch.evaluate                 |   2223 |     0.00275s |   2.4%
- batch.forward                  |   2223 |     0.02551s |  22.4%
- batch.mom                      |   2223 |     0.00126s |   1.1%
- batch.reduce                   |   2223 |     0.02073s |  18.2%
- batch.reporting.compr_err      |   2223 |     0.00001s |   0.0%
- batch.reporting.lr             |   2223 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2223 |     0.00001s |   0.0%
- batch.step                     |   2223 |     0.00048s |   0.4%
- batch.update_runavg            |   2223 |     0.00130s |   1.1%
- batch.wd                       |   2223 |     0.00001s |   0.0%
- epoch_metrics.collect          |     15 |     0.00734s |   0.0%
- reduce.combine                 |   2223 |     0.00550s |   4.8%
- reduce.flatpack                |   2223 |     0.00002s |   0.0%
- reduce.flatput                 |   2223 |     0.00009s |   0.1%
- reduce.gather.context          |   2223 |     0.00141s |   1.2%
- reduce.gather.tensors          |   2223 |     0.00028s |   0.2%
- reduce.heur_params             |   2223 |     0.01063s |   9.3%
- reduce.heur_params.alpha       |   2222 |     0.00873s |   7.7%
- reduce.heur_params.beta        |   2222 |     0.00182s |   1.6%
- reduce.memory                  |   2223 |     0.00042s |   0.4%
- reduce.pad                     |   2223 |     0.00029s |   0.3%
- reduce.threshold               |   2223 |     0.00187s |   1.6%
- test.last                      |     15 |     0.41482s |   2.8%
- test.runavg                    |     15 |     0.44691s |   3.0%
-----------------------------------------------------------------

[Iteration 2230] [Rank 0] a = 1.0239694118499756, b = 0.9995000000416666, delta = 0.3662140965461731, c = 0.0, d = 0.0, m = 1.33388183898499e-07
timer                          - epoch: -1.000, value:  0.006 (event:reduce.combine)
[Iteration 2240] [Rank 0] a = 0.9960256218910217, b = 0.9995000000416666, delta = 0.36462393403053284, c = 0.0, d = 0.0, m = 1.328546232865538e-07
[Iteration 2250] [Rank 0] a = 1.0750954151153564, b = 0.9995000000416666, delta = 0.40177252888679504, c = 0.0, d = 0.0, m = 1.3226442060647137e-07
[Iteration 2260] [Rank 0] a = 1.2945846319198608, b = 0.9995000000416666, delta = 0.40753471851348877, c = 0.0, d = 0.0, m = 1.3181693893290696e-07
[Iteration 2270] [Rank 0] a = 1.2332987785339355, b = 0.9995000000416666, delta = 0.4719592034816742, c = 0.0, d = 0.0, m = 1.3123650327049875e-07
[Iteration 2280] [Rank 0] a = 0.9991833567619324, b = 0.9995000000416666, delta = 0.3796357214450836, c = 0.0, d = 0.0, m = 1.306611569168359e-07
[Iteration 2290] [Rank 0] a = 1.1629400253295898, b = 0.9995000000416666, delta = 0.38150256872177124, c = 0.0, d = 0.0, m = 1.3012098873029708e-07
[Iteration 2300] [Rank 0] a = 0.9408963918685913, b = 0.9995000000416666, delta = 0.39814120531082153, c = 0.0, d = 0.0, m = 1.295554911695396e-07
timer                          - epoch: 17.000, value:  0.003 (event:batch.evaluate)
[Iteration 2310] [Rank 0] a = 1.107591152191162, b = 0.9995000000416666, delta = 0.3816862404346466, c = 0.0, d = 0.0, m = 1.2899488757296002e-07
timer                          - epoch: -1.000, value:  0.000 (event:reduce.memory)
[Iteration 2320] [Rank 0] a = 1.1014246940612793, b = 0.9995000000416666, delta = 0.4004553556442261, c = 0.0, d = 0.0, m = 1.2860282618571913e-07
[Iteration 2330] [Rank 0] a = 0.9624060392379761, b = 0.9995000000416666, delta = 0.3718658685684204, c = 0.0, d = 0.0, m = 1.280511195096757e-07
[Iteration 2340] [Rank 0] a = 0.9585917592048645, b = 0.9995000000416666, delta = 0.34996145963668823, c = 0.0, d = 0.0, m = 1.275041262610227e-07
[Iteration 2350] [Rank 0] a = 0.9096382856369019, b = 0.9995000000416666, delta = 0.3739471733570099, c = 0.0, d = 0.0, m = 1.2715279465198018e-07
[Iteration 2360] [Rank 0] a = 1.0488897562026978, b = 0.9995000000416666, delta = 0.36906710267066956, c = 0.0, d = 0.0, m = 1.266142398249917e-07
cross_entropy                  - bits:178174720.000, epoch: 17.000, ratio_transmit_grad:  0.003, value:  6.728 (split:train)
last_cross_entropy             - bits:178174720.000, epoch: 17.000, ratio_transmit_grad:  0.003, value:  6.728 (split:train)
perplexity                     - bits:178174720.000, epoch: 17.000, ratio_transmit_grad:  0.003, value:838.411 (split:train)
last_perplexity                - bits:178174720.000, epoch: 17.000, ratio_transmit_grad:  0.003, value:838.411 (split:train)
last_cross_entropy             - bits:178174720.000, epoch: 17.000, ratio_transmit_grad:  0.003, value:  6.527 (split:test)
last_perplexity                - bits:178174720.000, epoch: 17.000, ratio_transmit_grad:  0.003, value:685.074 (split:test)
runavg_cross_entropy           - bits:178174720.000, epoch: 17.000, ratio_transmit_grad:  0.003, value:  6.618 (split:test)
runavg_perplexity              - bits:178174720.000, epoch: 17.000, ratio_transmit_grad:  0.003, value:750.118 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2362 |     0.10567s |  92.7%
- batch.accumulate               |   2362 |     0.00083s |   0.7%
- batch.backward                 |   2362 |     0.05172s |  45.4%
- batch.evaluate                 |   2362 |     0.00275s |   2.4%
- batch.forward                  |   2362 |     0.02551s |  22.4%
- batch.mom                      |   2362 |     0.00126s |   1.1%
- batch.reduce                   |   2362 |     0.02075s |  18.2%
- batch.reporting.compr_err      |   2362 |     0.00001s |   0.0%
- batch.reporting.lr             |   2362 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2362 |     0.00001s |   0.0%
- batch.step                     |   2362 |     0.00048s |   0.4%
- batch.update_runavg            |   2362 |     0.00130s |   1.1%
- batch.wd                       |   2362 |     0.00001s |   0.0%
- epoch_metrics.collect          |     16 |     0.00697s |   0.0%
- reduce.combine                 |   2362 |     0.00550s |   4.8%
- reduce.flatpack                |   2362 |     0.00002s |   0.0%
- reduce.flatput                 |   2362 |     0.00009s |   0.1%
- reduce.gather.context          |   2362 |     0.00143s |   1.3%
- reduce.gather.tensors          |   2362 |     0.00028s |   0.2%
- reduce.heur_params             |   2362 |     0.01062s |   9.3%
- reduce.heur_params.alpha       |   2361 |     0.00873s |   7.7%
- reduce.heur_params.beta        |   2361 |     0.00182s |   1.6%
- reduce.memory                  |   2362 |     0.00042s |   0.4%
- reduce.pad                     |   2362 |     0.00029s |   0.3%
- reduce.threshold               |   2362 |     0.00187s |   1.6%
- test.last                      |     16 |     0.41515s |   2.8%
- test.runavg                    |     16 |     0.44710s |   3.0%
-----------------------------------------------------------------

[Iteration 2370] [Rank 0] a = 0.9789354205131531, b = 0.9995000000416666, delta = 0.35749977827072144, c = 0.0, d = 0.0, m = 1.2608022784766153e-07
[Iteration 2380] [Rank 0] a = 0.9295746684074402, b = 0.9995000000416666, delta = 0.36795586347579956, c = 0.0, d = 0.0, m = 1.255507014812287e-07
[Iteration 2390] [Rank 0] a = 1.0163986682891846, b = 0.9995000000416666, delta = 0.3798997104167938, c = 0.0, d = 0.0, m = 1.2502560444450253e-07
[Iteration 2400] [Rank 0] a = 1.0224610567092896, b = 0.9995000000416666, delta = 0.3951943814754486, c = 0.0, d = 0.0, m = 1.2450488139392155e-07
[Iteration 2410] [Rank 0] a = 0.88657546043396, b = 0.9995000173132257, delta = 0.3396502733230591, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 1.2400280520684763e-07

[Iteration 2230] [Rank 3] a = 0.9868497848510742, b = 0.9995000000416666, delta = 0.15636800229549408, c = 0.0, d = 0.0, m = 8.651264974264189e-07
[Iteration 2240] [Rank 3] a = 0.8848553895950317, b = 0.9995000000416666, delta = 0.1629423201084137, c = 0.0, d = 0.0, m = 8.613585339222509e-07
[Iteration 2250] [Rank 3] a = 1.0017117261886597, b = 0.9995000345847849, delta = 0.17344313859939575, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 8.576087028672963e-07
[Iteration 2260] [Rank 3] a = 0.954355001449585, b = 0.9995000173132257, delta = 0.14802397787570953, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 8.549156547064877e-07
[Iteration 2270] [Rank 3] a = 0.9660925269126892, b = 0.9995000000416666, delta = 0.1726992279291153, c = 0.0, d = 0.0, m = 8.511815858851504e-07
[Iteration 2280] [Rank 3] a = 0.9837570190429688, b = 0.9995000000416666, delta = 0.1708688735961914, c = 0.0, d = 0.0, m = 8.475862646590583e-07

[Iteration 2230] [Rank 1] a = 1.0548245906829834, b = 0.9995005872746774, delta = 0.011438642628490925, c = 1.174466314734381e-06, d = 1.174466314734381e-06, m = 4.082686386756832e-05
[Iteration 2240] [Rank 1] a = 1.0596418380737305, b = 0.9995001900288173, delta = 0.010525519028306007, c = 3.7997439594347627e-07, d = 3.7997439594347627e-07, m = 4.079800703786637e-05
[Iteration 2250] [Rank 1] a = 1.0373406410217285, b = 0.9995015199388717, delta = 0.010462772101163864, c = 3.03979516754781e-06, d = 3.074338294451762e-06, m = 4.085027833583118e-05
[Iteration 2260] [Rank 1] a = 1.0357481241226196, b = 0.9995019517278507, delta = 0.010595257394015789, c = 3.90337334014662e-06, d = 3.972459593954525e-06, m = 4.0727354955175995e-05
[Iteration 2270] [Rank 1] a = 0.9942752122879028, b = 0.9995008808911828, delta = 0.011243912391364574, c = 1.7616994721015717e-06, d = 1.796242599005524e-06, m = 4.0576948736690554e-05
[Iteration 2290] [Rank 3] a = 0.9370198845863342, b = 0.9995000000416666, delta = 0.15904918313026428, c = 0.0, d = 0.0, m = 8.457713489962051e-07
[Iteration 2300] [Rank 3] a = 0.9500464797019958, b = 0.9995000863994624, delta = 0.15833324193954468, c = 1.7271563451976193e-07, d = 2.0725876142371433e-07, m = 8.422608148397433e-07
[Iteration 2310] [Rank 3] a = 1.1593348979949951, b = 0.9995000000416666, delta = 0.17081281542778015, c = 0.0, d = 0.0, m = 8.42427794161297e-07
[Iteration 2320] [Rank 3] a = 1.0179246664047241, b = 0.9995000000416666, delta = 0.16328634321689606, c = 0.0, d = 0.0, m = 8.387982043544842e-07
[Iteration 2330] [Rank 3] a = 0.950224757194519, b = 0.9995000863994624, delta = 0.15520812571048737, c = 1.7271563451976193e-07, d = 1.7271563451976193e-07, m = 8.353479466219637e-07
[Iteration 2340] [Rank 3] a = 0.9110664129257202, b = 0.9995000691279032, delta = 0.15734916925430298, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 8.323255699578143e-07
[Iteration 2280] [Rank 1] a = 0.987201452255249, b = 0.9995073231827661, delta = 0.010276900604367256, c = 1.4646285807275812e-05, d = 1.519897583773905e-05, m = 4.046859825504918e-05
[Iteration 2290] [Rank 1] a = 1.0004448890686035, b = 0.9995086185497115, delta = 0.012028425000607967, c = 1.723702032507224e-05, d = 1.7271563451976192e-05, m = 4.034548263652389e-05
[Iteration 2300] [Rank 1] a = 1.123500108718872, b = 0.999500172757258, delta = 0.010720770806074142, c = 3.4543126903952387e-07, d = 3.4543126903952387e-07, m = 4.0604972790547246e-05
[Iteration 2310] [Rank 1] a = 1.0150437355041504, b = 0.999501571753549, delta = 0.010279429145157337, c = 3.1434245482596672e-06, d = 3.212510802067572e-06, m = 4.052469308230378e-05
[Iteration 2320] [Rank 1] a = 0.9396151304244995, b = 0.9995026080470993, delta = 0.010870486497879028, c = 5.216012162496811e-06, d = 5.250555289400763e-06, m = 4.0374560367873384e-05
[Iteration 2350] [Rank 3] a = 1.0840433835983276, b = 0.9995000000416666, delta = 0.17713914811611176, c = 0.0, d = 0.0, m = 8.29784386176398e-07
[Iteration 2360] [Rank 3] a = 1.0867033004760742, b = 0.9995000000416666, delta = 0.167153000831604, c = 0.0, d = 0.0, m = 8.353116240268336e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2362 |     0.10589s |  92.9%
- batch.accumulate               |   2362 |     0.00082s |   0.7%
- batch.backward                 |   2362 |     0.05170s |  45.4%
- batch.evaluate                 |   2362 |     0.00277s |   2.4%
- batch.forward                  |   2362 |     0.02538s |  22.3%
- batch.mom                      |   2362 |     0.00126s |   1.1%
- batch.reduce                   |   2362 |     0.02115s |  18.6%
- batch.reporting.compr_err      |   2362 |     0.00001s |   0.0%
- batch.reporting.lr             |   2362 |     0.00002s |   0.0%
[Iteration 2330] [Rank 1] a = 1.0574387311935425, b = 0.9995003109297312, delta = 0.010576081462204456, c = 6.217762842711429e-07, d = 6.217762842711429e-07, m = 4.035259621064601e-05
[Iteration 2340] [Rank 1] a = 0.9748467803001404, b = 0.9995079967735776, delta = 0.010007346048951149, c = 1.5993467756529955e-05, d = 1.6407985279377384e-05, m = 4.02108705004679e-05
[Iteration 2350] [Rank 1] a = 0.8790259957313538, b = 0.9995017444691409, delta = 0.009985271841287613, c = 3.488855817299191e-06, d = 3.557942071107096e-06, m = 4.023845250152402e-05
[Iteration 2360] [Rank 1] a = 1.025739312171936, b = 0.9995013472232801, delta = 0.011676092632114887, c = 2.694363898508286e-06, d = 2.763450152316191e-06, m = 4.010233183552424e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2362 |     0.10580s |  92.8%
- batch.accumulate               |   2362 |     0.00083s |   0.7%
- batch.reporting.memory_norm    |   2362 |     0.00001s |   0.0%
- batch.step                     |   2362 |     0.00047s |   0.4%
- batch.update_runavg            |   2362 |     0.00129s |   1.1%
- batch.wd                       |   2362 |     0.00001s |   0.0%
- epoch_metrics.collect          |     16 |     0.01056s |   0.1%
- reduce.combine                 |   2362 |     0.00525s |   4.6%
- reduce.flatpack                |   2362 |     0.00002s |   0.0%
- reduce.flatput                 |   2362 |     0.00010s |   0.1%
- reduce.gather.context          |   2362 |     0.00269s |   2.4%
- reduce.gather.tensors          |   2362 |     0.00029s |   0.3%
- reduce.heur_params             |   2362 |     0.01001s |   8.8%
- reduce.heur_params.alpha       |   2361 |     0.00808s |   7.1%
- reduce.heur_params.beta        |   2361 |     0.00186s |   1.6%
- reduce.memory                  |   2362 |     0.00041s |   0.4%
- reduce.pad                     |   2362 |     0.00027s |   0.2%
- batch.backward                 |   2362 |     0.05170s |  45.4%
- batch.evaluate                 |   2362 |     0.00277s |   2.4%
- batch.forward                  |   2362 |     0.02541s |  22.3%
- batch.mom                      |   2362 |     0.00126s |   1.1%
- batch.reduce                   |   2362 |     0.02102s |  18.4%
- batch.reporting.compr_err      |   2362 |     0.00001s |   0.0%
- batch.reporting.lr             |   2362 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   2362 |     0.00001s |   0.0%
- batch.step                     |   2362 |     0.00048s |   0.4%
- batch.update_runavg            |   2362 |     0.00129s |   1.1%
- batch.wd                       |   2362 |     0.00001s |   0.0%
- epoch_metrics.collect          |     16 |     0.01072s |   0.1%
- reduce.combine                 |   2362 |     0.00527s |   4.6%
- reduce.flatpack                |   2362 |     0.00002s |   0.0%
- reduce.flatput                 |   2362 |     0.00017s |   0.2%
- reduce.threshold               |   2362 |     0.00192s |   1.7%
- test.last                      |     16 |     0.41516s |   2.8%
- reduce.gather.context          |   2362 |     0.00136s |   1.2%
- reduce.gather.tensors          |   2362 |     0.00042s |   0.4%
- reduce.heur_params             |   2362 |     0.01060s |   9.3%
- test.runavg                    |     16 |     0.44707s |   3.0%
-----------------------------------------------------------------

[Iteration 2370] [Rank 3] a = 0.8966043591499329, b = 0.9995000000416666, delta = 0.15950246155261993, c = 0.0, d = 0.0, m = 8.323276423546186e-07
[Iteration 2380] [Rank 3] a = 0.9440937042236328, b = 0.9995000173132257, delta = 0.15077656507492065, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 8.288609518171393e-07
[Iteration 2390] [Rank 3] a = 1.2154998779296875, b = 0.9995000000416666, delta = 0.18368470668792725, c = 0.0, d = 0.0, m = 8.257410963288595e-07
[Iteration 2400] [Rank 3] a = 1.20653235912323, b = 0.9995000000416666, delta = 0.18040108680725098, c = 0.0, d = 0.0, m = 8.226040678830846e-07
[Iteration 2410] [Rank 3] a = 1.1151552200317383, b = 0.9995000000416666, delta = 0.17656823992729187, c = 0.0, d = 0.0, m = 8.200088449692291e-07
- reduce.heur_params.alpha       |   2361 |     0.00823s |   7.2%
- reduce.heur_params.beta        |   2361 |     0.00229s |   2.0%
- reduce.memory                  |   2362 |     0.00043s |   0.4%
- reduce.pad                     |   2362 |     0.00014s |   0.1%
- reduce.threshold               |   2362 |     0.00241s |   2.1%
- test.last                      |     16 |     0.41515s |   2.8%
- test.runavg                    |     16 |     0.44708s |   3.0%
-----------------------------------------------------------------

[Iteration 2370] [Rank 1] a = 1.0186970233917236, b = 0.9995015372104309, delta = 0.010376391932368279, c = 3.074338294451762e-06, d = 3.2470539289715243e-06, m = 4.005199077201499e-05
[Iteration 2380] [Rank 1] a = 1.0765937566757202, b = 0.9995008463480648, delta = 0.012485050596296787, c = 1.692613218293667e-06, d = 1.692613218293667e-06, m = 3.991678107272324e-05
[Iteration 2420] [Rank 3] a = 0.9873787760734558, b = 0.9995000000416666, delta = 0.16541670262813568, c = 0.0, d = 0.0, m = 8.16664582652426e-07
[Iteration 2430] [Rank 3] a = 0.8651489615440369, b = 0.9995001382141396, delta = 0.15555384755134583, c = 2.763450152316191e-07, d = 2.763450152316191e-07, m = 8.136178129960553e-07
[Iteration 2440] [Rank 3] a = 1.2478516101837158, b = 0.9995000000416666, delta = 0.18026182055473328, c = 0.0, d = 0.0, m = 8.144309871266974e-07
[Iteration 2450] [Rank 3] a = 0.9497947096824646, b = 0.9995000000416666, delta = 0.14777801930904388, c = 0.0, d = 0.0, m = 8.11460472357759e-07
[Iteration 2460] [Rank 3] a = 0.8263572454452515, b = 0.9995000000416666, delta = 0.1325853168964386, c = 0.0, d = 0.0, m = 8.323616288221379e-07
[Iteration 2470] [Rank 3] a = 1.044396996498108, b = 0.9995000000416666, delta = 0.10081426054239273, c = 0.0, d = 0.0, m = 1.009313542074206e-06
[Iteration 2390] [Rank 1] a = 1.0362248420715332, b = 0.9995009845205379, delta = 0.010477926582098007, c = 1.968958233525286e-06, d = 2.038044487333191e-06, m = 3.991740755462694e-05
[Iteration 2400] [Rank 1] a = 0.9615129828453064, b = 0.9995080658598146, delta = 0.010484540835022926, c = 1.6131640264145764e-05, d = 1.6822502802224812e-05, m = 3.978204313060216e-05
[Iteration 2410] [Rank 1] a = 1.0274969339370728, b = 0.9995007081755914, delta = 0.011663672514259815, c = 1.4162682030620478e-06, d = 1.4508113299660003e-06, m = 3.9651641313997835e-05
[Iteration 2420] [Rank 1] a = 0.9446635246276855, b = 0.9995523501387245, delta = 0.010570411570370197, c = 0.00010470021764587968, d = 0.00010698006402154055, m = 3.959836585126802e-05
[Iteration 2430] [Rank 1] a = 0.896185576915741, b = 0.999537928386226, delta = 0.010464902967214584, c = 7.585670668107944e-05, d = 7.75493198993731e-05, m = 3.9507120597190294e-05
[Iteration 2480] [Rank 3] a = 1.0261518955230713, b = 0.9995000173132257, delta = 0.07885530591011047, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 1.3731066982646874e-06
[Iteration 2490] [Rank 3] a = 1.0719444751739502, b = 0.9995000000416666, delta = 0.0706905946135521, c = 0.0, d = 0.0, m = 2.016106620307077e-06
[Iteration 2500] [Rank 3] a = 1.003803014755249, b = 0.9995002591150537, delta = 0.05138581991195679, c = 5.181469035592857e-07, d = 5.181469035592857e-07, m = 3.6427460691839726e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2501 |     0.10591s |  92.9%
- batch.accumulate               |   2501 |     0.00082s |   0.7%
- batch.backward                 |   2501 |     0.05170s |  45.3%
- batch.evaluate                 |   2501 |     0.00277s |   2.4%
- batch.forward                  |   2501 |     0.02539s |  22.3%
[Iteration 2440] [Rank 1] a = 1.004676103591919, b = 0.9995052678672165, delta = 0.011955110356211662, c = 1.0535653705705478e-05, d = 1.070836934022524e-05, m = 3.939986790469687e-05
[Iteration 2450] [Rank 1] a = 1.0224167108535767, b = 0.999501468124194, delta = 0.011342480778694153, c = 2.936165786835953e-06, d = 2.936165786835953e-06, m = 3.9420557230161785e-05
[Iteration 2460] [Rank 1] a = 0.9313187599182129, b = 0.9995657528693571, delta = 0.010655894875526428, c = 0.00013150568412334673, d = 0.00013261106418427322, m = 3.9541339107014624e-05
[Iteration 2470] [Rank 1] a = 1.0020878314971924, b = 0.9995031089223158, delta = 0.011615222319960594, c = 6.217762842711429e-06, d = 6.3559353503272394e-06, m = 3.951184326922914e-05
[Iteration 2480] [Rank 1] a = 1.1278862953186035, b = 0.9995004836453225, delta = 0.012474744580686092, c = 9.67207553310667e-07, d = 9.67207553310667e-07, m = 3.950884410782276e-05
- batch.mom                      |   2501 |     0.00126s |   1.1%
- batch.reduce                   |   2501 |     0.02118s |  18.6%
- batch.reporting.compr_err      |   2501 |     0.00001s |   0.0%
- batch.reporting.lr             |   2501 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2501 |     0.00001s |   0.0%
- batch.step                     |   2501 |     0.00047s |   0.4%
- batch.update_runavg            |   2501 |     0.00129s |   1.1%
- batch.wd                       |   2501 |     0.00001s |   0.0%
- epoch_metrics.collect          |     17 |     0.00998s |   0.1%
- reduce.combine                 |   2501 |     0.00525s |   4.6%
- reduce.flatpack                |   2501 |     0.00002s |   0.0%
- reduce.flatput                 |   2501 |     0.00010s |   0.1%
- reduce.gather.context          |   2501 |     0.00270s |   2.4%
- reduce.gather.tensors          |   2501 |     0.00029s |   0.3%
- reduce.heur_params             |   2501 |     0.01001s |   8.8%
[Iteration 2490] [Rank 1] a = 1.0631948709487915, b = 0.9995019344562915, delta = 0.011838752776384354, c = 3.868830213242668e-06, d = 3.868830213242668e-06, m = 3.944698901160866e-05
[Iteration 2500] [Rank 1] a = 0.9963824152946472, b = 0.9995277554375733, delta = 0.01055384986102581, c = 5.551080493465149e-05, d = 5.9414178274798106e-05, m = 3.958400637986705e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2501 |     0.10582s |  92.8%
- batch.accumulate               |   2501 |     0.00083s |   0.7%
- batch.backward                 |   2501 |     0.05170s |  45.4%
- batch.evaluate                 |   2501 |     0.00277s |   2.4%
- batch.forward                  |   2501 |     0.02541s |  22.3%
- batch.mom                      |   2501 |     0.00126s |   1.1%
- batch.reduce                   |   2501 |     0.02104s |  18.5%
- reduce.heur_params.alpha       |   2500 |     0.00808s |   7.1%
- reduce.heur_params.beta        |   2500 |     0.00186s |   1.6%
- reduce.memory                  |   2501 |     0.00041s |   0.4%
- reduce.pad                     |   2501 |     0.00027s |   0.2%
- batch.reporting.compr_err      |   2501 |     0.00001s |   0.0%
- batch.reporting.lr             |   2501 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   2501 |     0.00001s |   0.0%
- batch.step                     |   2501 |     0.00048s |   0.4%
- batch.update_runavg            |   2501 |     0.00129s |   1.1%
- reduce.threshold               |   2501 |     0.00193s |   1.7%
- test.last                      |     17 |     0.41536s |   2.8%
- test.runavg                    |     17 |     0.44717s |   3.0%
-----------------------------------------------------------------
- batch.wd                       |   2501 |     0.00001s |   0.0%
- epoch_metrics.collect          |     17 |     0.01160s |   0.1%
- reduce.combine                 |   2501 |     0.00528s |   4.6%
- reduce.flatpack                |   2501 |     0.00002s |   0.0%
- reduce.flatput                 |   2501 |     0.00018s |   0.2%
- reduce.gather.context          |   2501 |     0.00135s |   1.2%
- reduce.gather.tensors          |   2501 |     0.00042s |   0.4%
- reduce.heur_params             |   2501 |     0.01061s |   9.3%
- reduce.heur_params.alpha       |   2500 |     0.00823s |   7.2%
- reduce.heur_params.beta        |   2500 |     0.00230s |   2.0%
- reduce.memory                  |   2501 |     0.00044s |   0.4%
- reduce.pad                     |   2501 |     0.00014s |   0.1%
- reduce.threshold               |   2501 |     0.00242s |   2.1%
- test.last                      |     17 |     0.41536s |   2.8%
- test.runavg                    |     17 |     0.44717s |   3.0%
-----------------------------------------------------------------
[Iteration 2420] [Rank 0] a = 0.9924417734146118, b = 0.9995000000416666, delta = 0.3759969472885132, c = 0.0, d = 0.0, m = 1.236332898070009e-07
[Iteration 2430] [Rank 0] a = 1.0645909309387207, b = 0.9995000000416666, delta = 0.4192798137664795, c = 0.0, d = 0.0, m = 1.2312472012453687e-07
[Iteration 2440] [Rank 0] a = 0.8435063362121582, b = 0.999500656360914, delta = 0.3025189936161041, c = 1.3126388223501907e-06, d = 1.3126388223501907e-06, m = 1.2315806368090918e-07
timer                          - epoch: -1.000, value:  0.000 (event:reduce.flatpack)
[Iteration 2450] [Rank 0] a = 1.0689729452133179, b = 0.9995000000416666, delta = 0.4042154550552368, c = 0.0, d = 0.0, m = 1.2265558280093808e-07
[Iteration 2460] [Rank 0] a = 1.08333158493042, b = 0.9995000000416666, delta = 0.39333969354629517, c = 0.0, d = 0.0, m = 1.2215718547139343e-07
[Iteration 2470] [Rank 0] a = 0.8946701884269714, b = 0.9995000000416666, delta = 0.3682554066181183, c = 0.0, d = 0.0, m = 1.2166282211456866e-07
[Iteration 2480] [Rank 0] a = 0.9137181043624878, b = 0.9995000000416666, delta = 0.3300544023513794, c = 0.0, d = 0.0, m = 1.211863670181391e-07
[Iteration 2490] [Rank 0] a = 1.1252995729446411, b = 0.9995000000416666, delta = 0.3936905562877655, c = 0.0, d = 0.0, m = 1.20727604506548e-07
[Iteration 2500] [Rank 0] a = 0.979983389377594, b = 0.9995000000416666, delta = 0.3429221510887146, c = 0.0, d = 0.0, m = 1.202448871754543e-07
cross_entropy                  - bits:197951680.000, epoch: 18.000, ratio_transmit_grad:  0.008, value:  6.752 (split:train)
last_cross_entropy             - bits:197951680.000, epoch: 18.000, ratio_transmit_grad:  0.008, value:  6.752 (split:train)
perplexity                     - bits:197951680.000, epoch: 18.000, ratio_transmit_grad:  0.008, value:861.169 (split:train)
last_perplexity                - bits:197951680.000, epoch: 18.000, ratio_transmit_grad:  0.008, value:861.169 (split:train)
last_cross_entropy             - bits:197951680.000, epoch: 18.000, ratio_transmit_grad:  0.008, value:  6.530 (split:test)
last_perplexity                - bits:197951680.000, epoch: 18.000, ratio_transmit_grad:  0.008, value:687.155 (split:test)
runavg_cross_entropy           - bits:197951680.000, epoch: 18.000, ratio_transmit_grad:  0.008, value:  6.623 (split:test)
runavg_perplexity              - bits:197951680.000, epoch: 18.000, ratio_transmit_grad:  0.008, value:754.331 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2501 |     0.10570s |  92.7%
- batch.accumulate               |   2501 |     0.00083s |   0.7%
- batch.backward                 |   2501 |     0.05173s |  45.4%
- batch.evaluate                 |   2501 |     0.00275s |   2.4%
- batch.forward                  |   2501 |     0.02551s |  22.4%
- batch.mom                      |   2501 |     0.00126s |   1.1%
- batch.reduce                   |   2501 |     0.02076s |  18.2%
- batch.reporting.compr_err      |   2501 |     0.00001s |   0.0%
- batch.reporting.lr             |   2501 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2501 |     0.00001s |   0.0%
- batch.step                     |   2501 |     0.00048s |   0.4%
- batch.update_runavg            |   2501 |     0.00130s |   1.1%
- batch.wd                       |   2501 |     0.00001s |   0.0%
- epoch_metrics.collect          |     17 |     0.00804s |   0.1%
- reduce.combine                 |   2501 |     0.00553s |   4.9%
- reduce.flatpack                |   2501 |     0.00002s |   0.0%
- reduce.flatput                 |   2501 |     0.00009s |   0.1%
- reduce.gather.context          |   2501 |     0.00143s |   1.3%
- reduce.gather.tensors          |   2501 |     0.00028s |   0.2%
- reduce.heur_params             |   2501 |     0.01062s |   9.3%
- reduce.heur_params.alpha       |   2500 |     0.00873s |   7.7%
- reduce.heur_params.beta        |   2500 |     0.00182s |   1.6%
- reduce.memory                  |   2501 |     0.00042s |   0.4%
- reduce.pad                     |   2501 |     0.00029s |   0.3%
- reduce.threshold               |   2501 |     0.00187s |   1.6%
- test.last                      |     17 |     0.41535s |   2.8%
- test.runavg                    |     17 |     0.44719s |   3.0%
-----------------------------------------------------------------

learning_rate                  - epoch: 18.000, value: 10.000 (weight:encoder.weight)
effective_lr                   - epoch: 18.000, value:  0.000 (weight:encoder.weight)
grad_norm                      - epoch: 18.000, value:  0.086 (weight:encoder.weight)
learning_rate                  - epoch: 18.000, value: 10.000 (weight:rnn.weight_ih_l0)
effective_lr                   - epoch: 18.000, value:  0.009 (weight:rnn.weight_ih_l0)
grad_norm                      - epoch: 18.000, value:  0.199 (weight:rnn.weight_ih_l0)
learning_rate                  - epoch: 18.000, value: 10.000 (weight:rnn.weight_hh_l0)
effective_lr                   - epoch: 18.000, value:  0.011 (weight:rnn.weight_hh_l0)
grad_norm                      - epoch: 18.000, value:  0.082 (weight:rnn.weight_hh_l0)
learning_rate                  - epoch: 18.000, value: 10.000 (weight:rnn.bias_ih_l0)
effective_lr                   - epoch: 18.000, value:  0.132 (weight:rnn.bias_ih_l0)
grad_norm                      - epoch: 18.000, value:  0.030 (weight:rnn.bias_ih_l0)
learning_rate                  - epoch: 18.000, value: 10.000 (weight:rnn.bias_hh_l0)
effective_lr                   - epoch: 18.000, value:  0.133 (weight:rnn.bias_hh_l0)
grad_norm                      - epoch: 18.000, value:  0.030 (weight:rnn.bias_hh_l0)
learning_rate                  - epoch: 18.000, value: 10.000 (weight:rnn.weight_ih_l1)
effective_lr                   - epoch: 18.000, value:  0.006 (weight:rnn.weight_ih_l1)
grad_norm                      - epoch: 18.000, value:  0.244 (weight:rnn.weight_ih_l1)
learning_rate                  - epoch: 18.000, value: 10.000 (weight:rnn.weight_hh_l1)
effective_lr                   - epoch: 18.000, value:  0.002 (weight:rnn.weight_hh_l1)
grad_norm                      - epoch: 18.000, value:  0.150 (weight:rnn.weight_hh_l1)
learning_rate                  - epoch: 18.000, value: 10.000 (weight:rnn.bias_ih_l1)
effective_lr                   - epoch: 18.000, value:  0.008 (weight:rnn.bias_ih_l1)
grad_norm                      - epoch: 18.000, value:  0.046 (weight:rnn.bias_ih_l1)
learning_rate                  - epoch: 18.000, value: 10.000 (weight:rnn.bias_hh_l1)
effective_lr                   - epoch: 18.000, value:  0.008 (weight:rnn.bias_hh_l1)
grad_norm                      - epoch: 18.000, value:  0.046 (weight:rnn.bias_hh_l1)
learning_rate                  - epoch: 18.000, value: 10.000 (weight:rnn.weight_ih_l2)
effective_lr                   - epoch: 18.000, value:  0.002 (weight:rnn.weight_ih_l2)
grad_norm                      - epoch: 18.000, value:  0.118 (weight:rnn.weight_ih_l2)
learning_rate                  - epoch: 18.000, value: 10.000 (weight:rnn.weight_hh_l2)
effective_lr                   - epoch: 18.000, value:  0.001 (weight:rnn.weight_hh_l2)
grad_norm                      - epoch: 18.000, value:  0.048 (weight:rnn.weight_hh_l2)
learning_rate                  - epoch: 18.000, value: 10.000 (weight:rnn.bias_ih_l2)
effective_lr                   - epoch: 18.000, value:  0.002 (weight:rnn.bias_ih_l2)
grad_norm                      - epoch: 18.000, value:  0.023 (weight:rnn.bias_ih_l2)
learning_rate                  - epoch: 18.000, value: 10.000 (weight:rnn.bias_hh_l2)
effective_lr                   - epoch: 18.000, value:  0.002 (weight:rnn.bias_hh_l2)
grad_norm                      - epoch: 18.000, value:  0.023 (weight:rnn.bias_hh_l2)
learning_rate                  - epoch: 18.000, value: 10.000 (weight:decoder.bias)
effective_lr                   - epoch: 18.000, value:  0.002 (weight:decoder.bias)
grad_norm                      - epoch: 18.000, value:  0.029 (weight:decoder.bias)
grad_norm                      - epoch: 18.000, value:  0.400 (weight:entire_model)
[Iteration 2510] [Rank 0] a = 1.017099380493164, b = 0.9995000000416666, delta = 0.3478412926197052, c = 0.0, d = 0.0, m = 1.2127925399651372e-07
[Iteration 2250] [Rank 2] a = 1.1558163166046143, b = 0.9995000000416666, delta = 0.23881907761096954, c = 0.0, d = 0.0, m = 4.7298456571906663e-07
[Iteration 2260] [Rank 2] a = 1.1505626440048218, b = 0.9995000000416666, delta = 0.246072918176651, c = 0.0, d = 0.0, m = 4.70938472717528e-07
[Iteration 2270] [Rank 2] a = 1.0618523359298706, b = 0.9995000000416666, delta = 0.24683894217014313, c = 0.0, d = 0.0, m = 4.6887997795739093e-07
[Iteration 2280] [Rank 2] a = 0.9985610246658325, b = 0.9995000000416666, delta = 0.2452501505613327, c = 0.0, d = 0.0, m = 4.6724841626240485e-07
[Iteration 2290] [Rank 2] a = 0.8420628309249878, b = 0.9995000173132257, delta = 0.21972596645355225, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 4.689331252028903e-07
[Iteration 2300] [Rank 2] a = 1.0566742420196533, b = 0.9995000000416666, delta = 0.25148019194602966, c = 0.0, d = 0.0, m = 4.6689517159488123e-07
[Iteration 2310] [Rank 2] a = 1.0781587362289429, b = 0.9995000000416666, delta = 0.2611320912837982, c = 0.0, d = 0.0, m = 4.6490474949962335e-07
[Iteration 2320] [Rank 2] a = 0.9847003221511841, b = 0.9995000000416666, delta = 0.222288578748703, c = 0.0, d = 0.0, m = 4.6290171309505797e-07
[Iteration 2330] [Rank 2] a = 1.109907627105713, b = 0.9995000000416666, delta = 0.24729415774345398, c = 0.0, d = 0.0, m = 4.6097513882507307e-07
[Iteration 2340] [Rank 2] a = 1.0201770067214966, b = 0.9995000000416666, delta = 0.24959640204906464, c = 0.0, d = 0.0, m = 4.5900600111116845e-07
[Iteration 2350] [Rank 2] a = 1.0213210582733154, b = 0.9995000000416666, delta = 0.21677778661251068, c = 0.0, d = 0.0, m = 4.57465017505128e-07
[Iteration 2360] [Rank 2] a = 1.049516201019287, b = 0.9995000000416666, delta = 0.22595910727977753, c = 0.0, d = 0.0, m = 4.555566888641947e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2362 |     0.10566s |  92.7%
- batch.accumulate               |   2362 |     0.00083s |   0.7%
- batch.backward                 |   2362 |     0.05210s |  45.7%
- batch.evaluate                 |   2362 |     0.00275s |   2.4%
- batch.forward                  |   2362 |     0.02576s |  22.6%
- batch.mom                      |   2362 |     0.00126s |   1.1%
- batch.reduce                   |   2362 |     0.02013s |  17.7%
- batch.reporting.compr_err      |   2362 |     0.00001s |   0.0%
- batch.reporting.lr             |   2362 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2362 |     0.00001s |   0.0%
- batch.step                     |   2362 |     0.00048s |   0.4%
- batch.update_runavg            |   2362 |     0.00130s |   1.1%
- batch.wd                       |   2362 |     0.00001s |   0.0%
- epoch_metrics.collect          |     16 |     0.01672s |   0.1%
- reduce.combine                 |   2362 |     0.00549s |   4.8%
- reduce.flatpack                |   2362 |     0.00002s |   0.0%
- reduce.flatput                 |   2362 |     0.00010s |   0.1%
- reduce.gather.context          |   2362 |     0.00113s |   1.0%
- reduce.gather.tensors          |   2362 |     0.00028s |   0.2%
- reduce.heur_params             |   2362 |     0.01029s |   9.0%
- reduce.heur_params.alpha       |   2361 |     0.00837s |   7.3%
- reduce.heur_params.beta        |   2361 |     0.00185s |   1.6%
- reduce.memory                  |   2362 |     0.00042s |   0.4%
- reduce.pad                     |   2362 |     0.00029s |   0.3%
- reduce.threshold               |   2362 |     0.00191s |   1.7%
- test.last                      |     16 |     0.41516s |   2.8%
- test.runavg                    |     16 |     0.44708s |   3.0%
-----------------------------------------------------------------

[Iteration 2370] [Rank 2] a = 1.1177631616592407, b = 0.9995000000416666, delta = 0.2644016742706299, c = 0.0, d = 0.0, m = 4.5394126869394635e-07
[Iteration 2380] [Rank 2] a = 0.9961219429969788, b = 0.9995000000416666, delta = 0.22023703157901764, c = 0.0, d = 0.0, m = 4.546171460152248e-07
[Iteration 2390] [Rank 2] a = 0.8053916096687317, b = 0.9995000345847849, delta = 0.20895518362522125, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 4.5274467206861483e-07
[Iteration 2400] [Rank 2] a = 1.1200288534164429, b = 0.9995000000416666, delta = 0.26518598198890686, c = 0.0, d = 0.0, m = 4.508590216226814e-07
[Iteration 2410] [Rank 2] a = 1.0689448118209839, b = 0.9995000000416666, delta = 0.24118518829345703, c = 0.0, d = 0.0, m = 4.489890132376848e-07
[Iteration 2420] [Rank 2] a = 1.0359306335449219, b = 0.9995000000416666, delta = 0.24479758739471436, c = 0.0, d = 0.0, m = 4.477622505162462e-07
[Iteration 2430] [Rank 2] a = 1.0149589776992798, b = 0.9995000000416666, delta = 0.2548646330833435, c = 0.0, d = 0.0, m = 4.46545580453972e-07
[Iteration 2440] [Rank 2] a = 1.1536844968795776, b = 0.9995000000416666, delta = 0.25617516040802, c = 0.0, d = 0.0, m = 4.4471622535174355e-07
[Iteration 2450] [Rank 2] a = 1.2931524515151978, b = 0.9995000000416666, delta = 0.28615638613700867, c = 0.0, d = 0.0, m = 4.429017976677299e-07
[Iteration 2460] [Rank 2] a = 1.0362896919250488, b = 0.9995000000416666, delta = 0.22871938347816467, c = 0.0, d = 0.0, m = 4.411021154342162e-07
[Iteration 2470] [Rank 2] a = 0.8452432155609131, b = 0.9995000863994624, delta = 0.2077610343694687, c = 1.7271563451976193e-07, d = 1.7271563451976193e-07, m = 4.39568629044062e-07
[Iteration 2480] [Rank 2] a = 0.9481189250946045, b = 0.9995000000416666, delta = 0.2180626541376114, c = 0.0, d = 0.0, m = 4.380196583628941e-07
[Iteration 2490] [Rank 2] a = 0.8552173376083374, b = 0.9995000000416666, delta = 0.21786032617092133, c = 0.0, d = 0.0, m = 4.3633058532029714e-07
[Iteration 2500] [Rank 2] a = 0.9851473569869995, b = 0.9995000000416666, delta = 0.22462444007396698, c = 0.0, d = 0.0, m = 4.345859608288125e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2501 |     0.10568s |  92.7%
- batch.accumulate               |   2501 |     0.00083s |   0.7%
- batch.backward                 |   2501 |     0.05211s |  45.7%
- batch.evaluate                 |   2501 |     0.00275s |   2.4%
- batch.forward                  |   2501 |     0.02576s |  22.6%
- batch.mom                      |   2501 |     0.00126s |   1.1%
- batch.reduce                   |   2501 |     0.02014s |  17.7%
- batch.reporting.compr_err      |   2501 |     0.00001s |   0.0%
- batch.reporting.lr             |   2501 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   2501 |     0.00001s |   0.0%
- batch.step                     |   2501 |     0.00048s |   0.4%
- batch.update_runavg            |   2501 |     0.00130s |   1.1%
- batch.wd                       |   2501 |     0.00001s |   0.0%
- epoch_metrics.collect          |     17 |     0.01728s |   0.1%
- reduce.combine                 |   2501 |     0.00550s |   4.8%
- reduce.flatpack                |   2501 |     0.00002s |   0.0%
- reduce.flatput                 |   2501 |     0.00009s |   0.1%
- reduce.gather.context          |   2501 |     0.00114s |   1.0%
- reduce.gather.tensors          |   2501 |     0.00028s |   0.2%
- reduce.heur_params             |   2501 |     0.01029s |   9.0%
- reduce.heur_params.alpha       |   2500 |     0.00836s |   7.3%
- reduce.heur_params.beta        |   2500 |     0.00185s |   1.6%
- reduce.memory                  |   2501 |     0.00042s |   0.4%
- reduce.pad                     |   2501 |     0.00029s |   0.3%
- reduce.threshold               |   2501 |     0.00190s |   1.7%
- test.last                      |     17 |     0.41536s |   2.8%
- test.runavg                    |     17 |     0.44717s |   3.0%
-----------------------------------------------------------------

[Iteration 2510] [Rank 2] a = 1.2580294609069824, b = 0.9995000000416666, delta = 0.25225943326950073, c = 0.0, d = 0.0, m = 4.3324042038477527e-07
[Iteration 2520] [Rank 2] a = 0.9546436667442322, b = 0.9995000000416666, delta = 0.22541749477386475, c = 0.0, d = 0.0, m = 4.3152189432216213e-07
[Iteration 2530] [Rank 2] a = 1.193282127380371, b = 0.9995000000416666, delta = 0.27244317531585693, c = 0.0, d = 0.0, m = 4.298442441090393e-07
[Iteration 2520] [Rank 0] a = 1.0288708209991455, b = 0.9995000000416666, delta = 0.42752352356910706, c = 0.0, d = 0.0, m = 1.2079817801874098e-07
[Iteration 2530] [Rank 0] a = 1.1645119190216064, b = 0.9995000000416666, delta = 0.411713182926178, c = 0.0, d = 0.0, m = 1.2032090351056737e-07
[Iteration 2540] [Rank 0] a = 1.004476547241211, b = 0.9995000000416666, delta = 0.3843008875846863, c = 0.0, d = 0.0, m = 1.198473855904156e-07
[Iteration 2550] [Rank 0] a = 0.8917025327682495, b = 0.9995000000416666, delta = 0.34599369764328003, c = 0.0, d = 0.0, m = 1.193775800804571e-07
[Iteration 2560] [Rank 0] a = 1.0313835144042969, b = 0.9995000000416666, delta = 0.3746165931224823, c = 0.0, d = 0.0, m = 1.1891144349287236e-07
[Iteration 2570] [Rank 0] a = 1.1232936382293701, b = 0.9995000000416666, delta = 0.34760409593582153, c = 0.0, d = 0.0, m = 1.1852954708155184e-07
[Iteration 2580] [Rank 0] a = 0.8598511815071106, b = 0.9995000000416666, delta = 0.33053454756736755, c = 0.0, d = 0.0, m = 1.1807030823195264e-07
[Iteration 2590] [Rank 0] a = 0.8946335315704346, b = 0.9995000000416666, delta = 0.35106533765792847, c = 0.0, d = 0.0, m = 1.1761461425961782e-07
[Iteration 2600] [Rank 0] a = 1.0407222509384155, b = 0.9995000000416666, delta = 0.3583112955093384, c = 0.0, d = 0.0, m = 1.1716242427784305e-07
timer                          - epoch: -1.000, value:  0.006 (event:reduce.combine)
[Iteration 2610] [Rank 0] a = 1.1255850791931152, b = 0.9995000000416666, delta = 0.37077900767326355, c = 0.0, d = 0.0, m = 1.1675338756314885e-07
[Iteration 2620] [Rank 0] a = 0.9776740074157715, b = 0.9995000000416666, delta = 0.3502381443977356, c = 0.0, d = 0.0, m = 1.1632111333624022e-07
[Iteration 2630] [Rank 0] a = 0.9190200567245483, b = 0.9995000000416666, delta = 0.34320130944252014, c = 0.0, d = 0.0, m = 1.1594464222303513e-07
[Iteration 2640] [Rank 0] a = 1.1661931276321411, b = 0.9995000000416666, delta = 0.35616767406463623, c = 0.0, d = 0.0, m = 1.1657814846457005e-07
cross_entropy                  - bits:297052480.000, epoch: 19.000, ratio_transmit_grad:  0.038, value:  6.726 (split:train)
last_cross_entropy             - bits:297052480.000, epoch: 19.000, ratio_transmit_grad:  0.038, value:  6.726 (split:train)
perplexity                     - bits:297052480.000, epoch: 19.000, ratio_transmit_grad:  0.038, value:838.023 (split:train)
last_perplexity                - bits:297052480.000, epoch: 19.000, ratio_transmit_grad:  0.038, value:838.023 (split:train)
last_cross_entropy             - bits:297052480.000, epoch: 19.000, ratio_transmit_grad:  0.038, value:  6.358 (split:test)
last_perplexity                - bits:297052480.000, epoch: 19.000, ratio_transmit_grad:  0.038, value:579.069 (split:test)
runavg_cross_entropy           - bits:297052480.000, epoch: 19.000, ratio_transmit_grad:  0.038, value:  6.472 (split:test)
runavg_perplexity              - bits:297052480.000, epoch: 19.000, ratio_transmit_grad:  0.038, value:648.733 (split:test)
timer                          - epoch: 18.000, value:  0.443 (event:test.runavg)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2640 |     0.10576s |  92.7%
- batch.accumulate               |   2640 |     0.00083s |   0.7%
- batch.backward                 |   2640 |     0.05174s |  45.3%
- batch.evaluate                 |   2640 |     0.00275s |   2.4%
- batch.forward                  |   2640 |     0.02551s |  22.4%
- batch.mom                      |   2640 |     0.00126s |   1.1%
- batch.reduce                   |   2640 |     0.02083s |  18.3%
- batch.reporting.compr_err      |   2640 |     0.00001s |   0.0%
- batch.reporting.lr             |   2640 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2640 |     0.00001s |   0.0%
- batch.step                     |   2640 |     0.00048s |   0.4%
- batch.update_runavg            |   2640 |     0.00130s |   1.1%
- batch.wd                       |   2640 |     0.00001s |   0.0%
- epoch_metrics.collect          |     18 |     0.00887s |   0.1%
- reduce.combine                 |   2640 |     0.00554s |   4.9%
- reduce.flatpack                |   2640 |     0.00002s |   0.0%
- reduce.flatput                 |   2640 |     0.00009s |   0.1%
- reduce.gather.context          |   2640 |     0.00144s |   1.3%
- reduce.gather.tensors          |   2640 |     0.00034s |   0.3%
- reduce.heur_params             |   2640 |     0.01062s |   9.3%
- reduce.heur_params.alpha       |   2639 |     0.00872s |   7.6%
- reduce.heur_params.beta        |   2639 |     0.00182s |   1.6%
- reduce.memory                  |   2640 |     0.00042s |   0.4%
- reduce.pad                     |   2640 |     0.00029s |   0.3%
- reduce.threshold               |   2640 |     0.00187s |   1.6%
- test.last                      |     18 |     0.41586s |   2.8%
- test.runavg                    |     18 |     0.44693s |   3.0%
-----------------------------------------------------------------

[Iteration 2650] [Rank 0] a = 1.1026774644851685, b = 0.9995000000416666, delta = 0.331440269947052, c = 0.0, d = 0.0, m = 1.1613839686719332e-07
[Iteration 2660] [Rank 0] a = 1.0708845853805542, b = 0.9995000000416666, delta = 0.3670859634876251, c = 0.0, d = 0.0, m = 1.1570195043026287e-07
[Iteration 2670] [Rank 0] a = 1.136425495147705, b = 0.9995000000416666, delta = 0.3327614367008209, c = 0.0, d = 0.0, m = 1.1533343531615471e-07
[Iteration 2680] [Rank 0] a = 1.1424520015716553, b = 0.9995000000416666, delta = 0.36896905303001404, c = 0.0, d = 0.0, m = 1.1490324719487104e-07
[Iteration 2690] [Rank 0] a = 0.9724274277687073, b = 0.9995000000416666, delta = 0.37171486020088196, c = 0.0, d = 0.0, m = 1.144762563097173e-07
[Iteration 2700] [Rank 0] a = 1.036652684211731, b = 0.9995000000416666, delta = 0.36301401257514954, c = 0.0, d = 0.0, m = 1.1406521616303339e-07
[Iteration 2710] [Rank 0] a = 0.818545401096344, b = 0.9995000863994624, delta = 0.302406907081604, c = 1.7271563451976193e-07, d = 1.7271563451976193e-07, m = 1.1370817576203355e-07
rel_compression_error          - epoch: 19.518, value:  1.000 (weight:encoder.weight)
rel_compression_error          - epoch: 19.518, value:  1.000 (weight:rnn.weight_ih_l0)
rel_compression_error          - epoch: 19.518, value:  1.000 (weight:rnn.weight_hh_l0)
rel_compression_error          - epoch: 19.518, value:  1.000 (weight:rnn.bias_ih_l0)
rel_compression_error          - epoch: 19.518, value:  1.000 (weight:rnn.bias_hh_l0)
rel_compression_error          - epoch: 19.518, value:  1.000 (weight:rnn.weight_ih_l1)
rel_compression_error          - epoch: 19.518, value:  1.000 (weight:rnn.weight_hh_l1)
rel_compression_error          - epoch: 19.518, value:  1.000 (weight:rnn.bias_ih_l1)
rel_compression_error          - epoch: 19.518, value:  1.000 (weight:rnn.bias_hh_l1)
rel_compression_error          - epoch: 19.518, value:  1.000 (weight:rnn.weight_ih_l2)
rel_compression_error          - epoch: 19.518, value:  1.000 (weight:rnn.weight_hh_l2)
rel_compression_error          - epoch: 19.518, value:  1.000 (weight:rnn.bias_ih_l2)
rel_compression_error          - epoch: 19.518, value:  1.000 (weight:rnn.bias_hh_l2)
rel_compression_error          - epoch: 19.518, value:  1.000 (weight:decoder.bias)
rel_compression_error          - epoch: 19.518, value:  1.000 (weight:entire_model)
[Iteration 2720] [Rank 0] a = 0.9672839641571045, b = 0.9995000000416666, delta = 0.3161974549293518, c = 0.0, d = 0.0, m = 1.1329028463464643e-07
timer                          - epoch: 19.612, value:  0.001 (event:batch.accumulate)
[Iteration 2730] [Rank 0] a = 1.0795787572860718, b = 0.9995000000416666, delta = 0.36666253209114075, c = 0.0, d = 0.0, m = 1.1287545385971181e-07
[Iteration 2740] [Rank 0] a = 0.9943655729293823, b = 0.9995000000416666, delta = 0.3433980941772461, c = 0.0, d = 0.0, m = 1.1246364994194561e-07
[Iteration 2750] [Rank 0] a = 0.8396205902099609, b = 0.999500172757258, delta = 0.29057472944259644, c = 3.4543126903952387e-07, d = 3.4543126903952387e-07, m = 1.1219296215442255e-07
[Iteration 2760] [Rank 0] a = 1.0443331003189087, b = 0.9995000000416666, delta = 0.35973575711250305, c = 0.0, d = 0.0, m = 1.1178661314263543e-07

[Iteration 2510] [Rank 3] a = 0.8285635709762573, b = 0.9995700707594138, delta = 0.04315810650587082, c = 0.00014014146584933484, d = 0.0001534405697073565, m = 5.147407393930497e-06
[Iteration 2520] [Rank 3] a = 0.9560442566871643, b = 0.9995001382141396, delta = 0.047402478754520416, c = 2.763450152316191e-07, d = 2.763450152316191e-07, m = 5.127825107854272e-06
[Iteration 2530] [Rank 3] a = 0.8465395569801331, b = 0.9995021935296793, delta = 0.04401238262653351, c = 4.386977116801953e-06, d = 4.49060649751381e-06, m = 5.111686733001032e-06
[Iteration 2540] [Rank 3] a = 0.9143063426017761, b = 0.9995070295662587, delta = 0.0434487909078598, c = 1.4059052649908622e-05, d = 1.447357017275605e-05, m = 5.098271894053231e-06
[Iteration 2550] [Rank 3] a = 0.9616085886955261, b = 0.9995000863994624, delta = 0.04874608293175697, c = 1.7271563451976193e-07, d = 1.7271563451976193e-07, m = 5.079098969189924e-06

[Iteration 2510] [Rank 1] a = 1.003711462020874, b = 0.9995074613552404, delta = 0.010294493287801743, c = 1.492263082250743e-05, d = 1.58898383758181e-05, m = 3.963651165377629e-05
[Iteration 2520] [Rank 1] a = 1.006343126296997, b = 0.9995021589865609, delta = 0.010804289020597935, c = 4.317890862994048e-06, d = 4.421520243705905e-06, m = 3.959471323430034e-05
[Iteration 2530] [Rank 1] a = 1.0160071849822998, b = 0.9995012781370434, delta = 0.01061844453215599, c = 2.5561913908924768e-06, d = 2.5561913908924768e-06, m = 3.968638149650656e-05
[Iteration 2540] [Rank 1] a = 1.1592061519622803, b = 0.9995006736324731, delta = 0.010891684330999851, c = 1.347181949254143e-06, d = 1.347181949254143e-06, m = 4.020648683387482e-05
[Iteration 2550] [Rank 1] a = 0.9539068341255188, b = 0.999503765241565, delta = 0.010315882973372936, c = 7.53040166506162e-06, d = 7.703117299581382e-06, m = 4.0078937195845816e-05
[Iteration 2560] [Rank 3] a = 0.9642142653465271, b = 0.9995021244434424, delta = 0.04492035135626793, c = 4.248804609186144e-06, d = 4.317890862994048e-06, m = 5.064931504764997e-06
[Iteration 2570] [Rank 3] a = 1.1053045988082886, b = 0.9995000173132257, delta = 0.049418505281209946, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 5.671293530939956e-06
[Iteration 2580] [Rank 3] a = 1.0852470397949219, b = 0.9995000000416666, delta = 0.04875601828098297, c = 0.0, d = 0.0, m = 5.653870721113511e-06
[Iteration 2590] [Rank 3] a = 0.914246678352356, b = 0.9995276863513348, delta = 0.040986184030771255, c = 5.537263242703568e-05, d = 7.043343575715892e-05, m = 5.660046660629977e-06
[Iteration 2600] [Rank 3] a = 1.0535025596618652, b = 0.9995001209425806, delta = 0.04314300790429115, c = 2.4180188832766673e-07, d = 2.4180188832766673e-07, m = 5.932533032439923e-06
[Iteration 2560] [Rank 1] a = 1.1526720523834229, b = 0.9995004663737636, delta = 0.01025866623967886, c = 9.326644264067144e-07, d = 9.326644264067144e-07, m = 4.086531492764411e-05
[Iteration 2570] [Rank 1] a = 0.9846049547195435, b = 0.9998746029403673, delta = 0.00861621368676424, c = 0.0007492058794198233, d = 0.0007549400384858794, m = 4.140542606865393e-05
[Iteration 2580] [Rank 1] a = 0.9335653781890869, b = 0.9995147672248343, delta = 0.008982201106846333, c = 2.953437350287929e-05, d = 3.012160666024648e-05, m = 4.128420272809411e-05
[Iteration 2590] [Rank 1] a = 1.0757925510406494, b = 0.9995008808911828, delta = 0.009068803861737251, c = 1.7616994721015717e-06, d = 1.7616994721015717e-06, m = 4.165071856259494e-05
[Iteration 2600] [Rank 1] a = 1.1090185642242432, b = 0.9995018135553773, delta = 0.009116638451814651, c = 3.6270283249150006e-06, d = 3.661571451818953e-06, m = 4.2130223920322386e-05
[Iteration 2610] [Rank 3] a = 0.9221556782722473, b = 0.9995000000416666, delta = 0.04392120614647865, c = 0.0, d = 0.0, m = 5.933691597639936e-06
[Iteration 2620] [Rank 3] a = 1.0585662126541138, b = 0.9995000345847849, delta = 0.04697079584002495, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 5.9120146545981945e-06
[Iteration 2630] [Rank 3] a = 1.0026146173477173, b = 0.9995000345847849, delta = 0.04522765055298805, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 5.895110868684584e-06
[Iteration 2640] [Rank 3] a = 0.9971756935119629, b = 0.9995002418434945, delta = 0.04243398830294609, c = 4.836037766553335e-07, d = 4.836037766553335e-07, m = 5.8822982009724775e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2640 |     0.10597s |  92.9%
- batch.accumulate               |   2640 |     0.00082s |   0.7%
[Iteration 2610] [Rank 1] a = 1.046735167503357, b = 0.9995012954086027, delta = 0.009202586486935616, c = 2.590734517796429e-06, d = 2.590734517796429e-06, m = 4.2249763342467735e-05
[Iteration 2620] [Rank 1] a = 1.1012153625488281, b = 0.9995007427187096, delta = 0.008764563128352165, c = 1.4853544568699526e-06, d = 1.4853544568699526e-06, m = 4.2767725487522975e-05
[Iteration 2630] [Rank 1] a = 0.9507725238800049, b = 1.0009807599065306, delta = 0.007642031647264957, c = 0.0029615204419834538, d = 0.002890914290591775, m = 4.3804663085040986e-05
[Iteration 2640] [Rank 1] a = 1.1568875312805176, b = 0.9995024353315076, delta = 0.006702996790409088, c = 4.8705808934572865e-06, d = 4.8705808934572865e-06, m = 5.546059249081048e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2640 |     0.10588s |  92.8%
- batch.accumulate               |   2640 |     0.00083s |   0.7%
- batch.backward                 |   2640 |     0.05170s |  45.3%
- batch.evaluate                 |   2640 |     0.00277s |   2.4%
- batch.forward                  |   2640 |     0.02538s |  22.2%
- batch.mom                      |   2640 |     0.00126s |   1.1%
- batch.reduce                   |   2640 |     0.02125s |  18.6%
- batch.reporting.compr_err      |   2640 |     0.00001s |   0.0%
- batch.reporting.lr             |   2640 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2640 |     0.00001s |   0.0%
- batch.step                     |   2640 |     0.00047s |   0.4%
- batch.update_runavg            |   2640 |     0.00129s |   1.1%
- batch.wd                       |   2640 |     0.00001s |   0.0%
- epoch_metrics.collect          |     18 |     0.01075s |   0.1%
- reduce.combine                 |   2640 |     0.00526s |   4.6%
- reduce.flatpack                |   2640 |     0.00002s |   0.0%
- reduce.flatput                 |   2640 |     0.00010s |   0.1%
- batch.backward                 |   2640 |     0.05171s |  45.3%
- batch.evaluate                 |   2640 |     0.00277s |   2.4%
- batch.forward                  |   2640 |     0.02541s |  22.3%
- batch.mom                      |   2640 |     0.00126s |   1.1%
- batch.reduce                   |   2640 |     0.02110s |  18.5%
- batch.reporting.compr_err      |   2640 |     0.00001s |   0.0%
- batch.reporting.lr             |   2640 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   2640 |     0.00001s |   0.0%
- batch.step                     |   2640 |     0.00048s |   0.4%
- batch.update_runavg            |   2640 |     0.00129s |   1.1%
- batch.wd                       |   2640 |     0.00001s |   0.0%
- epoch_metrics.collect          |     18 |     0.01229s |   0.1%
- reduce.combine                 |   2640 |     0.00529s |   4.6%
- reduce.flatpack                |   2640 |     0.00002s |   0.0%
- reduce.flatput                 |   2640 |     0.00018s |   0.2%
- reduce.gather.context          |   2640 |     0.00268s |   2.3%
- reduce.gather.tensors          |   2640 |     0.00034s |   0.3%
- reduce.heur_params             |   2640 |     0.01003s |   8.8%
- reduce.heur_params.alpha       |   2639 |     0.00808s |   7.1%
- reduce.heur_params.beta        |   2639 |     0.00188s |   1.6%
- reduce.gather.context          |   2640 |     0.00133s |   1.2%
- reduce.gather.tensors          |   2640 |     0.00047s |   0.4%
- reduce.heur_params             |   2640 |     0.01061s |   9.3%
- reduce.memory                  |   2640 |     0.00041s |   0.4%
- reduce.pad                     |   2640 |     0.00027s |   0.2%
- reduce.threshold               |   2640 |     0.00195s |   1.7%
- test.last                      |     18 |     0.41587s |   2.8%
- test.runavg                    |     18 |     0.44691s |   3.0%
-----------------------------------------------------------------

[Iteration 2650] [Rank 3] a = 0.911031186580658, b = 0.9995037134268874, delta = 0.04220274090766907, c = 7.426772284349763e-06, d = 7.495858538157668e-06, m = 5.863887987767055e-06
[Iteration 2660] [Rank 3] a = 1.1341325044631958, b = 0.9995000173132257, delta = 0.04440688714385033, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 6.156971612613267e-06
[Iteration 2670] [Rank 3] a = 1.0020619630813599, b = 0.9995000345847849, delta = 0.047951195389032364, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 6.13445066618007e-06
- reduce.heur_params.alpha       |   2639 |     0.00823s |   7.2%
- reduce.heur_params.beta        |   2639 |     0.00230s |   2.0%
- reduce.memory                  |   2640 |     0.00044s |   0.4%
- reduce.pad                     |   2640 |     0.00014s |   0.1%
- reduce.threshold               |   2640 |     0.00243s |   2.1%
- test.last                      |     18 |     0.41587s |   2.8%
- test.runavg                    |     18 |     0.44691s |   3.0%
-----------------------------------------------------------------

[Iteration 2650] [Rank 1] a = 0.938474178314209, b = 0.9995874632207234, delta = 0.005677950102835894, c = 0.00017492639464161488, d = 0.00018031512243863146, m = 5.674094940150233e-05
[Iteration 2660] [Rank 1] a = 0.9508614540100098, b = 0.9995545090837253, delta = 0.005741372238844633, c = 0.00010901810850887373, d = 0.0001099162298083765, m = 5.816679623521617e-05
[Iteration 2680] [Rank 3] a = 0.9268077611923218, b = 0.9995058896433486, delta = 0.04195106402039528, c = 1.1779206274247764e-05, d = 1.1848292528055668e-05, m = 6.118217822771134e-06
[Iteration 2690] [Rank 3] a = 0.9338938593864441, b = 0.9995000518563442, delta = 0.048852499574422836, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 6.097831057254862e-06
[Iteration 2700] [Rank 3] a = 0.9438962936401367, b = 0.9995003627444087, delta = 0.04391258955001831, c = 7.254056649830001e-07, d = 7.254056649830001e-07, m = 6.085025666059776e-06
[Iteration 2710] [Rank 3] a = 0.7845478653907776, b = 0.9995183597091928, delta = 0.04068225622177124, c = 3.6719343898901386e-05, d = 3.713386142174882e-05, m = 6.0795011422190725e-06
[Iteration 2720] [Rank 3] a = 1.0538594722747803, b = 0.9995000000416666, delta = 0.04530775547027588, c = 0.0, d = 0.0, m = 6.0584531405733595e-06
[Iteration 2670] [Rank 1] a = 0.8461155891418457, b = 1.0105644095490613, delta = 0.004717571660876274, c = 0.022129605190367344, d = 0.02002876129832277, m = 6.828638190379306e-05
[Iteration 2680] [Rank 1] a = 0.9703675508499146, b = 0.999566340102404, delta = 0.004397426266223192, c = 0.0001326801504380811, d = 0.0001374816450777305, m = 7.407820592681356e-05
[Iteration 2690] [Rank 1] a = 0.9701375365257263, b = 0.9995301043696815, delta = 0.0043017808347940445, c = 6.020867019358901e-05, d = 6.1003162112379915e-05, m = 7.882677376786102e-05
[Iteration 2700] [Rank 1] a = 0.8935641050338745, b = 0.9996470501058863, delta = 0.004188319202512503, c = 0.0002941001824602506, d = 0.0003000070571608265, m = 7.885390164288245e-05
[Iteration 2710] [Rank 1] a = 1.08113694190979, b = 0.9995029707498422, delta = 0.0042618149891495705, c = 5.94141782747981e-06, d = 6.114133461999572e-06, m = 8.321694107952286e-05
[Iteration 2730] [Rank 3] a = 0.9896535277366638, b = 0.9995002763866128, delta = 0.04935145750641823, c = 5.526900304632381e-07, d = 5.526900304632381e-07, m = 6.038204355150649e-06
[Iteration 2740] [Rank 3] a = 1.059631586074829, b = 0.9995001900288173, delta = 0.04636615514755249, c = 3.7997439594347627e-07, d = 3.7997439594347627e-07, m = 6.026357876853271e-06
[Iteration 2750] [Rank 3] a = 1.0260684490203857, b = 0.9995000173132257, delta = 0.051478274166584015, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 6.005770254009353e-06
[Iteration 2760] [Rank 3] a = 1.0392851829528809, b = 0.9995000518563442, delta = 0.045609839260578156, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 6.00417346838899e-06
[Iteration 2770] [Rank 3] a = 0.9346615672111511, b = 0.999501209050807, delta = 0.04652655869722366, c = 2.418018883276667e-06, d = 2.4525620101806193e-06, m = 5.984387931571454e-06
--- Timer summary -----------------------------------------------
[Iteration 2720] [Rank 1] a = 0.9752798676490784, b = 0.9995077895148663, delta = 0.004417350050061941, c = 1.5578950233682527e-05, d = 1.564803648749043e-05, m = 8.433448629113729e-05
[Iteration 2730] [Rank 1] a = 1.0240530967712402, b = 0.9995068050359885, delta = 0.003967517055571079, c = 1.360999200015724e-05, d = 1.3644535127061193e-05, m = 9.334985967543238e-05
[Iteration 2740] [Rank 1] a = 1.0206857919692993, b = 0.9995386710632964, delta = 0.0039724549278616905, c = 7.734206113794939e-05, d = 7.779112178770077e-05, m = 9.327005952407968e-05
[Iteration 2750] [Rank 1] a = 1.0705763101577759, b = 0.9995030398360788, delta = 0.004080334212630987, c = 6.07959033509562e-06, d = 6.07959033509562e-06, m = 9.401394787066772e-05
[Iteration 2760] [Rank 1] a = 0.9605512022972107, b = 0.9998458976024724, delta = 0.0035639952402561903, c = 0.0006917952025054544, d = 0.0006978057065867422, m = 9.42575714031965e-05
  Event                          |  Count | Average time |  Frac.
- batch                          |   2779 |     0.10611s |  92.8%
- batch.accumulate               |   2779 |     0.00082s |   0.7%
- batch.backward                 |   2779 |     0.05169s |  45.2%
- batch.evaluate                 |   2779 |     0.00277s |   2.4%
- batch.forward                  |   2779 |     0.02538s |  22.2%
- batch.mom                      |   2779 |     0.00126s |   1.1%
- batch.reduce                   |   2779 |     0.02139s |  18.7%
- batch.reporting.compr_err      |   2779 |     0.00001s |   0.0%
- batch.reporting.lr             |   2779 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2779 |     0.00001s |   0.0%
- batch.step                     |   2779 |     0.00047s |   0.4%
- batch.update_runavg            |   2779 |     0.00129s |   1.1%
- batch.wd                       |   2779 |     0.00001s |   0.0%
- epoch_metrics.collect          |     19 |     0.01028s |   0.1%
[Iteration 2770] [Rank 1] a = 1.024369716644287, b = 0.9995189123990952, delta = 0.0036449444014579058, c = 3.7824723959827866e-05, d = 3.83774139902911e-05, m = 9.474762100677548e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2779 |     0.10602s |  92.8%
- batch.accumulate               |   2779 |     0.00083s |   0.7%
- batch.backward                 |   2779 |     0.05171s |  45.3%
- batch.evaluate                 |   2779 |     0.00277s |   2.4%
- batch.forward                  |   2779 |     0.02541s |  22.2%
- batch.mom                      |   2779 |     0.00126s |   1.1%
- batch.reduce                   |   2779 |     0.02124s |  18.6%
- batch.reporting.compr_err      |   2779 |     0.00001s |   0.0%
- batch.reporting.lr             |   2779 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   2779 |     0.00001s |   0.0%
- reduce.combine                 |   2779 |     0.00527s |   4.6%
- reduce.flatpack                |   2779 |     0.00002s |   0.0%
- reduce.flatput                 |   2779 |     0.00010s |   0.1%
- reduce.gather.context          |   2779 |     0.00269s |   2.4%
- batch.step                     |   2779 |     0.00048s |   0.4%
- batch.update_runavg            |   2779 |     0.00129s |   1.1%
- batch.wd                       |   2779 |     0.00001s |   0.0%
- epoch_metrics.collect          |     19 |     0.01173s |   0.1%
- reduce.combine                 |   2779 |     0.00530s |   4.6%
- reduce.gather.tensors          |   2779 |     0.00044s |   0.4%
- reduce.heur_params             |   2779 |     0.01004s |   8.8%
- reduce.heur_params.alpha       |   2778 |     0.00808s |   7.1%
- reduce.heur_params.beta        |   2778 |     0.00189s |   1.7%
- reduce.memory                  |   2779 |     0.00041s |   0.4%
- reduce.pad                     |   2779 |     0.00027s |   0.2%
- reduce.threshold               |   2779 |     0.00196s |   1.7%
- test.last                      |     19 |     0.41613s |   2.8%
- test.runavg                    |     19 |     0.44699s |   3.0%
-----------------------------------------------------------------
- reduce.flatpack                |   2779 |     0.00002s |   0.0%
- reduce.flatput                 |   2779 |     0.00018s |   0.2%
- reduce.gather.context          |   2779 |     0.00132s |   1.2%
- reduce.gather.tensors          |   2779 |     0.00058s |   0.5%
- reduce.heur_params             |   2779 |     0.01063s |   9.3%
- reduce.heur_params.alpha       |   2778 |     0.00823s |   7.2%
- reduce.heur_params.beta        |   2778 |     0.00231s |   2.0%
- reduce.memory                  |   2779 |     0.00044s |   0.4%
- reduce.pad                     |   2779 |     0.00014s |   0.1%
- reduce.threshold               |   2779 |     0.00244s |   2.1%
- test.last                      |     19 |     0.41613s |   2.8%
- test.runavg                    |     19 |     0.44699s |   3.0%
-----------------------------------------------------------------
[Iteration 2540] [Rank 2] a = 1.0481531620025635, b = 0.9995000000416666, delta = 0.23123164474964142, c = 0.0, d = 0.0, m = 4.289682681834772e-07
[Iteration 2550] [Rank 2] a = 0.9474928379058838, b = 0.9995000000416666, delta = 0.23210564255714417, c = 0.0, d = 0.0, m = 4.2728669911964547e-07
[Iteration 2560] [Rank 2] a = 1.1109510660171509, b = 0.9995000000416666, delta = 0.2184177190065384, c = 0.0, d = 0.0, m = 4.3218698643359646e-07
[Iteration 2570] [Rank 2] a = 0.9905280470848083, b = 0.9995000000416666, delta = 0.20285899937152863, c = 0.0, d = 0.0, m = 4.3058659316136303e-07
[Iteration 2580] [Rank 2] a = 1.0048764944076538, b = 0.9995000000416666, delta = 0.21077178418636322, c = 0.0, d = 0.0, m = 4.289316831246681e-07
[Iteration 2590] [Rank 2] a = 1.054692029953003, b = 0.9995000000416666, delta = 0.22638282179832458, c = 0.0, d = 0.0, m = 4.273028793510522e-07
[Iteration 2600] [Rank 2] a = 1.1525224447250366, b = 0.9995000000416666, delta = 0.22456583380699158, c = 0.0, d = 0.0, m = 4.2678889895632915e-07
[Iteration 2610] [Rank 2] a = 1.0385677814483643, b = 0.9995000000416666, delta = 0.22054998576641083, c = 0.0, d = 0.0, m = 4.2527338733341546e-07
[Iteration 2620] [Rank 2] a = 0.9739624857902527, b = 0.9995000000416666, delta = 0.21765504777431488, c = 0.0, d = 0.0, m = 4.2597039475873463e-07
[Iteration 2630] [Rank 2] a = 1.0801752805709839, b = 0.9995000000416666, delta = 0.22175432741641998, c = 0.0, d = 0.0, m = 4.24430126729026e-07
[Iteration 2640] [Rank 2] a = 1.0976719856262207, b = 0.9995000000416666, delta = 0.21092155575752258, c = 0.0, d = 0.0, m = 4.228753638514514e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2640 |     0.10574s |  92.7%
- batch.accumulate               |   2640 |     0.00083s |   0.7%
- batch.backward                 |   2640 |     0.05212s |  45.7%
- batch.evaluate                 |   2640 |     0.00275s |   2.4%
- batch.forward                  |   2640 |     0.02576s |  22.6%
- batch.mom                      |   2640 |     0.00126s |   1.1%
- batch.reduce                   |   2640 |     0.02020s |  17.7%
- batch.reporting.compr_err      |   2640 |     0.00001s |   0.0%
- batch.reporting.lr             |   2640 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2640 |     0.00001s |   0.0%
- batch.step                     |   2640 |     0.00048s |   0.4%
- batch.update_runavg            |   2640 |     0.00130s |   1.1%
- batch.wd                       |   2640 |     0.00001s |   0.0%
- epoch_metrics.collect          |     18 |     0.01639s |   0.1%
- reduce.combine                 |   2640 |     0.00551s |   4.8%
- reduce.flatpack                |   2640 |     0.00002s |   0.0%
- reduce.flatput                 |   2640 |     0.00009s |   0.1%
- reduce.gather.context          |   2640 |     0.00114s |   1.0%
- reduce.gather.tensors          |   2640 |     0.00033s |   0.3%
- reduce.heur_params             |   2640 |     0.01029s |   9.0%
- reduce.heur_params.alpha       |   2639 |     0.00836s |   7.3%
- reduce.heur_params.beta        |   2639 |     0.00185s |   1.6%
- reduce.memory                  |   2640 |     0.00042s |   0.4%
- reduce.pad                     |   2640 |     0.00029s |   0.3%
- reduce.threshold               |   2640 |     0.00190s |   1.7%
- test.last                      |     18 |     0.41588s |   2.8%
- test.runavg                    |     18 |     0.44692s |   3.0%
-----------------------------------------------------------------

[Iteration 2650] [Rank 2] a = 0.9902086853981018, b = 0.9995000000416666, delta = 0.2043459713459015, c = 0.0, d = 0.0, m = 4.2131930038189176e-07
[Iteration 2660] [Rank 2] a = 0.8691840171813965, b = 0.9995000000416666, delta = 0.186348557472229, c = 0.0, d = 0.0, m = 4.20956226697244e-07
[Iteration 2670] [Rank 2] a = 0.9813897013664246, b = 0.9995002418434945, delta = 0.17964959144592285, c = 4.836037766553335e-07, d = 4.836037766553335e-07, m = 4.1965178768489305e-07
[Iteration 2680] [Rank 2] a = 1.068535566329956, b = 0.9995000000416666, delta = 0.21379102766513824, c = 0.0, d = 0.0, m = 4.200835917853271e-07
[Iteration 2690] [Rank 2] a = 1.0322151184082031, b = 0.9995000000416666, delta = 0.19636155664920807, c = 0.0, d = 0.0, m = 4.1852252306817616e-07
[Iteration 2700] [Rank 2] a = 1.081632137298584, b = 0.9995000000416666, delta = 0.20645692944526672, c = 0.0, d = 0.0, m = 4.169730135418223e-07
[Iteration 2710] [Rank 2] a = 0.782577633857727, b = 0.9995076686139516, delta = 0.16577111184597015, c = 1.533714834535486e-05, d = 1.5578950233682527e-05, m = 4.237935820086517e-07
[Iteration 2720] [Rank 2] a = 0.9561613202095032, b = 0.9995000000416666, delta = 0.19227364659309387, c = 0.0, d = 0.0, m = 4.2226147999972894e-07
[Iteration 2730] [Rank 2] a = 0.9628282189369202, b = 0.9995000000416666, delta = 0.21597820520401, c = 0.0, d = 0.0, m = 4.224860947805989e-07
[Iteration 2740] [Rank 2] a = 0.9484211802482605, b = 0.9995000000416666, delta = 0.18774719536304474, c = 0.0, d = 0.0, m = 4.33030420848853e-07
[Iteration 2750] [Rank 2] a = 1.0158588886260986, b = 0.9995000000416666, delta = 0.1915869116783142, c = 0.0, d = 0.0, m = 4.3148145030916535e-07
[Iteration 2760] [Rank 2] a = 0.9209635853767395, b = 0.9995000173132257, delta = 0.1712270826101303, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 4.29993744499072e-07
[Iteration 2770] [Rank 2] a = 0.9367149472236633, b = 0.9995000345847849, delta = 0.16177034378051758, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 4.286788336243641e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2779 |     0.10589s |  92.7%
- batch.accumulate               |   2779 |     0.00083s |   0.7%
- batch.backward                 |   2779 |     0.05212s |  45.6%
- batch.evaluate                 |   2779 |     0.00275s |   2.4%
- batch.forward                  |   2779 |     0.02576s |  22.5%
- batch.mom                      |   2779 |     0.00126s |   1.1%
- batch.reduce                   |   2779 |     0.02034s |  17.8%
- batch.reporting.compr_err      |   2779 |     0.00001s |   0.0%
- batch.reporting.lr             |   2779 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2779 |     0.00001s |   0.0%
- batch.step                     |   2779 |     0.00048s |   0.4%
- batch.update_runavg            |   2779 |     0.00130s |   1.1%
- batch.wd                       |   2779 |     0.00001s |   0.0%
- epoch_metrics.collect          |     19 |     0.01567s |   0.1%
- reduce.combine                 |   2779 |     0.00552s |   4.8%
- reduce.flatpack                |   2779 |     0.00002s |   0.0%
- reduce.flatput                 |   2779 |     0.00009s |   0.1%
- reduce.gather.context          |   2779 |     0.00116s |   1.0%
- reduce.gather.tensors          |   2779 |     0.00044s |   0.4%
- reduce.heur_params             |   2779 |     0.01029s |   9.0%
- reduce.heur_params.alpha       |   2778 |     0.00836s |   7.3%
- reduce.heur_params.beta        |   2778 |     0.00185s |   1.6%
- reduce.memory                  |   2779 |     0.00042s |   0.4%
- reduce.pad                     |   2779 |     0.00029s |   0.3%
- reduce.threshold               |   2779 |     0.00190s |   1.7%
- test.last                      |     19 |     0.41614s |   2.8%
- test.runavg                    |     19 |     0.44700s |   3.0%
-----------------------------------------------------------------

[Iteration 2780] [Rank 2] a = 1.07295560836792, b = 0.9995000000416666, delta = 0.2094631940126419, c = 0.0, d = 0.0, m = 4.271373779119428e-07
[Iteration 2790] [Rank 2] a = 1.0024279356002808, b = 0.9995000000416666, delta = 0.16710418462753296, c = 0.0, d = 0.0, m = 4.2618866891350726e-07
[Iteration 2800] [Rank 2] a = 0.9465600848197937, b = 0.9995000000416666, delta = 0.19717612862586975, c = 0.0, d = 0.0, m = 4.246671099384501e-07
[Iteration 2810] [Rank 2] a = 0.9685764908790588, b = 0.9995000000416666, delta = 0.17261859774589539, c = 0.0, d = 0.0, m = 4.2316866526663207e-07
[Iteration 2770] [Rank 0] a = 0.9996063113212585, b = 0.9995000000416666, delta = 0.33778855204582214, c = 0.0, d = 0.0, m = 1.1138319699993376e-07
cross_entropy                  - bits:514663296.000, epoch: 20.000, ratio_transmit_grad:  0.084, value:  6.600 (split:train)
last_cross_entropy             - bits:514663296.000, epoch: 20.000, ratio_transmit_grad:  0.084, value:  6.600 (split:train)
perplexity                     - bits:514663296.000, epoch: 20.000, ratio_transmit_grad:  0.084, value:737.720 (split:train)
last_perplexity                - bits:514663296.000, epoch: 20.000, ratio_transmit_grad:  0.084, value:737.720 (split:train)
last_cross_entropy             - bits:514663296.000, epoch: 20.000, ratio_transmit_grad:  0.084, value:  6.281 (split:test)
last_perplexity                - bits:514663296.000, epoch: 20.000, ratio_transmit_grad:  0.084, value:535.844 (split:test)
runavg_cross_entropy           - bits:514663296.000, epoch: 20.000, ratio_transmit_grad:  0.084, value:  6.377 (split:test)
runavg_perplexity              - bits:514663296.000, epoch: 20.000, ratio_transmit_grad:  0.084, value:590.092 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2779 |     0.10589s |  92.7%
- batch.accumulate               |   2779 |     0.00083s |   0.7%
- batch.backward                 |   2779 |     0.05174s |  45.3%
- batch.evaluate                 |   2779 |     0.00275s |   2.4%
- batch.forward                  |   2779 |     0.02551s |  22.3%
- batch.mom                      |   2779 |     0.00126s |   1.1%
- batch.reduce                   |   2779 |     0.02095s |  18.3%
- batch.reporting.compr_err      |   2779 |     0.00001s |   0.0%
- batch.reporting.lr             |   2779 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2779 |     0.00001s |   0.0%
- batch.step                     |   2779 |     0.00048s |   0.4%
- batch.update_runavg            |   2779 |     0.00130s |   1.1%
- batch.wd                       |   2779 |     0.00001s |   0.0%
- epoch_metrics.collect          |     19 |     0.00844s |   0.1%
- reduce.combine                 |   2779 |     0.00555s |   4.9%
- reduce.flatpack                |   2779 |     0.00002s |   0.0%
- reduce.flatput                 |   2779 |     0.00009s |   0.1%
- reduce.gather.context          |   2779 |     0.00143s |   1.3%
- reduce.gather.tensors          |   2779 |     0.00045s |   0.4%
- reduce.heur_params             |   2779 |     0.01062s |   9.3%
- reduce.heur_params.alpha       |   2778 |     0.00873s |   7.6%
- reduce.heur_params.beta        |   2778 |     0.00182s |   1.6%
- reduce.memory                  |   2779 |     0.00042s |   0.4%
- reduce.pad                     |   2779 |     0.00029s |   0.3%
- reduce.threshold               |   2779 |     0.00187s |   1.6%
- test.last                      |     19 |     0.41612s |   2.8%
- test.runavg                    |     19 |     0.44701s |   3.0%
-----------------------------------------------------------------

[Iteration 2780] [Rank 0] a = 0.854785680770874, b = 0.9995000000416666, delta = 0.29408973455429077, c = 0.0, d = 0.0, m = 1.1236142609606442e-07
[Iteration 2790] [Rank 0] a = 0.8703751564025879, b = 0.9995000000416666, delta = 0.3050301671028137, c = 0.0, d = 0.0, m = 1.1195884126591012e-07
[Iteration 2800] [Rank 0] a = 1.0782667398452759, b = 0.9995000000416666, delta = 0.34445008635520935, c = 0.0, d = 0.0, m = 1.1171945256083774e-07
[Iteration 2810] [Rank 0] a = 0.9472699165344238, b = 0.9995000000416666, delta = 0.32980671525001526, c = 0.0, d = 0.0, m = 1.1132201587438865e-07
[Iteration 2820] [Rank 0] a = 1.0762007236480713, b = 0.9995000000416666, delta = 0.3503533601760864, c = 0.0, d = 0.0, m = 1.1092739688865881e-07
[Iteration 2830] [Rank 0] a = 1.0524977445602417, b = 0.9995000000416666, delta = 0.345223605632782, c = 0.0, d = 0.0, m = 1.105843727059422e-07
[Iteration 2840] [Rank 0] a = 1.1197996139526367, b = 0.9995000000416666, delta = 0.35997769236564636, c = 0.0, d = 0.0, m = 1.1019512816984243e-07
[Iteration 2850] [Rank 0] a = 1.062260627746582, b = 0.9995000000416666, delta = 0.34385812282562256, c = 0.0, d = 0.0, m = 1.1298304397732652e-07
[Iteration 2860] [Rank 0] a = 0.8519424200057983, b = 0.9995000000416666, delta = 0.32280081510543823, c = 0.0, d = 0.0, m = 1.1258813644856969e-07
[Iteration 2870] [Rank 0] a = 0.9140120148658752, b = 0.9995000000416666, delta = 0.30384936928749084, c = 0.0, d = 0.0, m = 1.1219597993011421e-07
[Iteration 2880] [Rank 0] a = 0.7529394030570984, b = 0.9995000000416666, delta = 0.27102425694465637, c = 0.0, d = 0.0, m = 1.1180654577554942e-07
[Iteration 2890] [Rank 0] a = 0.9221737384796143, b = 0.9995000000416666, delta = 0.33154982328414917, c = 0.0, d = 0.0, m = 1.1141980573481767e-07
[Iteration 2900] [Rank 0] a = 0.8522023558616638, b = 0.9995000000416666, delta = 0.2902677655220032, c = 0.0, d = 0.0, m = 1.1122624902096557e-07
timer                          - epoch: 20.928, value:  0.000 (event:batch.wd)
[Iteration 2910] [Rank 0] a = 1.0342351198196411, b = 0.9995000000416666, delta = 0.306633323431015, c = 0.0, d = 0.0, m = 1.108441595361804e-07
cross_entropy                  - bits:548784448.000, epoch: 21.000, ratio_transmit_grad:  0.013, value:  6.548 (split:train)
last_cross_entropy             - bits:548784448.000, epoch: 21.000, ratio_transmit_grad:  0.013, value:  6.548 (split:train)
perplexity                     - bits:548784448.000, epoch: 21.000, ratio_transmit_grad:  0.013, value:700.162 (split:train)
last_perplexity                - bits:548784448.000, epoch: 21.000, ratio_transmit_grad:  0.013, value:700.162 (split:train)
last_cross_entropy             - bits:548784448.000, epoch: 21.000, ratio_transmit_grad:  0.013, value:  6.225 (split:test)
last_perplexity                - bits:548784448.000, epoch: 21.000, ratio_transmit_grad:  0.013, value:506.609 (split:test)
runavg_cross_entropy           - bits:548784448.000, epoch: 21.000, ratio_transmit_grad:  0.013, value:  6.312 (split:test)
runavg_perplexity              - bits:548784448.000, epoch: 21.000, ratio_transmit_grad:  0.013, value:552.949 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2918 |     0.10592s |  92.6%
- batch.accumulate               |   2918 |     0.00083s |   0.7%
- batch.backward                 |   2918 |     0.05174s |  45.3%
- batch.evaluate                 |   2918 |     0.00275s |   2.4%
- batch.forward                  |   2918 |     0.02551s |  22.3%
- batch.mom                      |   2918 |     0.00126s |   1.1%
- batch.reduce                   |   2918 |     0.02097s |  18.3%
- batch.reporting.compr_err      |   2918 |     0.00001s |   0.0%
- batch.reporting.lr             |   2918 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2918 |     0.00001s |   0.0%
- batch.step                     |   2918 |     0.00048s |   0.4%
- batch.update_runavg            |   2918 |     0.00130s |   1.1%
- batch.wd                       |   2918 |     0.00001s |   0.0%
- epoch_metrics.collect          |     20 |     0.00934s |   0.1%
- reduce.combine                 |   2918 |     0.00556s |   4.9%
- reduce.flatpack                |   2918 |     0.00002s |   0.0%
- reduce.flatput                 |   2918 |     0.00009s |   0.1%
- reduce.gather.context          |   2918 |     0.00144s |   1.3%
- reduce.gather.tensors          |   2918 |     0.00045s |   0.4%
- reduce.heur_params             |   2918 |     0.01062s |   9.3%
- reduce.heur_params.alpha       |   2917 |     0.00873s |   7.6%
- reduce.heur_params.beta        |   2917 |     0.00181s |   1.6%
- reduce.memory                  |   2918 |     0.00042s |   0.4%
- reduce.pad                     |   2918 |     0.00029s |   0.3%
- reduce.threshold               |   2918 |     0.00186s |   1.6%
- test.last                      |     20 |     0.41629s |   2.7%
- test.runavg                    |     20 |     0.44704s |   2.9%
-----------------------------------------------------------------


[Iteration 2780] [Rank 3] a = 1.012198805809021, b = 0.9995000000416666, delta = 0.05130870267748833, c = 0.0, d = 0.0, m = 5.96902997099204e-06
[Iteration 2790] [Rank 3] a = 1.0026429891586304, b = 0.9995002073003761, delta = 0.04759032651782036, c = 4.1451752284742866e-07, d = 4.1451752284742866e-07, m = 5.950910689656578e-06
[Iteration 2800] [Rank 3] a = 0.950851559638977, b = 0.9995005872746774, delta = 0.05074481666088104, c = 1.174466314734381e-06, d = 1.2090094416383336e-06, m = 5.932205504810325e-06
[Iteration 2810] [Rank 3] a = 1.174756407737732, b = 0.9995000000416666, delta = 0.050871193408966064, c = 0.0, d = 0.0, m = 5.9459031498988675e-06
[Iteration 2820] [Rank 3] a = 0.9970884919166565, b = 0.9995001036710213, delta = 0.0533384270966053, c = 2.0725876142371433e-07, d = 2.0725876142371433e-07, m = 5.935270840700032e-06
[Iteration 2830] [Rank 3] a = 0.9807726740837097, b = 0.9995000000416666, delta = 0.049565043300390244, c = 0.0, d = 0.0, m = 5.919283870502156e-06

[Iteration 2780] [Rank 1] a = 0.9638183116912842, b = 0.999565562882195, delta = 0.0038555057253688574, c = 0.00013112570972740326, d = 0.00013288740919950484, m = 9.464624244366531e-05
[Iteration 2790] [Rank 1] a = 1.0349836349487305, b = 0.9995123664780824, delta = 0.0038150364998728037, c = 2.473287886322991e-05, d = 2.5078310132269434e-05, m = 9.465303172574163e-05
[Iteration 2800] [Rank 1] a = 0.9366481304168701, b = 0.9995141109055778, delta = 0.003914207685738802, c = 2.82217346805291e-05, d = 2.8532622822664672e-05, m = 9.461644871561691e-05
[Iteration 2810] [Rank 1] a = 1.0539906024932861, b = 0.9995146117807997, delta = 0.004296903498470783, c = 2.922348536074372e-05, d = 2.953437350287929e-05, m = 9.470814815169916e-05
[Iteration 2820] [Rank 1] a = 0.9744598865509033, b = 0.999542988953249, delta = 0.00393018638715148, c = 8.597784286393749e-05, d = 8.694505041724815e-05, m = 9.473324593225987e-05
[Iteration 2840] [Rank 3] a = 0.9721735119819641, b = 0.9995001036710213, delta = 0.04784923046827316, c = 2.0725876142371433e-07, d = 2.0725876142371433e-07, m = 5.905841203290816e-06
[Iteration 2850] [Rank 3] a = 0.9969291687011719, b = 0.9995000518563442, delta = 0.05071215331554413, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 5.889742472781344e-06
[Iteration 2860] [Rank 3] a = 1.0971698760986328, b = 0.9995000173132257, delta = 0.05344720557332039, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 5.874094347711755e-06
[Iteration 2870] [Rank 3] a = 0.9091864824295044, b = 0.9995046633626438, delta = 0.0496172197163105, c = 9.326644264067145e-06, d = 9.430273644779e-06, m = 5.860456245823013e-06
[Iteration 2880] [Rank 3] a = 0.8570399284362793, b = 0.9995116238010311, delta = 0.04833844304084778, c = 2.3247524406359956e-05, d = 2.3523869421591576e-05, m = 5.853075668844513e-06
[Iteration 2830] [Rank 1] a = 1.133072018623352, b = 0.9995022626159158, delta = 0.004361837636679411, c = 4.525149624417762e-06, d = 4.559692751321715e-06, m = 9.47071753331163e-05
[Iteration 2840] [Rank 1] a = 0.9451009035110474, b = 1.0000120673132236, delta = 0.003601088421419263, c = 0.0010241346264483803, d = 0.001023754652052437, m = 9.506791352006029e-05
[Iteration 2850] [Rank 1] a = 1.077515721321106, b = 0.9995068741222255, delta = 0.004096512217074633, c = 1.374816450777305e-05, d = 1.3817250761580954e-05, m = 9.585697118401783e-05
[Iteration 2860] [Rank 1] a = 1.0526745319366455, b = 0.9995103457056412, delta = 0.00396372377872467, c = 2.069133301546748e-05, d = 2.079496239617934e-05, m = 9.582183716110768e-05
[Iteration 2870] [Rank 1] a = 1.0599368810653687, b = 0.9995162007642643, delta = 0.0037077704910188913, c = 3.2401453035907335e-05, d = 3.267779805113896e-05, m = 9.645969062623854e-05
[Iteration 2890] [Rank 3] a = 0.9268462061882019, b = 0.9995002591150537, delta = 0.05112950876355171, c = 5.181469035592857e-07, d = 5.181469035592857e-07, m = 5.8361634501374085e-06
[Iteration 2900] [Rank 3] a = 1.004440188407898, b = 0.9995000691279032, delta = 0.055649809539318085, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 5.827012324793447e-06
[Iteration 2910] [Rank 3] a = 0.9754180908203125, b = 0.999500172757258, delta = 0.04961143806576729, c = 3.4543126903952387e-07, d = 3.4543126903952387e-07, m = 5.819929495895259e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2918 |     0.10613s |  92.8%
- batch.accumulate               |   2918 |     0.00082s |   0.7%
- batch.backward                 |   2918 |     0.05168s |  45.2%
- batch.evaluate                 |   2918 |     0.00277s |   2.4%
- batch.forward                  |   2918 |     0.02538s |  22.2%
[Iteration 2880] [Rank 1] a = 0.9533424973487854, b = 0.9995251474320767, delta = 0.003996333107352257, c = 5.0294792772154675e-05, d = 5.074385342190606e-05, m = 9.642250462584783e-05
[Iteration 2890] [Rank 1] a = 0.9843873381614685, b = 0.9995090330671343, delta = 0.0043859584257006645, c = 1.8066055370767097e-05, d = 1.8135141624575005e-05, m = 9.627677279578586e-05
[Iteration 2900] [Rank 1] a = 0.9749734401702881, b = 0.9995498112194087, delta = 0.003920284099876881, c = 9.962237799099868e-05, d = 0.00010014052489455797, m = 9.648017989640025e-05
[Iteration 2910] [Rank 1] a = 1.0049225091934204, b = 0.9995237829788728, delta = 0.003979059401899576, c = 4.7565885746742434e-05, d = 4.8533093300053106e-05, m = 9.650770576032348e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2918 |     0.10604s |  92.8%
- batch.accumulate               |   2918 |     0.00083s |   0.7%
- batch.mom                      |   2918 |     0.00126s |   1.1%
- batch.reduce                   |   2918 |     0.02142s |  18.7%
- batch.reporting.compr_err      |   2918 |     0.00001s |   0.0%
- batch.reporting.lr             |   2918 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   2918 |     0.00001s |   0.0%
- batch.step                     |   2918 |     0.00047s |   0.4%
- batch.update_runavg            |   2918 |     0.00129s |   1.1%
- batch.wd                       |   2918 |     0.00001s |   0.0%
- epoch_metrics.collect          |     20 |     0.00980s |   0.1%
- reduce.combine                 |   2918 |     0.00528s |   4.6%
- reduce.flatpack                |   2918 |     0.00002s |   0.0%
- reduce.flatput                 |   2918 |     0.00011s |   0.1%
- reduce.gather.context          |   2918 |     0.00268s |   2.3%
- reduce.gather.tensors          |   2918 |     0.00044s |   0.4%
- reduce.heur_params             |   2918 |     0.01005s |   8.8%
- batch.backward                 |   2918 |     0.05170s |  45.2%
- batch.evaluate                 |   2918 |     0.00277s |   2.4%
- batch.forward                  |   2918 |     0.02541s |  22.2%
- batch.mom                      |   2918 |     0.00126s |   1.1%
- batch.reduce                   |   2918 |     0.02127s |  18.6%
- batch.reporting.compr_err      |   2918 |     0.00001s |   0.0%
- batch.reporting.lr             |   2918 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   2918 |     0.00001s |   0.0%
- batch.step                     |   2918 |     0.00048s |   0.4%
- batch.update_runavg            |   2918 |     0.00129s |   1.1%
- batch.wd                       |   2918 |     0.00001s |   0.0%
- epoch_metrics.collect          |     20 |     0.01250s |   0.1%
- reduce.combine                 |   2918 |     0.00531s |   4.7%
- reduce.flatpack                |   2918 |     0.00002s |   0.0%
- reduce.flatput                 |   2918 |     0.00018s |   0.2%
- reduce.heur_params.alpha       |   2917 |     0.00808s |   7.1%
- reduce.heur_params.beta        |   2917 |     0.00190s |   1.7%
- reduce.gather.context          |   2918 |     0.00130s |   1.1%
- reduce.gather.tensors          |   2918 |     0.00058s |   0.5%
- reduce.heur_params             |   2918 |     0.01064s |   9.3%
- reduce.memory                  |   2918 |     0.00041s |   0.4%
- reduce.pad                     |   2918 |     0.00027s |   0.2%
- reduce.threshold               |   2918 |     0.00197s |   1.7%
- test.last                      |     20 |     0.41630s |   2.7%
- test.runavg                    |     20 |     0.44702s |   2.9%
-----------------------------------------------------------------

[Iteration 2920] [Rank 3] a = 1.023650884628296, b = 0.9995000173132257, delta = 0.04965862259268761, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 5.818559715393152e-06
[Iteration 2930] [Rank 3] a = 1.0107269287109375, b = 0.9995000691279032, delta = 0.05501517280936241, c = 1.3817250761580954e-07, d = 1.7271563451976193e-07, m = 5.799332553527571e-06
[Iteration 2940] [Rank 3] a = 1.0128533840179443, b = 0.9995000173132257, delta = 0.05178491398692131, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 5.797266927618481e-06
- reduce.heur_params.alpha       |   2917 |     0.00824s |   7.2%
- reduce.heur_params.beta        |   2917 |     0.00233s |   2.0%
- reduce.memory                  |   2918 |     0.00044s |   0.4%
- reduce.pad                     |   2918 |     0.00014s |   0.1%
- reduce.threshold               |   2918 |     0.00245s |   2.1%
- test.last                      |     20 |     0.41630s |   2.7%
- test.runavg                    |     20 |     0.44702s |   2.9%
-----------------------------------------------------------------

[Iteration 2920] [Rank 1] a = 0.8888651728630066, b = 0.9996601419494116, delta = 0.004069640766829252, c = 0.0003202838726534465, d = 0.0003223219171407797, m = 9.645666183225836e-05
[Iteration 2930] [Rank 1] a = 0.9698210954666138, b = 0.9995089812524564, delta = 0.004019732587039471, c = 1.796242599005524e-05, d = 1.8273314132190813e-05, m = 9.650136935108812e-05
[Iteration 2950] [Rank 3] a = 1.138899803161621, b = 0.9995000173132257, delta = 0.05561446771025658, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 5.784504707809379e-06
[Iteration 2960] [Rank 3] a = 1.0718538761138916, b = 0.9995000000416666, delta = 0.056087885051965714, c = 0.0, d = 0.0, m = 5.777603376961317e-06
[Iteration 2970] [Rank 3] a = 1.0502402782440186, b = 0.9995000000416666, delta = 0.05227278172969818, c = 0.0, d = 0.0, m = 5.789967551124765e-06
[Iteration 2980] [Rank 3] a = 0.9879893660545349, b = 0.9995001554856989, delta = 0.050897303968667984, c = 3.1088814213557147e-07, d = 3.1088814213557147e-07, m = 5.790301786569245e-06
[Iteration 2990] [Rank 3] a = 1.034201979637146, b = 0.9995000173132257, delta = 0.05442206561565399, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 5.773622076631441e-06
[Iteration 2940] [Rank 1] a = 1.021195888519287, b = 0.9995181524504794, delta = 0.004343085922300816, c = 3.630482637605396e-05, d = 3.6892059533421146e-05, m = 9.637299847918898e-05
[Iteration 2950] [Rank 1] a = 1.097058653831482, b = 0.9995108293093019, delta = 0.004110494628548622, c = 2.1658540568778147e-05, d = 2.1831256203297908e-05, m = 9.67126199623109e-05
[Iteration 2960] [Rank 1] a = 1.030900478363037, b = 0.9995128846248631, delta = 0.003902174299582839, c = 2.5769172670348482e-05, d = 2.608006081248405e-05, m = 9.677646064378751e-05
[Iteration 2970] [Rank 1] a = 1.010353922843933, b = 0.9995377211275089, delta = 0.004150204826146364, c = 7.5442189158232e-05, d = 7.651302609225454e-05, m = 9.670890765475731e-05
[Iteration 2980] [Rank 1] a = 0.9196677803993225, b = 0.9999626360986421, delta = 0.0036691189743578434, c = 0.0009252721972492687, d = 0.000926412120437099, m = 9.722752304958082e-05
[Iteration 3000] [Rank 3] a = 1.0363656282424927, b = 0.9995000518563442, delta = 0.05318175256252289, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 5.7578477548826155e-06
[Iteration 3010] [Rank 3] a = 0.9146724343299866, b = 0.9995284808430767, delta = 0.045912258327007294, c = 5.696161626461749e-05, d = 5.85506001021993e-05, m = 5.777065507311769e-06
[Iteration 3020] [Rank 3] a = 0.8235521912574768, b = 0.9995117965166241, delta = 0.04701012372970581, c = 2.359295567539948e-05, d = 2.38693006906311e-05, m = 5.767021345672783e-06
[Iteration 3030] [Rank 3] a = 0.9096210598945618, b = 0.9995025907755402, delta = 0.047772366553545, c = 5.181469035592858e-06, d = 5.319641543208668e-06, m = 5.750456219296843e-06
[Iteration 3040] [Rank 3] a = 0.9621200561523438, b = 0.9995000691279032, delta = 0.049873776733875275, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 5.741394834499988e-06
[Iteration 2990] [Rank 1] a = 1.0385178327560425, b = 0.9995067532213109, delta = 0.004159904085099697, c = 1.3506362619445383e-05, d = 1.360999200015724e-05, m = 9.712119459523947e-05
[Iteration 3000] [Rank 1] a = 1.0829781293869019, b = 0.999503765241565, delta = 0.004089890979230404, c = 7.53040166506162e-06, d = 7.634031045773477e-06, m = 9.709949809935981e-05
[Iteration 3010] [Rank 1] a = 0.9770652651786804, b = 0.9995753213137446, delta = 0.003924154210835695, c = 0.00015064257642813635, d = 0.0001521970171388142, m = 9.742216092249171e-05
[Iteration 3020] [Rank 1] a = 0.944219708442688, b = 0.9995206222834826, delta = 0.0037739675026386976, c = 4.124449352331915e-05, d = 4.169355417307053e-05, m = 9.804002606788372e-05
[Iteration 3030] [Rank 1] a = 0.967069685459137, b = 0.999521796749528, delta = 0.0036955582909286022, c = 4.359342615278791e-05, d = 4.393885742182744e-05, m = 0.00010060437834494325
[Iteration 3050] [Rank 3] a = 0.7937146425247192, b = 0.9995173406871858, delta = 0.046752043068408966, c = 3.468129941156819e-05, d = 3.54757913303591e-05, m = 5.735619591579094e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3057 |     0.10616s |  92.8%
- batch.accumulate               |   3057 |     0.00082s |   0.7%
- batch.backward                 |   3057 |     0.05170s |  45.2%
- batch.evaluate                 |   3057 |     0.00277s |   2.4%
- batch.forward                  |   3057 |     0.02538s |  22.2%
- batch.mom                      |   3057 |     0.00126s |   1.1%
- batch.reduce                   |   3057 |     0.02144s |  18.8%
- batch.reporting.compr_err      |   3057 |     0.00001s |   0.0%
- batch.reporting.lr             |   3057 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3057 |     0.00001s |   0.0%
[Iteration 3040] [Rank 1] a = 0.9206185936927795, b = 0.9995698980438114, delta = 0.0036702482029795647, c = 0.0001397960345802953, d = 0.00014083232838741388, m = 0.00010067993609721765
[Iteration 3050] [Rank 1] a = 0.9897175431251526, b = 0.9995408990945096, delta = 0.003610381856560707, c = 8.179812450855926e-05, d = 8.359436710756478e-05, m = 0.00010058869111395036
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3057 |     0.10608s |  92.7%
- batch.accumulate               |   3057 |     0.00083s |   0.7%
- batch.backward                 |   3057 |     0.05172s |  45.2%
- batch.evaluate                 |   3057 |     0.00277s |   2.4%
- batch.forward                  |   3057 |     0.02540s |  22.2%
- batch.mom                      |   3057 |     0.00126s |   1.1%
- batch.reduce                   |   3057 |     0.02130s |  18.6%
- batch.step                     |   3057 |     0.00047s |   0.4%
- batch.update_runavg            |   3057 |     0.00129s |   1.1%
- batch.wd                       |   3057 |     0.00001s |   0.0%
- epoch_metrics.collect          |     21 |     0.00949s |   0.1%
- reduce.combine                 |   3057 |     0.00529s |   4.6%
- reduce.flatpack                |   3057 |     0.00002s |   0.0%
- batch.reporting.compr_err      |   3057 |     0.00001s |   0.0%
- batch.reporting.lr             |   3057 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   3057 |     0.00001s |   0.0%
- batch.step                     |   3057 |     0.00048s |   0.4%
- batch.update_runavg            |   3057 |     0.00129s |   1.1%
- reduce.flatput                 |   3057 |     0.00011s |   0.1%
- reduce.gather.context          |   3057 |     0.00266s |   2.3%
- reduce.gather.tensors          |   3057 |     0.00045s |   0.4%
- reduce.heur_params             |   3057 |     0.01006s |   8.8%
- reduce.heur_params.alpha       |   3056 |     0.00808s |   7.1%
- reduce.heur_params.beta        |   3056 |     0.00190s |   1.7%
- reduce.memory                  |   3057 |     0.00041s |   0.4%
- reduce.pad                     |   3057 |     0.00027s |   0.2%
- reduce.threshold               |   3057 |     0.00198s |   1.7%
- test.last                      |     21 |     0.41635s |   2.7%
- test.runavg                    |     21 |     0.44702s |   2.9%
-----------------------------------------------------------------
- batch.wd                       |   3057 |     0.00001s |   0.0%
- epoch_metrics.collect          |     21 |     0.01202s |   0.1%
- reduce.combine                 |   3057 |     0.00532s |   4.7%
- reduce.flatpack                |   3057 |     0.00002s |   0.0%
- reduce.flatput                 |   3057 |     0.00019s |   0.2%
- reduce.gather.context          |   3057 |     0.00129s |   1.1%
- reduce.gather.tensors          |   3057 |     0.00059s |   0.5%
- reduce.heur_params             |   3057 |     0.01065s |   9.3%
- reduce.heur_params.alpha       |   3056 |     0.00824s |   7.2%
- reduce.heur_params.beta        |   3056 |     0.00233s |   2.0%
- reduce.memory                  |   3057 |     0.00044s |   0.4%
- reduce.pad                     |   3057 |     0.00014s |   0.1%
- reduce.threshold               |   3057 |     0.00246s |   2.2%
- test.last                      |     21 |     0.41634s |   2.7%
- test.runavg                    |     21 |     0.44703s |   2.9%
-----------------------------------------------------------------
[Iteration 2820] [Rank 2] a = 1.0801920890808105, b = 0.9995000000416666, delta = 0.17521440982818604, c = 0.0, d = 0.0, m = 4.229298334404856e-07
[Iteration 2830] [Rank 2] a = 1.0826681852340698, b = 0.9995000000416666, delta = 0.18268099427223206, c = 0.0, d = 0.0, m = 4.2631660575669047e-07
[Iteration 2840] [Rank 2] a = 0.945360004901886, b = 0.9995000000416666, delta = 0.19074168801307678, c = 0.0, d = 0.0, m = 4.248160193231928e-07
[Iteration 2850] [Rank 2] a = 0.827081024646759, b = 0.999508290390085, delta = 0.14561866223812103, c = 1.6580700913897144e-05, d = 1.678795967532086e-05, m = 4.2935979940209013e-07
[Iteration 2860] [Rank 2] a = 1.067585825920105, b = 0.9995000000416666, delta = 0.19534288346767426, c = 0.0, d = 0.0, m = 4.2785906609414853e-07
[Iteration 2870] [Rank 2] a = 1.0050289630889893, b = 0.9995000000416666, delta = 0.1708189696073532, c = 0.0, d = 0.0, m = 4.2644097765823147e-07
[Iteration 2880] [Rank 2] a = 0.9183634519577026, b = 0.9995000000416666, delta = 0.14861062169075012, c = 0.0, d = 0.0, m = 4.332698485946621e-07
[Iteration 2890] [Rank 2] a = 1.0673173666000366, b = 0.9995000000416666, delta = 0.18225322663784027, c = 0.0, d = 0.0, m = 4.3178311204708596e-07
[Iteration 2900] [Rank 2] a = 0.9472261071205139, b = 0.9995000000416666, delta = 0.16049712896347046, c = 0.0, d = 0.0, m = 4.303304399547871e-07
[Iteration 2910] [Rank 2] a = 0.8238328099250793, b = 0.9995003627444087, delta = 0.1471470445394516, c = 7.254056649830001e-07, d = 7.599487918869525e-07, m = 4.291369430967133e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   2918 |     0.10591s |  92.6%
- batch.accumulate               |   2918 |     0.00083s |   0.7%
- batch.backward                 |   2918 |     0.05213s |  45.6%
- batch.evaluate                 |   2918 |     0.00275s |   2.4%
- batch.forward                  |   2918 |     0.02576s |  22.5%
- batch.mom                      |   2918 |     0.00126s |   1.1%
- batch.reduce                   |   2918 |     0.02035s |  17.8%
- batch.reporting.compr_err      |   2918 |     0.00001s |   0.0%
- batch.reporting.lr             |   2918 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   2918 |     0.00001s |   0.0%
- batch.step                     |   2918 |     0.00048s |   0.4%
- batch.update_runavg            |   2918 |     0.00130s |   1.1%
- batch.wd                       |   2918 |     0.00001s |   0.0%
- epoch_metrics.collect          |     20 |     0.01631s |   0.1%
- reduce.combine                 |   2918 |     0.00554s |   4.8%
- reduce.flatpack                |   2918 |     0.00002s |   0.0%
- reduce.flatput                 |   2918 |     0.00009s |   0.1%
- reduce.gather.context          |   2918 |     0.00116s |   1.0%
- reduce.gather.tensors          |   2918 |     0.00044s |   0.4%
- reduce.heur_params             |   2918 |     0.01028s |   9.0%
- reduce.heur_params.alpha       |   2917 |     0.00836s |   7.3%
- reduce.heur_params.beta        |   2917 |     0.00184s |   1.6%
- reduce.memory                  |   2918 |     0.00042s |   0.4%
- reduce.pad                     |   2918 |     0.00029s |   0.3%
- reduce.threshold               |   2918 |     0.00190s |   1.7%
- test.last                      |     20 |     0.41630s |   2.7%
- test.runavg                    |     20 |     0.44702s |   2.9%
-----------------------------------------------------------------

[Iteration 2920] [Rank 2] a = 1.001488208770752, b = 0.9995000000416666, delta = 0.1603911966085434, c = 0.0, d = 0.0, m = 4.276677991627978e-07
[Iteration 2930] [Rank 2] a = 1.0237321853637695, b = 0.9995000000416666, delta = 0.17867714166641235, c = 0.0, d = 0.0, m = 4.2627939273829953e-07
[Iteration 2940] [Rank 2] a = 0.9023401141166687, b = 0.9995000000416666, delta = 0.15804095566272736, c = 0.0, d = 0.0, m = 4.25640386219765e-07
[Iteration 2950] [Rank 2] a = 0.9712251424789429, b = 0.9995000000416666, delta = 0.15713664889335632, c = 0.0, d = 0.0, m = 4.242097319550094e-07
[Iteration 2960] [Rank 2] a = 1.0007438659667969, b = 0.9995000000416666, delta = 0.1751089096069336, c = 0.0, d = 0.0, m = 4.2296373151965424e-07
[Iteration 2970] [Rank 2] a = 1.0915831327438354, b = 0.9995000000416666, delta = 0.15893779695034027, c = 0.0, d = 0.0, m = 4.344574294917493e-07
[Iteration 2980] [Rank 2] a = 0.9209555387496948, b = 0.9995000345847849, delta = 0.1419370323419571, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 4.3304635878148366e-07
[Iteration 2990] [Rank 2] a = 0.9504626989364624, b = 0.9995000000416666, delta = 0.15464109182357788, c = 0.0, d = 0.0, m = 4.3169091960643077e-07
[Iteration 3000] [Rank 2] a = 0.8805004358291626, b = 0.9995000000416666, delta = 0.13891491293907166, c = 0.0, d = 0.0, m = 4.3323365891734696e-07
[Iteration 3010] [Rank 2] a = 1.0440385341644287, b = 0.9995000000416666, delta = 0.1621084064245224, c = 0.0, d = 0.0, m = 4.3181776707564466e-07
[Iteration 3020] [Rank 2] a = 0.9777519106864929, b = 0.9995000000416666, delta = 0.16105440258979797, c = 0.0, d = 0.0, m = 4.3054846092069567e-07
[Iteration 3030] [Rank 2] a = 0.9800295233726501, b = 0.999500656360914, delta = 0.13489365577697754, c = 1.3126388223501907e-06, d = 1.3817250761580955e-06, m = 4.2983456757158257e-07
[Iteration 3040] [Rank 2] a = 1.1976131200790405, b = 0.9995000000416666, delta = 0.1666877716779709, c = 0.0, d = 0.0, m = 4.2847789869910773e-07
[Iteration 3050] [Rank 2] a = 0.8754291534423828, b = 0.9995001036710213, delta = 0.14027398824691772, c = 2.0725876142371433e-07, d = 2.0725876142371433e-07, m = 4.27152766906691e-07
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3057 |     0.10594s |  92.6%
- batch.accumulate               |   3057 |     0.00083s |   0.7%
- batch.backward                 |   3057 |     0.05213s |  45.6%
- batch.evaluate                 |   3057 |     0.00275s |   2.4%
- batch.forward                  |   3057 |     0.02576s |  22.5%
- batch.mom                      |   3057 |     0.00126s |   1.1%
- batch.reduce                   |   3057 |     0.02038s |  17.8%
- batch.reporting.compr_err      |   3057 |     0.00001s |   0.0%
- batch.reporting.lr             |   3057 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3057 |     0.00001s |   0.0%
- batch.step                     |   3057 |     0.00048s |   0.4%
- batch.update_runavg            |   3057 |     0.00130s |   1.1%
- batch.wd                       |   3057 |     0.00001s |   0.0%
- epoch_metrics.collect          |     21 |     0.01571s |   0.1%
- reduce.combine                 |   3057 |     0.00555s |   4.9%
- reduce.flatpack                |   3057 |     0.00002s |   0.0%
- reduce.flatput                 |   3057 |     0.00009s |   0.1%
- reduce.gather.context          |   3057 |     0.00115s |   1.0%
- reduce.gather.tensors          |   3057 |     0.00046s |   0.4%
- reduce.heur_params             |   3057 |     0.01029s |   9.0%
- reduce.heur_params.alpha       |   3056 |     0.00837s |   7.3%
- reduce.heur_params.beta        |   3056 |     0.00184s |   1.6%
- reduce.memory                  |   3057 |     0.00042s |   0.4%
- reduce.pad                     |   3057 |     0.00029s |   0.3%
- reduce.threshold               |   3057 |     0.00190s |   1.7%
- test.last                      |     21 |     0.41635s |   2.7%
- test.runavg                    |     21 |     0.44703s |   2.9%
-----------------------------------------------------------------

[Iteration 3060] [Rank 2] a = 0.9281319379806519, b = 0.9995000000416666, delta = 0.15142133831977844, c = 0.0, d = 0.0, m = 4.2620869549443725e-07
[Iteration 3070] [Rank 2] a = 1.0975383520126343, b = 0.9995000000416666, delta = 0.16139832139015198, c = 0.0, d = 0.0, m = 4.249445754817375e-07
[Iteration 3080] [Rank 2] a = 0.9896644353866577, b = 0.9995000000416666, delta = 0.15165147185325623, c = 0.0, d = 0.0, m = 4.2376714300184584e-07
[Iteration 3090] [Rank 2] a = 1.0295562744140625, b = 0.9995000000416666, delta = 0.15763837099075317, c = 0.0, d = 0.0, m = 4.2493298524616123e-07
[Iteration 2920] [Rank 0] a = 0.9152485728263855, b = 0.9995000000416666, delta = 0.3254978656768799, c = 0.0, d = 0.0, m = 1.1046468620671727e-07
[Iteration 2930] [Rank 0] a = 1.0802364349365234, b = 0.9995000000416666, delta = 0.351638525724411, c = 0.0, d = 0.0, m = 1.1008780225514198e-07
[Iteration 2940] [Rank 0] a = 0.7844286561012268, b = 0.9995000000416666, delta = 0.28257155418395996, c = 0.0, d = 0.0, m = 1.0971348126821528e-07
[Iteration 2950] [Rank 0] a = 1.1645182371139526, b = 0.9995000000416666, delta = 0.3066824674606323, c = 0.0, d = 0.0, m = 1.0957580852182318e-07
[Iteration 2960] [Rank 0] a = 1.1155213117599487, b = 0.9995000000416666, delta = 0.31695401668548584, c = 0.0, d = 0.0, m = 1.0920574500097947e-07
[Iteration 2970] [Rank 0] a = 1.1041382551193237, b = 0.9995000000416666, delta = 0.31739017367362976, c = 0.0, d = 0.0, m = 1.0883817265159885e-07
[Iteration 2980] [Rank 0] a = 0.9770079851150513, b = 0.9995000000416666, delta = 0.32089945673942566, c = 0.0, d = 0.0, m = 1.0900610358452937e-07
[Iteration 2990] [Rank 0] a = 0.9147607088088989, b = 0.9995000000416666, delta = 0.3022023141384125, c = 0.0, d = 0.0, m = 1.0864165656485525e-07
[Iteration 3000] [Rank 0] a = 0.9360268115997314, b = 0.9995000000416666, delta = 0.30170905590057373, c = 0.0, d = 0.0, m = 1.0829114892115494e-07
[Iteration 3010] [Rank 0] a = 1.0387835502624512, b = 0.9995000000416666, delta = 0.31654831767082214, c = 0.0, d = 0.0, m = 1.1333495539161328e-07
[Iteration 3020] [Rank 0] a = 0.9264583587646484, b = 0.9995000000416666, delta = 0.2843382954597473, c = 0.0, d = 0.0, m = 1.1295979830656987e-07
[Iteration 3030] [Rank 0] a = 0.9215677976608276, b = 0.9995001036710213, delta = 0.24659007787704468, c = 2.0725876142371433e-07, d = 2.4180188832766673e-07, m = 1.1266689296353521e-07
[Iteration 3040] [Rank 0] a = 1.2046927213668823, b = 0.9995000000416666, delta = 0.30416032671928406, c = 0.0, d = 0.0, m = 1.1229640005671662e-07
[Iteration 3050] [Rank 0] a = 0.8850951790809631, b = 0.9995000000416666, delta = 0.29221081733703613, c = 0.0, d = 0.0, m = 1.1192833581529833e-07
cross_entropy                  - bits:598295680.000, epoch: 22.000, ratio_transmit_grad:  0.019, value:  6.521 (split:train)
last_cross_entropy             - bits:598295680.000, epoch: 22.000, ratio_transmit_grad:  0.019, value:  6.521 (split:train)
perplexity                     - bits:598295680.000, epoch: 22.000, ratio_transmit_grad:  0.019, value:681.329 (split:train)
last_perplexity                - bits:598295680.000, epoch: 22.000, ratio_transmit_grad:  0.019, value:681.329 (split:train)
last_cross_entropy             - bits:598295680.000, epoch: 22.000, ratio_transmit_grad:  0.019, value:  6.194 (split:test)
last_perplexity                - bits:598295680.000, epoch: 22.000, ratio_transmit_grad:  0.019, value:491.370 (split:test)
runavg_cross_entropy           - bits:598295680.000, epoch: 22.000, ratio_transmit_grad:  0.019, value:  6.317 (split:test)
runavg_perplexity              - bits:598295680.000, epoch: 22.000, ratio_transmit_grad:  0.019, value:555.450 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3057 |     0.10595s |  92.6%
- batch.accumulate               |   3057 |     0.00083s |   0.7%
- batch.backward                 |   3057 |     0.05175s |  45.3%
- batch.evaluate                 |   3057 |     0.00275s |   2.4%
- batch.forward                  |   3057 |     0.02551s |  22.3%
- batch.mom                      |   3057 |     0.00126s |   1.1%
- batch.reduce                   |   3057 |     0.02100s |  18.4%
- batch.reporting.compr_err      |   3057 |     0.00001s |   0.0%
- batch.reporting.lr             |   3057 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3057 |     0.00001s |   0.0%
- batch.step                     |   3057 |     0.00048s |   0.4%
- batch.update_runavg            |   3057 |     0.00130s |   1.1%
- batch.wd                       |   3057 |     0.00001s |   0.0%
- epoch_metrics.collect          |     21 |     0.00893s |   0.1%
- reduce.combine                 |   3057 |     0.00558s |   4.9%
- reduce.flatpack                |   3057 |     0.00002s |   0.0%
- reduce.flatput                 |   3057 |     0.00009s |   0.1%
- reduce.gather.context          |   3057 |     0.00144s |   1.3%
- reduce.gather.tensors          |   3057 |     0.00046s |   0.4%
- reduce.heur_params             |   3057 |     0.01062s |   9.3%
- reduce.heur_params.alpha       |   3056 |     0.00873s |   7.6%
- reduce.heur_params.beta        |   3056 |     0.00181s |   1.6%
- reduce.memory                  |   3057 |     0.00042s |   0.4%
- reduce.pad                     |   3057 |     0.00029s |   0.3%
- reduce.threshold               |   3057 |     0.00186s |   1.6%
- test.last                      |     21 |     0.41634s |   2.7%
- test.runavg                    |     21 |     0.44704s |   2.9%
-----------------------------------------------------------------

[Iteration 3060] [Rank 0] a = 1.1333765983581543, b = 0.9995000000416666, delta = 0.31805509328842163, c = 0.0, d = 0.0, m = 1.1156267643661393e-07
[Iteration 3070] [Rank 0] a = 0.9539403319358826, b = 0.9995000000416666, delta = 0.2814794182777405, c = 0.0, d = 0.0, m = 1.1121064659699745e-07
[Iteration 3080] [Rank 0] a = 0.8919444680213928, b = 0.9995000000416666, delta = 0.29228273034095764, c = 0.0, d = 0.0, m = 1.1087211358428664e-07
timer                          - epoch: -1.000, value:  0.010 (event:reduce.heur_params)
[Iteration 3090] [Rank 0] a = 1.0633906126022339, b = 0.9995000000416666, delta = 0.27284684777259827, c = 0.0, d = 0.0, m = 1.1053577101488031e-07
[Iteration 3100] [Rank 0] a = 1.0563633441925049, b = 0.9995000000416666, delta = 0.2959330379962921, c = 0.0, d = 0.0, m = 1.1017931899612868e-07
[Iteration 3110] [Rank 0] a = 1.0847065448760986, b = 0.9995000000416666, delta = 0.2887263298034668, c = 0.0, d = 0.0, m = 1.0989177980341329e-07
[Iteration 3120] [Rank 0] a = 0.913491427898407, b = 0.9995000000416666, delta = 0.2771551311016083, c = 0.0, d = 0.0, m = 1.0953967541442446e-07
timer                          - epoch: -1.000, value:  0.011 (event:reduce.heur_params)
[Iteration 3130] [Rank 0] a = 0.8909004330635071, b = 0.9995000000416666, delta = 0.27824631333351135, c = 0.0, d = 0.0, m = 1.0918982017515769e-07
[Iteration 3140] [Rank 0] a = 0.9331185221672058, b = 0.9995000000416666, delta = 0.2796051502227783, c = 0.0, d = 0.0, m = 1.0888618257753409e-07
[Iteration 3150] [Rank 0] a = 1.0819061994552612, b = 0.9995000000416666, delta = 0.30808109045028687, c = 0.0, d = 0.0, m = 1.0934089106316187e-07
rel_compression_error          - epoch: 22.727, value:  1.000 (weight:encoder.weight)
rel_compression_error          - epoch: 22.727, value:  1.000 (weight:rnn.weight_ih_l0)
rel_compression_error          - epoch: 22.727, value:  1.000 (weight:rnn.weight_hh_l0)
rel_compression_error          - epoch: 22.727, value:  1.000 (weight:rnn.bias_ih_l0)
rel_compression_error          - epoch: 22.727, value:  1.000 (weight:rnn.bias_hh_l0)
rel_compression_error          - epoch: 22.727, value:  1.000 (weight:rnn.weight_ih_l1)
rel_compression_error          - epoch: 22.727, value:  1.000 (weight:rnn.weight_hh_l1)
rel_compression_error          - epoch: 22.727, value:  1.000 (weight:rnn.bias_ih_l1)
rel_compression_error          - epoch: 22.727, value:  1.000 (weight:rnn.bias_hh_l1)
rel_compression_error          - epoch: 22.727, value:  1.000 (weight:rnn.weight_ih_l2)
rel_compression_error          - epoch: 22.727, value:  1.000 (weight:rnn.weight_hh_l2)
rel_compression_error          - epoch: 22.727, value:  1.000 (weight:rnn.bias_ih_l2)
rel_compression_error          - epoch: 22.727, value:  1.000 (weight:rnn.bias_hh_l2)
rel_compression_error          - epoch: 22.727, value:  0.999 (weight:decoder.bias)
rel_compression_error          - epoch: 22.727, value:  1.000 (weight:entire_model)
[Iteration 3160] [Rank 0] a = 1.144713044166565, b = 0.9995000000416666, delta = 0.29238128662109375, c = 0.0, d = 0.0, m = 1.0900591296011611e-07
[Iteration 3170] [Rank 0] a = 1.077976942062378, b = 0.9995000000416666, delta = 0.26696160435676575, c = 0.0, d = 0.0, m = 1.0868394106614158e-07
[Iteration 3180] [Rank 0] a = 0.8509655594825745, b = 0.9995000000416666, delta = 0.27829447388648987, c = 0.0, d = 0.0, m = 1.0838571192340484e-07
[Iteration 3190] [Rank 0] a = 0.9432271718978882, b = 0.9995000000416666, delta = 0.2904675304889679, c = 0.0, d = 0.0, m = 1.0804605127807922e-07
cross_entropy                  - bits:757615616.000, epoch: 23.000, ratio_transmit_grad:  0.062, value:  6.497 (split:train)
last_cross_entropy             - bits:757615616.000, epoch: 23.000, ratio_transmit_grad:  0.062, value:  6.497 (split:train)
perplexity                     - bits:757615616.000, epoch: 23.000, ratio_transmit_grad:  0.062, value:665.772 (split:train)
last_perplexity                - bits:757615616.000, epoch: 23.000, ratio_transmit_grad:  0.062, value:665.772 (split:train)
last_cross_entropy             - bits:757615616.000, epoch: 23.000, ratio_transmit_grad:  0.062, value:  6.320 (split:test)
last_perplexity                - bits:757615616.000, epoch: 23.000, ratio_transmit_grad:  0.062, value:557.814 (split:test)
runavg_cross_entropy           - bits:757615616.000, epoch: 23.000, ratio_transmit_grad:  0.062, value:  6.464 (split:test)
runavg_perplexity              - bits:757615616.000, epoch: 23.000, ratio_transmit_grad:  0.062, value:644.559 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3196 |     0.10603s |  92.6%
- batch.accumulate               |   3196 |     0.00083s |   0.7%
- batch.backward                 |   3196 |     0.05175s |  45.2%
- batch.evaluate                 |   3196 |     0.00275s |   2.4%
- batch.forward                  |   3196 |     0.02551s |  22.3%
- batch.mom                      |   3196 |     0.00126s |   1.1%
- batch.reduce                   |   3196 |     0.02108s |  18.4%
- batch.reporting.compr_err      |   3196 |     0.00001s |   0.0%
- batch.reporting.lr             |   3196 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3196 |     0.00001s |   0.0%
- batch.step                     |   3196 |     0.00048s |   0.4%
- batch.update_runavg            |   3196 |     0.00130s |   1.1%
- batch.wd                       |   3196 |     0.00001s |   0.0%
- epoch_metrics.collect          |     22 |     0.00856s |   0.1%
- reduce.combine                 |   3196 |     0.00559s |   4.9%
- reduce.flatpack                |   3196 |     0.00002s |   0.0%
- reduce.flatput                 |   3196 |     0.00009s |   0.1%
- reduce.gather.context          |   3196 |     0.00144s |   1.3%
- reduce.gather.tensors          |   3196 |     0.00053s |   0.5%
- reduce.heur_params             |   3196 |     0.01062s |   9.3%
- reduce.heur_params.alpha       |   3195 |     0.00873s |   7.6%
- reduce.heur_params.beta        |   3195 |     0.00182s |   1.6%
- reduce.memory                  |   3196 |     0.00042s |   0.4%
- reduce.pad                     |   3196 |     0.00029s |   0.3%
- reduce.threshold               |   3196 |     0.00186s |   1.6%
- test.last                      |     22 |     0.41644s |   2.7%
- test.runavg                    |     22 |     0.44713s |   2.9%
-----------------------------------------------------------------

[Iteration 3200] [Rank 0] a = 1.0101659297943115, b = 0.9995000000416666, delta = 0.3121417760848999, c = 0.0, d = 0.0, m = 1.0780563504232626e-07
[Iteration 3210] [Rank 0] a = 0.9269920587539673, b = 0.9995000518563442, delta = 0.24769993126392365, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 1.0750216977614395e-07
[Iteration 3220] [Rank 0] a = 1.0174760818481445, b = 0.9995000000416666, delta = 0.29099950194358826, c = 0.0, d = 0.0, m = 1.0716841575634842e-07
[Iteration 3230] [Rank 0] a = 0.9009574055671692, b = 0.9995000000416666, delta = 0.25964784622192383, c = 0.0, d = 0.0, m = 1.0702916850370454e-07
[Iteration 3240] [Rank 0] a = 0.8751549124717712, b = 0.9995000000416666, delta = 0.2623015344142914, c = 0.0, d = 0.0, m = 1.0669893348826578e-07
[Iteration 3250] [Rank 0] a = 0.9976473450660706, b = 0.9995000000416666, delta = 0.27796682715415955, c = 0.0, d = 0.0, m = 1.0697637701291746e-07
[Iteration 3260] [Rank 0] a = 0.9021502137184143, b = 0.9995000000416666, delta = 0.2727319896221161, c = 0.0, d = 0.0, m = 1.066589220471937e-07
[Iteration 3270] [Rank 0] a = 0.8923123478889465, b = 0.9995000000416666, delta = 0.28038647770881653, c = 0.0, d = 0.0, m = 1.063328476905835e-07
[Iteration 3280] [Rank 0] a = 1.2103885412216187, b = 0.9995000000416666, delta = 0.31797540187835693, c = 0.0, d = 0.0, m = 1.0600876098625377e-07
memory_norm                    - epoch: 23.640, value: 29.769 (weight:encoder.weight)
memory_inf_norm                - epoch: 23.640, value:  0.240 (weight:encoder.weight)
memory_norm                    - epoch: 23.640, value:  6.421 (weight:rnn.weight_ih_l0)
memory_inf_norm                - epoch: 23.640, value:  0.158 (weight:rnn.weight_ih_l0)
memory_norm                    - epoch: 23.640, value:  8.348 (weight:rnn.weight_hh_l0)
memory_inf_norm                - epoch: 23.640, value:  0.131 (weight:rnn.weight_hh_l0)
memory_norm                    - epoch: 23.640, value:  1.954 (weight:rnn.bias_ih_l0)
memory_inf_norm                - epoch: 23.640, value:  0.185 (weight:rnn.bias_ih_l0)
memory_norm                    - epoch: 23.640, value:  1.954 (weight:rnn.bias_hh_l0)
memory_inf_norm                - epoch: 23.640, value:  0.185 (weight:rnn.bias_hh_l0)
memory_norm                    - epoch: 23.640, value: 17.914 (weight:rnn.weight_ih_l1)
memory_inf_norm                - epoch: 23.640, value:  0.165 (weight:rnn.weight_ih_l1)
memory_norm                    - epoch: 23.640, value: 29.230 (weight:rnn.weight_hh_l1)
memory_inf_norm                - epoch: 23.640, value:  0.185 (weight:rnn.weight_hh_l1)
memory_norm                    - epoch: 23.640, value:  5.772 (weight:rnn.bias_ih_l1)
memory_inf_norm                - epoch: 23.640, value:  0.232 (weight:rnn.bias_ih_l1)
memory_norm                    - epoch: 23.640, value:  5.772 (weight:rnn.bias_hh_l1)
memory_inf_norm                - epoch: 23.640, value:  0.232 (weight:rnn.bias_hh_l1)
memory_norm                    - epoch: 23.640, value: 25.890 (weight:rnn.weight_ih_l2)
memory_inf_norm                - epoch: 23.640, value:  0.218 (weight:rnn.weight_ih_l2)
memory_norm                    - epoch: 23.640, value: 25.946 (weight:rnn.weight_hh_l2)
memory_inf_norm                - epoch: 23.640, value:  0.225 (weight:rnn.weight_hh_l2)
memory_norm                    - epoch: 23.640, value:  6.161 (weight:rnn.bias_ih_l2)
memory_inf_norm                - epoch: 23.640, value:  0.233 (weight:rnn.bias_ih_l2)
memory_norm                    - epoch: 23.640, value:  6.161 (weight:rnn.bias_hh_l2)
memory_inf_norm                - epoch: 23.640, value:  0.233 (weight:rnn.bias_hh_l2)
memory_norm                    - epoch: 23.640, value:  7.745 (weight:decoder.bias)
memory_inf_norm                - epoch: 23.640, value:  0.233 (weight:decoder.bias)
memory_norm                    - epoch: 23.640, value: 61.042 (weight:entire_model)
memory_inf_norm                - epoch: 23.640, value:  0.240 (weight:entire_model)
[Iteration 3290] [Rank 0] a = 1.0921992063522339, b = 0.9995000000416666, delta = 0.2859756648540497, c = 0.0, d = 0.0, m = 1.0689371145240144e-07
[Iteration 3300] [Rank 0] a = 1.1481411457061768, b = 0.9995000000416666, delta = 0.2793276607990265, c = 0.0, d = 0.0, m = 1.0658035368577918e-07
[Iteration 3310] [Rank 0] a = 0.8580785989761353, b = 0.999504197030545, delta = 0.2252720445394516, c = 8.39397983766043e-06, d = 8.53215234527624e-06, m = 1.088353669169536e-07
[Iteration 3320] [Rank 0] a = 0.9137969613075256, b = 0.9995000000416666, delta = 0.23670780658721924, c = 0.0, d = 0.0, m = 1.0850764825716151e-07
[Iteration 3330] [Rank 0] a = 0.9324596524238586, b = 0.9995000000416666, delta = 0.2553781270980835, c = 0.0, d = 0.0, m = 1.0819226748391994e-07
cross_entropy                  - bits:1057180224.000, epoch: 24.000, ratio_transmit_grad:  0.116, value:  6.481 (split:train)
last_cross_entropy             - bits:1057180224.000, epoch: 24.000, ratio_transmit_grad:  0.116, value:  6.481 (split:train)

[Iteration 3060] [Rank 3] a = 0.9143159985542297, b = 0.999501571753549, delta = 0.04835428297519684, c = 3.1434245482596672e-06, d = 3.1779676751636197e-06, m = 5.7213958264192736e-06
[Iteration 3070] [Rank 3] a = 0.9294722080230713, b = 0.9995040070433937, delta = 0.049333784729242325, c = 8.014005441716954e-06, d = 8.25580733004462e-06, m = 5.708040817709981e-06
[Iteration 3080] [Rank 3] a = 1.1112215518951416, b = 0.9995000000416666, delta = 0.053969722241163254, c = 0.0, d = 0.0, m = 5.772805660810392e-06
[Iteration 3090] [Rank 3] a = 1.0621289014816284, b = 0.9995000518563442, delta = 0.049592893570661545, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 5.761158805493176e-06
[Iteration 3100] [Rank 3] a = 0.9860178828239441, b = 0.9995000173132257, delta = 0.05041150748729706, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 5.7430482680133425e-06

[Iteration 3060] [Rank 1] a = 0.9285069704055786, b = 0.9995673763960166, delta = 0.0036009964533150196, c = 0.00013475273805231826, d = 0.0001358926612401487, m = 0.0001007229281080131
[Iteration 3070] [Rank 1] a = 0.9021931886672974, b = 0.9996780698303113, delta = 0.0035337309818714857, c = 0.00035613963837974913, d = 0.00036076841738487875, m = 0.00010071702729872869
[Iteration 3080] [Rank 1] a = 0.9448505640029907, b = 0.9995499839350082, delta = 0.004002290312200785, c = 9.996780926003821e-05, d = 0.00010103864619406073, m = 0.00010064942217796283
[Iteration 3090] [Rank 1] a = 1.0317966938018799, b = 0.9995113819992004, delta = 0.003960469737648964, c = 2.2763920629704624e-05, d = 2.2971179391128336e-05, m = 0.0001006392154461471
[Iteration 3100] [Rank 1] a = 0.9217930436134338, b = 0.9996576375730024, delta = 0.003465337911620736, c = 0.00031527511925237344, d = 0.0003225637190291074, m = 0.00010123755044236676
[Iteration 3110] [Rank 3] a = 0.9680685997009277, b = 0.9995005700031182, delta = 0.04344324395060539, c = 1.1399231878304288e-06, d = 1.3126388223501907e-06, m = 5.792852402222717e-06
[Iteration 3120] [Rank 3] a = 0.9640342593193054, b = 0.9995000173132257, delta = 0.04849980026483536, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 5.785016377213971e-06
[Iteration 3130] [Rank 3] a = 1.0082117319107056, b = 0.9995000345847849, delta = 0.047795310616493225, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 5.768900780083758e-06
[Iteration 3140] [Rank 3] a = 0.9885598421096802, b = 0.9995000173132257, delta = 0.051592253148555756, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 5.755142283545052e-06
[Iteration 3150] [Rank 3] a = 1.0752087831497192, b = 0.9995000000416666, delta = 0.04765673726797104, c = 0.0, d = 0.0, m = 5.748421398046611e-06
[Iteration 3110] [Rank 1] a = 0.9591746926307678, b = 0.9996225935753007, delta = 0.003591312561184168, c = 0.00024518711476425404, d = 0.00024815782367799396, m = 0.00010115777612287862
[Iteration 3120] [Rank 1] a = 0.9586672186851501, b = 0.9998196102836354, delta = 0.0034368643537163734, c = 0.0006392205633576389, d = 0.0006508270539973669, m = 0.00010151309676150438
[Iteration 3130] [Rank 1] a = 0.9791485071182251, b = 0.9995379974724653, delta = 0.0035032168962061405, c = 7.599487918869525e-05, d = 7.730751801104545e-05, m = 0.00010226617940129204
[Iteration 3140] [Rank 1] a = 0.9728122353553772, b = 0.9995869968885897, delta = 0.003271897090598941, c = 0.00017399373021520818, d = 0.0001773098703979876, m = 0.00010742930063118695
[Iteration 3150] [Rank 1] a = 0.9942000508308411, b = 0.9995205531972445, delta = 0.003365657990798354, c = 4.110632101570334e-05, d = 4.12790366502231e-05, m = 0.00011104203317791038
[Iteration 3160] [Rank 3] a = 0.9355287551879883, b = 0.9996072391576691, delta = 0.042108140885829926, c = 0.00021447827494664037, d = 0.00021744898386038026, m = 5.80163891693619e-06
[Iteration 3170] [Rank 3] a = 0.9678221344947815, b = 0.9995000173132257, delta = 0.04647069424390793, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 6.149297515498794e-06
[Iteration 3180] [Rank 3] a = 1.0362032651901245, b = 0.9995000000416666, delta = 0.04500832036137581, c = 0.0, d = 0.0, m = 6.131149834165108e-06
[Iteration 3190] [Rank 3] a = 1.2032417058944702, b = 0.9995000000416666, delta = 0.04816041886806488, c = 0.0, d = 0.0, m = 6.120444537833194e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3196 |     0.10625s |  92.8%
- batch.accumulate               |   3196 |     0.00082s |   0.7%
- batch.backward                 |   3196 |     0.05170s |  45.2%
[Iteration 3160] [Rank 1] a = 0.9208521246910095, b = 0.9997407656003274, delta = 0.003161816392093897, c = 0.00048153118904109625, d = 0.00048481278609697174, m = 0.00011201338336670729
[Iteration 3170] [Rank 1] a = 1.0135523080825806, b = 0.9995534037038846, delta = 0.003188272938132286, c = 0.00010680734838702078, d = 0.00010825815971698678, m = 0.00011265869917784277
[Iteration 3180] [Rank 1] a = 1.0653225183486938, b = 0.9995201559513766, delta = 0.003075358923524618, c = 4.0311829096912436e-05, d = 4.076088974666381e-05, m = 0.00012025560340757803
[Iteration 3190] [Rank 1] a = 1.0363354682922363, b = 0.9995571516324123, delta = 0.0033074263483285904, c = 0.00011430320692517844, d = 0.00011520132822468121, m = 0.00012042984346194265
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3196 |     0.10616s |  92.7%
- batch.accumulate               |   3196 |     0.00083s |   0.7%
- batch.evaluate                 |   3196 |     0.00277s |   2.4%
- batch.forward                  |   3196 |     0.02538s |  22.2%
- batch.mom                      |   3196 |     0.00126s |   1.1%
- batch.reduce                   |   3196 |     0.02152s |  18.8%
- batch.reporting.compr_err      |   3196 |     0.00001s |   0.0%
- batch.reporting.lr             |   3196 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3196 |     0.00001s |   0.0%
- batch.step                     |   3196 |     0.00047s |   0.4%
- batch.update_runavg            |   3196 |     0.00129s |   1.1%
- batch.wd                       |   3196 |     0.00001s |   0.0%
- epoch_metrics.collect          |     22 |     0.01025s |   0.1%
- reduce.combine                 |   3196 |     0.00530s |   4.6%
- reduce.flatpack                |   3196 |     0.00002s |   0.0%
- reduce.flatput                 |   3196 |     0.00011s |   0.1%
- reduce.gather.context          |   3196 |     0.00265s |   2.3%
- batch.backward                 |   3196 |     0.05172s |  45.2%
- batch.evaluate                 |   3196 |     0.00277s |   2.4%
- batch.forward                  |   3196 |     0.02540s |  22.2%
- batch.mom                      |   3196 |     0.00126s |   1.1%
- batch.reduce                   |   3196 |     0.02138s |  18.7%
- batch.reporting.compr_err      |   3196 |     0.00001s |   0.0%
- batch.reporting.lr             |   3196 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   3196 |     0.00001s |   0.0%
- batch.step                     |   3196 |     0.00048s |   0.4%
- batch.update_runavg            |   3196 |     0.00129s |   1.1%
- batch.wd                       |   3196 |     0.00001s |   0.0%
- epoch_metrics.collect          |     22 |     0.01159s |   0.1%
- reduce.combine                 |   3196 |     0.00533s |   4.7%
- reduce.flatpack                |   3196 |     0.00002s |   0.0%
- reduce.flatput                 |   3196 |     0.00019s |   0.2%
- reduce.gather.tensors          |   3196 |     0.00050s |   0.4%
- reduce.heur_params             |   3196 |     0.01007s |   8.8%
- reduce.heur_params.alpha       |   3195 |     0.00808s |   7.1%
- reduce.heur_params.beta        |   3195 |     0.00191s |   1.7%
- reduce.memory                  |   3196 |     0.00041s |   0.4%
- reduce.gather.context          |   3196 |     0.00129s |   1.1%
- reduce.gather.tensors          |   3196 |     0.00065s |   0.6%
- reduce.heur_params             |   3196 |     0.01066s |   9.3%
- reduce.pad                     |   3196 |     0.00027s |   0.2%
- reduce.threshold               |   3196 |     0.00199s |   1.7%
- test.last                      |     22 |     0.41645s |   2.7%
- test.runavg                    |     22 |     0.44711s |   2.9%
-----------------------------------------------------------------

[Iteration 3200] [Rank 3] a = 0.9617737531661987, b = 0.9995000000416666, delta = 0.0444844625890255, c = 0.0, d = 0.0, m = 6.109083107925542e-06
[Iteration 3210] [Rank 3] a = 0.9062778353691101, b = 0.999500172757258, delta = 0.0425972081720829, c = 3.4543126903952387e-07, d = 3.4543126903952387e-07, m = 6.092209172796778e-06
[Iteration 3220] [Rank 3] a = 0.9903782606124878, b = 0.9995001554856989, delta = 0.04394512251019478, c = 3.1088814213557147e-07, d = 3.1088814213557147e-07, m = 6.077928061059597e-06
- reduce.heur_params.alpha       |   3195 |     0.00823s |   7.2%
- reduce.heur_params.beta        |   3195 |     0.00234s |   2.0%
- reduce.memory                  |   3196 |     0.00044s |   0.4%
- reduce.pad                     |   3196 |     0.00014s |   0.1%
- reduce.threshold               |   3196 |     0.00247s |   2.2%
- test.last                      |     22 |     0.41645s |   2.7%
- test.runavg                    |     22 |     0.44711s |   2.9%
-----------------------------------------------------------------

[Iteration 3200] [Rank 1] a = 1.0263440608978271, b = 0.9995322978577577, delta = 0.003291791770607233, c = 6.459564731039096e-05, d = 6.525196672156605e-05, m = 0.00012069599475234946
[Iteration 3210] [Rank 1] a = 0.9802377820014954, b = 0.9996616963899435, delta = 0.0032281659077852964, c = 0.00032339275407480226, d = 0.00032477447915096034, m = 0.00012101583690607383
[Iteration 3230] [Rank 3] a = 0.9230985045433044, b = 0.9995135927587968, delta = 0.03977171704173088, c = 2.7185440873410527e-05, d = 2.7634501523161908e-05, m = 6.0689953989267145e-06
[Iteration 3240] [Rank 3] a = 1.1004016399383545, b = 0.9995000000416666, delta = 0.048926908522844315, c = 0.0, d = 0.0, m = 6.051069073881521e-06
[Iteration 3250] [Rank 3] a = 1.0645008087158203, b = 0.9995000000416666, delta = 0.04461658373475075, c = 0.0, d = 0.0, m = 6.034156188481895e-06
[Iteration 3260] [Rank 3] a = 0.9546942114830017, b = 0.9995008118049463, delta = 0.04249807819724083, c = 1.6235269644857622e-06, d = 1.692613218293667e-06, m = 6.0182580122579006e-06
[Iteration 3270] [Rank 3] a = 0.9709376096725464, b = 0.9995000518563442, delta = 0.04355534166097641, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 6.006427759983881e-06
[Iteration 3220] [Rank 1] a = 1.0115939378738403, b = 0.9995218140210876, delta = 0.0032258406281471252, c = 4.362796927969186e-05, d = 4.3904314294923486e-05, m = 0.00012118561127359382
[Iteration 3230] [Rank 1] a = 0.9432024359703064, b = 1.0052029369444695, delta = 0.0028169574216008186, c = 0.011405967788050558, d = 0.009592073651197115, m = 0.00012443786742110782
[Iteration 3240] [Rank 1] a = 1.0587334632873535, b = 0.9995083594763222, delta = 0.003174030454829335, c = 1.6718873421512956e-05, d = 1.6718873421512956e-05, m = 0.00012437956813854444
[Iteration 3250] [Rank 1] a = 0.9389403462409973, b = 0.9995636284674551, delta = 0.002759309019893408, c = 0.0001272568795141606, d = 0.00012874223397103053, m = 0.0001324836233155909
[Iteration 3260] [Rank 1] a = 0.9806881546974182, b = 0.9998082974099661, delta = 0.002630501752719283, c = 0.0006165948152355501, d = 0.000624677906931075, m = 0.00013264090410714606
[Iteration 3280] [Rank 3] a = 0.9072954654693604, b = 0.9995015544819897, delta = 0.042834941297769547, c = 3.1088814213557147e-06, d = 3.212510802067572e-06, m = 5.989542372764189e-06
[Iteration 3290] [Rank 3] a = 0.9300559163093567, b = 0.9995001209425806, delta = 0.04290672019124031, c = 2.4180188832766673e-07, d = 2.4180188832766673e-07, m = 5.983486758695588e-06
[Iteration 3300] [Rank 3] a = 1.094186782836914, b = 0.9995000000416666, delta = 0.047267016023397446, c = 0.0, d = 0.0, m = 5.9793618984140165e-06
[Iteration 3310] [Rank 3] a = 1.0597776174545288, b = 0.9995000000416666, delta = 0.04164978116750717, c = 0.0, d = 0.0, m = 5.975689700593542e-06
[Iteration 3320] [Rank 3] a = 0.9904240965843201, b = 0.9995001036710213, delta = 0.04230831563472748, c = 2.0725876142371433e-07, d = 2.763450152316191e-07, m = 5.958101710513241e-06
[Iteration 3330] [Rank 3] a = 1.0552469491958618, b = 0.9995000000416666, delta = 0.04345745965838432, c = 0.0, d = 0.0, m = 6.269147169883201e-06
[Iteration 3270] [Rank 1] a = 1.0477170944213867, b = 0.9995189296706545, delta = 0.00272175925783813, c = 3.785926708673182e-05, d = 3.8135612101963435e-05, m = 0.00013353938827892893
[Iteration 3280] [Rank 1] a = 1.0710593461990356, b = 0.9995129537111004, delta = 0.0026432534214109182, c = 2.590734517796429e-05, d = 2.5976431431772194e-05, m = 0.0001393260016937891
[Iteration 3290] [Rank 1] a = 0.9216547012329102, b = 0.9999160374206285, delta = 0.0024278867058455944, c = 0.0008320748408624051, d = 0.0008349419203954331, m = 0.00014208569494065848
[Iteration 3300] [Rank 1] a = 1.0385714769363403, b = 0.9995304670724339, delta = 0.002587827853858471, c = 6.093407585857201e-05, d = 6.14522227621313e-05, m = 0.00014204940591473628
[Iteration 3310] [Rank 1] a = 0.9991246461868286, b = 0.9998382981147432, delta = 0.0022937527392059565, c = 0.0006765962266677154, d = 0.0007311052809221523, m = 0.00014795140497808257
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3335 |     0.10636s |  92.8%
- batch.accumulate               |   3335 |     0.00082s |   0.7%
- batch.backward                 |   3335 |     0.05171s |  45.1%
- batch.evaluate                 |   3335 |     0.00278s |   2.4%
- batch.forward                  |   3335 |     0.02538s |  22.1%
- batch.mom                      |   3335 |     0.00126s |   1.1%
- batch.reduce                   |   3335 |     0.02163s |  18.9%
- batch.reporting.compr_err      |   3335 |     0.00001s |   0.0%
- batch.reporting.lr             |   3335 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3335 |     0.00001s |   0.0%
- batch.step                     |   3335 |     0.00047s |   0.4%
- batch.update_runavg            |   3335 |     0.00129s |   1.1%
- batch.wd                       |   3335 |     0.00001s |   0.0%
[Iteration 3320] [Rank 1] a = 0.9513128399848938, b = 0.999578412923049, delta = 0.002449873834848404, c = 0.00015682579614394382, d = 0.00015768937431654263, m = 0.00014781535514933782
[Iteration 3330] [Rank 1] a = 1.0002604722976685, b = 0.9995418317587399, delta = 0.002197979250922799, c = 8.366345336137268e-05, d = 8.435431589945172e-05, m = 0.00016131855964247727
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3335 |     0.10627s |  92.7%
- batch.accumulate               |   3335 |     0.00083s |   0.7%
- batch.backward                 |   3335 |     0.05173s |  45.1%
- batch.evaluate                 |   3335 |     0.00277s |   2.4%
- batch.forward                  |   3335 |     0.02540s |  22.2%
- batch.mom                      |   3335 |     0.00126s |   1.1%
- batch.reduce                   |   3335 |     0.02150s |  18.8%
- epoch_metrics.collect          |     23 |     0.00988s |   0.1%
- reduce.combine                 |   3335 |     0.00532s |   4.6%
- reduce.flatpack                |   3335 |     0.00002s |   0.0%
- reduce.flatput                 |   3335 |     0.00011s |   0.1%
- reduce.gather.context          |   3335 |     0.00266s |   2.3%
- reduce.gather.tensors          |   3335 |     0.00058s |   0.5%
- batch.reporting.compr_err      |   3335 |     0.00001s |   0.0%
- batch.reporting.lr             |   3335 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   3335 |     0.00001s |   0.0%
- batch.step                     |   3335 |     0.00048s |   0.4%
- batch.update_runavg            |   3335 |     0.00129s |   1.1%
- reduce.heur_params             |   3335 |     0.01007s |   8.8%
- reduce.heur_params.alpha       |   3334 |     0.00808s |   7.1%
- reduce.heur_params.beta        |   3334 |     0.00192s |   1.7%
- reduce.memory                  |   3335 |     0.00041s |   0.4%
- reduce.pad                     |   3335 |     0.00027s |   0.2%
- reduce.threshold               |   3335 |     0.00199s |   1.7%
- test.last                      |     23 |     0.41621s |   2.7%
- test.runavg                    |     23 |     0.44710s |   2.9%
-----------------------------------------------------------------
- batch.wd                       |   3335 |     0.00001s |   0.0%
- epoch_metrics.collect          |     23 |     0.01116s |   0.1%
- reduce.combine                 |   3335 |     0.00534s |   4.7%
- reduce.flatpack                |   3335 |     0.00002s |   0.0%
- reduce.flatput                 |   3335 |     0.00019s |   0.2%
- reduce.gather.context          |   3335 |     0.00129s |   1.1%
- reduce.gather.tensors          |   3335 |     0.00073s |   0.6%
- reduce.heur_params             |   3335 |     0.01066s |   9.3%
- reduce.heur_params.alpha       |   3334 |     0.00823s |   7.2%
- reduce.heur_params.beta        |   3334 |     0.00235s |   2.1%
- reduce.memory                  |   3335 |     0.00044s |   0.4%
- reduce.pad                     |   3335 |     0.00014s |   0.1%
- reduce.threshold               |   3335 |     0.00248s |   2.2%
- test.last                      |     23 |     0.41621s |   2.7%
- test.runavg                    |     23 |     0.44710s |   2.9%
-----------------------------------------------------------------
[Iteration 3100] [Rank 2] a = 0.9751686453819275, b = 0.9995000000416666, delta = 0.14815343916416168, c = 0.0, d = 0.0, m = 4.2378546273265503e-07
[Iteration 3110] [Rank 2] a = 0.9356784820556641, b = 0.9995000173132257, delta = 0.1439017951488495, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 4.2253428196817833e-07
[Iteration 3120] [Rank 2] a = 0.9396894574165344, b = 0.9995000000416666, delta = 0.1524936407804489, c = 0.0, d = 0.0, m = 4.212357791853645e-07
[Iteration 3130] [Rank 2] a = 1.0202497243881226, b = 0.9995000000416666, delta = 0.1458328664302826, c = 0.0, d = 0.0, m = 4.2201970307569e-07
[Iteration 3140] [Rank 2] a = 1.0864773988723755, b = 0.9995000000416666, delta = 0.1455748975276947, c = 0.0, d = 0.0, m = 4.2098404899181673e-07
[Iteration 3150] [Rank 2] a = 1.126340627670288, b = 0.9995000000416666, delta = 0.14381849765777588, c = 0.0, d = 0.0, m = 4.358836143535544e-07
[Iteration 3160] [Rank 2] a = 1.055920124053955, b = 0.9995000000416666, delta = 0.13796907663345337, c = 0.0, d = 0.0, m = 4.4320328941587975e-07
[Iteration 3170] [Rank 2] a = 1.0181865692138672, b = 0.9995000000416666, delta = 0.12201644480228424, c = 0.0, d = 0.0, m = 4.5791702382041675e-07
[Iteration 3180] [Rank 2] a = 0.8837851285934448, b = 0.9995000000416666, delta = 0.10315994173288345, c = 0.0, d = 0.0, m = 5.443393028338323e-07
[Iteration 3190] [Rank 2] a = 1.0552130937576294, b = 0.9995000345847849, delta = 0.06065293028950691, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 1.7316379668015796e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3196 |     0.10602s |  92.6%
- batch.accumulate               |   3196 |     0.00083s |   0.7%
- batch.backward                 |   3196 |     0.05213s |  45.6%
- batch.evaluate                 |   3196 |     0.00275s |   2.4%
- batch.forward                  |   3196 |     0.02576s |  22.5%
- batch.mom                      |   3196 |     0.00126s |   1.1%
- batch.reduce                   |   3196 |     0.02046s |  17.9%
- batch.reporting.compr_err      |   3196 |     0.00001s |   0.0%
- batch.reporting.lr             |   3196 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3196 |     0.00001s |   0.0%
- batch.step                     |   3196 |     0.00048s |   0.4%
- batch.update_runavg            |   3196 |     0.00130s |   1.1%
- batch.wd                       |   3196 |     0.00001s |   0.0%
- epoch_metrics.collect          |     22 |     0.01624s |   0.1%
- reduce.combine                 |   3196 |     0.00556s |   4.9%
- reduce.flatpack                |   3196 |     0.00002s |   0.0%
- reduce.flatput                 |   3196 |     0.00010s |   0.1%
- reduce.gather.context          |   3196 |     0.00115s |   1.0%
- reduce.gather.tensors          |   3196 |     0.00052s |   0.5%
- reduce.heur_params             |   3196 |     0.01029s |   9.0%
- reduce.heur_params.alpha       |   3195 |     0.00836s |   7.3%
- reduce.heur_params.beta        |   3195 |     0.00185s |   1.6%
- reduce.memory                  |   3196 |     0.00042s |   0.4%
- reduce.pad                     |   3196 |     0.00029s |   0.3%
- reduce.threshold               |   3196 |     0.00191s |   1.7%
- test.last                      |     22 |     0.41645s |   2.7%
- test.runavg                    |     22 |     0.44711s |   2.9%
-----------------------------------------------------------------

[Iteration 3200] [Rank 2] a = 0.9268063902854919, b = 0.9995002418434945, delta = 0.048595111817121506, c = 4.836037766553335e-07, d = 4.836037766553335e-07, m = 3.3641509205475286e-06
[Iteration 3210] [Rank 2] a = 1.0140697956085205, b = 0.999500172757258, delta = 0.04549292102456093, c = 3.4543126903952387e-07, d = 4.1451752284742866e-07, m = 4.877078572887368e-06
[Iteration 3220] [Rank 2] a = 1.101487636566162, b = 0.9995000000416666, delta = 0.049286775290966034, c = 0.0, d = 0.0, m = 4.86467177736785e-06
[Iteration 3230] [Rank 2] a = 1.0424107313156128, b = 0.9995000000416666, delta = 0.04126608744263649, c = 0.0, d = 0.0, m = 4.862466305614483e-06
[Iteration 3240] [Rank 2] a = 0.9550458192825317, b = 0.9995000000416666, delta = 0.0423739030957222, c = 0.0, d = 0.0, m = 5.78565934041583e-06
[Iteration 3250] [Rank 2] a = 0.9650678634643555, b = 0.9995001900288173, delta = 0.03968806192278862, c = 3.7997439594347627e-07, d = 3.7997439594347627e-07, m = 5.871768428262522e-06
[Iteration 3260] [Rank 2] a = 1.1378551721572876, b = 0.9995000000416666, delta = 0.04089643433690071, c = 0.0, d = 0.0, m = 6.051466446125983e-06
[Iteration 3270] [Rank 2] a = 0.9725346565246582, b = 0.9995000345847849, delta = 0.04027455300092697, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 6.0338003631434555e-06
[Iteration 3280] [Rank 2] a = 0.9305962324142456, b = 0.9995013126801616, delta = 0.03658690303564072, c = 2.6252776447003814e-06, d = 2.694363898508286e-06, m = 6.019916320072276e-06
[Iteration 3290] [Rank 2] a = 0.8495875000953674, b = 0.9995007945333871, delta = 0.03802478685975075, c = 1.5889838375818099e-06, d = 1.6235269644857622e-06, m = 6.002453464959755e-06
[Iteration 3300] [Rank 2] a = 0.8980547189712524, b = 0.9995006390893548, delta = 0.03845658153295517, c = 1.2780956954462384e-06, d = 1.347181949254143e-06, m = 5.985661493202296e-06
[Iteration 3310] [Rank 2] a = 1.0633132457733154, b = 0.9995000000416666, delta = 0.04132482409477234, c = 0.0, d = 0.0, m = 5.970087266541144e-06
[Iteration 3320] [Rank 2] a = 0.9301852583885193, b = 0.9995000345847849, delta = 0.03742161765694618, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 6.27862157065935e-06
[Iteration 3330] [Rank 2] a = 1.0332821607589722, b = 0.9995000518563442, delta = 0.04064536839723587, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 6.260705829354866e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3335 |     0.10613s |  92.6%
- batch.accumulate               |   3335 |     0.00083s |   0.7%
- batch.backward                 |   3335 |     0.05214s |  45.5%
- batch.evaluate                 |   3335 |     0.00275s |   2.4%
- batch.forward                  |   3335 |     0.02576s |  22.5%
- batch.mom                      |   3335 |     0.00126s |   1.1%
- batch.reduce                   |   3335 |     0.02057s |  18.0%
- batch.reporting.compr_err      |   3335 |     0.00001s |   0.0%
- batch.reporting.lr             |   3335 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3335 |     0.00001s |   0.0%
- batch.step                     |   3335 |     0.00048s |   0.4%
- batch.update_runavg            |   3335 |     0.00130s |   1.1%
- batch.wd                       |   3335 |     0.00001s |   0.0%
- epoch_metrics.collect          |     23 |     0.01561s |   0.1%
- reduce.combine                 |   3335 |     0.00557s |   4.9%
- reduce.flatpack                |   3335 |     0.00002s |   0.0%
- reduce.flatput                 |   3335 |     0.00010s |   0.1%
- reduce.gather.context          |   3335 |     0.00114s |   1.0%
- reduce.gather.tensors          |   3335 |     0.00060s |   0.5%
- reduce.heur_params             |   3335 |     0.01030s |   9.0%
- reduce.heur_params.alpha       |   3334 |     0.00836s |   7.3%
- reduce.heur_params.beta        |   3334 |     0.00186s |   1.6%
- reduce.memory                  |   3335 |     0.00042s |   0.4%
- reduce.pad                     |   3335 |     0.00029s |   0.3%
- reduce.threshold               |   3335 |     0.00192s |   1.7%
- test.last                      |     23 |     0.41621s |   2.7%
- test.runavg                    |     23 |     0.44711s |   2.9%
-----------------------------------------------------------------

[Iteration 3340] [Rank 2] a = 1.1786359548568726, b = 0.9995000000416666, delta = 0.03826276212930679, c = 0.0, d = 0.0, m = 7.543646126469577e-06
[Iteration 3350] [Rank 2] a = 1.0803290605545044, b = 0.9995000000416666, delta = 0.036627545952796936, c = 0.0, d = 0.0, m = 7.5218560809961606e-06
perplexity                     - bits:1057180224.000, epoch: 24.000, ratio_transmit_grad:  0.116, value:657.092 (split:train)
last_perplexity                - bits:1057180224.000, epoch: 24.000, ratio_transmit_grad:  0.116, value:657.092 (split:train)
last_cross_entropy             - bits:1057180224.000, epoch: 24.000, ratio_transmit_grad:  0.116, value:  6.116 (split:test)
last_perplexity                - bits:1057180224.000, epoch: 24.000, ratio_transmit_grad:  0.116, value:454.357 (split:test)
runavg_cross_entropy           - bits:1057180224.000, epoch: 24.000, ratio_transmit_grad:  0.116, value:  6.217 (split:test)
runavg_perplexity              - bits:1057180224.000, epoch: 24.000, ratio_transmit_grad:  0.116, value:502.846 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3335 |     0.10615s |  92.6%
- batch.accumulate               |   3335 |     0.00083s |   0.7%
- batch.backward                 |   3335 |     0.05175s |  45.2%
- batch.evaluate                 |   3335 |     0.00275s |   2.4%
- batch.forward                  |   3335 |     0.02552s |  22.3%
- batch.mom                      |   3335 |     0.00126s |   1.1%
- batch.reduce                   |   3335 |     0.02120s |  18.5%
- batch.reporting.compr_err      |   3335 |     0.00001s |   0.0%
- batch.reporting.lr             |   3335 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3335 |     0.00001s |   0.0%
- batch.step                     |   3335 |     0.00048s |   0.4%
- batch.update_runavg            |   3335 |     0.00130s |   1.1%
- batch.wd                       |   3335 |     0.00001s |   0.0%
- epoch_metrics.collect          |     23 |     0.00822s |   0.1%
- reduce.combine                 |   3335 |     0.00560s |   4.9%
- reduce.flatpack                |   3335 |     0.00002s |   0.0%
- reduce.flatput                 |   3335 |     0.00009s |   0.1%
- reduce.gather.context          |   3335 |     0.00146s |   1.3%
- reduce.gather.tensors          |   3335 |     0.00061s |   0.5%
- reduce.heur_params             |   3335 |     0.01062s |   9.3%
- reduce.heur_params.alpha       |   3334 |     0.00873s |   7.6%
- reduce.heur_params.beta        |   3334 |     0.00181s |   1.6%
- reduce.memory                  |   3335 |     0.00042s |   0.4%
- reduce.pad                     |   3335 |     0.00029s |   0.3%
- reduce.threshold               |   3335 |     0.00186s |   1.6%
- test.last                      |     23 |     0.41620s |   2.7%
- test.runavg                    |     23 |     0.44712s |   2.9%
-----------------------------------------------------------------

[Iteration 3340] [Rank 0] a = 1.0424522161483765, b = 0.9995000000416666, delta = 0.2615952491760254, c = 0.0, d = 0.0, m = 1.0792013128508143e-07
[Iteration 3350] [Rank 0] a = 1.1448673009872437, b = 0.9995000000416666, delta = 0.26622241735458374, c = 0.0, d = 0.0, m = 1.1080396033738772e-07
[Iteration 3360] [Rank 0] a = 0.9524804353713989, b = 0.9995000000416666, delta = 0.2440846562385559, c = 0.0, d = 0.0, m = 1.1047428476363768e-07
[Iteration 3370] [Rank 0] a = 0.9929032921791077, b = 0.9995000000416666, delta = 0.24580523371696472, c = 0.0, d = 0.0, m = 1.1014656514108166e-07
[Iteration 3380] [Rank 0] a = 1.0222619771957397, b = 0.9995000000416666, delta = 0.25782641768455505, c = 0.0, d = 0.0, m = 1.0987186830082994e-07
[Iteration 3390] [Rank 0] a = 1.1366485357284546, b = 0.9995000000416666, delta = 0.22936663031578064, c = 0.0, d = 0.0, m = 1.1746293020627454e-07
[Iteration 3400] [Rank 0] a = 0.929290771484375, b = 0.9995000000416666, delta = 0.2412467896938324, c = 0.0, d = 0.0, m = 1.1711755258143987e-07
[Iteration 3410] [Rank 0] a = 1.0281494855880737, b = 0.9995000000416666, delta = 0.24098464846611023, c = 0.0, d = 0.0, m = 1.1677420003795865e-07
[Iteration 3420] [Rank 0] a = 1.1380655765533447, b = 0.9995000000416666, delta = 0.24600614607334137, c = 0.0, d = 0.0, m = 1.1647324432537059e-07
[Iteration 3430] [Rank 0] a = 0.9568501710891724, b = 0.9995000000416666, delta = 0.21486245095729828, c = 0.0, d = 0.0, m = 1.1619417883955596e-07
[Iteration 3440] [Rank 0] a = 1.0052189826965332, b = 0.9995000000416666, delta = 0.23867817223072052, c = 0.0, d = 0.0, m = 1.1601712224033123e-07
[Iteration 3450] [Rank 0] a = 1.0263762474060059, b = 0.9995000000416666, delta = 0.24008753895759583, c = 0.0, d = 0.0, m = 1.1577102456421772e-07
[Iteration 3460] [Rank 0] a = 0.8722144961357117, b = 0.9995009672489787, delta = 0.20219574868679047, c = 1.934415106621334e-06, d = 2.0035013604292384e-06, m = 1.1601540223390481e-07
[Iteration 3470] [Rank 0] a = 1.0686891078948975, b = 0.9995000000416666, delta = 0.24674248695373535, c = 0.0, d = 0.0, m = 1.1573091984041036e-07
cross_entropy                  - bits:1217776192.000, epoch: 25.000, ratio_transmit_grad:  0.062, value:  6.384 (split:train)
last_cross_entropy             - bits:1217776192.000, epoch: 25.000, ratio_transmit_grad:  0.062, value:  6.384 (split:train)
perplexity                     - bits:1217776192.000, epoch: 25.000, ratio_transmit_grad:  0.062, value:594.151 (split:train)
last_perplexity                - bits:1217776192.000, epoch: 25.000, ratio_transmit_grad:  0.062, value:594.151 (split:train)
last_cross_entropy             - bits:1217776192.000, epoch: 25.000, ratio_transmit_grad:  0.062, value:  6.103 (split:test)
last_perplexity                - bits:1217776192.000, epoch: 25.000, ratio_transmit_grad:  0.062, value:448.839 (split:test)
runavg_cross_entropy           - bits:1217776192.000, epoch: 25.000, ratio_transmit_grad:  0.062, value:  6.201 (split:test)
runavg_perplexity              - bits:1217776192.000, epoch: 25.000, ratio_transmit_grad:  0.062, value:494.731 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3474 |     0.10621s |  92.6%
- batch.accumulate               |   3474 |     0.00083s |   0.7%
- batch.backward                 |   3474 |     0.05176s |  45.1%
- batch.evaluate                 |   3474 |     0.00275s |   2.4%
- batch.forward                  |   3474 |     0.02552s |  22.3%
- batch.mom                      |   3474 |     0.00126s |   1.1%
- batch.reduce                   |   3474 |     0.02125s |  18.5%
- batch.reporting.compr_err      |   3474 |     0.00001s |   0.0%
- batch.reporting.lr             |   3474 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3474 |     0.00001s |   0.0%
- batch.step                     |   3474 |     0.00048s |   0.4%
- batch.update_runavg            |   3474 |     0.00130s |   1.1%
- batch.wd                       |   3474 |     0.00001s |   0.0%
- epoch_metrics.collect          |     24 |     0.00888s |   0.1%
- reduce.combine                 |   3474 |     0.00562s |   4.9%
- reduce.flatpack                |   3474 |     0.00002s |   0.0%
- reduce.flatput                 |   3474 |     0.00009s |   0.1%
- reduce.gather.context          |   3474 |     0.00147s |   1.3%
- reduce.gather.tensors          |   3474 |     0.00064s |   0.6%
- reduce.heur_params             |   3474 |     0.01062s |   9.3%
- reduce.heur_params.alpha       |   3473 |     0.00873s |   7.6%
- reduce.heur_params.beta        |   3473 |     0.00181s |   1.6%
- reduce.memory                  |   3474 |     0.00042s |   0.4%
- reduce.pad                     |   3474 |     0.00029s |   0.3%
- reduce.threshold               |   3474 |     0.00186s |   1.6%
- test.last                      |     24 |     0.41633s |   2.7%
- test.runavg                    |     24 |     0.44720s |   2.9%
-----------------------------------------------------------------

[Iteration 3480] [Rank 0] a = 1.0219286680221558, b = 0.9995000000416666, delta = 0.22378040850162506, c = 0.0, d = 0.0, m = 1.1539845526172489e-07
[Iteration 3490] [Rank 0] a = 1.0082772970199585, b = 0.9995000000416666, delta = 0.21765010058879852, c = 0.0, d = 0.0, m = 1.1507779028730115e-07
[Iteration 3500] [Rank 0] a = 0.9168140888214111, b = 0.9995000000416666, delta = 0.22144284844398499, c = 0.0, d = 0.0, m = 1.1495629007653564e-07

[Iteration 3340] [Rank 3] a = 0.9569110870361328, b = 0.999500172757258, delta = 0.04122244939208031, c = 3.4543126903952387e-07, d = 3.7997439594347627e-07, m = 6.252605805197634e-06
[Iteration 3350] [Rank 3] a = 0.944050133228302, b = 0.999504352474578, delta = 0.039515312761068344, c = 8.704867979796002e-06, d = 8.946669868123668e-06, m = 6.2384000674389145e-06
[Iteration 3360] [Rank 3] a = 1.152984857559204, b = 0.9995000000416666, delta = 0.04695839807391167, c = 0.0, d = 0.0, m = 6.22232611207931e-06
[Iteration 3370] [Rank 3] a = 1.0848981142044067, b = 0.9995000000416666, delta = 0.044558338820934296, c = 0.0, d = 0.0, m = 6.250871369269352e-06
[Iteration 3380] [Rank 3] a = 1.0796359777450562, b = 0.9995000000416666, delta = 0.042876072227954865, c = 0.0, d = 0.0, m = 6.2362961855697135e-06
[Iteration 3390] [Rank 3] a = 1.0403887033462524, b = 0.9995001036710213, delta = 0.04217826575040817, c = 2.0725876142371433e-07, d = 2.0725876142371433e-07, m = 6.231677885870052e-06

[Iteration 3340] [Rank 1] a = 0.9657845497131348, b = 0.9996608846265546, delta = 0.0021586415823549032, c = 0.00032176922711031646, d = 0.0003234963834555141, m = 0.00016143123966945005
[Iteration 3350] [Rank 1] a = 0.9642375111579895, b = 0.9998385917313143, delta = 0.0021067794878035784, c = 0.0006771834598250826, d = 0.0006816049800687885, m = 0.0001616760078285793
[Iteration 3360] [Rank 1] a = 0.9845759272575378, b = 0.9997167926720211, delta = 0.002102526603266597, c = 0.00043358532889841035, d = 0.0004421520243705905, m = 0.00016181548453448244
[Iteration 3370] [Rank 1] a = 1.0323026180267334, b = 0.9995239211513489, delta = 0.0023876430932432413, c = 4.784223076197406e-05, d = 4.7980403269589866e-05, m = 0.00016211167334329366
[Iteration 3380] [Rank 1] a = 0.9518753290176392, b = 0.9996015740857436, delta = 0.0021021177526563406, c = 0.00020314812932214398, d = 0.00020497891504805347, m = 0.0001640925012383486
[Iteration 3400] [Rank 3] a = 1.0660032033920288, b = 0.9995000173132257, delta = 0.04137911647558212, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 6.2202106208895965e-06
[Iteration 3410] [Rank 3] a = 0.9282573461532593, b = 0.9995317278962886, delta = 0.03777233883738518, c = 6.345572412256053e-05, d = 7.088249640691029e-05, m = 6.2268669972370075e-06
[Iteration 3420] [Rank 3] a = 0.9918710589408875, b = 0.9995000345847849, delta = 0.042941536754369736, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 6.209594064674247e-06
[Iteration 3430] [Rank 3] a = 1.0552048683166504, b = 0.9995000000416666, delta = 0.041081853210926056, c = 0.0, d = 0.0, m = 6.1996204018251495e-06
[Iteration 3440] [Rank 3] a = 0.9692499041557312, b = 0.9995000345847849, delta = 0.04148098826408386, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 6.204531851354466e-06
[Iteration 3390] [Rank 1] a = 1.0209697484970093, b = 0.9996351845433231, delta = 0.002075271215289831, c = 0.00027036905427723533, d = 0.00027171623622648946, m = 0.00016662279127752926
[Iteration 3400] [Rank 1] a = 0.9924114942550659, b = 0.9995939055128118, delta = 0.0021996567957103252, c = 0.00018781098097678912, d = 0.00019033262924077765, m = 0.00016662591789900826
[Iteration 3410] [Rank 1] a = 1.0486780405044556, b = 0.9995519874359647, delta = 0.0022040652111172676, c = 0.00010397481198089668, d = 0.00010480384702659155, m = 0.0001668424421528368
[Iteration 3420] [Rank 1] a = 0.9920192360877991, b = 0.9995742159338836, delta = 0.0021773315966129303, c = 0.0001484318163062834, d = 0.00014991717076315335, m = 0.00016701843185372588
[Iteration 3430] [Rank 1] a = 1.0552310943603516, b = 0.9995439561606007, delta = 0.0023246530909091234, c = 8.791225797055882e-05, d = 8.856857738173392e-05, m = 0.00016705199135601864
[Iteration 3450] [Rank 3] a = 0.9228456020355225, b = 0.9995004663737636, delta = 0.0393785685300827, c = 9.326644264067144e-07, d = 9.67207553310667e-07, m = 6.403330802628112e-06
[Iteration 3460] [Rank 3] a = 0.9330832958221436, b = 0.9995000345847849, delta = 0.043591707944869995, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 6.385567983606041e-06
[Iteration 3470] [Rank 3] a = 1.0789477825164795, b = 0.9995000000416666, delta = 0.04246820881962776, c = 0.0, d = 0.0, m = 6.370922947307202e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3474 |     0.10642s |  92.8%
- batch.accumulate               |   3474 |     0.00082s |   0.7%
- batch.backward                 |   3474 |     0.05171s |  45.1%
- batch.evaluate                 |   3474 |     0.00277s |   2.4%
- batch.forward                  |   3474 |     0.02538s |  22.1%
[Iteration 3440] [Rank 1] a = 1.000909686088562, b = 0.9996235089680338, delta = 0.0020737946033477783, c = 0.00024701790049016354, d = 0.00025282114581002754, m = 0.00016766621439183967
[Iteration 3450] [Rank 1] a = 1.0161088705062866, b = 0.9996395024336182, delta = 0.002016931539401412, c = 0.0002790048360032234, d = 0.0002808356217291329, m = 0.0001687564776831691
[Iteration 3460] [Rank 1] a = 0.9232189655303955, b = 1.0003743901538273, delta = 0.0019283281872048974, c = 0.0017487803426394935, d = 0.0016252195777040558, m = 0.00017126393490944506
[Iteration 3470] [Rank 1] a = 0.9331442713737488, b = 0.9996434576211403, delta = 0.0019269048934802413, c = 0.00028691521206422854, d = 0.0002890223428053696, m = 0.0001776361939736663
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3474 |     0.10633s |  92.7%
- batch.accumulate               |   3474 |     0.00083s |   0.7%
- batch.mom                      |   3474 |     0.00126s |   1.1%
- batch.reduce                   |   3474 |     0.02168s |  18.9%
- batch.reporting.compr_err      |   3474 |     0.00001s |   0.0%
- batch.reporting.lr             |   3474 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3474 |     0.00001s |   0.0%
- batch.step                     |   3474 |     0.00047s |   0.4%
- batch.update_runavg            |   3474 |     0.00129s |   1.1%
- batch.wd                       |   3474 |     0.00001s |   0.0%
- epoch_metrics.collect          |     24 |     0.01048s |   0.1%
- reduce.combine                 |   3474 |     0.00533s |   4.7%
- reduce.flatpack                |   3474 |     0.00002s |   0.0%
- reduce.flatput                 |   3474 |     0.00011s |   0.1%
- reduce.gather.context          |   3474 |     0.00266s |   2.3%
- reduce.gather.tensors          |   3474 |     0.00060s |   0.5%
- reduce.heur_params             |   3474 |     0.01008s |   8.8%
- batch.backward                 |   3474 |     0.05173s |  45.1%
- batch.evaluate                 |   3474 |     0.00277s |   2.4%
- batch.forward                  |   3474 |     0.02540s |  22.2%
- batch.mom                      |   3474 |     0.00126s |   1.1%
- batch.reduce                   |   3474 |     0.02156s |  18.8%
- batch.reporting.compr_err      |   3474 |     0.00001s |   0.0%
- batch.reporting.lr             |   3474 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   3474 |     0.00001s |   0.0%
- batch.step                     |   3474 |     0.00048s |   0.4%
- batch.update_runavg            |   3474 |     0.00129s |   1.1%
- batch.wd                       |   3474 |     0.00001s |   0.0%
- epoch_metrics.collect          |     24 |     0.01172s |   0.1%
- reduce.combine                 |   3474 |     0.00536s |   4.7%
- reduce.flatpack                |   3474 |     0.00002s |   0.0%
- reduce.flatput                 |   3474 |     0.00019s |   0.2%
[Iteration 3360] [Rank 2] a = 0.939938485622406, b = 0.9995000173132257, delta = 0.03703846409916878, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 7.501480403797799e-06
[Iteration 3370] [Rank 2] a = 0.9485400915145874, b = 0.9995000863994624, delta = 0.0366644561290741, c = 1.7271563451976193e-07, d = 1.7271563451976193e-07, m = 7.482188846288829e-06
[Iteration 3380] [Rank 2] a = 1.1393206119537354, b = 0.9995000000416666, delta = 0.03818682208657265, c = 0.0, d = 0.0, m = 7.47119509292072e-06
[Iteration 3390] [Rank 2] a = 0.8871657252311707, b = 0.9995078413295442, delta = 0.033886730670928955, c = 1.5682579614394383e-05, d = 1.606255401033786e-05, m = 7.454235649178155e-06
[Iteration 3400] [Rank 2] a = 1.045275092124939, b = 0.9995000000416666, delta = 0.03426694869995117, c = 0.0, d = 0.0, m = 7.4509555202093145e-06
[Iteration 3410] [Rank 2] a = 1.0839316844940186, b = 0.9995000000416666, delta = 0.03841172531247139, c = 0.0, d = 0.0, m = 7.43111675853382e-06
- reduce.heur_params.alpha       |   3473 |     0.00808s |   7.0%
- reduce.heur_params.beta        |   3473 |     0.00192s |   1.7%
- reduce.memory                  |   3474 |     0.00041s |   0.4%
- reduce.gather.context          |   3474 |     0.00130s |   1.1%
- reduce.gather.tensors          |   3474 |     0.00076s |   0.7%
- reduce.heur_params             |   3474 |     0.01067s |   9.3%
[Iteration 3420] [Rank 2] a = 0.9698580503463745, b = 0.9995021417150015, delta = 0.03341306000947952, c = 4.283347736090096e-06, d = 4.317890862994048e-06, m = 7.562268987046099e-06
[Iteration 3430] [Rank 2] a = 0.9955044984817505, b = 0.999500172757258, delta = 0.036632996052503586, c = 3.4543126903952387e-07, d = 3.7997439594347627e-07, m = 7.540721310959778e-06
[Iteration 3440] [Rank 2] a = 0.9564943909645081, b = 0.9995003109297312, delta = 0.036532867699861526, c = 6.217762842711429e-07, d = 6.217762842711429e-07, m = 7.526145261165298e-06
[Iteration 3450] [Rank 2] a = 1.0509947538375854, b = 0.9995000691279032, delta = 0.03595435991883278, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 7.507799990025662e-06
[Iteration 3460] [Rank 2] a = 1.0727649927139282, b = 0.9995000000416666, delta = 0.039027318358421326, c = 0.0, d = 0.0, m = 7.487604517369012e-06
- reduce.pad                     |   3474 |     0.00027s |   0.2%
- reduce.threshold               |   3474 |     0.00200s |   1.7%
- test.last                      |     24 |     0.41634s |   2.7%
- test.runavg                    |     24 |     0.44718s |   2.9%
-----------------------------------------------------------------

[Iteration 3480] [Rank 3] a = 1.0464646816253662, b = 0.9995000000416666, delta = 0.041542164981365204, c = 0.0, d = 0.0, m = 6.3543476168298155e-06
[Iteration 3490] [Rank 3] a = 0.9570273756980896, b = 0.9995000518563442, delta = 0.04180208221077919, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 6.349127653017066e-06
[Iteration 3500] [Rank 3] a = 0.9499046206474304, b = 0.9995090157955752, delta = 0.03800634294748306, c = 1.8031512243863145e-05, d = 1.8998719797173813e-05, m = 6.343769776070607e-06
[Iteration 3510] [Rank 3] a = 1.09543776512146, b = 0.9995000000416666, delta = 0.040158845484256744, c = 0.0, d = 0.0, m = 6.539443867277573e-06
- reduce.heur_params.alpha       |   3473 |     0.00823s |   7.2%
- reduce.heur_params.beta        |   3473 |     0.00236s |   2.1%
- reduce.memory                  |   3474 |     0.00044s |   0.4%
- reduce.pad                     |   3474 |     0.00014s |   0.1%
- reduce.threshold               |   3474 |     0.00249s |   2.2%
- test.last                      |     24 |     0.41634s |   2.7%
- test.runavg                    |     24 |     0.44718s |   2.9%
-----------------------------------------------------------------

[Iteration 3480] [Rank 1] a = 0.9484570622444153, b = 0.9997823037080615, delta = 0.0019402350299060345, c = 0.0005646074092451017, d = 0.0005669563418745705, m = 0.0001785898912202995
[Iteration 3490] [Rank 1] a = 0.971196711063385, b = 1.004537703939241, delta = 0.0017577710095793009, c = 0.010075470169091024, d = 0.0084846210026564, m = 0.0001823500995042115
[Iteration 3470] [Rank 2] a = 1.0170016288757324, b = 0.9995000000416666, delta = 0.040234822779893875, c = 0.0, d = 0.0, m = 7.478243633340623e-06
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3474 |     0.10619s |  92.6%
- batch.accumulate               |   3474 |     0.00083s |   0.7%
- batch.backward                 |   3474 |     0.05214s |  45.5%
- batch.evaluate                 |   3474 |     0.00275s |   2.4%
- batch.forward                  |   3474 |     0.02576s |  22.5%
- batch.mom                      |   3474 |     0.00126s |   1.1%
- batch.reduce                   |   3474 |     0.02062s |  18.0%
- batch.reporting.compr_err      |   3474 |     0.00001s |   0.0%
- batch.reporting.lr             |   3474 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3474 |     0.00001s |   0.0%
- batch.step                     |   3474 |     0.00048s |   0.4%
[Iteration 3520] [Rank 3] a = 0.9633141160011292, b = 0.9995000518563442, delta = 0.04157528281211853, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 6.521342086936369e-06
[Iteration 3530] [Rank 3] a = 1.0038962364196777, b = 0.9995000173132257, delta = 0.040064044296741486, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 6.512783255637683e-06
[Iteration 3540] [Rank 3] a = 1.0206687450408936, b = 0.9995000863994624, delta = 0.03699739649891853, c = 1.7271563451976193e-07, d = 1.7271563451976193e-07, m = 6.681270928482257e-06
[Iteration 3550] [Rank 3] a = 1.0644482374191284, b = 0.9995000000416666, delta = 0.040107909590005875, c = 0.0, d = 0.0, m = 6.734032296681203e-06
[Iteration 3560] [Rank 3] a = 1.0479254722595215, b = 0.9995000000416666, delta = 0.038550328463315964, c = 0.0, d = 0.0, m = 6.879805490301418e-06
[Iteration 3500] [Rank 1] a = 0.9950911998748779, b = 0.999624044386425, delta = 0.0018470478244125843, c = 0.00024808873742418605, d = 0.00025012678191151924, m = 0.00018256555634319817
[Iteration 3510] [Rank 1] a = 1.0341095924377441, b = 0.9996340273487262, delta = 0.0019946692045778036, c = 0.0002680546647746705, d = 0.00026947093297773257, m = 0.0001827435111469599
[Iteration 3520] [Rank 1] a = 1.0034959316253662, b = 0.9996159267527748, delta = 0.0017771362327039242, c = 0.00023185346777932842, d = 0.00023472054731235646, m = 0.00018568079532277544
[Iteration 3530] [Rank 1] a = 1.0701298713684082, b = 0.9995646474895051, delta = 0.001686231349594891, c = 0.0001292949240014938, d = 0.00012998578653957284, m = 0.0001968728043840763
[Iteration 3540] [Rank 1] a = 1.0568790435791016, b = 0.9996790543093265, delta = 0.0018468932248651981, c = 0.0003581085966132744, d = 0.00035942123543562457, m = 0.0001971650861000019
- batch.update_runavg            |   3474 |     0.00130s |   1.1%
- batch.wd                       |   3474 |     0.00001s |   0.0%
- epoch_metrics.collect          |     24 |     0.01499s |   0.1%
- reduce.combine                 |   3474 |     0.00558s |   4.9%
- reduce.flatpack                |   3474 |     0.00002s |   0.0%
- reduce.flatput                 |   3474 |     0.00010s |   0.1%
- reduce.gather.context          |   3474 |     0.00113s |   1.0%
- reduce.gather.tensors          |   3474 |     0.00063s |   0.5%
- reduce.heur_params             |   3474 |     0.01031s |   9.0%
- reduce.heur_params.alpha       |   3473 |     0.00836s |   7.3%
- reduce.heur_params.beta        |   3473 |     0.00187s |   1.6%
- reduce.memory                  |   3474 |     0.00042s |   0.4%
- reduce.pad                     |   3474 |     0.00029s |   0.3%
- reduce.threshold               |   3474 |     0.00193s |   1.7%
- test.last                      |     24 |     0.41635s |   2.7%
[Iteration 3570] [Rank 3] a = 1.0250129699707031, b = 0.9995000345847849, delta = 0.03344317153096199, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 8.32934327256043e-06
[Iteration 3580] [Rank 3] a = 1.1119102239608765, b = 0.9995000000416666, delta = 0.03292912244796753, c = 0.0, d = 0.0, m = 1.013892381927553e-05
[Iteration 3590] [Rank 3] a = 1.0102390050888062, b = 0.9995017790122589, delta = 0.021507803350687027, c = 3.557942071107096e-06, d = 3.76520083253081e-06, m = 1.8111805053739892e-05
[Iteration 3600] [Rank 3] a = 0.9196208119392395, b = 1.0055673909029306, delta = 0.008978958241641521, c = 0.012134896851977762, d = 0.011336225214831479, m = 4.8730673079236887e-05
[Iteration 3610] [Rank 3] a = 0.883395791053772, b = 1.0181881573154794, delta = 0.002962155733257532, c = 0.03738032663220851, d = 0.03184257978572829, m = 0.00011043155471735351
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
[Iteration 3550] [Rank 1] a = 1.020700216293335, b = 0.999607930020101, delta = 0.0016681269044056535, c = 0.00021586000002279845, d = 0.00021737989760657237, m = 0.00019834908606745092
[Iteration 3560] [Rank 1] a = 0.9940561056137085, b = 0.9995962026303741, delta = 0.0018568807281553745, c = 0.0001924052168550148, d = 0.00019326879502761361, m = 0.00019858858207683284
[Iteration 3570] [Rank 1] a = 1.0251137018203735, b = 0.9996234398817897, delta = 0.0016944566741585732, c = 0.0002468797279825477, d = 0.00024895231559678486, m = 0.00019973213232081803
[Iteration 3580] [Rank 1] a = 1.0101354122161865, b = 0.9996819904748137, delta = 0.0016260338015854359, c = 0.0003639809281869463, d = 0.00036746978400424546, m = 0.00020094846235749273
[Iteration 3590] [Rank 1] a = 1.0588111877441406, b = 0.9996221099715931, delta = 0.0019482069183140993, c = 0.00024421990721094336, d = 0.0002451525716373501, m = 0.00020200594558437683
- test.runavg                    |     24 |     0.44718s |   2.9%
-----------------------------------------------------------------

- batch                          |   3613 |     0.10686s |  92.8%
- batch.accumulate               |   3613 |     0.00082s |   0.7%
- batch.backward                 |   3613 |     0.05172s |  44.9%
- batch.evaluate                 |   3613 |     0.00277s |   2.4%
- batch.forward                  |   3613 |     0.02538s |  22.1%
- batch.mom                      |   3613 |     0.00126s |   1.1%
- batch.reduce                   |   3613 |     0.02212s |  19.2%
- batch.reporting.compr_err      |   3613 |     0.00001s |   0.0%
- batch.reporting.lr             |   3613 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3613 |     0.00001s |   0.0%
- batch.step                     |   3613 |     0.00047s |   0.4%
- batch.update_runavg            |   3613 |     0.00129s |   1.1%
- batch.wd                       |   3613 |     0.00001s |   0.0%
- epoch_metrics.collect          |     25 |     0.01009s |   0.1%
- reduce.combine                 |   3613 |     0.00535s |   4.6%
[Iteration 3600] [Rank 1] a = 0.9412220120429993, b = 1.000206752373509, delta = 0.0018715157639235258, c = 0.0014135047529097316, d = 0.001409566836442681, m = 0.00020381198855496478
[Iteration 3610] [Rank 1] a = 0.9924218058586121, b = 0.9996726292883973, delta = 0.0018789188470691442, c = 0.0003452585534050041, d = 0.0003477456585420887, m = 0.0002047837478159586
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3613 |     0.10678s |  92.8%
- batch.accumulate               |   3613 |     0.00083s |   0.7%
- batch.backward                 |   3613 |     0.05173s |  45.0%
- batch.evaluate                 |   3613 |     0.00277s |   2.4%
- batch.forward                  |   3613 |     0.02540s |  22.1%
- batch.mom                      |   3613 |     0.00126s |   1.1%
- batch.reduce                   |   3613 |     0.02201s |  19.1%
[Iteration 3480] [Rank 2] a = 0.8602973818778992, b = 1.000365374398939, delta = 0.031061869114637375, c = 0.0017307488303956303, d = 0.0017079849097659259, m = 8.134494567504897e-06
[Iteration 3490] [Rank 2] a = 0.9416248202323914, b = 0.9995000345847849, delta = 0.037133991718292236, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 8.112331151268548e-06
[Iteration 3500] [Rank 2] a = 0.9864835739135742, b = 0.9995003109297312, delta = 0.03558571636676788, c = 6.217762842711429e-07, d = 6.217762842711429e-07, m = 8.09061007961536e-06
[Iteration 3510] [Rank 2] a = 0.9986670613288879, b = 0.9995000000416666, delta = 0.03644763305783272, c = 0.0, d = 0.0, m = 8.077946137173752e-06
[Iteration 3520] [Rank 2] a = 1.1346557140350342, b = 0.9995000000416666, delta = 0.03719353303313255, c = 0.0, d = 0.0, m = 8.065785794968614e-06
[Iteration 3530] [Rank 2] a = 1.1357430219650269, b = 0.9995000000416666, delta = 0.03966900706291199, c = 0.0, d = 0.0, m = 8.057490063378837e-06
- reduce.flatpack                |   3613 |     0.00002s |   0.0%
- reduce.flatput                 |   3613 |     0.00011s |   0.1%
- reduce.gather.context          |   3613 |     0.00267s |   2.3%
- batch.reporting.compr_err      |   3613 |     0.00001s |   0.0%
- batch.reporting.lr             |   3613 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   3613 |     0.00001s |   0.0%
- batch.step                     |   3613 |     0.00048s |   0.4%
- batch.update_runavg            |   3613 |     0.00129s |   1.1%
[Iteration 3540] [Rank 2] a = 0.9211010336875916, b = 0.9995000691279032, delta = 0.03189064934849739, c = 1.3817250761580954e-07, d = 1.3817250761580954e-07, m = 9.172492755641215e-06
[Iteration 3550] [Rank 2] a = 0.9706488847732544, b = 0.9995000345847849, delta = 0.03306572511792183, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 9.147916899773625e-06
[Iteration 3560] [Rank 2] a = 0.9230119585990906, b = 0.9995054578543678, delta = 0.027116959914565086, c = 1.0915628101648954e-05, d = 1.1330145624496382e-05, m = 1.085788161626305e-05
[Iteration 3570] [Rank 2] a = 0.9707188010215759, b = 0.9995000345847849, delta = 0.029486509039998055, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 1.1012834453443364e-05
[Iteration 3580] [Rank 2] a = 0.9025919437408447, b = 0.9998897328297409, delta = 0.025958940386772156, c = 0.0007794656585876856, d = 0.0007883432422020013, m = 1.1552520018385473e-05
- reduce.gather.tensors          |   3613 |     0.00099s |   0.9%
- reduce.heur_params             |   3613 |     0.01009s |   8.8%
- reduce.heur_params.alpha       |   3612 |     0.00808s |   7.0%
- reduce.heur_params.beta        |   3612 |     0.00194s |   1.7%
- reduce.memory                  |   3613 |     0.00042s |   0.4%
- reduce.pad                     |   3613 |     0.00027s |   0.2%
- reduce.threshold               |   3613 |     0.00201s |   1.8%
- test.last                      |     25 |     0.41639s |   2.7%
- test.runavg                    |     25 |     0.44706s |   2.9%
-----------------------------------------------------------------
- batch.wd                       |   3613 |     0.00001s |   0.0%
- epoch_metrics.collect          |     25 |     0.01133s |   0.1%
- reduce.combine                 |   3613 |     0.00537s |   4.7%
- reduce.flatpack                |   3613 |     0.00002s |   0.0%
- reduce.flatput                 |   3613 |     0.00019s |   0.2%
- reduce.gather.context          |   3613 |     0.00131s |   1.1%
- reduce.gather.tensors          |   3613 |     0.00116s |   1.0%
- reduce.heur_params             |   3613 |     0.01067s |   9.3%
- reduce.heur_params.alpha       |   3612 |     0.00823s |   7.2%
- reduce.heur_params.beta        |   3612 |     0.00237s |   2.1%
- reduce.memory                  |   3613 |     0.00044s |   0.4%
- reduce.pad                     |   3613 |     0.00014s |   0.1%
- reduce.threshold               |   3613 |     0.00250s |   2.2%
- test.last                      |     25 |     0.41638s |   2.7%
- test.runavg                    |     25 |     0.44707s |   2.9%
[Iteration 3590] [Rank 2] a = 1.0648046731948853, b = 0.9995000173132257, delta = 0.028978968039155006, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 1.174489401201819e-05
[Iteration 3600] [Rank 2] a = 1.0392512083053589, b = 0.9995001036710213, delta = 0.026437856256961823, c = 2.0725876142371433e-07, d = 2.0725876142371433e-07, m = 1.2028480835682393e-05
[Iteration 3610] [Rank 2] a = 0.9877978563308716, b = 0.9995006045462366, delta = 0.025325948372483253, c = 1.2090094416383336e-06, d = 1.2435525685422859e-06, m = 1.2764369365968485e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3613 |     0.10664s |  92.6%
- batch.accumulate               |   3613 |     0.00083s |   0.7%
- batch.backward                 |   3613 |     0.05215s |  45.3%
- batch.evaluate                 |   3613 |     0.00275s |   2.4%
- batch.forward                  |   3613 |     0.02576s |  22.4%
-----------------------------------------------------------------
- batch.mom                      |   3613 |     0.00126s |   1.1%
- batch.reduce                   |   3613 |     0.02107s |  18.3%
- batch.reporting.compr_err      |   3613 |     0.00001s |   0.0%
- batch.reporting.lr             |   3613 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3613 |     0.00001s |   0.0%
- batch.step                     |   3613 |     0.00048s |   0.4%
- batch.update_runavg            |   3613 |     0.00130s |   1.1%
- batch.wd                       |   3613 |     0.00001s |   0.0%
- epoch_metrics.collect          |     25 |     0.01520s |   0.1%
- reduce.combine                 |   3613 |     0.00560s |   4.9%
- reduce.flatpack                |   3613 |     0.00002s |   0.0%
- reduce.flatput                 |   3613 |     0.00010s |   0.1%
- reduce.gather.context          |   3613 |     0.00113s |   1.0%
- reduce.gather.tensors          |   3613 |     0.00104s |   0.9%
- reduce.heur_params             |   3613 |     0.01032s |   9.0%
- reduce.heur_params.alpha       |   3612 |     0.00836s |   7.3%
- reduce.heur_params.beta        |   3612 |     0.00188s |   1.6%
- reduce.memory                  |   3613 |     0.00042s |   0.4%
- reduce.pad                     |   3613 |     0.00029s |   0.3%
- reduce.threshold               |   3613 |     0.00194s |   1.7%
- test.last                      |     25 |     0.41639s |   2.7%
- test.runavg                    |     25 |     0.44707s |   2.9%
-----------------------------------------------------------------
[Iteration 3510] [Rank 0] a = 1.07740318775177, b = 0.9995000000416666, delta = 0.2216852456331253, c = 0.0, d = 0.0, m = 1.1475677362794152e-07
[Iteration 3520] [Rank 0] a = 0.8934294581413269, b = 0.9995000000416666, delta = 0.19973033666610718, c = 0.0, d = 0.0, m = 1.2034664519477022e-07
[Iteration 3530] [Rank 0] a = 0.9796673059463501, b = 0.9995000000416666, delta = 0.21783198416233063, c = 0.0, d = 0.0, m = 1.201329930276231e-07
[Iteration 3540] [Rank 0] a = 1.1278941631317139, b = 0.9995000000416666, delta = 0.19950591027736664, c = 0.0, d = 0.0, m = 1.3225110743769673e-07
[Iteration 3550] [Rank 0] a = 1.0149004459381104, b = 0.9995000000416666, delta = 0.1994653344154358, c = 0.0, d = 0.0, m = 1.318884017357894e-07
[Iteration 3560] [Rank 0] a = 1.0947387218475342, b = 0.9995000000416666, delta = 0.221482515335083, c = 0.0, d = 0.0, m = 1.315374335348487e-07
[Iteration 3570] [Rank 0] a = 0.9365481734275818, b = 0.9995000000416666, delta = 0.17179569602012634, c = 0.0, d = 0.0, m = 1.4741044830280933e-07
[Iteration 3580] [Rank 0] a = 1.0747781991958618, b = 0.9995000000416666, delta = 0.18432940542697906, c = 0.0, d = 0.0, m = 1.46998802258959e-07
[Iteration 3590] [Rank 0] a = 1.0392745733261108, b = 0.9995000000416666, delta = 0.2059023231267929, c = 0.0, d = 0.0, m = 1.4673373929069657e-07
[Iteration 3600] [Rank 0] a = 1.0536746978759766, b = 0.9995000000416666, delta = 0.19134663045406342, c = 0.0, d = 0.0, m = 1.4640299994671564e-07
[Iteration 3610] [Rank 0] a = 0.9472826719284058, b = 0.9995000000416666, delta = 0.1740582436323166, c = 0.0, d = 0.0, m = 1.4601669594625614e-07
cross_entropy                  - bits:2260192832.000, epoch: 26.000, ratio_transmit_grad:  0.405, value:  6.365 (split:train)
last_cross_entropy             - bits:2260192832.000, epoch: 26.000, ratio_transmit_grad:  0.405, value:  6.365 (split:train)
perplexity                     - bits:2260192832.000, epoch: 26.000, ratio_transmit_grad:  0.405, value:583.128 (split:train)
last_perplexity                - bits:2260192832.000, epoch: 26.000, ratio_transmit_grad:  0.405, value:583.128 (split:train)
last_cross_entropy             - bits:2260192832.000, epoch: 26.000, ratio_transmit_grad:  0.405, value:  6.046 (split:test)
last_perplexity                - bits:2260192832.000, epoch: 26.000, ratio_transmit_grad:  0.405, value:423.976 (split:test)
runavg_cross_entropy           - bits:2260192832.000, epoch: 26.000, ratio_transmit_grad:  0.405, value:  6.181 (split:test)
runavg_perplexity              - bits:2260192832.000, epoch: 26.000, ratio_transmit_grad:  0.405, value:485.279 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3613 |     0.10666s |  92.6%
- batch.accumulate               |   3613 |     0.00083s |   0.7%
- batch.backward                 |   3613 |     0.05176s |  45.0%
- batch.evaluate                 |   3613 |     0.00275s |   2.4%
- batch.forward                  |   3613 |     0.02552s |  22.2%
- batch.mom                      |   3613 |     0.00126s |   1.1%
- batch.reduce                   |   3613 |     0.02170s |  18.9%
- batch.reporting.compr_err      |   3613 |     0.00001s |   0.0%
- batch.reporting.lr             |   3613 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3613 |     0.00001s |   0.0%
- batch.step                     |   3613 |     0.00048s |   0.4%
- batch.update_runavg            |   3613 |     0.00130s |   1.1%
- batch.wd                       |   3613 |     0.00001s |   0.0%
- epoch_metrics.collect          |     25 |     0.00916s |   0.1%
- reduce.combine                 |   3613 |     0.00563s |   4.9%
- reduce.flatpack                |   3613 |     0.00002s |   0.0%
- reduce.flatput                 |   3613 |     0.00009s |   0.1%
- reduce.gather.context          |   3613 |     0.00149s |   1.3%
- reduce.gather.tensors          |   3613 |     0.00106s |   0.9%
- reduce.heur_params             |   3613 |     0.01062s |   9.2%
- reduce.heur_params.alpha       |   3612 |     0.00873s |   7.6%
- reduce.heur_params.beta        |   3612 |     0.00182s |   1.6%
- reduce.memory                  |   3613 |     0.00042s |   0.4%
- reduce.pad                     |   3613 |     0.00029s |   0.3%
- reduce.threshold               |   3613 |     0.00186s |   1.6%
- test.last                      |     25 |     0.41637s |   2.7%
- test.runavg                    |     25 |     0.44708s |   2.9%
-----------------------------------------------------------------

[Iteration 3620] [Rank 0] a = 1.0565598011016846, b = 0.9995000000416666, delta = 0.1848127394914627, c = 0.0, d = 0.0, m = 1.4568976362252487e-07
[Iteration 3630] [Rank 0] a = 1.095346450805664, b = 0.9995000000416666, delta = 0.17471624910831451, c = 0.0, d = 0.0, m = 1.4935074339442308e-07
[Iteration 3640] [Rank 0] a = 1.0212032794952393, b = 0.9995000000416666, delta = 0.16642910242080688, c = 0.0, d = 0.0, m = 1.4909234806251398e-07
[Iteration 3650] [Rank 0] a = 1.0165023803710938, b = 0.9995000000416666, delta = 0.17456649243831635, c = 0.0, d = 0.0, m = 1.4877860053811364e-07
[Iteration 3660] [Rank 0] a = 0.9658863544464111, b = 0.9995000000416666, delta = 0.15757907927036285, c = 0.0, d = 0.0, m = 1.625348003407499e-07
timer                          - epoch: 27.000, value:  0.053 (event:batch.backward)
[Iteration 3670] [Rank 0] a = 0.9924442768096924, b = 0.9995000173132257, delta = 0.14923441410064697, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 1.8313220806448458e-07
[Iteration 3680] [Rank 0] a = 0.9524882435798645, b = 0.9995000000416666, delta = 0.16011208295822144, c = 0.0, d = 0.0, m = 1.8583470309127156e-07
[Iteration 3690] [Rank 0] a = 0.9674452543258667, b = 0.9995252856045533, delta = 0.11614932119846344, c = 5.057113778738629e-05, d = 5.14347159599851e-05, m = 2.4471245794758835e-07
[Iteration 3700] [Rank 0] a = 0.8892722725868225, b = 0.9997267929064856, delta = 0.08402670174837112, c = 0.0004535857993757988, d = 0.00045479480881743713, m = 4.961759441613118e-07
[Iteration 3710] [Rank 0] a = 1.0633935928344727, b = 0.9995000000416666, delta = 0.053647831082344055, c = 0.0, d = 0.0, m = 2.4902792697372937e-06
[Iteration 3720] [Rank 0] a = 1.0580822229385376, b = 0.9995000000416666, delta = 0.04521498829126358, c = 0.0, d = 0.0, m = 3.8095192651670565e-06
[Iteration 3730] [Rank 0] a = 1.0406607389450073, b = 0.9995000000416666, delta = 0.04890570789575577, c = 0.0, d = 0.0, m = 3.7993828814531894e-06
[Iteration 3740] [Rank 0] a = 0.8113677501678467, b = 1.0024091138577584, delta = 0.037241555750370026, c = 0.005818237036940317, d = 0.005692050994360178, m = 5.452403125305709e-06
[Iteration 3750] [Rank 0] a = 0.9567540287971497, b = 0.9995012608654843, delta = 0.03771161660552025, c = 2.5216482639885243e-06, d = 2.659820771604334e-06, m = 5.439386752254816e-06
cross_entropy                  - bits:2930514752.000, epoch: 27.000, ratio_transmit_grad:  0.260, value:  6.324 (split:train)
last_cross_entropy             - bits:2930514752.000, epoch: 27.000, ratio_transmit_grad:  0.260, value:  6.324 (split:train)
perplexity                     - bits:2930514752.000, epoch: 27.000, ratio_transmit_grad:  0.260, value:559.632 (split:train)
last_perplexity                - bits:2930514752.000, epoch: 27.000, ratio_transmit_grad:  0.260, value:559.632 (split:train)
last_cross_entropy             - bits:2930514752.000, epoch: 27.000, ratio_transmit_grad:  0.260, value:  5.983 (split:test)
last_perplexity                - bits:2930514752.000, epoch: 27.000, ratio_transmit_grad:  0.260, value:397.904 (split:test)
runavg_cross_entropy           - bits:2930514752.000, epoch: 27.000, ratio_transmit_grad:  0.260, value:  6.103 (split:test)
runavg_perplexity              - bits:2930514752.000, epoch: 27.000, ratio_transmit_grad:  0.260, value:448.439 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3752 |     0.10698s |  92.7%
- batch.accumulate               |   3752 |     0.00083s |   0.7%
- batch.backward                 |   3752 |     0.05176s |  44.8%
- batch.evaluate                 |   3752 |     0.00275s |   2.4%
- batch.forward                  |   3752 |     0.02551s |  22.1%
- batch.mom                      |   3752 |     0.00126s |   1.1%
- batch.reduce                   |   3752 |     0.02202s |  19.1%
- batch.reporting.compr_err      |   3752 |     0.00001s |   0.0%
- batch.reporting.lr             |   3752 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3752 |     0.00001s |   0.0%
- batch.step                     |   3752 |     0.00048s |   0.4%
- batch.update_runavg            |   3752 |     0.00130s |   1.1%
- batch.wd                       |   3752 |     0.00001s |   0.0%
- epoch_metrics.collect          |     26 |     0.00885s |   0.1%
- reduce.combine                 |   3752 |     0.00566s |   4.9%
- reduce.flatpack                |   3752 |     0.00002s |   0.0%
- reduce.flatput                 |   3752 |     0.00009s |   0.1%
- reduce.gather.context          |   3752 |     0.00149s |   1.3%
- reduce.gather.tensors          |   3752 |     0.00132s |   1.1%
- reduce.heur_params             |   3752 |     0.01063s |   9.2%
- reduce.heur_params.alpha       |   3751 |     0.00873s |   7.6%
- reduce.heur_params.beta        |   3751 |     0.00182s |   1.6%
- reduce.memory                  |   3752 |     0.00042s |   0.4%
- reduce.pad                     |   3752 |     0.00029s |   0.3%
- reduce.threshold               |   3752 |     0.00187s |   1.6%
- test.last                      |     26 |     0.41651s |   2.7%
- test.runavg                    |     26 |     0.44723s |   2.9%
-----------------------------------------------------------------

[Iteration 3620] [Rank 1] a = 0.999043881893158, b = 0.9997056006998375, delta = 0.0017071169568225741, c = 0.0004112013826646492, d = 0.00042215155389320214, m = 0.00020610812519210783
[Iteration 3630] [Rank 1] a = 1.08608078956604, b = 0.9995301734559201, delta = 0.0018161885673180223, c = 6.034684270120482e-05, d = 6.0830446477860155e-05, m = 0.00020684164674480943
[Iteration 3640] [Rank 1] a = 0.9726102352142334, b = 0.9995690171942386, delta = 0.0016781798331066966, c = 0.00013803433510819373, d = 0.00013938151705744788, m = 0.00020786842247232052
[Iteration 3650] [Rank 1] a = 0.9224673509597778, b = 1.0022871600208016, delta = 0.0015450119972229004, c = 0.005574328017871509, d = 0.0048871961374980875, m = 0.00020915784811733674
[Iteration 3660] [Rank 1] a = 0.9832955598831177, b = 0.9997398674790887, delta = 0.0015581356128677726, c = 0.00047973494644209077, d = 0.0004866781149497852, m = 0.0002092874459596986

[Iteration 3620] [Rank 3] a = 0.9649219512939453, b = 1.0049080498091496, delta = 0.0018505305051803589, c = 0.010816178439292475, d = 0.009360807416575153, m = 0.00015100153494212198
[Iteration 3630] [Rank 3] a = 0.9660500288009644, b = 0.9995806582259008, delta = 0.0014674095436930656, c = 0.00016131640264145764, d = 0.00016252541208309598, m = 0.00017425112455327305
[Iteration 3640] [Rank 3] a = 0.9565851092338562, b = 0.999616462171163, delta = 0.0013569954317063093, c = 0.00023292430471335095, d = 0.00023430602978950904, m = 0.0001774506329285765
[Iteration 3650] [Rank 3] a = 1.0845348834991455, b = 0.9995514520176053, delta = 0.0012750679161399603, c = 0.00010290397504687416, d = 0.00010356029445804926, m = 0.00018576135588487357
[Iteration 3660] [Rank 3] a = 1.016526699066162, b = 0.9995742159338836, delta = 0.0013486534589901567, c = 0.0001484318163062834, d = 0.00014960628262101778, m = 0.0001856368397775023
[Iteration 3670] [Rank 1] a = 1.0360981225967407, b = 0.9995445261220763, delta = 0.0017212589737027884, c = 8.905218115838925e-05, d = 8.991575933098806e-05, m = 0.00020911922544498076
[Iteration 3680] [Rank 1] a = 0.9958087205886841, b = 0.9995883440703099, delta = 0.0016298267291858792, c = 0.00017668809411371645, d = 0.00017855342296652988, m = 0.0002094144270880686
[Iteration 3690] [Rank 1] a = 1.0659323930740356, b = 0.9995365639330057, delta = 0.001658712513744831, c = 7.31277996556672e-05, d = 7.347323092470673e-05, m = 0.0002105049449894234
[Iteration 3700] [Rank 1] a = 1.040169596672058, b = 0.9995514002029253, delta = 0.001650528865866363, c = 0.0001028003456661623, d = 0.0001035257513311453, m = 0.00021053456240236555
[Iteration 3710] [Rank 1] a = 0.9994333386421204, b = 0.9996585529657585, delta = 0.0015910236397758126, c = 0.0003171059049782829, d = 0.00031945483760775165, m = 0.0002120233393182005

[Iteration 3620] [Rank 2] a = 0.9143655896186829, b = 0.9995003800159677, delta = 0.025491155683994293, c = 7.599487918869525e-07, d = 7.944919187909049e-07, m = 1.3184465703919263e-05
[Iteration 3630] [Rank 2] a = 0.9690849184989929, b = 0.9995012435939251, delta = 0.024227114394307137, c = 2.4871051370845718e-06, d = 2.4871051370845718e-06, m = 1.3719786058983594e-05
[Iteration 3640] [Rank 2] a = 1.1061856746673584, b = 0.9995000345847849, delta = 0.02629791386425495, c = 6.908625380790477e-08, d = 6.908625380790477e-08, m = 1.396406616637047e-05
[Iteration 3650] [Rank 2] a = 0.96767258644104, b = 0.9995002936581718, delta = 0.02378387749195099, c = 5.872331573671905e-07, d = 5.872331573671905e-07, m = 1.4397671798605528e-05
[Iteration 3660] [Rank 2] a = 0.9168373346328735, b = 0.9995134200432032, delta = 0.022906694561243057, c = 2.6840009604371003e-05, d = 2.839445031504886e-05, m = 1.436985587313073e-05
[Iteration 3670] [Rank 3] a = 0.9307375550270081, b = 0.9996194328796433, delta = 0.0014122365973889828, c = 0.00023886572254083077, d = 0.0002400056457286612, m = 0.00018559911050653675
[Iteration 3680] [Rank 3] a = 1.0397121906280518, b = 0.9995319869696838, delta = 0.0015479811700060964, c = 6.397387102611982e-05, d = 6.42847591682554e-05, m = 0.00018554330586860853
[Iteration 3690] [Rank 3] a = 0.9369906783103943, b = 0.999549103085451, delta = 0.0015356767689809203, c = 9.820610978793664e-05, d = 9.886242919911173e-05, m = 0.00018561799311123288
[Iteration 3700] [Rank 3] a = 1.158483624458313, b = 0.9995302425421585, delta = 0.0016270405612885952, c = 6.048501520882063e-05, d = 6.055410146262853e-05, m = 0.00018576956711123063
[Iteration 3710] [Rank 3] a = 1.1049702167510986, b = 0.999529793481608, delta = 0.0016791581874713302, c = 5.9586893909317866e-05, d = 5.975960954383763e-05, m = 0.00018595959596771124
[Iteration 3720] [Rank 1] a = 0.9614035487174988, b = 1.0023661942672684, delta = 0.0014813351444900036, c = 0.005732397366583994, d = 0.00496806159758024, m = 0.00021429422441345108
[Iteration 3730] [Rank 1] a = 1.0379270315170288, b = 0.9995524710396445, delta = 0.0015947375213727355, c = 0.00010494201953420735, d = 0.0001056328820722864, m = 0.0002165980156419073
[Iteration 3740] [Rank 1] a = 0.9506428837776184, b = 1.006783607866884, delta = 0.0013444321230053902, c = 0.01456742384855409, d = 0.0122025322944557, m = 0.00022360408707754504
[Iteration 3750] [Rank 1] a = 0.9570596814155579, b = 0.9996305212218196, delta = 0.0012641673674806952, c = 0.0002610424100131682, d = 0.00026259685072384606, m = 0.00023506993847064386
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3752 |     0.10710s |  92.8%
- batch.accumulate               |   3752 |     0.00083s |   0.7%
[Iteration 3670] [Rank 2] a = 0.9947240352630615, b = 0.9995000863994624, delta = 0.025383541360497475, c = 1.7271563451976193e-07, d = 1.7271563451976193e-07, m = 1.433496481745905e-05
[Iteration 3680] [Rank 2] a = 0.9543887972831726, b = 0.9995065977772774, delta = 0.02221108227968216, c = 1.3195474477309811e-05, d = 1.3575448873253288e-05, m = 1.5203658538180506e-05
[Iteration 3690] [Rank 2] a = 1.0766609907150269, b = 0.9995000518563442, delta = 0.024154840037226677, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 1.5270560876397475e-05
[Iteration 3700] [Rank 2] a = 1.0729238986968994, b = 0.9995000518563442, delta = 0.02413484826683998, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 1.5587891686147776e-05
[Iteration 3710] [Rank 2] a = 0.985806941986084, b = 0.9995006045462366, delta = 0.022431621327996254, c = 1.2090094416383336e-06, d = 1.2780956954462384e-06, m = 1.5895339585195663e-05
[Iteration 3720] [Rank 3] a = 1.1480718851089478, b = 0.9995210022577912, delta = 0.0016649591270834208, c = 4.20044423152061e-05, d = 4.231533045734167e-05, m = 0.0001860598366068886
[Iteration 3730] [Rank 3] a = 1.0011714696884155, b = 0.9995445088505164, delta = 0.0017294412245973945, c = 8.90176380314853e-05, d = 8.984667307718015e-05, m = 0.00018585336429524925
[Iteration 3740] [Rank 3] a = 1.1215364933013916, b = 0.9995192405587248, delta = 0.001706790877506137, c = 3.8481043371002956e-05, d = 3.865375900552272e-05, m = 0.00018590048105292145
[Iteration 3750] [Rank 3] a = 1.0428508520126343, b = 0.9995424017202144, delta = 0.0017575080273672938, c = 8.480337654920311e-05, d = 8.53215234527624e-05, m = 0.00018580413673311116
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3752 |     0.10719s |  92.8%
- batch.accumulate               |   3752 |     0.00082s |   0.7%
- batch.backward                 |   3752 |     0.05174s |  44.8%
- batch.evaluate                 |   3752 |     0.00277s |   2.4%
- batch.forward                  |   3752 |     0.02540s |  22.0%
- batch.mom                      |   3752 |     0.00126s |   1.1%
- batch.reduce                   |   3752 |     0.02233s |  19.3%
- batch.reporting.compr_err      |   3752 |     0.00001s |   0.0%
- batch.reporting.lr             |   3752 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   3752 |     0.00001s |   0.0%
- batch.step                     |   3752 |     0.00048s |   0.4%
- batch.update_runavg            |   3752 |     0.00129s |   1.1%
- batch.wd                       |   3752 |     0.00001s |   0.0%
- epoch_metrics.collect          |     26 |     0.01104s |   0.1%
- reduce.combine                 |   3752 |     0.00540s |   4.7%
- reduce.flatpack                |   3752 |     0.00002s |   0.0%
- reduce.flatput                 |   3752 |     0.00020s |   0.2%
[Iteration 3720] [Rank 2] a = 0.953008234500885, b = 0.9995008808911828, delta = 0.02074555866420269, c = 1.7616994721015717e-06, d = 1.8307857259094765e-06, m = 1.7075129008200937e-05
[Iteration 3730] [Rank 2] a = 1.0109286308288574, b = 0.9995000518563442, delta = 0.02129925973713398, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 1.7763740516091446e-05
[Iteration 3740] [Rank 2] a = 1.0201854705810547, b = 0.9995001900288173, delta = 0.02015024609863758, c = 3.7997439594347627e-07, d = 3.7997439594347627e-07, m = 1.781860248172697e-05
[Iteration 3750] [Rank 2] a = 0.9720781445503235, b = 0.9995006218177959, delta = 0.020992662757635117, c = 1.2435525685422859e-06, d = 1.2435525685422859e-06, m = 1.7774331250782158e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3752 |     0.10696s |  92.6%
- batch.accumulate               |   3752 |     0.00083s |   0.7%
- batch.backward                 |   3752 |     0.05172s |  44.8%
- batch.evaluate                 |   3752 |     0.00277s |   2.4%
- batch.forward                  |   3752 |     0.02537s |  22.0%
- batch.mom                      |   3752 |     0.00126s |   1.1%
- batch.reduce                   |   3752 |     0.02245s |  19.4%
- batch.reporting.compr_err      |   3752 |     0.00001s |   0.0%
- batch.reporting.lr             |   3752 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3752 |     0.00001s |   0.0%
- batch.step                     |   3752 |     0.00047s |   0.4%
- batch.update_runavg            |   3752 |     0.00129s |   1.1%
- batch.wd                       |   3752 |     0.00001s |   0.0%
- epoch_metrics.collect          |     26 |     0.01075s |   0.1%
- reduce.combine                 |   3752 |     0.00537s |   4.7%
- reduce.flatpack                |   3752 |     0.00002s |   0.0%
- reduce.flatput                 |   3752 |     0.00012s |   0.1%
- reduce.gather.context          |   3752 |     0.00134s |   1.2%
- reduce.gather.tensors          |   3752 |     0.00141s |   1.2%
- reduce.heur_params             |   3752 |     0.01068s |   9.3%
- batch.backward                 |   3752 |     0.05215s |  45.2%
- batch.evaluate                 |   3752 |     0.00275s |   2.4%
- batch.forward                  |   3752 |     0.02576s |  22.3%
- batch.mom                      |   3752 |     0.00126s |   1.1%
- batch.reduce                   |   3752 |     0.02139s |  18.5%
- batch.reporting.compr_err      |   3752 |     0.00001s |   0.0%
- batch.reporting.lr             |   3752 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3752 |     0.00001s |   0.0%
- batch.step                     |   3752 |     0.00048s |   0.4%
- batch.update_runavg            |   3752 |     0.00130s |   1.1%
- batch.wd                       |   3752 |     0.00001s |   0.0%
- epoch_metrics.collect          |     26 |     0.01570s |   0.1%
- reduce.combine                 |   3752 |     0.00562s |   4.9%
- reduce.flatpack                |   3752 |     0.00002s |   0.0%
- reduce.flatput                 |   3752 |     0.00010s |   0.1%
- reduce.gather.context          |   3752 |     0.00268s |   2.3%
- reduce.gather.tensors          |   3752 |     0.00123s |   1.1%
- reduce.heur_params             |   3752 |     0.01011s |   8.8%
- reduce.heur_params.alpha       |   3751 |     0.00823s |   7.1%
- reduce.heur_params.beta        |   3751 |     0.00237s |   2.1%
- reduce.memory                  |   3752 |     0.00045s |   0.4%
- reduce.pad                     |   3752 |     0.00014s |   0.1%
- reduce.threshold               |   3752 |     0.00251s |   2.2%
- test.last                      |     26 |     0.41652s |   2.7%
- test.runavg                    |     26 |     0.44722s |   2.9%
-----------------------------------------------------------------

[Iteration 3760] [Rank 1] a = 0.9377981424331665, b = 0.9997856025765269, delta = 0.0012308930745348334, c = 0.0005712051464837566, d = 0.0005735195359863215, m = 0.00023616404773325154
[Iteration 3770] [Rank 1] a = 1.0165739059448242, b = 0.999580157350649, delta = 0.0012758778175339103, c = 0.00016031465196124302, d = 0.00016104005762622602, m = 0.00023729504994978324
- reduce.gather.context          |   3752 |     0.00113s |   1.0%
- reduce.gather.tensors          |   3752 |     0.00130s |   1.1%
- reduce.heur_params             |   3752 |     0.01033s |   9.0%
- reduce.heur_params.alpha       |   3751 |     0.00808s |   7.0%
- reduce.heur_params.beta        |   3751 |     0.00196s |   1.7%
- reduce.memory                  |   3752 |     0.00042s |   0.4%
- reduce.pad                     |   3752 |     0.00027s |   0.2%
- reduce.threshold               |   3752 |     0.00204s |   1.8%
- test.last                      |     26 |     0.41652s |   2.7%
- test.runavg                    |     26 |     0.44722s |   2.9%
-----------------------------------------------------------------

[Iteration 3760] [Rank 3] a = 0.9531646370887756, b = 0.9995946309183572, delta = 0.0017540121916681528, c = 0.00018926179230675512, d = 0.00019085077614433693, m = 0.00018566689156969185
[Iteration 3770] [Rank 3] a = 1.0712274312973022, b = 0.9995218831073256, delta = 0.0018763513071462512, c = 4.376614178730767e-05, d = 4.393885742182744e-05, m = 0.0001855837966102959
[Iteration 3780] [Rank 1] a = 0.9772104024887085, b = 1.0000003744647672, delta = 0.001161627471446991, c = 0.0010007489295344046, d = 0.0010007489295344046, m = 0.00023962658493036125
[Iteration 3790] [Rank 1] a = 1.0790865421295166, b = 0.9995554935626474, delta = 0.0012509051011875272, c = 0.00011098706674239901, d = 0.00011147067051905436, m = 0.00024164791582478536
[Iteration 3800] [Rank 1] a = 1.0250318050384521, b = 0.9996192947071556, delta = 0.0011588411871343851, c = 0.00023858937752559912, d = 0.0002400056457286612, m = 0.00024649933554297417
[Iteration 3810] [Rank 1] a = 1.0415037870407104, b = 0.9996346145818051, delta = 0.0012190707493573427, c = 0.0002692291310894049, d = 0.0002699545367543879, m = 0.00024814116393848985
[Iteration 3820] [Rank 1] a = 1.005472183227539, b = 0.9996217127256906, delta = 0.00124004774261266, c = 0.00024342541529215247, d = 0.0002448416834952145, m = 0.0002488270707707894
- reduce.heur_params.alpha       |   3751 |     0.00836s |   7.2%
- reduce.heur_params.beta        |   3751 |     0.00190s |   1.6%
- reduce.memory                  |   3752 |     0.00042s |   0.4%
- reduce.pad                     |   3752 |     0.00029s |   0.3%
- reduce.threshold               |   3752 |     0.00196s |   1.7%
- test.last                      |     26 |     0.41653s |   2.7%
- test.runavg                    |     26 |     0.44722s |   2.9%
-----------------------------------------------------------------

[Iteration 3760] [Rank 2] a = 1.0562176704406738, b = 0.9995000518563442, delta = 0.021694250404834747, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 1.7742299661284404e-05
[Iteration 3770] [Rank 2] a = 0.9928383827209473, b = 0.9995003972875268, delta = 0.020153310149908066, c = 7.944919187909049e-07, d = 7.944919187909049e-07, m = 1.8501769604210033e-05
[Iteration 3780] [Rank 3] a = 1.0615496635437012, b = 0.9995204668394472, delta = 0.0018364256247878075, c = 4.093360538118358e-05, d = 4.124449352331915e-05, m = 0.00018548197391192697
[Iteration 3790] [Rank 3] a = 1.009230613708496, b = 0.9995487231111324, delta = 0.0018819289980456233, c = 9.744616099604968e-05, d = 9.796430789960897e-05, m = 0.00018527380607385462
[Iteration 3800] [Rank 3] a = 0.9259544610977173, b = 0.9995608304747122, delta = 0.0019393129041418433, c = 0.00012166089295572031, d = 0.00012248992800141517, m = 0.00018521298522289795
[Iteration 3810] [Rank 3] a = 0.9766895771026611, b = 0.999635840862647, delta = 0.0018776062643155456, c = 0.0002716816930995855, d = 0.00027309796130264754, m = 0.00018506901264309336
[Iteration 3820] [Rank 3] a = 1.062473177909851, b = 0.9995144908798843, delta = 0.0022051658015698195, c = 2.8981683472416052e-05, d = 2.9050769726223957e-05, m = 0.00018496941327420416
[Iteration 3830] [Rank 1] a = 0.9509495496749878, b = 0.9998371063768964, delta = 0.0010838592424988747, c = 0.0006742127509113426, d = 0.0006765271404139075, m = 0.0002530669781806639
[Iteration 3840] [Rank 1] a = 0.9487554430961609, b = 1.0000723623411087, delta = 0.0010385125642642379, c = 0.0011447246824700782, d = 0.001143377500520824, m = 0.00026025025634300884
[Iteration 3850] [Rank 1] a = 1.090049386024475, b = 0.999575442214667, delta = 0.001148598617874086, c = 0.000150884378316464, d = 0.00015167887023525493, m = 0.0002613303979727571
[Iteration 3860] [Rank 1] a = 1.0289219617843628, b = 0.999592074727389, delta = 0.00116350210737437, c = 0.00018414940952497018, d = 0.000185012987697569, m = 0.0002621875491147472
[Iteration 3870] [Rank 1] a = 1.1098941564559937, b = 0.9995835943911751, delta = 0.0010806753998622298, c = 0.00016718873421512956, d = 0.00016763779486488094, m = 0.0002641117868045045
[Iteration 3780] [Rank 2] a = 0.999686062335968, b = 0.9995001209425806, delta = 0.01991606503725052, c = 2.4180188832766673e-07, d = 2.4180188832766673e-07, m = 1.9201474522214634e-05
[Iteration 3790] [Rank 2] a = 1.0993800163269043, b = 0.9995001900288173, delta = 0.018634790554642677, c = 3.7997439594347627e-07, d = 3.7997439594347627e-07, m = 2.3108103571551874e-05
[Iteration 3800] [Rank 2] a = 0.9411330819129944, b = 1.0015395977115746, delta = 0.015854159370064735, c = 0.004079197856087738, d = 0.0038969137754155804, m = 2.4085865466774518e-05
[Iteration 3810] [Rank 2] a = 1.0435034036636353, b = 0.9995001036710213, delta = 0.015752125531435013, c = 2.0725876142371433e-07, d = 2.0725876142371433e-07, m = 2.5592550426619666e-05
[Iteration 3820] [Rank 2] a = 1.003739356994629, b = 0.9995006045462366, delta = 0.015518313273787498, c = 1.2090094416383336e-06, d = 1.2090094416383336e-06, m = 2.661226543976371e-05
[Iteration 3830] [Rank 3] a = 0.8405185341835022, b = 1.0003563931871136, delta = 0.0016532718436792493, c = 0.0017127864044055752, d = 0.0017060159515324004, m = 0.0001852908565416826
[Iteration 3840] [Rank 3] a = 0.9432933926582336, b = 0.9996302794199644, delta = 0.0018640937050804496, c = 0.00026055880623651286, d = 0.00026173327255124725, m = 0.0001851343338082993
[Iteration 3850] [Rank 3] a = 0.9043819904327393, b = 0.9998403534307408, delta = 0.001787315821275115, c = 0.0006807068587692857, d = 0.0006825031013682913, m = 0.00018513209017459594
[Iteration 3860] [Rank 3] a = 1.001555323600769, b = 0.9995765648660897, delta = 0.0017753071151673794, c = 0.00015312968156522093, d = 0.0001555477004484976, m = 0.00018506967385453958
[Iteration 3870] [Rank 3] a = 0.8831952214241028, b = 0.9996490708785597, delta = 0.0018580335890874267, c = 0.00029814172830801305, d = 0.00029952345338417113, m = 0.00018486932719639958
[Iteration 3880] [Rank 1] a = 0.9905882477760315, b = 0.9996689849889039, delta = 0.0010863164206966758, c = 0.00033796995362827013, d = 0.00033942076495823613, m = 0.0002644106541549516
[Iteration 3890] [Rank 1] a = 0.9782533049583435, b = 0.9997019045855833, delta = 0.0010258081601932645, c = 0.0004038091535072034, d = 0.0004058471979945366, m = 0.0002651366805154363
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3891 |     0.10758s |  92.8%
- batch.accumulate               |   3891 |     0.00083s |   0.7%
- batch.backward                 |   3891 |     0.05174s |  44.6%
- batch.evaluate                 |   3891 |     0.00276s |   2.4%
- batch.forward                  |   3891 |     0.02539s |  21.9%
- batch.mom                      |   3891 |     0.00126s |   1.1%
- batch.reduce                   |   3891 |     0.02281s |  19.7%
[Iteration 3830] [Rank 2] a = 0.9689010381698608, b = 0.9995034198103809, delta = 0.0141952158883214, c = 6.839539126982573e-06, d = 7.219513522926049e-06, m = 2.824367240638585e-05
[Iteration 3840] [Rank 2] a = 1.0117218494415283, b = 0.9995007427187096, delta = 0.014168897643685341, c = 1.4853544568699526e-06, d = 1.4853544568699526e-06, m = 2.8856020594980744e-05
[Iteration 3850] [Rank 2] a = 0.9617065191268921, b = 0.999872426723407, delta = 0.011816835962235928, c = 0.0007448534454299253, d = 0.0007610541719478789, m = 3.379674061735722e-05
[Iteration 3860] [Rank 2] a = 0.8255690932273865, b = 1.0065980504969432, delta = 0.01027605589479208, c = 0.014196292493098023, d = 0.01325689215694504, m = 3.886561635985722e-05
[Iteration 3870] [Rank 2] a = 0.9961668252944946, b = 0.9995067532213109, delta = 0.00880667194724083, c = 1.3506362619445383e-05, d = 1.4300854538236288e-05, m = 4.514626062145006e-05
[Iteration 3880] [Rank 3] a = 0.9546253681182861, b = 0.9996131460314721, delta = 0.00197917059995234, c = 0.00022629202434779207, d = 0.00022826098258131738, m = 0.00018465826422948598
[Iteration 3890] [Rank 3] a = 1.0083999633789062, b = 0.9995276690797752, delta = 0.0020834729075431824, c = 5.5338089300131727e-05, d = 5.5787149949883104e-05, m = 0.00018453891856966587
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3891 |     0.10767s |  92.9%
- batch.accumulate               |   3891 |     0.00082s |   0.7%
- batch.backward                 |   3891 |     0.05172s |  44.6%
- batch.evaluate                 |   3891 |     0.00277s |   2.4%
- batch.forward                  |   3891 |     0.02537s |  21.9%
- batch.mom                      |   3891 |     0.00126s |   1.1%
- batch.reduce                   |   3891 |     0.02293s |  19.8%
- batch.reporting.compr_err      |   3891 |     0.00001s |   0.0%
- batch.reporting.lr             |   3891 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   3891 |     0.00001s |   0.0%
- batch.step                     |   3891 |     0.00048s |   0.4%
- batch.update_runavg            |   3891 |     0.00129s |   1.1%
[Iteration 3880] [Rank 2] a = 0.914222240447998, b = 1.0062208032391748, delta = 0.006215834058821201, c = 0.013441766972134991, d = 0.012466925387778553, m = 5.792347457307647e-05
[Iteration 3890] [Rank 2] a = 0.8906603455543518, b = 1.0071549457113371, delta = 0.005480784457176924, c = 0.015310135620115968, d = 0.014087827074619613, m = 6.305880219917944e-05
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3891 |     0.10744s |  92.7%
- batch.accumulate               |   3891 |     0.00083s |   0.7%
- batch.backward                 |   3891 |     0.05215s |  45.0%
- batch.evaluate                 |   3891 |     0.00275s |   2.4%
- batch.forward                  |   3891 |     0.02576s |  22.2%
- batch.mom                      |   3891 |     0.00126s |   1.1%
- batch.reduce                   |   3891 |     0.02186s |  18.9%
- batch.reporting.compr_err      |   3891 |     0.00001s |   0.0%
- batch.reporting.compr_err      |   3891 |     0.00001s |   0.0%
- batch.reporting.lr             |   3891 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3891 |     0.00001s |   0.0%
- batch.step                     |   3891 |     0.00047s |   0.4%
- batch.update_runavg            |   3891 |     0.00129s |   1.1%
- batch.wd                       |   3891 |     0.00001s |   0.0%
- epoch_metrics.collect          |     27 |     0.01170s |   0.1%
- reduce.combine                 |   3891 |     0.00543s |   4.7%
- reduce.flatpack                |   3891 |     0.00002s |   0.0%
- reduce.flatput                 |   3891 |     0.00020s |   0.2%
- reduce.gather.context          |   3891 |     0.00140s |   1.2%
- reduce.gather.tensors          |   3891 |     0.00179s |   1.5%
- reduce.heur_params             |   3891 |     0.01068s |   9.2%
- reduce.heur_params.alpha       |   3890 |     0.00822s |   7.1%
- reduce.heur_params.beta        |   3890 |     0.00238s |   2.1%
- reduce.memory                  |   3891 |     0.00045s |   0.4%
- reduce.pad                     |   3891 |     0.00015s |   0.1%
- reduce.threshold               |   3891 |     0.00251s |   2.2%
- test.last                      |     27 |     0.41660s |   2.7%
- test.runavg                    |     27 |     0.44711s |   2.9%
- batch.reporting.lr             |   3891 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3891 |     0.00001s |   0.0%
- batch.step                     |   3891 |     0.00048s |   0.4%
- batch.update_runavg            |   3891 |     0.00130s |   1.1%
- batch.wd                       |   3891 |     0.00001s |   0.0%
- epoch_metrics.collect          |     27 |     0.01135s |   0.1%
- reduce.combine                 |   3891 |     0.00540s |   4.7%
- reduce.flatpack                |   3891 |     0.00002s |   0.0%
- reduce.flatput                 |   3891 |     0.00012s |   0.1%
- reduce.gather.context          |   3891 |     0.00273s |   2.4%
- reduce.gather.tensors          |   3891 |     0.00158s |   1.4%
- reduce.heur_params             |   3891 |     0.01013s |   8.7%
- reduce.heur_params.alpha       |   3890 |     0.00808s |   7.0%
- reduce.heur_params.beta        |   3890 |     0.00198s |   1.7%
- reduce.memory                  |   3891 |     0.00042s |   0.4%
- reduce.pad                     |   3891 |     0.00027s |   0.2%
- reduce.threshold               |   3891 |     0.00206s |   1.8%
- test.last                      |     27 |     0.41660s |   2.7%
- test.runavg                    |     27 |     0.44711s |   2.9%
-----------------------------------------------------------------
- batch.wd                       |   3891 |     0.00001s |   0.0%
- epoch_metrics.collect          |     27 |     0.01514s |   0.1%
- reduce.combine                 |   3891 |     0.00566s |   4.9%
- reduce.flatpack                |   3891 |     0.00002s |   0.0%
- reduce.flatput                 |   3891 |     0.00011s |   0.1%
- reduce.gather.context          |   3891 |     0.00114s |   1.0%
- reduce.gather.tensors          |   3891 |     0.00169s |   1.5%
- reduce.heur_params             |   3891 |     0.01035s |   8.9%
- reduce.heur_params.alpha       |   3890 |     0.00836s |   7.2%
- reduce.heur_params.beta        |   3890 |     0.00192s |   1.7%
- reduce.memory                  |   3891 |     0.00042s |   0.4%
- reduce.pad                     |   3891 |     0.00029s |   0.2%
- reduce.threshold               |   3891 |     0.00198s |   1.7%
- test.last                      |     27 |     0.41661s |   2.7%
- test.runavg                    |     27 |     0.44712s |   2.9%
-----------------------------------------------------------------
-----------------------------------------------------------------

[Iteration 3760] [Rank 0] a = 0.9783684611320496, b = 0.9995250610742791, delta = 0.03651067242026329, c = 5.0122077137634915e-05, d = 7.440589535111344e-05, m = 5.7031428098597014e-06
[Iteration 3770] [Rank 0] a = 1.157220482826233, b = 0.9995000000416666, delta = 0.043732620775699615, c = 0.0, d = 0.0, m = 5.776131117892192e-06
timer                          - epoch: -1.000, value:  0.001 (event:reduce.gather.context)
[Iteration 3780] [Rank 0] a = 0.9724357724189758, b = 0.9995000518563442, delta = 0.03833663836121559, c = 1.0362938071185717e-07, d = 1.0362938071185717e-07, m = 5.761704035010189e-06
[Iteration 3790] [Rank 0] a = 0.7540143132209778, b = 1.003489406106877, delta = 0.029135243967175484, c = 0.00797884053852873, d = 0.007715760084028229, m = 9.558623548648451e-06
[Iteration 3800] [Rank 0] a = 0.9604791402816772, b = 0.9995004836453225, delta = 0.023847563192248344, c = 9.67207553310667e-07, d = 9.67207553310667e-07, m = 1.4679665682339802e-05
[Iteration 3810] [Rank 0] a = 1.063646912574768, b = 0.9995000173132257, delta = 0.021393410861492157, c = 3.4543126903952384e-08, d = 3.4543126903952384e-08, m = 1.8502662004153742e-05
[Iteration 3820] [Rank 0] a = 0.8436245918273926, b = 1.000510386417623, delta = 0.01690042018890381, c = 0.0020207729238812147, d = 0.001960322451799298, m = 2.3681921629825502e-05
[Iteration 3830] [Rank 0] a = 0.9249002933502197, b = 0.9995023489737115, delta = 0.015115631744265556, c = 4.697865258937524e-06, d = 4.9396671472651915e-06, m = 2.8031400338107926e-05
[Iteration 3840] [Rank 0] a = 1.0176548957824707, b = 0.9995038343278019, delta = 0.012035355903208256, c = 7.66857417267743e-06, d = 7.979462314813002e-06, m = 3.571711657569642e-05
[Iteration 3850] [Rank 0] a = 0.9810697436332703, b = 0.9995100866322515, delta = 0.007304908707737923, c = 2.0173186111908194e-05, d = 2.082950552308329e-05, m = 5.4429903760591e-05
[Iteration 3860] [Rank 0] a = 1.0416553020477295, b = 0.9995022280727973, delta = 0.005721846129745245, c = 4.456063370609858e-06, d = 4.594235878225667e-06, m = 6.487772714674288e-05
[Iteration 3870] [Rank 0] a = 1.0347015857696533, b = 0.9995014163095166, delta = 0.005124198272824287, c = 2.8325364061240955e-06, d = 2.867079533028048e-06, m = 7.334056425777802e-05
[Iteration 3880] [Rank 0] a = 1.0021628141403198, b = 0.9995043352030186, delta = 0.004771971609443426, c = 8.670324852892048e-06, d = 8.739411106699954e-06, m = 7.898861388684655e-05
[Iteration 3890] [Rank 0] a = 0.9033092856407166, b = 0.9995226257843846, delta = 0.004067159257829189, c = 4.5251496244177624e-05, d = 4.62877900512962e-05, m = 8.128173538940681e-05
cross_entropy                  - bits:3950400448.000, epoch: 28.000, ratio_transmit_grad:  0.396, value:  6.254 (split:train)
last_cross_entropy             - bits:3950400448.000, epoch: 28.000, ratio_transmit_grad:  0.396, value:  6.254 (split:train)
perplexity                     - bits:3950400448.000, epoch: 28.000, ratio_transmit_grad:  0.396, value:521.847 (split:train)
last_perplexity                - bits:3950400448.000, epoch: 28.000, ratio_transmit_grad:  0.396, value:521.847 (split:train)
timer                          - epoch: 28.000, value:  0.024 (event:epoch_metrics.collect)
last_cross_entropy             - bits:3950400448.000, epoch: 28.000, ratio_transmit_grad:  0.396, value:  5.922 (split:test)
last_perplexity                - bits:3950400448.000, epoch: 28.000, ratio_transmit_grad:  0.396, value:374.515 (split:test)
runavg_cross_entropy           - bits:3950400448.000, epoch: 28.000, ratio_transmit_grad:  0.396, value:  6.039 (split:test)
runavg_perplexity              - bits:3950400448.000, epoch: 28.000, ratio_transmit_grad:  0.396, value:420.747 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   3891 |     0.10746s |  92.7%
- batch.accumulate               |   3891 |     0.00083s |   0.7%
- batch.backward                 |   3891 |     0.05177s |  44.7%
- batch.evaluate                 |   3891 |     0.00275s |   2.4%
- batch.forward                  |   3891 |     0.02552s |  22.0%
- batch.mom                      |   3891 |     0.00126s |   1.1%
- batch.reduce                   |   3891 |     0.02249s |  19.4%
- batch.reporting.compr_err      |   3891 |     0.00001s |   0.0%
- batch.reporting.lr             |   3891 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   3891 |     0.00001s |   0.0%
- batch.step                     |   3891 |     0.00048s |   0.4%
- batch.update_runavg            |   3891 |     0.00130s |   1.1%
- batch.wd                       |   3891 |     0.00001s |   0.0%
- epoch_metrics.collect          |     27 |     0.00942s |   0.1%
- reduce.combine                 |   3891 |     0.00570s |   4.9%
- reduce.flatpack                |   3891 |     0.00002s |   0.0%
- reduce.flatput                 |   3891 |     0.00009s |   0.1%
- reduce.gather.context          |   3891 |     0.00146s |   1.3%
- reduce.gather.tensors          |   3891 |     0.00173s |   1.5%
- reduce.heur_params             |   3891 |     0.01066s |   9.2%
- reduce.heur_params.alpha       |   3890 |     0.00874s |   7.5%
- reduce.heur_params.beta        |   3890 |     0.00184s |   1.6%
- reduce.memory                  |   3891 |     0.00043s |   0.4%
- reduce.pad                     |   3891 |     0.00029s |   0.2%
- reduce.threshold               |   3891 |     0.00190s |   1.6%
- test.last                      |     27 |     0.41659s |   2.7%
- test.runavg                    |     27 |     0.44713s |   2.9%
-----------------------------------------------------------------

[Iteration 3900] [Rank 0] a = 1.1111416816711426, b = 0.999501658111345, delta = 0.004413279239088297, c = 3.3161401827794293e-06, d = 3.3161401827794293e-06, m = 8.231033860129424e-05
[Iteration 3910] [Rank 0] a = 0.9391238689422607, b = 0.9995738359595565, delta = 0.003945011179894209, c = 0.00014767186751439646, d = 0.00015154069772763912, m = 8.222038795886636e-05
[Iteration 3920] [Rank 0] a = 0.9397068023681641, b = 0.9995553553901668, delta = 0.003983586095273495, c = 0.0001107107217271674, d = 0.00011229970556474921, m = 8.224628656128331e-05
[Iteration 3930] [Rank 0] a = 1.027185320854187, b = 0.9995023317021526, delta = 0.004438086412847042, c = 4.663322132033572e-06, d = 4.697865258937524e-06, m = 8.340686233985262e-05
[Iteration 3940] [Rank 0] a = 1.1109733581542969, b = 0.9995018135553773, delta = 0.004247174598276615, c = 3.6270283249150006e-06, d = 3.6270283249150006e-06, m = 8.990590739629128e-05
timer                          - epoch: 28.353, value:  0.001 (event:batch.mom)
[Iteration 3950] [Rank 0] a = 1.1084636449813843, b = 0.9995017617406998, delta = 0.004101429600268602, c = 3.5233989442031435e-06, d = 3.557942071107096e-06, m = 8.976674564965401e-05
[Iteration 3960] [Rank 0] a = 0.989692747592926, b = 0.999507444083681, delta = 0.004040755797177553, c = 1.4888087695603479e-05, d = 1.5095346457027193e-05, m = 8.957346755341168e-05
[Iteration 3970] [Rank 0] a = 0.8099591732025146, b = 1.0008286493720033, delta = 0.003445568960160017, c = 0.0026572991233403454, d = 0.0024401955707490045, m = 9.00525139263185e-05
[Iteration 3980] [Rank 0] a = 0.9803686738014221, b = 0.9995082385754074, delta = 0.0038893800228834152, c = 1.6477071533185288e-05, d = 1.6718873421512956e-05, m = 8.986288170844284e-05
[Iteration 3990] [Rank 0] a = 0.8425403833389282, b = 0.9996193810649603, delta = 0.0035600361879915, c = 0.0002387620931601189, d = 0.00024038562012460466, m = 8.974016149620298e-05
[Iteration 4000] [Rank 0] a = 0.9864223003387451, b = 0.9995042143021042, delta = 0.0039215898141264915, c = 8.428522964564382e-06, d = 8.497609218372288e-06, m = 9.146200673313513e-05
rel_compression_error          - epoch: 28.842, value:  1.000 (weight:encoder.weight)
rel_compression_error          - epoch: 28.842, value:  1.000 (weight:rnn.weight_ih_l0)
rel_compression_error          - epoch: 28.842, value:  1.000 (weight:rnn.weight_hh_l0)
rel_compression_error          - epoch: 28.842, value:  1.000 (weight:rnn.bias_ih_l0)
rel_compression_error          - epoch: 28.842, value:  1.000 (weight:rnn.bias_hh_l0)
rel_compression_error          - epoch: 28.842, value:  1.000 (weight:rnn.weight_ih_l1)
rel_compression_error          - epoch: 28.842, value:  1.000 (weight:rnn.weight_hh_l1)
rel_compression_error          - epoch: 28.842, value:  1.000 (weight:rnn.bias_ih_l1)
rel_compression_error          - epoch: 28.842, value:  1.000 (weight:rnn.bias_hh_l1)
rel_compression_error          - epoch: 28.842, value:  1.000 (weight:rnn.weight_ih_l2)
rel_compression_error          - epoch: 28.842, value:  1.000 (weight:rnn.weight_hh_l2)
rel_compression_error          - epoch: 28.842, value:  1.000 (weight:rnn.bias_ih_l2)
rel_compression_error          - epoch: 28.842, value:  1.000 (weight:rnn.bias_hh_l2)
rel_compression_error          - epoch: 28.842, value:  0.960 (weight:decoder.bias)
rel_compression_error          - epoch: 28.842, value:  1.000 (weight:entire_model)

[Iteration 3900] [Rank 3] a = 0.9487453103065491, b = 0.9995814354461199, delta = 0.0020145676098763943, c = 0.0001628708433521355, d = 0.0001651161466008924, m = 0.00018434945150904792
[Iteration 3910] [Rank 3] a = 1.0300623178482056, b = 0.9995163562082989, delta = 0.0021324967965483665, c = 3.271234117804291e-05, d = 3.288505681256267e-05, m = 0.00018410881627228533
[Iteration 3920] [Rank 3] a = 1.0709946155548096, b = 0.9995084285625594, delta = 0.002282314468175173, c = 1.6857045929128764e-05, d = 1.6995218436744576e-05, m = 0.00018391600335200585
[Iteration 3930] [Rank 3] a = 0.9963338375091553, b = 0.9995288090027094, delta = 0.0020344809163361788, c = 5.7617935675792584e-05, d = 5.810153945244791e-05, m = 0.00018376101683455356
[Iteration 3940] [Rank 3] a = 0.9370430707931519, b = 0.9995682227024676, delta = 0.0019556712359189987, c = 0.00013644535127061192, d = 0.00013772344696605816, m = 0.00018359506289694676

[Iteration 3900] [Rank 1] a = 0.9922685027122498, b = 0.9996400723951382, delta = 0.0010771109955385327, c = 0.00028014475919105385, d = 0.00028187191553625146, m = 0.0002654545528737948
[Iteration 3910] [Rank 1] a = 1.0302157402038574, b = 0.9995858051509156, delta = 0.0011377563932910562, c = 0.00017161025445883545, d = 0.00017271563451976194, m = 0.0002657487277835979
[Iteration 3920] [Rank 1] a = 1.0492310523986816, b = 0.9996086554256546, delta = 0.0011018285294994712, c = 0.00021731081135276445, d = 0.00021813984639845933, m = 0.0002661471811495448
[Iteration 3930] [Rank 1] a = 1.0397018194198608, b = 0.9995717806438811, delta = 0.0011098122922703624, c = 0.00014356123541282612, d = 0.0001440102960625775, m = 0.00026638370362065835
[Iteration 3940] [Rank 1] a = 1.011099100112915, b = 0.9995701916603356, delta = 0.0010802922770380974, c = 0.0001403832677376625, d = 0.00014107413027574154, m = 0.00026711057070160455

[Iteration 3900] [Rank 2] a = 0.9956467747688293, b = 0.9999804603521096, delta = 0.004569628741592169, c = 0.0009609207042141475, d = 0.0009651004225695257, m = 7.179582164101804e-05
[Iteration 3910] [Rank 2] a = 1.039438009262085, b = 0.9995075131699181, delta = 0.003881999058648944, c = 1.5026260203219289e-05, d = 1.533714834535486e-05, m = 8.404640424255435e-05
[Iteration 3920] [Rank 2] a = 1.0105684995651245, b = 0.9995171679715915, delta = 0.003266502171754837, c = 3.433586814252867e-05, d = 3.4957644426799816e-05, m = 9.606813602529827e-05
[Iteration 3930] [Rank 2] a = 1.0153260231018066, b = 0.9995159935055514, delta = 0.0029939154628664255, c = 3.198693551305991e-05, d = 3.2470539289715246e-05, m = 0.00010261632069449538
[Iteration 3940] [Rank 2] a = 1.0550650358200073, b = 0.9995047497204399, delta = 0.003189405659213662, c = 9.499359898586907e-06, d = 9.499359898586907e-06, m = 0.00010493006398356104
[Iteration 3950] [Rank 3] a = 0.9565061926841736, b = 0.9995467714248616, delta = 0.002007432747632265, c = 9.354278765590306e-05, d = 9.419910706707816e-05, m = 0.00018342815672895189
[Iteration 3960] [Rank 3] a = 1.0563009977340698, b = 0.9995121074046922, delta = 0.002163083292543888, c = 2.421473195967062e-05, d = 2.4560163228710146e-05, m = 0.00018315412096468387
[Iteration 3970] [Rank 3] a = 1.0857176780700684, b = 0.9995126255514728, delta = 0.0020555504597723484, c = 2.5251025766789194e-05, d = 2.5389198274405006e-05, m = 0.0001830364266705625
[Iteration 3980] [Rank 3] a = 0.9150134325027466, b = 0.9995737150586345, delta = 0.0020162828732281923, c = 0.00014743006562606878, d = 0.00014891542008293874, m = 0.00018277389717899628
[Iteration 3990] [Rank 3] a = 1.0047662258148193, b = 0.9995241974963015, delta = 0.0021347200963646173, c = 4.839492079243729e-05, d = 4.891306769599658e-05, m = 0.00018255191757068917
[Iteration 3950] [Rank 1] a = 1.0360201597213745, b = 0.9995864960133353, delta = 0.0010610446333885193, c = 0.00017299197953499356, d = 0.00017385555770759237, m = 0.00026890517233863273
[Iteration 3960] [Rank 1] a = 1.011015772819519, b = 0.9995744059210472, delta = 0.001099892659112811, c = 0.0001488117907022269, d = 0.00014970991200172966, m = 0.00026895826274261415
[Iteration 3970] [Rank 1] a = 1.0083115100860596, b = 0.9996129215011811, delta = 0.0010487663093954325, c = 0.0002258429636980407, d = 0.0002272246887741988, m = 0.00026934013709353983
[Iteration 3980] [Rank 1] a = 0.9818140268325806, b = 0.9997407137856408, delta = 0.0009656945476308465, c = 0.0004814275596603844, d = 0.0004862290543000338, m = 0.00027021206136211996
[Iteration 3990] [Rank 1] a = 1.0362757444381714, b = 0.9995842852535934, delta = 0.001024044817313552, c = 0.00016857045929128764, d = 0.0001693304080831746, m = 0.0002710498594077815
[Iteration 4010] [Rank 0] a = 0.9641685485839844, b = 0.9995057341993155, delta = 0.004180361982434988, c = 1.1468318132112192e-05, d = 1.157194751282405e-05, m = 9.126377665379241e-05
[Iteration 4020] [Rank 0] a = 1.0060079097747803, b = 0.9995130573404567, delta = 0.0037405812181532383, c = 2.6114603939388003e-05, d = 2.6287319573907767e-05, m = 9.111580869270579e-05
[Iteration 4030] [Rank 0] a = 0.8940784335136414, b = 0.9995430234963687, delta = 0.0037184148095548153, c = 8.60469291177454e-05, d = 8.666870540201653e-05, m = 9.096507857916198e-05
cross_entropy                  - bits:4828511680.000, epoch: 29.000, ratio_transmit_grad:  0.341, value:  6.184 (split:train)
last_cross_entropy             - bits:4828511680.000, epoch: 29.000, ratio_transmit_grad:  0.341, value:  6.184 (split:train)
perplexity                     - bits:4828511680.000, epoch: 29.000, ratio_transmit_grad:  0.341, value:486.297 (split:train)
[Iteration 3950] [Rank 2] a = 1.089476466178894, b = 0.9995062523460926, delta = 0.0028668774757534266, c = 1.2504611939230765e-05, d = 1.2539155066134717e-05, m = 0.00011085803054650544
[Iteration 3960] [Rank 2] a = 0.8428884744644165, b = 1.0036403403814516, delta = 0.0024479227140545845, c = 0.00828071292454237, d = 0.007109804551879096, m = 0.00011638323339002122
[Iteration 3970] [Rank 2] a = 1.0703321695327759, b = 0.9995112956414035, delta = 0.002469475846737623, c = 2.259120499518486e-05, d = 2.2798463756608576e-05, m = 0.00012151374323657968
[Iteration 3980] [Rank 2] a = 0.9706822037696838, b = 0.9995281008687652, delta = 0.002290403936058283, c = 5.6201667472730535e-05, d = 5.6685271249385864e-05, m = 0.00012683945519716266
[Iteration 3990] [Rank 2] a = 1.0100764036178589, b = 0.9995291371623423, delta = 0.0020122204441577196, c = 5.8274255086967674e-05, d = 5.858514322910325e-05, m = 0.00013595023600340722
[Iteration 4000] [Rank 3] a = 1.1350088119506836, b = 0.9995075477130366, delta = 0.0021757895592600107, c = 1.5095346457027193e-05, d = 1.5164432710835097e-05, m = 0.00018240047918175915
[Iteration 4010] [Rank 3] a = 1.054153323173523, b = 0.9995195514467952, delta = 0.0019960617646574974, c = 3.91028196552741e-05, d = 3.934462154360177e-05, m = 0.00018246176548748522
[Iteration 4020] [Rank 3] a = 0.9976622462272644, b = 0.9995892076483366, delta = 0.00187870382796973, c = 0.00017841525045891407, d = 0.000180660553707671, m = 0.00018231037674563432
[Iteration 4030] [Rank 3] a = 0.9878332614898682, b = 0.9995770311982191, delta = 0.001719262101687491, c = 0.00015406234599162763, d = 0.0001553404416870739, m = 0.0001827866570320335
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4030 |     0.10806s |  92.9%
- batch.accumulate               |   4030 |     0.00082s |   0.7%
[Iteration 4000] [Rank 1] a = 0.9570383429527283, b = 1.006334825607054, delta = 0.0009112730040214956, c = 0.013669820695954887, d = 0.011639030265271525, m = 0.000274636516146416
[Iteration 4010] [Rank 1] a = 1.0408673286437988, b = 0.9996344245946325, delta = 0.0009079238516278565, c = 0.0002688491566934614, d = 0.00026978182111986814, m = 0.00027854285720578894
[Iteration 4020] [Rank 1] a = 0.9176059365272522, b = 1.0016701703947755, delta = 0.0008658987935632467, c = 0.004340343895481618, d = 0.003832836275008749, m = 0.00027979611500745003
[Iteration 4030] [Rank 1] a = 1.0514816045761108, b = 0.9996167212445768, delta = 0.0009546403307467699, c = 0.00023344245161691023, d = 0.00023399514164737346, m = 0.0002828568616836307
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4030 |     0.10797s |  92.8%
- batch.accumulate               |   4030 |     0.00083s |   0.7%
last_perplexity                - bits:4828511680.000, epoch: 29.000, ratio_transmit_grad:  0.341, value:486.297 (split:train)
last_cross_entropy             - bits:4828511680.000, epoch: 29.000, ratio_transmit_grad:  0.341, value:  5.835 (split:test)
last_perplexity                - bits:4828511680.000, epoch: 29.000, ratio_transmit_grad:  0.341, value:342.966 (split:test)
runavg_cross_entropy           - bits:4828511680.000, epoch: 29.000, ratio_transmit_grad:  0.341, value:  5.950 (split:test)
runavg_perplexity              - bits:4828511680.000, epoch: 29.000, ratio_transmit_grad:  0.341, value:384.746 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4030 |     0.10786s |  92.7%
- batch.accumulate               |   4030 |     0.00083s |   0.7%
- batch.backward                 |   4030 |     0.05177s |  44.5%
- batch.evaluate                 |   4030 |     0.00275s |   2.4%
[Iteration 4000] [Rank 2] a = 0.9287150502204895, b = 0.9996014704563794, delta = 0.0018941672751680017, c = 0.00020294087056072028, d = 0.00020508254442876532, m = 0.00013813287928476992
[Iteration 4010] [Rank 2] a = 0.9417779445648193, b = 0.9996117815781645, delta = 0.0017546199960634112, c = 0.00022356311732237984, d = 0.0002263611106016, m = 0.00014364612486729924
[Iteration 4020] [Rank 2] a = 1.1464996337890625, b = 0.9995061141736186, delta = 0.0019619048107415438, c = 1.2228266923999145e-05, d = 1.2366439431614955e-05, m = 0.00014755720769972657
[Iteration 4030] [Rank 2] a = 1.0631123781204224, b = 0.9995371166229176, delta = 0.0018361220136284828, c = 7.423317971659368e-05, d = 7.437135222420949e-05, m = 0.00014743988612307484
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4030 |     0.10783s |  92.7%
- batch.accumulate               |   4030 |     0.00083s |   0.7%
- batch.backward                 |   4030 |     0.05171s |  44.4%
- batch.evaluate                 |   4030 |     0.00277s |   2.4%
- batch.forward                  |   4030 |     0.02537s |  21.8%
- batch.mom                      |   4030 |     0.00126s |   1.1%
- batch.reduce                   |   4030 |     0.02333s |  20.1%
- batch.reporting.compr_err      |   4030 |     0.00001s |   0.0%
- batch.reporting.lr             |   4030 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   4030 |     0.00001s |   0.0%
- batch.step                     |   4030 |     0.00047s |   0.4%
- batch.update_runavg            |   4030 |     0.00129s |   1.1%
- batch.wd                       |   4030 |     0.00001s |   0.0%
- epoch_metrics.collect          |     28 |     0.01104s |   0.1%
- reduce.combine                 |   4030 |     0.00544s |   4.7%
- reduce.flatpack                |   4030 |     0.00002s |   0.0%
- reduce.flatput                 |   4030 |     0.00013s |   0.1%
- batch.backward                 |   4030 |     0.05174s |  44.5%
- batch.evaluate                 |   4030 |     0.00276s |   2.4%
- batch.forward                  |   4030 |     0.02539s |  21.8%
- batch.mom                      |   4030 |     0.00126s |   1.1%
- batch.reduce                   |   4030 |     0.02321s |  20.0%
- batch.reporting.compr_err      |   4030 |     0.00001s |   0.0%
- batch.reporting.lr             |   4030 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   4030 |     0.00001s |   0.0%
- batch.step                     |   4030 |     0.00048s |   0.4%
- batch.update_runavg            |   4030 |     0.00129s |   1.1%
- batch.wd                       |   4030 |     0.00001s |   0.0%
- epoch_metrics.collect          |     28 |     0.01223s |   0.1%
- reduce.combine                 |   4030 |     0.00546s |   4.7%
- reduce.flatpack                |   4030 |     0.00002s |   0.0%
- reduce.flatput                 |   4030 |     0.00020s |   0.2%
- batch.forward                  |   4030 |     0.02551s |  21.9%
- batch.mom                      |   4030 |     0.00126s |   1.1%
- batch.reduce                   |   4030 |     0.02289s |  19.7%
- batch.reporting.compr_err      |   4030 |     0.00001s |   0.0%
- batch.reporting.lr             |   4030 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   4030 |     0.00001s |   0.0%
- batch.step                     |   4030 |     0.00048s |   0.4%
- batch.update_runavg            |   4030 |     0.00130s |   1.1%
- batch.wd                       |   4030 |     0.00001s |   0.0%
- epoch_metrics.collect          |     28 |     0.00911s |   0.1%
- reduce.combine                 |   4030 |     0.00574s |   4.9%
- reduce.flatpack                |   4030 |     0.00002s |   0.0%
- reduce.flatput                 |   4030 |     0.00010s |   0.1%
- reduce.gather.context          |   4030 |     0.00145s |   1.2%
- reduce.gather.tensors          |   4030 |     0.00204s |   1.8%
- batch.backward                 |   4030 |     0.05215s |  44.8%
- batch.evaluate                 |   4030 |     0.00275s |   2.4%
- batch.forward                  |   4030 |     0.02576s |  22.1%
- batch.mom                      |   4030 |     0.00126s |   1.1%
- batch.reduce                   |   4030 |     0.02225s |  19.1%
- batch.reporting.compr_err      |   4030 |     0.00001s |   0.0%
- batch.reporting.lr             |   4030 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   4030 |     0.00001s |   0.0%
- batch.step                     |   4030 |     0.00048s |   0.4%
- batch.update_runavg            |   4030 |     0.00130s |   1.1%
- batch.wd                       |   4030 |     0.00001s |   0.0%
- epoch_metrics.collect          |     28 |     0.01558s |   0.1%
- reduce.combine                 |   4030 |     0.00569s |   4.9%
- reduce.flatpack                |   4030 |     0.00002s |   0.0%
- reduce.flatput                 |   4030 |     0.00011s |   0.1%
- reduce.gather.context          |   4030 |     0.00277s |   2.4%
- reduce.gather.tensors          |   4030 |     0.00185s |   1.6%
- reduce.heur_params             |   4030 |     0.01015s |   8.7%
- reduce.gather.context          |   4030 |     0.00146s |   1.3%
- reduce.gather.tensors          |   4030 |     0.00208s |   1.8%
- reduce.heur_params             |   4030 |     0.01068s |   9.2%
- reduce.heur_params             |   4030 |     0.01068s |   9.2%
- reduce.heur_params.alpha       |   4029 |     0.00874s |   7.5%
- reduce.heur_params.beta        |   4029 |     0.00187s |   1.6%
- reduce.gather.context          |   4030 |     0.00113s |   1.0%
- reduce.gather.tensors          |   4030 |     0.00199s |   1.7%
- reduce.heur_params             |   4030 |     0.01038s |   8.9%
- reduce.heur_params.alpha       |   4029 |     0.00808s |   6.9%
- reduce.heur_params.beta        |   4029 |     0.00200s |   1.7%
- reduce.memory                  |   4030 |     0.00042s |   0.4%
- reduce.pad                     |   4030 |     0.00027s |   0.2%
- reduce.threshold               |   4030 |     0.00209s |   1.8%
- test.last                      |     28 |     0.41620s |   2.7%
- test.runavg                    |     28 |     0.44712s |   2.9%
-----------------------------------------------------------------

[Iteration 4040] [Rank 3] a = 0.9174192547798157, b = 0.9996578621033011, delta = 0.0017425246769562364, c = 0.0003157241799021248, d = 0.00031810765565849753, m = 0.00018260433760100033
[Iteration 4050] [Rank 3] a = 0.89927738904953, b = 0.9995361148724524, delta = 0.001876232330687344, c = 7.222967835616444e-05, d = 7.278236838662768e-05, m = 0.0001824273267814778
- reduce.heur_params.alpha       |   4029 |     0.00822s |   7.1%
- reduce.heur_params.beta        |   4029 |     0.00238s |   2.0%
- reduce.memory                  |   4030 |     0.00045s |   0.4%
- reduce.pad                     |   4030 |     0.00015s |   0.1%
- reduce.threshold               |   4030 |     0.00252s |   2.2%
- test.last                      |     28 |     0.41620s |   2.7%
- test.runavg                    |     28 |     0.44712s |   2.9%
-----------------------------------------------------------------

[Iteration 4040] [Rank 1] a = 1.0507131814956665, b = 0.9996276368711199, delta = 0.000851225748192519, c = 0.00025527370782020813, d = 0.0002564827172618465, m = 0.00028883995919843486
[Iteration 4050] [Rank 1] a = 1.0484999418258667, b = 0.9996191738062288, delta = 0.0008385651162825525, c = 0.00023834757563727146, d = 0.00023921115380987027, m = 0.000289691145834858
- reduce.memory                  |   4030 |     0.00043s |   0.4%
- reduce.pad                     |   4030 |     0.00029s |   0.2%
- reduce.threshold               |   4030 |     0.00192s |   1.7%
- test.last                      |     28 |     0.41619s |   2.7%
- test.runavg                    |     28 |     0.44713s |   2.9%
-----------------------------------------------------------------

[Iteration 4040] [Rank 0] a = 1.0266377925872803, b = 0.9995054405828087, delta = 0.0037657052744179964, c = 1.0881084974745002e-05, d = 1.0950171228552906e-05, m = 9.088369347815845e-05
[Iteration 4050] [Rank 0] a = 1.003253698348999, b = 0.9995032643663483, delta = 0.004382559098303318, c = 6.528650984847001e-06, d = 6.563194111750954e-06, m = 9.069395603489049e-05
[Iteration 4060] [Rank 0] a = 0.9489351511001587, b = 0.9995123492065231, delta = 0.004024178255349398, c = 2.4698335736325957e-05, d = 2.490559449774967e-05, m = 9.051944321660752e-05
- reduce.heur_params.alpha       |   4029 |     0.00836s |   7.2%
- reduce.heur_params.beta        |   4029 |     0.00194s |   1.7%
- reduce.memory                  |   4030 |     0.00043s |   0.4%
- reduce.pad                     |   4030 |     0.00029s |   0.2%
- reduce.threshold               |   4030 |     0.00200s |   1.7%
- test.last                      |     28 |     0.41620s |   2.7%
- test.runavg                    |     28 |     0.44713s |   2.9%
-----------------------------------------------------------------

[Iteration 4040] [Rank 2] a = 0.9572376608848572, b = 0.9995181351789201, delta = 0.001818972174078226, c = 3.627028324915001e-05, d = 3.630482637605396e-05, m = 0.00015163105181112692
[Iteration 4050] [Rank 2] a = 1.0566903352737427, b = 0.9995324533017947, delta = 0.0015391719061881304, c = 6.490653545252653e-05, d = 6.542468235608582e-05, m = 0.00015506345714221543
[Iteration 4060] [Rank 3] a = 1.0692368745803833, b = 0.9995232130174082, delta = 0.0018592517590150237, c = 4.642596255891201e-05, d = 4.6702307574143625e-05, m = 0.00018229791153262116
[Iteration 4070] [Rank 3] a = 0.9288130402565002, b = 0.9998822887859897, delta = 0.0016987205017358065, c = 0.0007645775708920821, d = 0.0007669955897753588, m = 0.0001822665842517009
[Iteration 4080] [Rank 3] a = 1.017836332321167, b = 0.9995245256559329, delta = 0.0018356426153331995, c = 4.905124020361239e-05, d = 4.953484398026772e-05, m = 0.00018221355547407703
[Iteration 4090] [Rank 3] a = 1.0559148788452148, b = 0.9995207086412798, delta = 0.0018706165719777346, c = 4.141720915783891e-05, d = 4.183172668068634e-05, m = 0.00018201948082669384
[Iteration 4100] [Rank 3] a = 0.9358173608779907, b = 0.999587445949163, delta = 0.0017160788411274552, c = 0.00017489185151471095, d = 0.00017651537847919669, m = 0.00018208984402099732
[Iteration 4060] [Rank 1] a = 0.8687335848808289, b = 1.0002321070274343, delta = 0.0007954339380376041, c = 0.0014642140632047337, d = 0.0014556473677325536, m = 0.00029016608521604647
[Iteration 4070] [Rank 1] a = 0.9678558707237244, b = 0.999735981377579, delta = 0.0007786486530676484, c = 0.00047196274288870143, d = 0.00047355172672628327, m = 0.0002946157074462924
[Iteration 4080] [Rank 1] a = 0.9405991435050964, b = 0.9999261240136216, delta = 0.00075705157360062, c = 0.0008522480269743133, d = 0.0008535952089235674, m = 0.00029574649553050085
[Iteration 4090] [Rank 1] a = 1.0250575542449951, b = 0.999642110439363, delta = 0.0007904432131908834, c = 0.00028422084816572023, d = 0.00028529168509974274, m = 0.00029807135016996725
[Iteration 4100] [Rank 1] a = 1.0337834358215332, b = 0.9997410592168866, delta = 0.0006944490596652031, c = 0.00048211842219846344, d = 0.0004836728629091413, m = 0.00030479101490942136
[Iteration 4070] [Rank 0] a = 0.8957844376564026, b = 0.9995407781935909, delta = 0.003770375857129693, c = 8.155632262023159e-05, d = 8.231627141211853e-05, m = 9.042151788640696e-05
[Iteration 4080] [Rank 0] a = 0.9683390259742737, b = 0.9995247847293262, delta = 0.003911761566996574, c = 4.9569387107171675e-05, d = 4.998390463001911e-05, m = 9.024150245663666e-05
[Iteration 4090] [Rank 0] a = 1.1016380786895752, b = 0.9995008118049463, delta = 0.004660765640437603, c = 1.6235269644857622e-06, d = 1.6235269644857622e-06, m = 9.017332558449047e-05
[Iteration 4100] [Rank 0] a = 0.9473984241485596, b = 0.9995189123990952, delta = 0.0038841066416352987, c = 3.7824723959827866e-05, d = 3.823924148267529e-05, m = 9.001019068814983e-05
timer                          - epoch: 29.554, value:  0.112 (event:batch)
[Iteration 4110] [Rank 0] a = 0.9895930290222168, b = 0.9995079104157811, delta = 0.003994174767285585, c = 1.582075212201019e-05, d = 1.58898383758181e-05, m = 8.987498146797063e-05
[Iteration 4060] [Rank 2] a = 1.1636476516723633, b = 0.9995174788596612, delta = 0.0016421847976744175, c = 3.4957644426799816e-05, d = 3.506127380751167e-05, m = 0.0001571633507974912
[Iteration 4070] [Rank 2] a = 1.185080647468567, b = 0.9995116410725903, delta = 0.0017879449296742678, c = 2.328206753326391e-05, d = 2.3385696913975765e-05, m = 0.00015706418699394775
[Iteration 4080] [Rank 2] a = 1.0479791164398193, b = 0.9995185324247873, delta = 0.0017360963393002748, c = 3.7064775167940914e-05, d = 3.7444749563884387e-05, m = 0.00015692294181105388
[Iteration 4090] [Rank 2] a = 0.9891955852508545, b = 0.9995275827219774, delta = 0.0017200512811541557, c = 5.516537366561196e-05, d = 5.537263242703568e-05, m = 0.00015685865053328206
[Iteration 4100] [Rank 2] a = 1.1345875263214111, b = 0.9995183597091928, delta = 0.0015347050502896309, c = 3.6719343898901386e-05, d = 3.69266026603251e-05, m = 0.00015991313127936422
[Iteration 4110] [Rank 3] a = 1.033859372138977, b = 0.9995258728375785, delta = 0.0018477727426216006, c = 5.1745604102120676e-05, d = 5.2056492244256245e-05, m = 0.00018201623909755443
[Iteration 4120] [Rank 3] a = 0.9649903774261475, b = 0.9995701053025343, delta = 0.001724368310533464, c = 0.00014021055210314273, d = 0.0001412468459102613, m = 0.0001822195962569003
[Iteration 4130] [Rank 3] a = 1.0935543775558472, b = 0.9995156653459228, delta = 0.0018507252680137753, c = 3.1330616101884814e-05, d = 3.153787486330853e-05, m = 0.00018208916411729581
[Iteration 4140] [Rank 3] a = 0.990593671798706, b = 0.9995415554137829, delta = 0.0017823821399360895, c = 8.311076333090944e-05, d = 8.435431589945172e-05, m = 0.0001819170443080483
[Iteration 4150] [Rank 3] a = 0.9797247052192688, b = 0.9995366502908044, delta = 0.0018060628790408373, c = 7.330051529018696e-05, d = 7.374957593993835e-05, m = 0.00018176004204760321
[Iteration 4110] [Rank 1] a = 0.9330192804336548, b = 1.0016808960055676, delta = 0.000637443910818547, c = 0.004361795177288972, d = 0.0038831656109078075, m = 0.0003096510427709849
[Iteration 4120] [Rank 1] a = 1.057570457458496, b = 0.999659623802568, delta = 0.0007008797838352621, c = 0.00031924757884632795, d = 0.000319938441384407, m = 0.0003117244529478648
[Iteration 4130] [Rank 1] a = 0.9788768291473389, b = 0.9996973967079288, delta = 0.0006844628369435668, c = 0.0003947933973852718, d = 0.0003963478380959497, m = 0.00031311545051405536
[Iteration 4140] [Rank 1] a = 1.038072109222412, b = 0.9996139577948333, delta = 0.0007028844556771219, c = 0.00022791555131227784, d = 0.00022871004323106876, m = 0.0003153082359424985
[Iteration 4150] [Rank 1] a = 0.9570145606994629, b = 1.0003001224394652, delta = 0.0006156210438348353, c = 0.0016002448969524982, d = 0.0015886038631858664, m = 0.00031664243956999825
[Iteration 4120] [Rank 0] a = 1.0540729761123657, b = 0.9995043352030186, delta = 0.004020773805677891, c = 8.670324852892048e-06, d = 8.84304048741181e-06, m = 8.97261199951291e-05
[Iteration 4130] [Rank 0] a = 0.9887135624885559, b = 0.9995104493349971, delta = 0.003975712228566408, c = 2.0898591776891195e-05, d = 2.1071307411410955e-05, m = 8.958366533801052e-05
[Iteration 4140] [Rank 0] a = 0.9933454394340515, b = 0.9995091021533716, delta = 0.00413169153034687, c = 1.820422787838291e-05, d = 1.8342400385998717e-05, m = 8.941993491175507e-05
[Iteration 4150] [Rank 0] a = 0.7921099066734314, b = 0.9997149446148808, delta = 0.003583474550396204, c = 0.00042988921431968746, d = 0.00043475979521314474, m = 8.948033784890612e-05
[Iteration 4160] [Rank 0] a = 1.186369776725769, b = 0.9995013472232801, delta = 0.004344805609434843, c = 2.694363898508286e-06, d = 2.7289070254122384e-06, m = 8.941059619346532e-05
[Iteration 4110] [Rank 2] a = 1.1502001285552979, b = 0.9995182906229547, delta = 0.0016144657274708152, c = 3.658117139128558e-05, d = 3.6684800771997434e-05, m = 0.00015984466881429114
[Iteration 4120] [Rank 2] a = 1.0286498069763184, b = 0.9995440597899597, delta = 0.0014430774608626962, c = 8.811951673198253e-05, d = 8.870674988934973e-05, m = 0.00015999524748401043
[Iteration 4130] [Rank 2] a = 1.0784615278244019, b = 0.9995147844963935, delta = 0.0016076193423941731, c = 2.9568916629783245e-05, d = 2.9707089137399053e-05, m = 0.00015988907160690335
[Iteration 4140] [Rank 2] a = 0.9738712906837463, b = 0.9996335610165757, delta = 0.0014304686337709427, c = 0.0002671220003482638, d = 0.0002695400192315405, m = 0.00015988949872557185
[Iteration 4150] [Rank 2] a = 1.0075517892837524, b = 0.9995400182449599, delta = 0.0016148803988471627, c = 8.003642503645768e-05, d = 8.048548568620906e-05, m = 0.00015975765132135146
[Iteration 4160] [Rank 3] a = 0.9165681600570679, b = 0.9995416072284622, delta = 0.0017410614527761936, c = 8.32143927116213e-05, d = 8.345619459994897e-05, m = 0.0001818464015717892
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4169 |     0.10828s |  92.9%
- batch.accumulate               |   4169 |     0.00082s |   0.7%
- batch.backward                 |   4169 |     0.05171s |  44.4%
- batch.evaluate                 |   4169 |     0.00277s |   2.4%
- batch.forward                  |   4169 |     0.02538s |  21.8%
- batch.mom                      |   4169 |     0.00126s |   1.1%
- batch.reduce                   |   4169 |     0.02356s |  20.2%
- batch.reporting.compr_err      |   4169 |     0.00001s |   0.0%
- batch.reporting.lr             |   4169 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   4169 |     0.00001s |   0.0%
[Iteration 4160] [Rank 1] a = 0.9698448181152344, b = 0.9999006311861591, delta = 0.0006224265671335161, c = 0.0008012623716640796, d = 0.0008027477261209495, m = 0.0003179060171078196
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4169 |     0.10820s |  92.8%
- batch.accumulate               |   4169 |     0.00083s |   0.7%
- batch.backward                 |   4169 |     0.05173s |  44.4%
- batch.evaluate                 |   4169 |     0.00276s |   2.4%
- batch.forward                  |   4169 |     0.02539s |  21.8%
- batch.mom                      |   4169 |     0.00126s |   1.1%
- batch.reduce                   |   4169 |     0.02345s |  20.1%
- batch.reporting.compr_err      |   4169 |     0.00001s |   0.0%
- batch.reporting.lr             |   4169 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   4169 |     0.00001s |   0.0%
cross_entropy                  - bits:5280378944.000, epoch: 30.000, ratio_transmit_grad:  0.175, value:  6.124 (split:train)
last_cross_entropy             - bits:5280378944.000, epoch: 30.000, ratio_transmit_grad:  0.175, value:  6.124 (split:train)
perplexity                     - bits:5280378944.000, epoch: 30.000, ratio_transmit_grad:  0.175, value:457.820 (split:train)
last_perplexity                - bits:5280378944.000, epoch: 30.000, ratio_transmit_grad:  0.175, value:457.820 (split:train)
last_cross_entropy             - bits:5280378944.000, epoch: 30.000, ratio_transmit_grad:  0.175, value:  5.803 (split:test)
last_perplexity                - bits:5280378944.000, epoch: 30.000, ratio_transmit_grad:  0.175, value:332.413 (split:test)
runavg_cross_entropy           - bits:5280378944.000, epoch: 30.000, ratio_transmit_grad:  0.175, value:  5.925 (split:test)
runavg_perplexity              - bits:5280378944.000, epoch: 30.000, ratio_transmit_grad:  0.175, value:375.455 (split:test)
[Iteration 4160] [Rank 2] a = 1.0350472927093506, b = 0.9995334550522564, delta = 0.0015740296803414822, c = 6.691003681295577e-05, d = 6.739364058961111e-05, m = 0.00015971882660576327
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4169 |     0.10805s |  92.7%
- batch.accumulate               |   4169 |     0.00083s |   0.7%
- batch.backward                 |   4169 |     0.05216s |  44.7%
- batch.evaluate                 |   4169 |     0.00275s |   2.4%
- batch.forward                  |   4169 |     0.02576s |  22.1%
- batch.mom                      |   4169 |     0.00126s |   1.1%
- batch.reduce                   |   4169 |     0.02247s |  19.3%
- batch.reporting.compr_err      |   4169 |     0.00001s |   0.0%
- batch.reporting.lr             |   4169 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   4169 |     0.00001s |   0.0%
- batch.step                     |   4169 |     0.00047s |   0.4%
- batch.update_runavg            |   4169 |     0.00129s |   1.1%
- batch.wd                       |   4169 |     0.00001s |   0.0%
- epoch_metrics.collect          |     29 |     0.01153s |   0.1%
- reduce.combine                 |   4169 |     0.00547s |   4.7%
- batch.step                     |   4169 |     0.00048s |   0.4%
- batch.update_runavg            |   4169 |     0.00129s |   1.1%
- batch.wd                       |   4169 |     0.00001s |   0.0%
- epoch_metrics.collect          |     29 |     0.01184s |   0.1%
- reduce.combine                 |   4169 |     0.00549s |   4.7%
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4169 |     0.10808s |  92.7%
- batch.step                     |   4169 |     0.00048s |   0.4%
- batch.update_runavg            |   4169 |     0.00130s |   1.1%
- batch.wd                       |   4169 |     0.00001s |   0.0%
- epoch_metrics.collect          |     29 |     0.01585s |   0.1%
- reduce.combine                 |   4169 |     0.00573s |   4.9%
- reduce.flatpack                |   4169 |     0.00002s |   0.0%
- reduce.flatput                 |   4169 |     0.00013s |   0.1%
- reduce.gather.context          |   4169 |     0.00280s |   2.4%
- reduce.gather.tensors          |   4169 |     0.00197s |   1.7%
- reduce.heur_params             |   4169 |     0.01017s |   8.7%
- reduce.heur_params.alpha       |   4168 |     0.00808s |   6.9%
- reduce.heur_params.beta        |   4168 |     0.00202s |   1.7%
- reduce.memory                  |   4169 |     0.00042s |   0.4%
- reduce.pad                     |   4169 |     0.00027s |   0.2%
- reduce.threshold               |   4169 |     0.00211s |   1.8%
- test.last                      |     29 |     0.41611s |   2.6%
- test.runavg                    |     29 |     0.44705s |   2.8%
-----------------------------------------------------------------
- reduce.flatpack                |   4169 |     0.00002s |   0.0%
- reduce.flatput                 |   4169 |     0.00020s |   0.2%
- reduce.gather.context          |   4169 |     0.00151s |   1.3%
- reduce.gather.tensors          |   4169 |     0.00221s |   1.9%
- reduce.heur_params             |   4169 |     0.01069s |   9.2%
- reduce.heur_params.alpha       |   4168 |     0.00822s |   7.1%
- reduce.heur_params.beta        |   4168 |     0.00239s |   2.1%
- reduce.memory                  |   4169 |     0.00045s |   0.4%
- reduce.pad                     |   4169 |     0.00015s |   0.1%
- reduce.threshold               |   4169 |     0.00253s |   2.2%
- test.last                      |     29 |     0.41611s |   2.6%
- test.runavg                    |     29 |     0.44705s |   2.8%
-----------------------------------------------------------------
- batch.accumulate               |   4169 |     0.00083s |   0.7%
- batch.backward                 |   4169 |     0.05177s |  44.4%
- batch.evaluate                 |   4169 |     0.00275s |   2.4%
- batch.forward                  |   4169 |     0.02551s |  21.9%
- batch.mom                      |   4169 |     0.00126s |   1.1%
- batch.reduce                   |   4169 |     0.02312s |  19.8%
- batch.reporting.compr_err      |   4169 |     0.00001s |   0.0%
- batch.reporting.lr             |   4169 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   4169 |     0.00001s |   0.0%
- batch.step                     |   4169 |     0.00048s |   0.4%
- batch.update_runavg            |   4169 |     0.00130s |   1.1%
- batch.wd                       |   4169 |     0.00001s |   0.0%
- epoch_metrics.collect          |     29 |     0.00960s |   0.1%
- reduce.combine                 |   4169 |     0.00577s |   5.0%
- reduce.flatpack                |   4169 |     0.00002s |   0.0%
- reduce.flatpack                |   4169 |     0.00002s |   0.0%
- reduce.flatput                 |   4169 |     0.00012s |   0.1%
- reduce.gather.context          |   4169 |     0.00112s |   1.0%
- reduce.gather.tensors          |   4169 |     0.00213s |   1.8%
- reduce.heur_params             |   4169 |     0.01040s |   8.9%
- reduce.heur_params.alpha       |   4168 |     0.00836s |   7.2%
- reduce.heur_params.beta        |   4168 |     0.00196s |   1.7%
- reduce.memory                  |   4169 |     0.00043s |   0.4%
- reduce.pad                     |   4169 |     0.00029s |   0.2%
- reduce.threshold               |   4169 |     0.00203s |   1.7%
- test.last                      |     29 |     0.41611s |   2.6%
- test.runavg                    |     29 |     0.44706s |   2.8%
-----------------------------------------------------------------
- reduce.flatput                 |   4169 |     0.00010s |   0.1%
- reduce.gather.context          |   4169 |     0.00144s |   1.2%
- reduce.gather.tensors          |   4169 |     0.00218s |   1.9%
- reduce.heur_params             |   4169 |     0.01070s |   9.2%
- reduce.heur_params.alpha       |   4168 |     0.00874s |   7.5%
- reduce.heur_params.beta        |   4168 |     0.00189s |   1.6%
- reduce.memory                  |   4169 |     0.00043s |   0.4%
- reduce.pad                     |   4169 |     0.00029s |   0.2%
- reduce.threshold               |   4169 |     0.00195s |   1.7%
- test.last                      |     29 |     0.41610s |   2.6%
- test.runavg                    |     29 |     0.44706s |   2.8%
-----------------------------------------------------------------

[Iteration 4170] [Rank 0] a = 0.9812877774238586, b = 0.9995232475605271, delta = 0.0038384587969630957, c = 4.649504881271991e-05, d = 4.7082281970087105e-05, m = 8.927819805513728e-05
[Iteration 4180] [Rank 0] a = 0.8560333251953125, b = 0.9997600752070637, delta = 0.0035389659460633993, c = 0.000520150404919715, d = 0.0005237428901177261, m = 8.924339525287989e-05
[Iteration 4190] [Rank 0] a = 1.0962525606155396, b = 0.9995028843920462, delta = 0.003991580102592707, c = 5.768702192960048e-06, d = 5.906874700575858e-06, m = 8.911178886389383e-05
[Iteration 4200] [Rank 0] a = 1.1422070264816284, b = 0.9995014163095166, delta = 0.004360666498541832, c = 2.8325364061240955e-06, d = 2.8325364061240955e-06, m = 8.913588718835413e-05
[Iteration 4210] [Rank 0] a = 0.9653804898262024, b = 0.9995059587295856, delta = 0.004070917144417763, c = 1.1917378781863573e-05, d = 1.2124637543287288e-05, m = 8.904308395398738e-05
[Iteration 4220] [Rank 0] a = 1.1116081476211548, b = 0.9995026253186586, delta = 0.004110044799745083, c = 5.250555289400763e-06, d = 5.285098416304715e-06, m = 8.89020359915315e-05
[Iteration 4230] [Rank 0] a = 0.947638750076294, b = 0.9995065286910406, delta = 0.0039382376708090305, c = 1.3057301969694001e-05, d = 1.3264560731117717e-05, m = 8.876640638386342e-05
[Iteration 4240] [Rank 0] a = 0.9545298218727112, b = 0.9995128846248631, delta = 0.003757952246814966, c = 2.5769172670348482e-05, d = 2.5976431431772194e-05, m = 8.886204327712405e-05
[Iteration 4250] [Rank 0] a = 1.0274336338043213, b = 0.9995046633626438, delta = 0.00398668646812439, c = 9.326644264067145e-06, d = 9.430273644779e-06, m = 8.871579399667606e-05
[Iteration 4260] [Rank 0] a = 0.8109553456306458, b = 0.9996753927382561, delta = 0.0035821383353322744, c = 0.0003507854537096365, d = 0.0003527889550700657, m = 8.863436416296502e-05
[Iteration 4270] [Rank 0] a = 1.104816198348999, b = 0.9995014335810758, delta = 0.0044422694481909275, c = 2.867079533028048e-06, d = 2.867079533028048e-06, m = 8.847098961090203e-05
[Iteration 4280] [Rank 0] a = 0.9956367015838623, b = 0.9995051124231832, delta = 0.0039682392962276936, c = 1.0224765563569907e-05, d = 1.0328394944281763e-05, m = 8.847964153853482e-05
[Iteration 4290] [Rank 0] a = 1.005167841911316, b = 0.9995035407112954, delta = 0.0040395925752818584, c = 7.081341015310239e-06, d = 7.081341015310239e-06, m = 8.83639590644082e-05
[Iteration 4300] [Rank 0] a = 0.9631459712982178, b = 0.999545838760627, delta = 0.0037460040766745806, c = 9.167745880308963e-05, d = 9.309372700615169e-05, m = 8.823407687198673e-05
cross_entropy                  - bits:5601075648.000, epoch: 31.000, ratio_transmit_grad:  0.125, value:  6.080 (split:train)
last_cross_entropy             - bits:5601075648.000, epoch: 31.000, ratio_transmit_grad:  0.125, value:  6.080 (split:train)
perplexity                     - bits:5601075648.000, epoch: 31.000, ratio_transmit_grad:  0.125, value:438.376 (split:train)
last_perplexity                - bits:5601075648.000, epoch: 31.000, ratio_transmit_grad:  0.125, value:438.376 (split:train)
timer                          - epoch: 31.000, value:  0.004 (event:epoch_metrics.collect)
last_cross_entropy             - bits:5601075648.000, epoch: 31.000, ratio_transmit_grad:  0.125, value:  5.755 (split:test)
last_perplexity                - bits:5601075648.000, epoch: 31.000, ratio_transmit_grad:  0.125, value:316.709 (split:test)
runavg_cross_entropy           - bits:5601075648.000, epoch: 31.000, ratio_transmit_grad:  0.125, value:  5.877 (split:test)
runavg_perplexity              - bits:5601075648.000, epoch: 31.000, ratio_transmit_grad:  0.125, value:357.825 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4308 |     0.10824s |  92.7%
- batch.accumulate               |   4308 |     0.00083s |   0.7%
- batch.backward                 |   4308 |     0.05177s |  44.4%
- batch.evaluate                 |   4308 |     0.00275s |   2.4%
- batch.forward                  |   4308 |     0.02551s |  21.9%
- batch.mom                      |   4308 |     0.00126s |   1.1%
- batch.reduce                   |   4308 |     0.02327s |  19.9%
- batch.reporting.compr_err      |   4308 |     0.00001s |   0.0%
- batch.reporting.lr             |   4308 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   4308 |     0.00001s |   0.0%
- batch.step                     |   4308 |     0.00048s |   0.4%
- batch.update_runavg            |   4308 |     0.00130s |   1.1%
- batch.wd                       |   4308 |     0.00001s |   0.0%
- epoch_metrics.collect          |     30 |     0.00941s |   0.1%
- reduce.combine                 |   4308 |     0.00581s |   5.0%
- reduce.flatpack                |   4308 |     0.00002s |   0.0%
- reduce.flatput                 |   4308 |     0.00011s |   0.1%
- reduce.gather.context          |   4308 |     0.00143s |   1.2%
- reduce.gather.tensors          |   4308 |     0.00226s |   1.9%
- reduce.heur_params             |   4308 |     0.01072s |   9.2%
- reduce.heur_params.alpha       |   4307 |     0.00873s |   7.5%
- reduce.heur_params.beta        |   4307 |     0.00191s |   1.6%
- reduce.memory                  |   4308 |     0.00043s |   0.4%
- reduce.pad                     |   4308 |     0.00029s |   0.2%
- reduce.threshold               |   4308 |     0.00198s |   1.7%
- test.last                      |     30 |     0.41619s |   2.6%
- test.runavg                    |     30 |     0.44719s |   2.8%
-----------------------------------------------------------------

[Iteration 4310] [Rank 0] a = 1.0153286457061768, b = 0.9995165980101307, delta = 0.0036397140938788652, c = 3.319594495469825e-05, d = 3.361046247754567e-05, m = 8.81919282926021e-05
[Iteration 4320] [Rank 0] a = 1.0872321128845215, b = 0.9995026944048953, delta = 0.003996474668383598, c = 5.388727797016572e-06, d = 5.423270923920525e-06, m = 8.811914899677365e-05
[Iteration 4330] [Rank 0] a = 0.9960241913795471, b = 0.9995049397075911, delta = 0.003907663282006979, c = 9.879334294530383e-06, d = 9.98296367524224e-06, m = 8.80600014207479e-05
[Iteration 4340] [Rank 0] a = 1.0902259349822998, b = 0.9995017790122589, delta = 0.0040872604586184025, c = 3.557942071107096e-06, d = 3.592485198011048e-06, m = 8.791938781200232e-05
[Iteration 4350] [Rank 0] a = 0.9312790632247925, b = 0.9995230403018129, delta = 0.003826647764071822, c = 4.608053128987248e-05, d = 4.656413506652782e-05, m = 8.782514196699256e-05
memory_norm                    - epoch: 31.353, value:  6.235 (weight:encoder.weight)
memory_inf_norm                - epoch: 31.353, value:  0.004 (weight:encoder.weight)
memory_norm                    - epoch: 31.353, value:  1.811 (weight:rnn.weight_ih_l0)
memory_inf_norm                - epoch: 31.353, value:  0.004 (weight:rnn.weight_ih_l0)
memory_norm                    - epoch: 31.353, value:  1.618 (weight:rnn.weight_hh_l0)
memory_inf_norm                - epoch: 31.353, value:  0.004 (weight:rnn.weight_hh_l0)
memory_norm                    - epoch: 31.353, value:  0.064 (weight:rnn.bias_ih_l0)
memory_inf_norm                - epoch: 31.353, value:  0.004 (weight:rnn.bias_ih_l0)
memory_norm                    - epoch: 31.353, value:  0.064 (weight:rnn.bias_hh_l0)
memory_inf_norm                - epoch: 31.353, value:  0.004 (weight:rnn.bias_hh_l0)
memory_norm                    - epoch: 31.353, value:  1.361 (weight:rnn.weight_ih_l1)
memory_inf_norm                - epoch: 31.353, value:  0.004 (weight:rnn.weight_ih_l1)
memory_norm                    - epoch: 31.353, value:  1.026 (weight:rnn.weight_hh_l1)
memory_inf_norm                - epoch: 31.353, value:  0.004 (weight:rnn.weight_hh_l1)
memory_norm                    - epoch: 31.353, value:  0.054 (weight:rnn.bias_ih_l1)
memory_inf_norm                - epoch: 31.353, value:  0.004 (weight:rnn.bias_ih_l1)
memory_norm                    - epoch: 31.353, value:  0.054 (weight:rnn.bias_hh_l1)
memory_inf_norm                - epoch: 31.353, value:  0.004 (weight:rnn.bias_hh_l1)

[Iteration 4170] [Rank 1] a = 1.0584203004837036, b = 0.9998496628032179, delta = 0.000641746271867305, c = 0.000699325604170516, d = 0.0007001546392162109, m = 0.000319245905935363
[Iteration 4180] [Rank 1] a = 1.0712822675704956, b = 0.9997087959388025, delta = 0.0006207515252754092, c = 0.0004175918611418804, d = 0.00041876632745661477, m = 0.0003230512472222371
[Iteration 4190] [Rank 1] a = 0.951679527759552, b = 0.9999991999984524, delta = 0.000599640654399991, c = 0.0009983999969049358, d = 0.0009983999969049358, m = 0.00032540917922978783
[Iteration 4200] [Rank 1] a = 1.0023595094680786, b = 1.00007999637211, delta = 0.0005631999229080975, c = 0.0011599927445616251, d = 0.001157885613820484, m = 0.00032759519146365724
[Iteration 4210] [Rank 1] a = 1.0619934797286987, b = 0.999741491005944, delta = 0.0005940576083958149, c = 0.00048298200037106225, d = 0.00048408738043198877, m = 0.0003290474007853419
[Iteration 4220] [Rank 1] a = 1.044467568397522, b = 0.9997347896397841, delta = 0.0005967437755316496, c = 0.00046957926713232876, d = 0.00047047738843183153, m = 0.00033113396619924453
[Iteration 4230] [Rank 1] a = 0.9921547770500183, b = 0.9999204934839695, delta = 0.0005842046812176704, c = 0.0008409869676036248, d = 0.0008419196320300315, m = 0.00033241630709727587
[Iteration 4240] [Rank 1] a = 1.1520572900772095, b = 0.9996845812090714, delta = 0.0006556309526786208, c = 0.0003691623972225392, d = 0.0003697841735068103, m = 0.0003333931888670474
[Iteration 4250] [Rank 1] a = 1.1454131603240967, b = 0.999709003197546, delta = 0.000623229134362191, c = 0.00041800637866472784, d = 0.0004188354137104227, m = 0.00033573099669381864
[Iteration 4260] [Rank 1] a = 1.0306464433670044, b = 0.9997414737343817, delta = 0.0006214762688614428, c = 0.0004829474572441583, d = 0.0004835346904015255, m = 0.0003372609399376124

[Iteration 4170] [Rank 3] a = 1.1118342876434326, b = 0.9995189642137734, delta = 0.0018789904424920678, c = 3.792835334053972e-05, d = 3.792835334053972e-05, m = 0.00018194163082859937
[Iteration 4180] [Rank 3] a = 1.0650242567062378, b = 0.9995159244193137, delta = 0.0018169402610510588, c = 3.18487630054441e-05, d = 3.209056489377177e-05, m = 0.0001819363856344563
[Iteration 4190] [Rank 3] a = 1.090760350227356, b = 0.9995117101588274, delta = 0.0018637306056916714, c = 2.3420240040879717e-05, d = 2.359295567539948e-05, m = 0.0001821029167663232
[Iteration 4200] [Rank 3] a = 1.068230390548706, b = 0.9995333514228983, delta = 0.0016038431786000729, c = 6.670277805153206e-05, d = 6.71863818281874e-05, m = 0.00018254912784012212
[Iteration 4210] [Rank 3] a = 0.9933980703353882, b = 0.9996016604435471, delta = 0.0015668424312025309, c = 0.00020332084495666374, d = 0.00020594612260136413, m = 0.00018245206313540526
[Iteration 4270] [Rank 1] a = 0.9558004140853882, b = 0.9998372445494003, delta = 0.0006076236604712903, c = 0.0006744890959265743, d = 0.0006758017347489245, m = 0.0003382195602736717
[Iteration 4280] [Rank 1] a = 0.99709552526474, b = 0.9996665324271644, delta = 0.0006552356644533575, c = 0.0003330648296079089, d = 0.0003339974940343156, m = 0.00033948381564583897
[Iteration 4290] [Rank 1] a = 1.0249419212341309, b = 0.9997849117140205, delta = 0.00057746353559196, c = 0.0005698234214075986, d = 0.0005711015171030448, m = 0.00034115751706369235
[Iteration 4300] [Rank 1] a = 0.9753052592277527, b = 1.0014382484020061, delta = 0.0005095105152577162, c = 0.0038764987874153447, d = 0.003508407227126828, m = 0.0003459897095649563
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4308 |     0.10835s |  92.8%
- batch.accumulate               |   4308 |     0.00083s |   0.7%
[Iteration 4220] [Rank 3] a = 0.9955624938011169, b = 0.9995298107531676, delta = 0.0017063148552551866, c = 5.962143703622182e-05, d = 5.9966868305261346e-05, m = 0.00018233292879451878
[Iteration 4230] [Rank 3] a = 0.9615411162376404, b = 0.9998620465139556, delta = 0.0015430842759087682, c = 0.0007240930261606499, d = 0.0007268219331860622, m = 0.00018234316566610723
[Iteration 4240] [Rank 3] a = 1.0013668537139893, b = 0.999549690318489, delta = 0.0016934776213020086, c = 9.938057610267102e-05, d = 9.98987230062303e-05, m = 0.00018217786116780544
[Iteration 4250] [Rank 3] a = 0.976349949836731, b = 0.9995608822893924, delta = 0.0016606529243290424, c = 0.00012176452233643216, d = 0.0001226626436359349, m = 0.00018243016778941856
[Iteration 4260] [Rank 3] a = 1.1001580953598022, b = 0.9995211577018267, delta = 0.0017246694769710302, c = 4.231533045734167e-05, d = 4.2453502964957486e-05, m = 0.00018237092895155658
- batch.backward                 |   4308 |     0.05173s |  44.3%
- batch.evaluate                 |   4308 |     0.00276s |   2.4%
- batch.forward                  |   4308 |     0.02539s |  21.8%
- batch.mom                      |   4308 |     0.00126s |   1.1%
- batch.reduce                   |   4308 |     0.02360s |  20.2%
- batch.reporting.compr_err      |   4308 |     0.00001s |   0.0%
- batch.reporting.lr             |   4308 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   4308 |     0.00001s |   0.0%
- batch.step                     |   4308 |     0.00048s |   0.4%
- batch.update_runavg            |   4308 |     0.00129s |   1.1%
- batch.wd                       |   4308 |     0.00001s |   0.0%
- epoch_metrics.collect          |     30 |     0.01165s |   0.1%
- reduce.combine                 |   4308 |     0.00552s |   4.7%
- reduce.flatpack                |   4308 |     0.00002s |   0.0%
- reduce.flatput                 |   4308 |     0.00020s |   0.2%
[Iteration 4270] [Rank 3] a = 0.9327515363693237, b = 0.9996659797371956, delta = 0.001573955756612122, c = 0.00033195944954698243, d = 0.00033506833096833813, m = 0.0001823221015664616
[Iteration 4280] [Rank 3] a = 1.0443092584609985, b = 0.9995352340229063, delta = 0.0016720147104933858, c = 7.046797888406287e-05, d = 7.088249640691029e-05, m = 0.00018215482434188953
[Iteration 4290] [Rank 3] a = 1.0188302993774414, b = 0.9995263391696869, delta = 0.0017262216424569488, c = 5.267826852852739e-05, d = 5.302369979756691e-05, m = 0.00018229374083349095
[Iteration 4300] [Rank 3] a = 1.0293110609054565, b = 0.9995354240100632, delta = 0.0016672302735969424, c = 7.084795328000635e-05, d = 7.126247080285377e-05, m = 0.00018223227802892722
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4308 |     0.10843s |  92.9%
- batch.accumulate               |   4308 |     0.00082s |   0.7%
- reduce.gather.context          |   4308 |     0.00155s |   1.3%
- reduce.gather.tensors          |   4308 |     0.00228s |   2.0%
- reduce.heur_params             |   4308 |     0.01069s |   9.2%
- batch.backward                 |   4308 |     0.05171s |  44.3%
- batch.evaluate                 |   4308 |     0.00277s |   2.4%
- batch.forward                  |   4308 |     0.02538s |  21.7%
- batch.mom                      |   4308 |     0.00126s |   1.1%
- batch.reduce                   |   4308 |     0.02370s |  20.3%
- batch.reporting.compr_err      |   4308 |     0.00001s |   0.0%
- batch.reporting.lr             |   4308 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   4308 |     0.00001s |   0.0%
- batch.step                     |   4308 |     0.00047s |   0.4%
- batch.update_runavg            |   4308 |     0.00129s |   1.1%
- batch.wd                       |   4308 |     0.00001s |   0.0%
- epoch_metrics.collect          |     30 |     0.01117s |   0.1%
- reduce.combine                 |   4308 |     0.00551s |   4.7%
- reduce.flatpack                |   4308 |     0.00002s |   0.0%
- reduce.flatput                 |   4308 |     0.00013s |   0.1%
- reduce.heur_params.alpha       |   4307 |     0.00822s |   7.0%
- reduce.heur_params.beta        |   4307 |     0.00239s |   2.1%
- reduce.memory                  |   4308 |     0.00045s |   0.4%
- reduce.pad                     |   4308 |     0.00015s |   0.1%
- reduce.threshold               |   4308 |     0.00253s |   2.2%
- test.last                      |     30 |     0.41620s |   2.6%
- test.runavg                    |     30 |     0.44718s |   2.8%
-----------------------------------------------------------------

[Iteration 4310] [Rank 1] a = 0.9769490361213684, b = 0.9997520957452236, delta = 0.0006274094339460135, c = 0.000504191480290089, d = 0.0005055732053662472, m = 0.0003466463521740856
[Iteration 4320] [Rank 1] a = 0.9896525740623474, b = 0.9998846204470241, delta = 0.0005657315487042069, c = 0.0007692408930241157, d = 0.0007705535318464658, m = 0.0003481161917362562
- reduce.gather.context          |   4308 |     0.00280s |   2.4%
- reduce.gather.tensors          |   4308 |     0.00204s |   1.7%
- reduce.heur_params             |   4308 |     0.01019s |   8.7%
[Iteration 4330] [Rank 1] a = 0.9951274394989014, b = 1.0000342612722466, delta = 0.000585851026698947, c = 0.0010685225445199592, d = 0.0010682116563778235, m = 0.0003491678447779751
[Iteration 4340] [Rank 1] a = 0.9364345669746399, b = 1.0002304144143064, delta = 0.000551240227650851, c = 0.0014608288367681465, d = 0.0014543692720371073, m = 0.00035040317962153086
[Iteration 4350] [Rank 1] a = 0.9424647092819214, b = 1.0000880103774954, delta = 0.0005707117379643023, c = 0.001176020755445059, d = 0.0011747426597496127, m = 0.00035160880434281387
[Iteration 4360] [Rank 1] a = 1.036133050918579, b = 0.9997080532616369, delta = 0.0006061022286303341, c = 0.0004161065066850104, d = 0.00041690099860380137, m = 0.0003525559850062042
[Iteration 4370] [Rank 1] a = 0.9772898554801941, b = 1.0006096115184564, delta = 0.0005327395047061145, c = 0.002219223187944421, d = 0.002176596969344944, m = 0.00035437674558525835
- reduce.heur_params.alpha       |   4307 |     0.00808s |   6.9%
- reduce.heur_params.beta        |   4307 |     0.00203s |   1.7%
- reduce.memory                  |   4308 |     0.00042s |   0.4%
- reduce.pad                     |   4308 |     0.00027s |   0.2%
- reduce.threshold               |   4308 |     0.00213s |   1.8%
- test.last                      |     30 |     0.41620s |   2.6%
- test.runavg                    |     30 |     0.44718s |   2.8%
-----------------------------------------------------------------

[Iteration 4310] [Rank 3] a = 0.9789633750915527, b = 0.9996069800842574, delta = 0.001493062824010849, c = 0.0002139601280430811, d = 0.00021603271565731822, m = 0.00018302605678168578
[Iteration 4320] [Rank 3] a = 0.9437509179115295, b = 0.9996011595682868, delta = 0.0014548287726938725, c = 0.00020231909427644913, d = 0.00020363173309879932, m = 0.00018450355451961158
[Iteration 4380] [Rank 1] a = 0.9646003246307373, b = 0.9999462281133972, delta = 0.00056884327204898, c = 0.0008924562266905138, d = 0.0008930434598478811, m = 0.0003552296662882497
[Iteration 4390] [Rank 1] a = 1.0655479431152344, b = 0.9997147546276981, delta = 0.000613402749877423, c = 0.00042950923992374397, d = 0.000430234645588727, m = 0.00035614682863663587
[Iteration 4400] [Rank 1] a = 0.9533442854881287, b = 0.9998406125041861, delta = 0.0006014842656441033, c = 0.000681225005672845, d = 0.0006824685582413873, m = 0.0003572837136498634
[Iteration 4410] [Rank 1] a = 0.9627556800842285, b = 0.9997704036014384, delta = 0.0005739700281992555, c = 0.0005408071948082786, d = 0.0005418434886153971, m = 0.00035970011773789215
[Iteration 4420] [Rank 1] a = 1.0212510824203491, b = 0.9997857234774654, delta = 0.0005639504524879158, c = 0.0005714469483720843, d = 0.0005723105265446831, m = 0.00036059157626494706

[Iteration 4170] [Rank 2] a = 1.0981824398040771, b = 0.9995511238579659, delta = 0.001591185457073152, c = 0.00010224765563569906, d = 0.00010266217315854649, m = 0.00015977616511050639
[Iteration 4180] [Rank 2] a = 0.975159227848053, b = 0.9995269782173913, delta = 0.001719660242088139, c = 5.395636422397363e-05, d = 5.4370881746821055e-05, m = 0.00015962491304556494
[Iteration 4190] [Rank 2] a = 0.9649892449378967, b = 0.9995820917654161, delta = 0.0015184053918346763, c = 0.0001641834821744857, d = 0.00016553066412373983, m = 0.00015975188994293033
[Iteration 4200] [Rank 2] a = 1.2743855714797974, b = 0.9995133509569657, delta = 0.001750984345562756, c = 2.6701837096755195e-05, d = 2.67709233505631e-05, m = 0.00016018497339556758
[Iteration 4210] [Rank 2] a = 1.0843397378921509, b = 0.9995161144064673, delta = 0.0016742710722610354, c = 3.2228737401387575e-05, d = 3.226328052829153e-05, m = 0.00016007633637757788
[Iteration 4330] [Rank 3] a = 0.9751992225646973, b = 0.9996602283072189, delta = 0.00138030422385782, c = 0.0003204565882879663, d = 0.00032332366782099434, m = 0.00018469238504872164
[Iteration 4340] [Rank 3] a = 0.9391008615493774, b = 0.999709521344406, delta = 0.0013949504354968667, c = 0.0004190426724718464, d = 0.00042184066575106657, m = 0.0001847003091376603
[Iteration 4350] [Rank 3] a = 0.9710506796836853, b = 0.9995656837831164, delta = 0.0014699986204504967, c = 0.00013136751161573092, d = 0.0001321965466614258, m = 0.0001848094126895086
[Iteration 4360] [Rank 3] a = 1.1629241704940796, b = 0.9995179970064442, delta = 0.0015428531914949417, c = 3.5993938233918386e-05, d = 3.623574012224605e-05, m = 0.00018630054889098605
[Iteration 4370] [Rank 3] a = 1.1475677490234375, b = 0.9995244220265758, delta = 0.0014174598036333919, c = 4.8843981442188675e-05, d = 4.905124020361239e-05, m = 0.00018709265621816773
[Iteration 4430] [Rank 1] a = 1.026900291442871, b = 0.9997804729224231, delta = 0.0005823315004818141, c = 0.0005609458377932829, d = 0.0005616021572044579, m = 0.00036219616878043197
[Iteration 4440] [Rank 1] a = 1.0131547451019287, b = 0.9997461197846452, delta = 0.0006087509100325406, c = 0.0004922395583813215, d = 0.0004935867403305757, m = 0.00036278759188214897
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4447 |     0.10850s |  92.8%
- batch.accumulate               |   4447 |     0.00083s |   0.7%
- batch.backward                 |   4447 |     0.05173s |  44.3%
- batch.evaluate                 |   4447 |     0.00276s |   2.4%
- batch.forward                  |   4447 |     0.02539s |  21.7%
- batch.mom                      |   4447 |     0.00126s |   1.1%
- batch.reduce                   |   4447 |     0.02376s |  20.3%
[Iteration 4380] [Rank 3] a = 0.9233196377754211, b = 0.9997949637635061, delta = 0.001295076566748321, c = 0.0005899275212656989, d = 0.0005923109970220715, m = 0.00018705726902886054
[Iteration 4390] [Rank 3] a = 0.9111927151679993, b = 0.999785844378404, delta = 0.0012598293833434582, c = 0.000571688750260412, d = 0.0005742794847782084, m = 0.00018746001147925044
[Iteration 4400] [Rank 3] a = 0.9522193074226379, b = 0.9999389740567712, delta = 0.0012547509977594018, c = 0.0008779481133908538, d = 0.0008798479853705713, m = 0.0001876052684539477
[Iteration 4410] [Rank 3] a = 1.0270308256149292, b = 0.9995432998413262, delta = 0.0014017359353601933, c = 8.659961914820863e-05, d = 8.68414210365363e-05, m = 0.00018765915097352157
[Iteration 4420] [Rank 3] a = 1.0775221586227417, b = 0.9995274445495005, delta = 0.0013614199124276638, c = 5.488902865038034e-05, d = 5.5096287411804055e-05, m = 0.0001903763687622454
- batch.reporting.compr_err      |   4447 |     0.00001s |   0.0%
- batch.reporting.lr             |   4447 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   4447 |     0.00001s |   0.0%
- batch.step                     |   4447 |     0.00048s |   0.4%
- batch.update_runavg            |   4447 |     0.00129s |   1.1%
[Iteration 4220] [Rank 2] a = 0.9758986234664917, b = 0.9996401242098217, delta = 0.001492841518484056, c = 0.0002802483885717657, d = 0.0002827009505819463, m = 0.00016004988679073275
[Iteration 4230] [Rank 2] a = 1.0102345943450928, b = 0.999538861050454, delta = 0.0016553291352465749, c = 7.772203553389287e-05, d = 7.810200992983635e-05, m = 0.0001599175407126946
[Iteration 4240] [Rank 2] a = 0.9723280072212219, b = 0.9996010732104832, delta = 0.0015733614563941956, c = 0.00020214637864192936, d = 0.0002039426212409349, m = 0.00015982608785346654
[Iteration 4250] [Rank 2] a = 1.0567327737808228, b = 0.999524370211897, delta = 0.0016761492006480694, c = 4.874035206147682e-05, d = 4.929304209194006e-05, m = 0.00015969151052869611
[Iteration 4260] [Rank 2] a = 0.9981193542480469, b = 0.9996137678076636, delta = 0.0014999660197645426, c = 0.00022753557691633438, d = 0.00023385696913975765, m = 0.0001597688284007369
[Iteration 4430] [Rank 3] a = 0.927543044090271, b = 0.9995709170658669, delta = 0.0012669058050960302, c = 0.0001418340790676285, d = 0.00014245585535189965, m = 0.00019122972929234001
[Iteration 4440] [Rank 3] a = 1.0652878284454346, b = 0.9995596387370644, delta = 0.001221831189468503, c = 0.0001192774171993476, d = 0.00011969193472219502, m = 0.00019581718485212822
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4447 |     0.10858s |  92.9%
- batch.accumulate               |   4447 |     0.00082s |   0.7%
- batch.backward                 |   4447 |     0.05171s |  44.2%
- batch.evaluate                 |   4447 |     0.00277s |   2.4%
- batch.forward                  |   4447 |     0.02537s |  21.7%
- batch.mom                      |   4447 |     0.00126s |   1.1%
- batch.reduce                   |   4447 |     0.02385s |  20.4%
- batch.wd                       |   4447 |     0.00001s |   0.0%
- epoch_metrics.collect          |     31 |     0.01215s |   0.1%
- reduce.combine                 |   4447 |     0.00555s |   4.8%
- reduce.flatpack                |   4447 |     0.00002s |   0.0%
- reduce.flatput                 |   4447 |     0.00020s |   0.2%
- reduce.gather.context          |   4447 |     0.00160s |   1.4%
- reduce.gather.tensors          |   4447 |     0.00236s |   2.0%
- reduce.heur_params             |   4447 |     0.01069s |   9.1%
- reduce.heur_params.alpha       |   4446 |     0.00822s |   7.0%
- reduce.heur_params.beta        |   4446 |     0.00240s |   2.1%
- reduce.memory                  |   4447 |     0.00045s |   0.4%
- reduce.pad                     |   4447 |     0.00015s |   0.1%
- reduce.threshold               |   4447 |     0.00254s |   2.2%
- test.last                      |     31 |     0.41608s |   2.6%
- test.runavg                    |     31 |     0.44713s |   2.8%
[Iteration 4270] [Rank 2] a = 0.9161058068275452, b = 0.9996109352716831, delta = 0.0015647290274500847, c = 0.00022187050410408618, d = 0.00022390854859141937, m = 0.00015969547187077564
[Iteration 4280] [Rank 2] a = 1.0482654571533203, b = 0.9995326778320706, delta = 0.0016174553893506527, c = 6.535559610227792e-05, d = 6.56664842444135e-05, m = 0.00015964880313337236
[Iteration 4290] [Rank 2] a = 0.9872464537620544, b = 0.9995370648082385, delta = 0.0016566021367907524, c = 7.412955033588183e-05, d = 7.440589535111344e-05, m = 0.00015966163310519039
[Iteration 4300] [Rank 2] a = 0.9855554699897766, b = 0.9995521601515648, delta = 0.0016618878580629826, c = 0.0001043202432499362, d = 0.0001050456489149192, m = 0.00015956583471408726
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4308 |     0.10820s |  92.7%
- batch.accumulate               |   4308 |     0.00083s |   0.7%
- batch.reporting.compr_err      |   4447 |     0.00001s |   0.0%
- batch.reporting.lr             |   4447 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   4447 |     0.00001s |   0.0%
- batch.step                     |   4447 |     0.00047s |   0.4%
- batch.update_runavg            |   4447 |     0.00129s |   1.1%
-----------------------------------------------------------------
- batch.backward                 |   4308 |     0.05216s |  44.7%
- batch.evaluate                 |   4308 |     0.00275s |   2.4%
- batch.forward                  |   4308 |     0.02577s |  22.1%
- batch.mom                      |   4308 |     0.00126s |   1.1%
- batch.reduce                   |   4308 |     0.02262s |  19.4%
- batch.reporting.compr_err      |   4308 |     0.00001s |   0.0%
- batch.reporting.lr             |   4308 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   4308 |     0.00001s |   0.0%
- batch.step                     |   4308 |     0.00048s |   0.4%
- batch.update_runavg            |   4308 |     0.00130s |   1.1%
- batch.wd                       |   4308 |     0.00001s |   0.0%
- epoch_metrics.collect          |     30 |     0.01556s |   0.1%
- reduce.combine                 |   4308 |     0.00576s |   4.9%
- reduce.flatpack                |   4308 |     0.00002s |   0.0%
- reduce.flatput                 |   4308 |     0.00012s |   0.1%
- batch.wd                       |   4447 |     0.00001s |   0.0%
- epoch_metrics.collect          |     31 |     0.01144s |   0.1%
- reduce.combine                 |   4447 |     0.00555s |   4.7%
- reduce.flatpack                |   4447 |     0.00002s |   0.0%
- reduce.flatput                 |   4447 |     0.00014s |   0.1%
- reduce.gather.context          |   4447 |     0.00278s |   2.4%
- reduce.gather.tensors          |   4447 |     0.00211s |   1.8%
- reduce.heur_params             |   4447 |     0.01022s |   8.7%
- reduce.heur_params.alpha       |   4446 |     0.00809s |   6.9%
- reduce.heur_params.beta        |   4446 |     0.00205s |   1.8%
- reduce.memory                  |   4447 |     0.00042s |   0.4%
- reduce.pad                     |   4447 |     0.00027s |   0.2%
- reduce.threshold               |   4447 |     0.00215s |   1.8%
- test.last                      |     31 |     0.41608s |   2.6%
- test.runavg                    |     31 |     0.44713s |   2.8%
- reduce.gather.context          |   4308 |     0.00111s |   0.9%
- reduce.gather.tensors          |   4308 |     0.00221s |   1.9%
- reduce.heur_params             |   4308 |     0.01042s |   8.9%
-----------------------------------------------------------------
- reduce.heur_params.alpha       |   4307 |     0.00836s |   7.2%
- reduce.heur_params.beta        |   4307 |     0.00198s |   1.7%
- reduce.memory                  |   4308 |     0.00043s |   0.4%
- reduce.pad                     |   4308 |     0.00029s |   0.2%
- reduce.threshold               |   4308 |     0.00205s |   1.8%
- test.last                      |     30 |     0.41620s |   2.6%
- test.runavg                    |     30 |     0.44719s |   2.8%
-----------------------------------------------------------------

[Iteration 4310] [Rank 2] a = 0.9362841248512268, b = 0.9995587751590597, delta = 0.001692289370112121, c = 0.00011755026085414998, d = 0.00011831020964603692, m = 0.00015962699453816317
[Iteration 4320] [Rank 2] a = 1.1158342361450195, b = 0.9995115547147936, delta = 0.001856105518527329, c = 2.3109351898744148e-05, d = 2.3109351898744148e-05, m = 0.00015956724613767643
[Iteration 4330] [Rank 2] a = 1.0025633573532104, b = 0.9995532655314044, delta = 0.0016751918010413647, c = 0.00010653100337178916, d = 0.00010749821092509982, m = 0.00015942877349244854
[Iteration 4340] [Rank 2] a = 0.993913471698761, b = 0.9995533173460845, delta = 0.0016251959605142474, c = 0.00010663463275250101, d = 0.0001078781853210433, m = 0.00015946494355832715
[Iteration 4350] [Rank 2] a = 1.0503578186035156, b = 0.9995210540724696, delta = 0.0017445922130718827, c = 4.210807169591796e-05, d = 4.234987358424563e-05, m = 0.0001597312851570825
[Iteration 4360] [Rank 2] a = 0.9199324250221252, b = 0.9996073255154732, delta = 0.0015617574099451303, c = 0.00021465099058116013, d = 0.00021630906067254983, m = 0.00015971034130293448
[Iteration 4370] [Rank 2] a = 1.0567119121551514, b = 0.9995181179073604, delta = 0.0017139584524556994, c = 3.623574012224605e-05, d = 3.6373912629861865e-05, m = 0.0001598715895346259
[Iteration 4380] [Rank 2] a = 0.9313145279884338, b = 0.9996824568069798, delta = 0.0015763967530801892, c = 0.000364913592613353, d = 0.00036746978400424546, m = 0.00015976573084533355
[Iteration 4390] [Rank 2] a = 0.9101675152778625, b = 0.9997579680764446, delta = 0.001501115271821618, c = 0.0005159361434374329, d = 0.0005198049736506755, m = 0.0001598855336541701
[Iteration 4400] [Rank 2] a = 1.0513184070587158, b = 0.9995620912986015, delta = 0.0013995182234793901, c = 0.00012418254121970883, d = 0.00012483886063088391, m = 0.0001622771740747816
[Iteration 4410] [Rank 2] a = 1.0443090200424194, b = 0.9995327469183094, delta = 0.0015081356978043914, c = 6.549376860989373e-05, d = 6.590828613274115e-05, m = 0.0001622354330656109
[Iteration 4420] [Rank 2] a = 0.9499818086624146, b = 0.9995490167276513, delta = 0.001450242823921144, c = 9.803339415341687e-05, d = 9.855154105697616e-05, m = 0.00016396967576765465
[Iteration 4430] [Rank 2] a = 1.097281813621521, b = 0.9995382220027422, delta = 0.001440798630937934, c = 7.644393983844664e-05, d = 7.672028485367825e-05, m = 0.0001641526810247683
[Iteration 4440] [Rank 2] a = 0.9592346549034119, b = 0.9996095362752561, delta = 0.0013855010038241744, c = 0.00021907251082486603, d = 0.00022107601218529526, m = 0.00016461641854995828
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4447 |     0.10836s |  92.7%
- batch.accumulate               |   4447 |     0.00083s |   0.7%
- batch.backward                 |   4447 |     0.05216s |  44.6%
- batch.evaluate                 |   4447 |     0.00275s |   2.4%
- batch.forward                  |   4447 |     0.02576s |  22.0%
- batch.mom                      |   4447 |     0.00126s |   1.1%
- batch.reduce                   |   4447 |     0.02278s |  19.5%
- batch.reporting.compr_err      |   4447 |     0.00001s |   0.0%
- batch.reporting.lr             |   4447 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   4447 |     0.00001s |   0.0%
- batch.step                     |   4447 |     0.00048s |   0.4%
- batch.update_runavg            |   4447 |     0.00130s |   1.1%
- batch.wd                       |   4447 |     0.00001s |   0.0%
- epoch_metrics.collect          |     31 |     0.01595s |   0.1%
- reduce.combine                 |   4447 |     0.00579s |   5.0%
- reduce.flatpack                |   4447 |     0.00002s |   0.0%
- reduce.flatput                 |   4447 |     0.00012s |   0.1%
- reduce.gather.context          |   4447 |     0.00111s |   0.9%
- reduce.gather.tensors          |   4447 |     0.00229s |   2.0%
- reduce.heur_params             |   4447 |     0.01044s |   8.9%
- reduce.heur_params.alpha       |   4446 |     0.00836s |   7.2%
- reduce.heur_params.beta        |   4446 |     0.00200s |   1.7%
- reduce.memory                  |   4447 |     0.00043s |   0.4%
- reduce.pad                     |   4447 |     0.00029s |   0.2%
- reduce.threshold               |   4447 |     0.00207s |   1.8%
- test.last                      |     31 |     0.41608s |   2.6%
- test.runavg                    |     31 |     0.44714s |   2.8%
-----------------------------------------------------------------
memory_norm                    - epoch: 31.353, value:  1.247 (weight:rnn.weight_ih_l2)
memory_inf_norm                - epoch: 31.353, value:  0.004 (weight:rnn.weight_ih_l2)
memory_norm                    - epoch: 31.353, value:  1.063 (weight:rnn.weight_hh_l2)
memory_inf_norm                - epoch: 31.353, value:  0.004 (weight:rnn.weight_hh_l2)
memory_norm                    - epoch: 31.353, value:  0.063 (weight:rnn.bias_ih_l2)
memory_inf_norm                - epoch: 31.353, value:  0.004 (weight:rnn.bias_ih_l2)
memory_norm                    - epoch: 31.353, value:  0.063 (weight:rnn.bias_hh_l2)
memory_inf_norm                - epoch: 31.353, value:  0.004 (weight:rnn.bias_hh_l2)
memory_norm                    - epoch: 31.353, value:  0.295 (weight:decoder.bias)
memory_inf_norm                - epoch: 31.353, value:  0.004 (weight:decoder.bias)
memory_norm                    - epoch: 31.353, value:  7.104 (weight:entire_model)
memory_inf_norm                - epoch: 31.353, value:  0.004 (weight:entire_model)
[Iteration 4360] [Rank 0] a = 1.1246191263198853, b = 0.9995015890251083, delta = 0.004199162125587463, c = 3.1779676751636197e-06, d = 3.1779676751636197e-06, m = 8.771100326558855e-05
[Iteration 4370] [Rank 0] a = 1.2346071004867554, b = 0.999501001792097, delta = 0.0040164003148674965, c = 2.0035013604292384e-06, d = 2.0035013604292384e-06, m = 9.01230734119928e-05
[Iteration 4380] [Rank 0] a = 1.0700982809066772, b = 0.9995033679957033, delta = 0.0038060955703258514, c = 6.735909746270716e-06, d = 6.839539126982573e-06, m = 9.000418689734921e-05
[Iteration 4390] [Rank 0] a = 0.9314769506454468, b = 0.999580036449726, delta = 0.0034265643917024136, c = 0.00016007285007291536, d = 0.00016211089456024855, m = 8.990573702543688e-05
timer                          - epoch: -1.000, value:  0.000 (event:reduce.gather.context)
[Iteration 4400] [Rank 0] a = 0.9140270948410034, b = 0.9995316760816096, delta = 0.003605947131291032, c = 6.335209474184868e-05, d = 6.390478477231192e-05, m = 8.981026190569479e-05
[Iteration 4410] [Rank 0] a = 0.9980165958404541, b = 0.9995097930157433, delta = 0.003915053326636553, c = 1.9585952954541002e-05, d = 1.9758668589060766e-05, m = 8.965521754180325e-05
[Iteration 4420] [Rank 0] a = 1.0365409851074219, b = 0.9995053542250124, delta = 0.0037837824784219265, c = 1.070836934022524e-05, d = 1.0881084974745002e-05, m = 8.960140203066543e-05
[Iteration 4430] [Rank 0] a = 1.168886423110962, b = 0.9995040588580715, delta = 0.004213400650769472, c = 8.117634822428812e-06, d = 8.152177949332764e-06, m = 8.948772391555407e-05
[Iteration 4440] [Rank 0] a = 0.9453522562980652, b = 0.999537082079798, delta = 0.003599562682211399, c = 7.416409346278577e-05, d = 7.499312850848064e-05, m = 8.940539065911183e-05
cross_entropy                  - bits:5992860608.000, epoch: 32.000, ratio_transmit_grad:  0.152, value:  6.037 (split:train)
last_cross_entropy             - bits:5992860608.000, epoch: 32.000, ratio_transmit_grad:  0.152, value:  6.037 (split:train)
perplexity                     - bits:5992860608.000, epoch: 32.000, ratio_transmit_grad:  0.152, value:419.868 (split:train)
last_perplexity                - bits:5992860608.000, epoch: 32.000, ratio_transmit_grad:  0.152, value:419.868 (split:train)
last_cross_entropy             - bits:5992860608.000, epoch: 32.000, ratio_transmit_grad:  0.152, value:  5.732 (split:test)
last_perplexity                - bits:5992860608.000, epoch: 32.000, ratio_transmit_grad:  0.152, value:309.397 (split:test)
runavg_cross_entropy           - bits:5992860608.000, epoch: 32.000, ratio_transmit_grad:  0.152, value:  5.857 (split:test)
runavg_perplexity              - bits:5992860608.000, epoch: 32.000, ratio_transmit_grad:  0.152, value:350.661 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4447 |     0.10839s |  92.7%
- batch.accumulate               |   4447 |     0.00083s |   0.7%
- batch.backward                 |   4447 |     0.05178s |  44.3%
- batch.evaluate                 |   4447 |     0.00275s |   2.4%
- batch.forward                  |   4447 |     0.02551s |  21.8%
- batch.mom                      |   4447 |     0.00126s |   1.1%
- batch.reduce                   |   4447 |     0.02342s |  20.0%
- batch.reporting.compr_err      |   4447 |     0.00001s |   0.0%
- batch.reporting.lr             |   4447 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   4447 |     0.00001s |   0.0%
- batch.step                     |   4447 |     0.00048s |   0.4%
- batch.update_runavg            |   4447 |     0.00130s |   1.1%
- batch.wd                       |   4447 |     0.00001s |   0.0%
- epoch_metrics.collect          |     31 |     0.00913s |   0.1%
- reduce.combine                 |   4447 |     0.00584s |   5.0%
- reduce.flatpack                |   4447 |     0.00002s |   0.0%
- reduce.flatput                 |   4447 |     0.00011s |   0.1%
- reduce.gather.context          |   4447 |     0.00142s |   1.2%
- reduce.gather.tensors          |   4447 |     0.00234s |   2.0%
- reduce.heur_params             |   4447 |     0.01074s |   9.2%
- reduce.heur_params.alpha       |   4446 |     0.00873s |   7.5%
- reduce.heur_params.beta        |   4446 |     0.00193s |   1.7%
- reduce.memory                  |   4447 |     0.00043s |   0.4%
- reduce.pad                     |   4447 |     0.00029s |   0.3%
- reduce.threshold               |   4447 |     0.00200s |   1.7%
- test.last                      |     31 |     0.41607s |   2.6%
- test.runavg                    |     31 |     0.44715s |   2.8%
-----------------------------------------------------------------

[Iteration 4450] [Rank 0] a = 1.0665779113769531, b = 0.9995025044177441, delta = 0.0038703386671841145, c = 5.0087534010730965e-06, d = 5.077839654881001e-06, m = 8.929766940602492e-05
[Iteration 4460] [Rank 0] a = 1.0444344282150269, b = 0.9995049051644727, delta = 0.0036043289583176374, c = 9.810248040722477e-06, d = 9.913877421434335e-06, m = 8.958361566691776e-05
[Iteration 4470] [Rank 0] a = 1.0040830373764038, b = 0.999502849848928, delta = 0.00397380581125617, c = 5.699615939152144e-06, d = 5.734159066056096e-06, m = 8.951487826955555e-05
[Iteration 4480] [Rank 0] a = 1.0608859062194824, b = 0.999507824057985, delta = 0.0034802216105163097, c = 1.564803648749043e-05, d = 1.5682579614394383e-05, m = 8.950156557768552e-05
[Iteration 4490] [Rank 0] a = 1.0592433214187622, b = 0.9995034370819401, delta = 0.0038455778267234564, c = 6.874082253886525e-06, d = 6.977711634598382e-06, m = 8.93715070226834e-05
[Iteration 4500] [Rank 0] a = 1.0990980863571167, b = 0.9995033161810258, delta = 0.003707136260345578, c = 6.632280365558859e-06, d = 6.632280365558859e-06, m = 9.055085095077999e-05
[Iteration 4510] [Rank 0] a = 0.9861002564430237, b = 0.9995097930157433, delta = 0.0034498085733503103, c = 1.9585952954541002e-05, d = 1.9724125462156814e-05, m = 9.099546368708007e-05
[Iteration 4520] [Rank 0] a = 1.1731936931610107, b = 0.9995018826416141, delta = 0.0037069173995405436, c = 3.76520083253081e-06, d = 3.76520083253081e-06, m = 9.118446473601971e-05
timer                          - epoch: -1.000, value:  0.011 (event:reduce.heur_params)
[Iteration 4530] [Rank 0] a = 1.1180176734924316, b = 0.9995031261938748, delta = 0.0036279999185353518, c = 6.252305969615382e-06, d = 6.3559353503272394e-06, m = 9.10858953662961e-05
[Iteration 4540] [Rank 0] a = 1.052288293838501, b = 0.9995060105442634, delta = 0.0036018386017531157, c = 1.202100816257543e-05, d = 1.2055551289479383e-05, m = 9.11301240603034e-05
[Iteration 4550] [Rank 0] a = 0.976895272731781, b = 0.9995147844963935, delta = 0.003553379327058792, c = 2.9568916629783245e-05, d = 2.9983434152630673e-05, m = 9.10086762378e-05
[Iteration 4560] [Rank 0] a = 0.9666115045547485, b = 0.9995155444450068, delta = 0.0036250187549740076, c = 3.108881421355715e-05, d = 3.139970235569272e-05, m = 9.088701117935854e-05
[Iteration 4570] [Rank 0] a = 0.9130774736404419, b = 0.9995812800020759, delta = 0.0031606298871338367, c = 0.00016255995520999994, d = 0.0001651161466008924, m = 9.253126575208626e-05
[Iteration 4580] [Rank 0] a = 0.8718380928039551, b = 1.0008647296421853, delta = 0.0030586794018745422, c = 0.0027294597154427017, d = 0.002476120422729115, m = 9.312733510844638e-05
cross_entropy                  - bits:6390942464.000, epoch: 33.000, ratio_transmit_grad:  0.155, value:  5.999 (split:train)
last_cross_entropy             - bits:6390942464.000, epoch: 33.000, ratio_transmit_grad:  0.155, value:  5.999 (split:train)
perplexity                     - bits:6390942464.000, epoch: 33.000, ratio_transmit_grad:  0.155, value:404.113 (split:train)
last_perplexity                - bits:6390942464.000, epoch: 33.000, ratio_transmit_grad:  0.155, value:404.113 (split:train)
last_cross_entropy             - bits:6390942464.000, epoch: 33.000, ratio_transmit_grad:  0.155, value:  5.674 (split:test)
last_perplexity                - bits:6390942464.000, epoch: 33.000, ratio_transmit_grad:  0.155, value:291.856 (split:test)

[Iteration 4450] [Rank 3] a = 1.0350314378738403, b = 0.9995944409311907, delta = 0.0011250937823206186, c = 0.00018888181791081165, d = 0.00018988356859102627, m = 0.00019621972177319408
[Iteration 4460] [Rank 3] a = 1.1260409355163574, b = 0.9995422980908555, delta = 0.0011969167971983552, c = 8.45961177877794e-05, d = 8.501063531062682e-05, m = 0.00019682243953417664
[Iteration 4470] [Rank 3] a = 0.9913086891174316, b = 0.9995943718449481, delta = 0.0011646540369838476, c = 0.00018874364540319584, d = 0.00018960722357579465, m = 0.00019693638506495227
[Iteration 4480] [Rank 3] a = 0.9886379837989807, b = 0.9996471537352539, delta = 0.0011696122819557786, c = 0.0002943074412216743, d = 0.00029603459756687194, m = 0.0001970896456778459
[Iteration 4490] [Rank 3] a = 1.022788405418396, b = 0.9995556144635674, delta = 0.0011848307913169265, c = 0.00011122886863072669, d = 0.00011160884302667017, m = 0.00019899846217959468

[Iteration 4450] [Rank 1] a = 0.9383968114852905, b = 0.9998410442932614, delta = 0.0005602044984698296, c = 0.0006820885838454439, d = 0.0006832975932870821, m = 0.0003665073337946309
[Iteration 4460] [Rank 1] a = 0.9770459532737732, b = 0.999916797369415, delta = 0.0005351593135856092, c = 0.000833594738446179, d = 0.000834320144111162, m = 0.0003677836843132416
[Iteration 4470] [Rank 1] a = 0.9725660681724548, b = 1.0005604048510317, delta = 0.0005072701605968177, c = 0.002120809819395061, d = 0.002085714002460645, m = 0.0003693222412736496
[Iteration 4480] [Rank 1] a = 1.0018292665481567, b = 0.9997742724314511, delta = 0.0005697635351680219, c = 0.0005485448552347639, d = 0.0005497538646764022, m = 0.0003705489480066733
[Iteration 4490] [Rank 1] a = 1.044537901878357, b = 0.999810076380937, delta = 0.0005460642860271037, c = 0.0006201527573066572, d = 0.0006213272236213916, m = 0.0003717898054497716
[Iteration 4500] [Rank 3] a = 0.9615568518638611, b = 0.999600848680194, delta = 0.001205813605338335, c = 0.00020169731799217798, d = 0.00020287178430691236, m = 0.00019896877934492442
[Iteration 4510] [Rank 3] a = 0.9714910984039307, b = 0.9996305557649418, delta = 0.0011486879084259272, c = 0.0002611114962669761, d = 0.0002632186270081172, m = 0.0001991839628353581
[Iteration 4520] [Rank 3] a = 0.9746733903884888, b = 0.9995921265420711, delta = 0.0011560687562450767, c = 0.00018425303890568203, d = 0.00018532387583970454, m = 0.00020039003522644367
[Iteration 4530] [Rank 3] a = 0.9735140204429626, b = 0.9996234398817897, delta = 0.0010656284866854548, c = 0.0002468797279825477, d = 0.00024836508243941766, m = 0.00020350471411019944
[Iteration 4540] [Rank 3] a = 0.9230741858482361, b = 1.0013528925017192, delta = 0.0008950737537816167, c = 0.003705786654256012, d = 0.0033268140089927505, m = 0.00021008392670234018
[Iteration 4500] [Rank 1] a = 0.872005045413971, b = 1.0004240977055086, delta = 0.0005398740177042782, c = 0.0018481954618690686, d = 0.0018374180062750353, m = 0.00037265550473775073
[Iteration 4510] [Rank 1] a = 1.0010409355163574, b = 0.9999386631686302, delta = 0.0005582532612606883, c = 0.0008773263371065827, d = 0.0008779135702639499, m = 0.00037361584171720076
[Iteration 4520] [Rank 1] a = 1.0216481685638428, b = 0.9997563963642633, delta = 0.0005814186297357082, c = 0.0005127927188891732, d = 0.0005139326420770036, m = 0.00037524387478443053
[Iteration 4530] [Rank 1] a = 0.9135305881500244, b = 1.0000185096063898, delta = 0.0005605517653748393, c = 0.0010370192127835546, d = 0.0010368464971490347, m = 0.0003764205630635852
[Iteration 4540] [Rank 1] a = 0.9429187774658203, b = 1.0004417492400477, delta = 0.000527426484040916, c = 0.001883498537564908, d = 0.0018655706547017566, m = 0.0003778243544384359
runavg_cross_entropy           - bits:6390942464.000, epoch: 33.000, ratio_transmit_grad:  0.155, value:  5.805 (split:test)
runavg_perplexity              - bits:6390942464.000, epoch: 33.000, ratio_transmit_grad:  0.155, value:332.820 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4586 |     0.10855s |  92.7%
- batch.accumulate               |   4586 |     0.00083s |   0.7%
- batch.backward                 |   4586 |     0.05179s |  44.2%
- batch.evaluate                 |   4586 |     0.00275s |   2.4%
- batch.forward                  |   4586 |     0.02551s |  21.8%
- batch.mom                      |   4586 |     0.00126s |   1.1%
- batch.reduce                   |   4586 |     0.02358s |  20.1%
- batch.reporting.compr_err      |   4586 |     0.00001s |   0.0%
- batch.reporting.lr             |   4586 |     0.00001s |   0.0%
[Iteration 4550] [Rank 3] a = 0.9081849455833435, b = 0.9998584540288276, delta = 0.0009474639082327485, c = 0.0007169080557646279, d = 0.0007188770139981532, m = 0.00021027307619640037
[Iteration 4560] [Rank 3] a = 1.0587126016616821, b = 0.9995655974253154, delta = 0.0010964942630380392, c = 0.00013119479598121115, d = 0.0001316093135040586, m = 0.00021039799777877578
[Iteration 4570] [Rank 3] a = 0.9512152075767517, b = 0.9998615974533144, delta = 0.0009472714737057686, c = 0.0007231949048611472, d = 0.0007250947768408646, m = 0.00021089760892396925
[Iteration 4580] [Rank 3] a = 1.0955934524536133, b = 0.9995477731753365, delta = 0.0010926652466878295, c = 9.55462890163323e-05, d = 9.582263403156392e-05, m = 0.00021104914759653332
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4586 |     0.10872s |  92.9%
- batch.accumulate               |   4586 |     0.00082s |   0.7%
[Iteration 4550] [Rank 1] a = 1.020074725151062, b = 0.9997377948916158, delta = 0.0006253521423786879, c = 0.00047558977121361646, d = 0.00047638426313240735, m = 0.00037833300917288057
[Iteration 4560] [Rank 1] a = 1.0469937324523926, b = 0.9997814574014928, delta = 0.0005776849575340748, c = 0.0005629147960268081, d = 0.000563674744818695, m = 0.00037993513447233585
[Iteration 4570] [Rank 1] a = 1.029923915863037, b = 0.999768900975498, delta = 0.0005754452431574464, c = 0.0005378019427676347, d = 0.000538976409082369, m = 0.0003809352556021029
[Iteration 4580] [Rank 1] a = 0.856941819190979, b = 0.9999498205985854, delta = 0.0005690431571565568, c = 0.000899641197086536, d = 0.0008998484558479597, m = 0.0003820988246398927
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4586 |     0.10866s |  92.8%
- batch.accumulate               |   4586 |     0.00083s |   0.7%
- batch.reporting.memory_norm    |   4586 |     0.00001s |   0.0%
- batch.step                     |   4586 |     0.00048s |   0.4%
- batch.update_runavg            |   4586 |     0.00130s |   1.1%
- batch.wd                       |   4586 |     0.00001s |   0.0%
- epoch_metrics.collect          |     32 |     0.00956s |   0.1%
- reduce.combine                 |   4586 |     0.00587s |   5.0%
- reduce.flatpack                |   4586 |     0.00002s |   0.0%
- reduce.flatput                 |   4586 |     0.00012s |   0.1%
- reduce.gather.context          |   4586 |     0.00141s |   1.2%
- reduce.gather.tensors          |   4586 |     0.00243s |   2.1%
- reduce.heur_params             |   4586 |     0.01076s |   9.2%
- reduce.heur_params.alpha       |   4585 |     0.00873s |   7.5%
- reduce.heur_params.beta        |   4585 |     0.00195s |   1.7%
- reduce.memory                  |   4586 |     0.00043s |   0.4%
- reduce.pad                     |   4586 |     0.00029s |   0.3%
- batch.backward                 |   4586 |     0.05172s |  44.2%
- batch.evaluate                 |   4586 |     0.00277s |   2.4%
- batch.forward                  |   4586 |     0.02537s |  21.7%
- batch.mom                      |   4586 |     0.00126s |   1.1%
- batch.reduce                   |   4586 |     0.02399s |  20.5%
- batch.reporting.compr_err      |   4586 |     0.00001s |   0.0%
- batch.reporting.lr             |   4586 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   4586 |     0.00001s |   0.0%
- batch.step                     |   4586 |     0.00047s |   0.4%
- batch.update_runavg            |   4586 |     0.00129s |   1.1%
- batch.wd                       |   4586 |     0.00001s |   0.0%
- epoch_metrics.collect          |     32 |     0.01153s |   0.1%
- reduce.combine                 |   4586 |     0.00558s |   4.8%
- reduce.flatpack                |   4586 |     0.00002s |   0.0%
- reduce.flatput                 |   4586 |     0.00014s |   0.1%
- batch.backward                 |   4586 |     0.05173s |  44.2%
- batch.evaluate                 |   4586 |     0.00276s |   2.4%
- batch.forward                  |   4586 |     0.02539s |  21.7%
- batch.mom                      |   4586 |     0.00126s |   1.1%
- batch.reduce                   |   4586 |     0.02392s |  20.4%
- batch.reporting.compr_err      |   4586 |     0.00001s |   0.0%
- batch.reporting.lr             |   4586 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   4586 |     0.00001s |   0.0%
- batch.step                     |   4586 |     0.00048s |   0.4%
- batch.update_runavg            |   4586 |     0.00129s |   1.1%
- batch.wd                       |   4586 |     0.00001s |   0.0%
- epoch_metrics.collect          |     32 |     0.01180s |   0.1%
- reduce.combine                 |   4586 |     0.00558s |   4.8%
- reduce.flatpack                |   4586 |     0.00002s |   0.0%
- reduce.flatput                 |   4586 |     0.00020s |   0.2%
- reduce.threshold               |   4586 |     0.00202s |   1.7%
- test.last                      |     32 |     0.41615s |   2.6%
- test.runavg                    |     32 |     0.44723s |   2.8%
-----------------------------------------------------------------

[Iteration 4590] [Rank 0] a = 1.087557315826416, b = 0.9995062350745334, delta = 0.003333185100927949, c = 1.2470068812326811e-05, d = 1.2539155066134717e-05, m = 9.311135596418632e-05
[Iteration 4600] [Rank 0] a = 0.9463781118392944, b = 0.9995248365440048, delta = 0.003102970076724887, c = 4.967301648788353e-05, d = 5.0122077137634915e-05, m = 9.688461933624092e-05
[Iteration 4610] [Rank 0] a = 0.960516631603241, b = 0.9995502948230874, delta = 0.0029792902059853077, c = 0.00010058958554430935, d = 0.00010242037127021883, m = 9.685766178176517e-05
[Iteration 4620] [Rank 0] a = 1.011544108390808, b = 0.999511312912963, delta = 0.0028998618945479393, c = 2.2625748122088812e-05, d = 2.304026564493624e-05, m = 0.00010241542265519843
- reduce.gather.context          |   4586 |     0.00276s |   2.4%
- reduce.gather.tensors          |   4586 |     0.00218s |   1.9%
- reduce.heur_params             |   4586 |     0.01025s |   8.8%
- reduce.gather.context          |   4586 |     0.00164s |   1.4%
- reduce.gather.tensors          |   4586 |     0.00244s |   2.1%
- reduce.heur_params             |   4586 |     0.01070s |   9.1%
[Iteration 4630] [Rank 0] a = 0.9778926372528076, b = 0.9995194305458789, delta = 0.0027697300538420677, c = 3.8861017766946435e-05, d = 3.9206449035985956e-05, m = 0.00010461240157310076
[Iteration 4640] [Rank 0] a = 0.985487163066864, b = 0.9995207086412798, delta = 0.002801767783239484, c = 4.141720915783891e-05, d = 4.1900812934494246e-05, m = 0.00010584118285865467
[Iteration 4650] [Rank 0] a = 0.9010558724403381, b = 0.9996777934853248, delta = 0.0023562749847769737, c = 0.0003555869483492859, d = 0.00035893763165896925, m = 0.00011264522595817574
[Iteration 4660] [Rank 0] a = 1.0195196866989136, b = 0.9995413826981846, delta = 0.0022724538575857878, c = 8.276533206186992e-05, d = 8.380162586898849e-05, m = 0.0001171438807167009
[Iteration 4670] [Rank 0] a = 1.0120911598205566, b = 0.9995301907274797, delta = 0.002290798583999276, c = 6.038138582810877e-05, d = 6.1003162112379915e-05, m = 0.00011883578875737607
timer                          - epoch: -1.000, value:  0.003 (event:reduce.gather.tensors)
- reduce.heur_params.alpha       |   4585 |     0.00811s |   6.9%
- reduce.heur_params.beta        |   4585 |     0.00207s |   1.8%
- reduce.memory                  |   4586 |     0.00043s |   0.4%
- reduce.pad                     |   4586 |     0.00027s |   0.2%
- reduce.threshold               |   4586 |     0.00216s |   1.8%
- test.last                      |     32 |     0.41616s |   2.6%
- test.runavg                    |     32 |     0.44722s |   2.8%
-----------------------------------------------------------------

[Iteration 4590] [Rank 3] a = 0.9589958190917969, b = 0.9996696413082434, delta = 0.0010246572783216834, c = 0.00033928259245062035, d = 0.0003405952312729705, m = 0.00021136940857347785
[Iteration 4600] [Rank 3] a = 0.9357322454452515, b = 1.0001563539530278, delta = 0.0009074510890059173, c = 0.0013127079086039987, d = 0.0013004796416799995, m = 0.00021248922599205586
- reduce.heur_params.alpha       |   4585 |     0.00821s |   7.0%
- reduce.heur_params.beta        |   4585 |     0.00240s |   2.1%
- reduce.memory                  |   4586 |     0.00045s |   0.4%
- reduce.pad                     |   4586 |     0.00015s |   0.1%
- reduce.threshold               |   4586 |     0.00254s |   2.2%
- test.last                      |     32 |     0.41616s |   2.6%
- test.runavg                    |     32 |     0.44722s |   2.8%
-----------------------------------------------------------------

[Iteration 4590] [Rank 1] a = 1.079677700996399, b = 0.9996638035204451, delta = 0.0006384224980138242, c = 0.0003276070155570844, d = 0.00032826333496825953, m = 0.00038272160909560505
[Iteration 4600] [Rank 1] a = 1.037688970565796, b = 0.999736948585065, delta = 0.000633370247669518, c = 0.0004738971579953228, d = 0.0004745880205334018, m = 0.0003834965335868054
[Iteration 4680] [Rank 0] a = 1.0997042655944824, b = 0.9995114510854377, delta = 0.002457838971167803, c = 2.2902093137320432e-05, d = 2.3109351898744148e-05, m = 0.00011878786559951703
[Iteration 4690] [Rank 0] a = 0.8670200109481812, b = 1.0005521663178147, delta = 0.0020978839602321386, c = 0.0021043327478618753, d = 0.0019350368829056048, m = 0.00012010263048361377
[Iteration 4700] [Rank 0] a = 1.082976222038269, b = 0.9995189123990952, delta = 0.0020829434506595135, c = 3.7824723959827866e-05, d = 3.8135612101963435e-05, m = 0.00012606258819274985
[Iteration 4710] [Rank 0] a = 1.1490556001663208, b = 0.9995089985240156, delta = 0.00231154914945364, c = 1.7996969116959193e-05, d = 1.8031512243863145e-05, m = 0.00012675399875159373
[Iteration 4720] [Rank 0] a = 0.9695829153060913, b = 0.999555787179168, delta = 0.00201308517716825, c = 0.00011157429989976621, d = 0.00011292148184902035, m = 0.0001286578773283543
[Iteration 4610] [Rank 3] a = 1.0227017402648926, b = 0.9995865132848957, delta = 0.000978752039372921, c = 0.0001730265226618975, d = 0.00017385555770759237, m = 0.00021452840780399076
[Iteration 4620] [Rank 3] a = 1.0973143577575684, b = 0.9995848724866493, delta = 0.0009894398972392082, c = 0.00016974492560602202, d = 0.00017022852938267737, m = 0.00021485916879824507
[Iteration 4630] [Rank 3] a = 0.9417724609375, b = 0.9997423891271838, delta = 0.0009121072362177074, c = 0.0004847782429700678, d = 0.00048626359742693774, m = 0.00021646429961816134
[Iteration 4640] [Rank 3] a = 1.0574806928634644, b = 0.9995989142653972, delta = 0.0009595677256584167, c = 0.00019782848777893532, d = 0.00019869206595153412, m = 0.0002169593437820836
[Iteration 4650] [Rank 3] a = 0.9227234721183777, b = 1.00067384443646, delta = 0.000856118684168905, c = 0.00234768907690022, d = 0.0021943175934466715, m = 0.00021787937295110455
[Iteration 4610] [Rank 1] a = 0.9330971837043762, b = 1.000210103056673, delta = 0.0005790071445517242, c = 0.0014202061195290985, d = 0.0014157155130315846, m = 0.000384672478454784
[Iteration 4620] [Rank 1] a = 1.067413568496704, b = 0.9998110954031442, delta = 0.0005807891138829291, c = 0.0006221908017939904, d = 0.0006233307249818208, m = 0.0003862867206895276
[Iteration 4630] [Rank 1] a = 0.8676957488059998, b = 1.001534934400463, delta = 0.0005451220786198974, c = 0.00406987121182367, d = 0.00398282253202571, m = 0.00038739561865183404
[Iteration 4640] [Rank 1] a = 0.8985026478767395, b = 1.0000851778411104, delta = 0.0005955387023277581, c = 0.0011703556826328108, d = 0.001169526647587116, m = 0.0003881014834207565
[Iteration 4650] [Rank 1] a = 1.0312566757202148, b = 0.9998078828924585, delta = 0.0005904927966184914, c = 0.0006157657801898552, d = 0.0006168711602507817, m = 0.00038908122233461746
cross_entropy                  - bits:7022543744.000, epoch: 34.000, ratio_transmit_grad:  0.245, value:  5.960 (split:train)
last_cross_entropy             - bits:7022543744.000, epoch: 34.000, ratio_transmit_grad:  0.245, value:  5.960 (split:train)
perplexity                     - bits:7022543744.000, epoch: 34.000, ratio_transmit_grad:  0.245, value:388.441 (split:train)
last_perplexity                - bits:7022543744.000, epoch: 34.000, ratio_transmit_grad:  0.245, value:388.441 (split:train)
last_cross_entropy             - bits:7022543744.000, epoch: 34.000, ratio_transmit_grad:  0.245, value:  5.680 (split:test)
last_perplexity                - bits:7022543744.000, epoch: 34.000, ratio_transmit_grad:  0.245, value:293.736 (split:test)
timer                          - epoch: 33.000, value:  0.416 (event:test.last)
runavg_cross_entropy           - bits:7022543744.000, epoch: 34.000, ratio_transmit_grad:  0.245, value:  5.811 (split:test)
[Iteration 4660] [Rank 3] a = 0.9428492188453674, b = 0.9997952055653844, delta = 0.0009166107629425824, c = 0.0005904111250423542, d = 0.0005916546776108965, m = 0.00021814885829339955
[Iteration 4670] [Rank 3] a = 0.9741845726966858, b = 0.9998196102836354, delta = 0.0009133561979979277, c = 0.0006392205633576389, d = 0.000641362237225684, m = 0.00021845676165436665
[Iteration 4680] [Rank 3] a = 1.0683611631393433, b = 0.9996186556594007, delta = 0.0009700356749817729, c = 0.0002373112818301529, d = 0.0002378294287337122, m = 0.00021883192654301994
[Iteration 4690] [Rank 3] a = 1.0820039510726929, b = 0.9995888794886862, delta = 0.0009919815929606557, c = 0.000177758931047739, d = 0.00017834616420510618, m = 0.00022037432500501887
[Iteration 4700] [Rank 3] a = 0.9051568508148193, b = 0.9996996420109736, delta = 0.0009207091643474996, c = 0.00039928400388278566, d = 0.00040066572895894374, m = 0.0002208088007813682
[Iteration 4660] [Rank 1] a = 1.028323769569397, b = 0.999749245937431, delta = 0.0006146499654278159, c = 0.0004984918643509368, d = 0.0004997699600463832, m = 0.0003898410127941599
[Iteration 4670] [Rank 1] a = 0.9954290986061096, b = 0.9999975764714879, delta = 0.000588825554586947, c = 0.0009951529429759643, d = 0.0009951874861028683, m = 0.00039071912024235225
[Iteration 4680] [Rank 1] a = 0.9322994947433472, b = 1.0002117265835653, delta = 0.0005954536609351635, c = 0.00142345317345807, d = 0.0014184444200569968, m = 0.0003914241990776385
[Iteration 4690] [Rank 1] a = 1.0011221170425415, b = 0.999959026341886, delta = 0.0005753106670454144, c = 0.0009180526837263426, d = 0.0009186744600106138, m = 0.0003930176258783131
[Iteration 4700] [Rank 1] a = 1.026757836341858, b = 0.9999036018950443, delta = 0.0005534904776141047, c = 0.0008072037894915594, d = 0.0008083437126793898, m = 0.0003950716381943216
runavg_perplexity              - bits:7022543744.000, epoch: 34.000, ratio_transmit_grad:  0.245, value:335.108 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4725 |     0.10876s |  92.7%
- batch.accumulate               |   4725 |     0.00083s |   0.7%
- batch.backward                 |   4725 |     0.05179s |  44.2%
- batch.evaluate                 |   4725 |     0.00275s |   2.3%
- batch.forward                  |   4725 |     0.02551s |  21.8%
- batch.mom                      |   4725 |     0.00126s |   1.1%
- batch.reduce                   |   4725 |     0.02378s |  20.3%
- batch.reporting.compr_err      |   4725 |     0.00001s |   0.0%
- batch.reporting.lr             |   4725 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   4725 |     0.00001s |   0.0%
- batch.step                     |   4725 |     0.00048s |   0.4%

[Iteration 4450] [Rank 2] a = 0.9534879326820374, b = 0.9995594142067828, delta = 0.0014490678440779448, c = 0.00011882835654959621, d = 0.00011917378781863573, m = 0.00016625998897072374
[Iteration 4460] [Rank 2] a = 0.9384364485740662, b = 0.9995719533594838, delta = 0.0014100432163104415, c = 0.00014390666668186565, d = 0.00014439027045852097, m = 0.00016645952656061278
[Iteration 4470] [Rank 2] a = 1.0130186080932617, b = 0.9995739914035994, delta = 0.0013448870740830898, c = 0.000147982755656532, d = 0.0001490190494636506, m = 0.0001665878027880238
[Iteration 4480] [Rank 2] a = 0.9463825821876526, b = 0.9995599496251463, delta = 0.0014085110742598772, c = 0.00011989919348361873, d = 0.00012059005602169779, m = 0.00016665909349273202
[Iteration 4490] [Rank 2] a = 1.0128728151321411, b = 0.9995484640377332, delta = 0.0013875641161575913, c = 9.69280140924904e-05, d = 9.716981598081806e-05, m = 0.00016720093314616258
[Iteration 4710] [Rank 3] a = 1.0565681457519531, b = 0.9996069455411358, delta = 0.0009827115572988987, c = 0.00021389104178927318, d = 0.00021458190432735222, m = 0.00022105534203570052
[Iteration 4720] [Rank 3] a = 0.9371047616004944, b = 1.003881879778301, delta = 0.0008265634533017874, c = 0.008763798554294145, d = 0.007788611538668664, m = 0.00022326389233302672
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4725 |     0.10892s |  92.9%
- batch.accumulate               |   4725 |     0.00082s |   0.7%
- batch.backward                 |   4725 |     0.05171s |  44.1%
- batch.evaluate                 |   4725 |     0.00277s |   2.4%
- batch.forward                  |   4725 |     0.02537s |  21.6%
- batch.mom                      |   4725 |     0.00126s |   1.1%
- batch.reduce                   |   4725 |     0.02420s |  20.6%
[Iteration 4710] [Rank 1] a = 1.0160167217254639, b = 0.9997056179713995, delta = 0.0006075498531572521, c = 0.00041123592579155315, d = 0.0004120304177103441, m = 0.0003965953519553782
[Iteration 4720] [Rank 1] a = 0.9345260262489319, b = 1.0000803763465036, delta = 0.0005857145297341049, c = 0.0011607526933535121, d = 0.0011596127701656816, m = 0.00039720568712888144
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4725 |     0.10887s |  92.8%
- batch.accumulate               |   4725 |     0.00083s |   0.7%
- batch.backward                 |   4725 |     0.05173s |  44.1%
- batch.evaluate                 |   4725 |     0.00276s |   2.4%
- batch.forward                  |   4725 |     0.02539s |  21.7%
- batch.mom                      |   4725 |     0.00126s |   1.1%
- batch.reduce                   |   4725 |     0.02413s |  20.6%
- batch.update_runavg            |   4725 |     0.00130s |   1.1%
- batch.wd                       |   4725 |     0.00001s |   0.0%
- epoch_metrics.collect          |     33 |     0.00996s |   0.1%
[Iteration 4500] [Rank 2] a = 1.0453510284423828, b = 0.9995732832696266, delta = 0.0013146121054887772, c = 0.00014656648745346997, d = 0.0001473609793722609, m = 0.00016778965108617573
[Iteration 4510] [Rank 2] a = 1.1307313442230225, b = 0.9995577561370147, delta = 0.001360941561870277, c = 0.00011551221636681678, d = 0.00011582310450895235, m = 0.00016997976679775103
[Iteration 4520] [Rank 2] a = 0.9895220398902893, b = 0.9995589478746605, delta = 0.0013895800802856684, c = 0.0001178956921231895, d = 0.00011900107218411597, m = 0.0001699645162866721
[Iteration 4530] [Rank 2] a = 0.9361944794654846, b = 0.9999505460042486, delta = 0.0012168532703071833, c = 0.0009010920084165019, d = 0.0009021628453505245, m = 0.00017044646136803946
[Iteration 4540] [Rank 2] a = 0.9570717215538025, b = 0.9997047889364259, delta = 0.0012698854552581906, c = 0.00040957785570016345, d = 0.0004117195295682085, m = 0.0001704582818737321
- batch.reporting.compr_err      |   4725 |     0.00001s |   0.0%
- batch.reporting.lr             |   4725 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   4725 |     0.00001s |   0.0%
- batch.step                     |   4725 |     0.00047s |   0.4%
- batch.update_runavg            |   4725 |     0.00129s |   1.1%
- batch.reporting.compr_err      |   4725 |     0.00001s |   0.0%
- batch.reporting.lr             |   4725 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   4725 |     0.00001s |   0.0%
- batch.step                     |   4725 |     0.00048s |   0.4%
- batch.update_runavg            |   4725 |     0.00129s |   1.1%
- batch.wd                       |   4725 |     0.00001s |   0.0%
- reduce.combine                 |   4725 |     0.00590s |   5.0%
- reduce.flatpack                |   4725 |     0.00002s |   0.0%
- reduce.flatput                 |   4725 |     0.00012s |   0.1%
- reduce.gather.context          |   4725 |     0.00139s |   1.2%
- reduce.gather.tensors          |   4725 |     0.00257s |   2.2%
- reduce.heur_params             |   4725 |     0.01078s |   9.2%
- reduce.heur_params.alpha       |   4724 |     0.00873s |   7.4%
- reduce.heur_params.beta        |   4724 |     0.00197s |   1.7%
- reduce.memory                  |   4725 |     0.00043s |   0.4%
- reduce.pad                     |   4725 |     0.00029s |   0.2%
- reduce.threshold               |   4725 |     0.00204s |   1.7%
- test.last                      |     33 |     0.41614s |   2.6%
- test.runavg                    |     33 |     0.44734s |   2.8%
-----------------------------------------------------------------
[Iteration 4550] [Rank 2] a = 1.1444605588912964, b = 0.9995236793495155, delta = 0.0014927072916179895, c = 4.735862698531872e-05, d = 4.7427713239126626e-05, m = 0.00017108515490657383
[Iteration 4560] [Rank 2] a = 1.0041390657424927, b = 0.9995647165757457, delta = 0.0013478827895596623, c = 0.0001294330965091096, d = 0.00012998578653957284, m = 0.00017122093425745463
[Iteration 4570] [Rank 2] a = 0.9539298415184021, b = 0.9996467219462215, delta = 0.0013019361067563295, c = 0.0002934438630490755, d = 0.00029517101939427313, m = 0.00017137985610988604
[Iteration 4580] [Rank 2] a = 0.8434586524963379, b = 1.0000403926772634, delta = 0.0012359349057078362, c = 0.0010807853545708624, d = 0.0010797145176368397, m = 0.00017158167588407754
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4586 |     0.10852s |  92.7%
- batch.accumulate               |   4586 |     0.00083s |   0.7%
- batch.wd                       |   4725 |     0.00001s |   0.0%
- epoch_metrics.collect          |     33 |     0.01191s |   0.1%
- reduce.combine                 |   4725 |     0.00562s |   4.8%
- reduce.flatpack                |   4725 |     0.00002s |   0.0%
- reduce.flatput                 |   4725 |     0.00014s |   0.1%
- reduce.gather.context          |   4725 |     0.00276s |   2.4%
- reduce.gather.tensors          |   4725 |     0.00231s |   2.0%
- reduce.heur_params             |   4725 |     0.01027s |   8.8%
- reduce.heur_params.alpha       |   4724 |     0.00811s |   6.9%
- reduce.heur_params.beta        |   4724 |     0.00208s |   1.8%
- reduce.memory                  |   4725 |     0.00043s |   0.4%
- reduce.pad                     |   4725 |     0.00027s |   0.2%
- reduce.threshold               |   4725 |     0.00218s |   1.9%
- test.last                      |     33 |     0.41614s |   2.6%
- test.runavg                    |     33 |     0.44733s |   2.8%
- epoch_metrics.collect          |     33 |     0.01218s |   0.1%
- reduce.combine                 |   4725 |     0.00561s |   4.8%
- reduce.flatpack                |   4725 |     0.00002s |   0.0%
- reduce.flatput                 |   4725 |     0.00021s |   0.2%
- reduce.gather.context          |   4725 |     0.00168s |   1.4%
- reduce.gather.tensors          |   4725 |     0.00257s |   2.2%
- reduce.heur_params             |   4725 |     0.01070s |   9.1%
- reduce.heur_params.alpha       |   4724 |     0.00822s |   7.0%
- reduce.heur_params.beta        |   4724 |     0.00241s |   2.1%
- reduce.memory                  |   4725 |     0.00045s |   0.4%
- reduce.pad                     |   4725 |     0.00015s |   0.1%
- reduce.threshold               |   4725 |     0.00255s |   2.2%
- test.last                      |     33 |     0.41614s |   2.6%
- test.runavg                    |     33 |     0.44733s |   2.8%
-----------------------------------------------------------------
- batch.backward                 |   4586 |     0.05215s |  44.6%
- batch.evaluate                 |   4586 |     0.00275s |   2.4%
- batch.forward                  |   4586 |     0.02576s |  22.0%
- batch.mom                      |   4586 |     0.00126s |   1.1%
- batch.reduce                   |   4586 |     0.02294s |  19.6%
- batch.reporting.compr_err      |   4586 |     0.00001s |   0.0%
- batch.reporting.lr             |   4586 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   4586 |     0.00001s |   0.0%
- batch.step                     |   4586 |     0.00048s |   0.4%
- batch.update_runavg            |   4586 |     0.00130s |   1.1%
- batch.wd                       |   4586 |     0.00001s |   0.0%
- epoch_metrics.collect          |     32 |     0.01621s |   0.1%
- reduce.combine                 |   4586 |     0.00582s |   5.0%
- reduce.flatpack                |   4586 |     0.00002s |   0.0%
- reduce.flatput                 |   4586 |     0.00013s |   0.1%
-----------------------------------------------------------------
- reduce.gather.context          |   4586 |     0.00112s |   1.0%
- reduce.gather.tensors          |   4586 |     0.00237s |   2.0%
- reduce.heur_params             |   4586 |     0.01045s |   8.9%
- reduce.heur_params.alpha       |   4585 |     0.00836s |   7.1%
- reduce.heur_params.beta        |   4585 |     0.00202s |   1.7%
- reduce.memory                  |   4586 |     0.00043s |   0.4%
- reduce.pad                     |   4586 |     0.00029s |   0.2%
- reduce.threshold               |   4586 |     0.00209s |   1.8%
- test.last                      |     32 |     0.41616s |   2.6%
- test.runavg                    |     32 |     0.44722s |   2.8%
-----------------------------------------------------------------

[Iteration 4590] [Rank 2] a = 0.9922709465026855, b = 0.9995601568838676, delta = 0.0013753907987847924, c = 0.00012031371100646616, d = 0.00012100457354454521, m = 0.0001716141368926151
[Iteration 4600] [Rank 2] a = 0.9799765348434448, b = 0.9995714179411149, delta = 0.0013841805048286915, c = 0.00014283582974784312, d = 0.00014394120980876958, m = 0.00017157148447245597
[Iteration 4610] [Rank 2] a = 1.036188006401062, b = 0.9995280145109673, delta = 0.001535091083496809, c = 5.602895183821077e-05, d = 5.640892623415425e-05, m = 0.00017166945198405668
[Iteration 4620] [Rank 2] a = 0.8875248432159424, b = 0.99997042557375, delta = 0.0012426000321283937, c = 0.0009408511474829511, d = 0.0009414383806403184, m = 0.00017213397042310533
[Iteration 4630] [Rank 2] a = 1.0022964477539062, b = 0.9995565989424904, delta = 0.0013986340491101146, c = 0.00011319782686425198, d = 0.00011385414627542707, m = 0.00017206018782416622
[Iteration 4640] [Rank 2] a = 0.9599984884262085, b = 0.9996013668270151, delta = 0.0012453011004254222, c = 0.00020273361179929655, d = 0.00020383899186022305, m = 0.0001745736915270712
[Iteration 4650] [Rank 2] a = 1.0191105604171753, b = 0.9995618840398798, delta = 0.0013183739501982927, c = 0.0001237680236968614, d = 0.0001242170843466128, m = 0.00017468128029691246
[Iteration 4660] [Rank 2] a = 0.9649242758750916, b = 0.9996716793525098, delta = 0.0012434448581188917, c = 0.00034335868142528674, d = 0.00034722751163852937, m = 0.00017478099631363194
[Iteration 4670] [Rank 2] a = 1.0236624479293823, b = 0.9995668755207704, delta = 0.0012590598780661821, c = 0.00013375098737210365, d = 0.00013426913427566292, m = 0.00017581567124409835
[Iteration 4680] [Rank 2] a = 1.0950312614440918, b = 0.9995369266357603, delta = 0.0013505907263606787, c = 7.38532053206502e-05, d = 7.3991377828266e-05, m = 0.00017595958170734776
[Iteration 4690] [Rank 2] a = 1.0810234546661377, b = 0.9995500702928082, delta = 0.001317651942372322, c = 0.00010014052489455797, d = 0.00010052049929050145, m = 0.00017602971286593235
[Iteration 4700] [Rank 2] a = 0.9965503811836243, b = 0.9995778775046773, delta = 0.0013054099399596453, c = 0.00015575495920992132, d = 0.00015724031366679128, m = 0.00017601548410216993
[Iteration 4710] [Rank 2] a = 1.0677030086517334, b = 0.999559034232461, delta = 0.0012585968943312764, c = 0.00011806840775770925, d = 0.00011872472716888435, m = 0.00017649745799476596
[Iteration 4720] [Rank 2] a = 0.9070736169815063, b = 0.9997018354993358, delta = 0.001243183622136712, c = 0.00040367098099958757, d = 0.0004053981373447852, m = 0.0001765459997429317
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4725 |     0.10872s |  92.7%
- batch.accumulate               |   4725 |     0.00083s |   0.7%
- batch.backward                 |   4725 |     0.05215s |  44.5%
- batch.evaluate                 |   4725 |     0.00275s |   2.3%
- batch.forward                  |   4725 |     0.02576s |  22.0%
- batch.mom                      |   4725 |     0.00126s |   1.1%
- batch.reduce                   |   4725 |     0.02315s |  19.7%
- batch.reporting.compr_err      |   4725 |     0.00001s |   0.0%
- batch.reporting.lr             |   4725 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   4725 |     0.00001s |   0.0%
- batch.step                     |   4725 |     0.00048s |   0.4%
- batch.update_runavg            |   4725 |     0.00130s |   1.1%
- batch.wd                       |   4725 |     0.00001s |   0.0%
- epoch_metrics.collect          |     33 |     0.01574s |   0.1%
- reduce.combine                 |   4725 |     0.00585s |   5.0%
- reduce.flatpack                |   4725 |     0.00002s |   0.0%
- reduce.flatput                 |   4725 |     0.00013s |   0.1%
- reduce.gather.context          |   4725 |     0.00111s |   1.0%
- reduce.gather.tensors          |   4725 |     0.00251s |   2.1%
- reduce.heur_params             |   4725 |     0.01047s |   8.9%
- reduce.heur_params.alpha       |   4724 |     0.00836s |   7.1%
- reduce.heur_params.beta        |   4724 |     0.00203s |   1.7%
- reduce.memory                  |   4725 |     0.00043s |   0.4%
- reduce.pad                     |   4725 |     0.00029s |   0.2%
- reduce.threshold               |   4725 |     0.00211s |   1.8%
- test.last                      |     33 |     0.41615s |   2.6%
- test.runavg                    |     33 |     0.44733s |   2.8%
-----------------------------------------------------------------

[Iteration 4730] [Rank 0] a = 1.1438149213790894, b = 0.999514214534934, delta = 0.0020332420244812965, c = 2.8428993441952816e-05, d = 2.8601709076472576e-05, m = 0.00013151069291325525
[Iteration 4740] [Rank 0] a = 1.0436655282974243, b = 0.9995201041366982, delta = 0.002113827271386981, c = 4.020819971620058e-05, d = 4.038091535072034e-05, m = 0.00013147691882804704
[Iteration 4750] [Rank 0] a = 0.9690625667572021, b = 0.9995587751590597, delta = 0.0018598599126562476, c = 0.00011755026085414998, d = 0.0001186210977881725, m = 0.0001317802478154695
[Iteration 4760] [Rank 0] a = 1.0699087381362915, b = 0.9995167016394872, delta = 0.002076047472655773, c = 3.340320371612196e-05, d = 3.357591935064172e-05, m = 0.00013268948818316126
[Iteration 4770] [Rank 0] a = 0.992474377155304, b = 0.9995561498819289, delta = 0.0019234840292483568, c = 0.00011229970556474921, d = 0.00011375051689471521, m = 0.00013263431979601423
[Iteration 4780] [Rank 0] a = 0.9265387654304504, b = 0.9995593278489825, delta = 0.0017619166756048799, c = 0.00011865564091507644, d = 0.0001192774171993476, m = 0.000136176780445832
rel_compression_error          - epoch: 34.439, value:  0.980 (weight:encoder.weight)
rel_compression_error          - epoch: 34.439, value:  0.980 (weight:rnn.weight_ih_l0)
rel_compression_error          - epoch: 34.439, value:  0.978 (weight:rnn.weight_hh_l0)
rel_compression_error          - epoch: 34.439, value:  0.962 (weight:rnn.bias_ih_l0)
rel_compression_error          - epoch: 34.439, value:  0.962 (weight:rnn.bias_hh_l0)
rel_compression_error          - epoch: 34.439, value:  0.977 (weight:rnn.weight_ih_l1)
rel_compression_error          - epoch: 34.439, value:  0.981 (weight:rnn.weight_hh_l1)
rel_compression_error          - epoch: 34.439, value:  0.961 (weight:rnn.bias_ih_l1)
rel_compression_error          - epoch: 34.439, value:  0.961 (weight:rnn.bias_hh_l1)
rel_compression_error          - epoch: 34.439, value:  0.971 (weight:rnn.weight_ih_l2)
rel_compression_error          - epoch: 34.439, value:  0.976 (weight:rnn.weight_hh_l2)
rel_compression_error          - epoch: 34.439, value:  0.890 (weight:rnn.bias_ih_l2)
rel_compression_error          - epoch: 34.439, value:  0.890 (weight:rnn.bias_hh_l2)
rel_compression_error          - epoch: 34.439, value:  0.860 (weight:decoder.bias)
rel_compression_error          - epoch: 34.439, value:  0.980 (weight:entire_model)
[Iteration 4790] [Rank 0] a = 1.0612425804138184, b = 0.9995223667109916, delta = 0.0018422742141410708, c = 4.473334934061834e-05, d = 4.497515122894601e-05, m = 0.0001368043085062707
[Iteration 4800] [Rank 0] a = 0.928806722164154, b = 0.9995802091653302, delta = 0.0017281346954405308, c = 0.0001604182813419549, d = 0.00016107460075312998, m = 0.0001378487332540772
[Iteration 4810] [Rank 0] a = 1.000145673751831, b = 0.999530708874269, delta = 0.0017862097593024373, c = 6.141767963522734e-05, d = 6.183219715807478e-05, m = 0.00013828338882736194
timer                          - epoch: 34.626, value:  0.001 (event:batch.mom)
[Iteration 4820] [Rank 0] a = 1.1112868785858154, b = 0.9995155271734475, delta = 0.001868312363512814, c = 3.10542710866532e-05, d = 3.11233573404611e-05, m = 0.00013832776181073916
memory_norm                    - epoch: 34.734, value:  2.780 (weight:encoder.weight)
memory_inf_norm                - epoch: 34.734, value:  0.002 (weight:encoder.weight)
memory_norm                    - epoch: 34.734, value:  0.826 (weight:rnn.weight_ih_l0)
memory_inf_norm                - epoch: 34.734, value:  0.002 (weight:rnn.weight_ih_l0)
memory_norm                    - epoch: 34.734, value:  0.704 (weight:rnn.weight_hh_l0)
memory_inf_norm                - epoch: 34.734, value:  0.002 (weight:rnn.weight_hh_l0)
memory_norm                    - epoch: 34.734, value:  0.032 (weight:rnn.bias_ih_l0)
memory_inf_norm                - epoch: 34.734, value:  0.002 (weight:rnn.bias_ih_l0)
memory_norm                    - epoch: 34.734, value:  0.032 (weight:rnn.bias_hh_l0)
memory_inf_norm                - epoch: 34.734, value:  0.002 (weight:rnn.bias_hh_l0)
memory_norm                    - epoch: 34.734, value:  0.584 (weight:rnn.weight_ih_l1)
memory_inf_norm                - epoch: 34.734, value:  0.002 (weight:rnn.weight_ih_l1)
memory_norm                    - epoch: 34.734, value:  0.442 (weight:rnn.weight_hh_l1)
memory_inf_norm                - epoch: 34.734, value:  0.002 (weight:rnn.weight_hh_l1)
memory_norm                    - epoch: 34.734, value:  0.028 (weight:rnn.bias_ih_l1)
memory_inf_norm                - epoch: 34.734, value:  0.002 (weight:rnn.bias_ih_l1)
memory_norm                    - epoch: 34.734, value:  0.028 (weight:rnn.bias_hh_l1)
memory_inf_norm                - epoch: 34.734, value:  0.002 (weight:rnn.bias_hh_l1)
memory_norm                    - epoch: 34.734, value:  0.510 (weight:rnn.weight_ih_l2)
memory_inf_norm                - epoch: 34.734, value:  0.002 (weight:rnn.weight_ih_l2)
memory_norm                    - epoch: 34.734, value:  0.397 (weight:rnn.weight_hh_l2)
memory_inf_norm                - epoch: 34.734, value:  0.002 (weight:rnn.weight_hh_l2)
memory_norm                    - epoch: 34.734, value:  0.033 (weight:rnn.bias_ih_l2)
memory_inf_norm                - epoch: 34.734, value:  0.002 (weight:rnn.bias_ih_l2)
memory_norm                    - epoch: 34.734, value:  0.033 (weight:rnn.bias_hh_l2)
memory_inf_norm                - epoch: 34.734, value:  0.002 (weight:rnn.bias_hh_l2)
memory_norm                    - epoch: 34.734, value:  0.129 (weight:decoder.bias)
memory_inf_norm                - epoch: 34.734, value:  0.002 (weight:decoder.bias)
memory_norm                    - epoch: 34.734, value:  3.144 (weight:entire_model)
memory_inf_norm                - epoch: 34.734, value:  0.002 (weight:entire_model)
[Iteration 4830] [Rank 0] a = 1.0292879343032837, b = 0.9995673763960166, delta = 0.0016156883211806417, c = 0.00013475273805231826, d = 0.00013585811811324473, m = 0.00013998683333796576
[Iteration 4840] [Rank 0] a = 1.0446323156356812, b = 0.9995312961072973, delta = 0.0017993667861446738, c = 6.259214594996172e-05, d = 6.286849096519334e-05, m = 0.00013988675577745655
[Iteration 4850] [Rank 0] a = 0.8836556077003479, b = 0.9996191392631071, delta = 0.0017128514591604471, c = 0.00023827848938346357, d = 0.00023972930071342958, m = 0.0001398818262918887
[Iteration 4860] [Rank 0] a = 1.1334041357040405, b = 0.9995174270449829, delta = 0.0018902471056208014, c = 3.485401504608796e-05, d = 3.4957644426799816e-05, m = 0.00014190745034623045
cross_entropy                  - bits:7604629952.000, epoch: 35.000, ratio_transmit_grad:  0.226, value:  5.928 (split:train)
last_cross_entropy             - bits:7604629952.000, epoch: 35.000, ratio_transmit_grad:  0.226, value:  5.928 (split:train)
perplexity                     - bits:7604629952.000, epoch: 35.000, ratio_transmit_grad:  0.226, value:376.402 (split:train)
last_perplexity                - bits:7604629952.000, epoch: 35.000, ratio_transmit_grad:  0.226, value:376.402 (split:train)
last_cross_entropy             - bits:7604629952.000, epoch: 35.000, ratio_transmit_grad:  0.226, value:  5.633 (split:test)
last_perplexity                - bits:7604629952.000, epoch: 35.000, ratio_transmit_grad:  0.226, value:280.215 (split:test)
runavg_cross_entropy           - bits:7604629952.000, epoch: 35.000, ratio_transmit_grad:  0.226, value:  5.772 (split:test)
runavg_perplexity              - bits:7604629952.000, epoch: 35.000, ratio_transmit_grad:  0.226, value:322.097 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4864 |     0.10891s |  92.7%
- batch.accumulate               |   4864 |     0.00083s |   0.7%
- batch.backward                 |   4864 |     0.05178s |  44.1%
- batch.evaluate                 |   4864 |     0.00275s |   2.3%
- batch.forward                  |   4864 |     0.02551s |  21.7%
- batch.mom                      |   4864 |     0.00126s |   1.1%
- batch.reduce                   |   4864 |     0.02394s |  20.4%
- batch.reporting.compr_err      |   4864 |     0.00001s |   0.0%
- batch.reporting.lr             |   4864 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   4864 |     0.00001s |   0.0%
- batch.step                     |   4864 |     0.00048s |   0.4%
- batch.update_runavg            |   4864 |     0.00130s |   1.1%
- batch.wd                       |   4864 |     0.00001s |   0.0%
- epoch_metrics.collect          |     34 |     0.00976s |   0.1%
- reduce.combine                 |   4864 |     0.00594s |   5.1%
- reduce.flatpack                |   4864 |     0.00002s |   0.0%
- reduce.flatput                 |   4864 |     0.00013s |   0.1%
- reduce.gather.context          |   4864 |     0.00139s |   1.2%
- reduce.gather.tensors          |   4864 |     0.00266s |   2.3%
- reduce.heur_params             |   4864 |     0.01080s |   9.2%
- reduce.heur_params.alpha       |   4863 |     0.00873s |   7.4%
- reduce.heur_params.beta        |   4863 |     0.00199s |   1.7%
- reduce.memory                  |   4864 |     0.00044s |   0.4%
- reduce.pad                     |   4864 |     0.00029s |   0.2%
- reduce.threshold               |   4864 |     0.00206s |   1.8%
- test.last                      |     34 |     0.41604s |   2.6%
- test.runavg                    |     34 |     0.44712s |   2.8%
-----------------------------------------------------------------

[Iteration 4730] [Rank 3] a = 0.9206753373146057, b = 0.9998523398954935, delta = 0.0008849481237120926, c = 0.0007046797888406287, d = 0.0007062342295513066, m = 0.0002235440386517819
[Iteration 4740] [Rank 3] a = 0.9296352863311768, b = 1.0038185977079626, delta = 0.0007978370995260775, c = 0.008637232537318063, d = 0.007636863582179601, m = 0.00022639821112937814
[Iteration 4750] [Rank 3] a = 0.9848393201828003, b = 0.99989185723202, delta = 0.0008188577485270798, c = 0.0007837144631968717, d = 0.0007861324820801484, m = 0.00022688254386452817
[Iteration 4760] [Rank 3] a = 0.9534025192260742, b = 0.9997900413681342, delta = 0.0008535783272236586, c = 0.0005800827300980724, d = 0.0005821898608392135, m = 0.0002272636504611291
[Iteration 4770] [Rank 3] a = 0.9858608841896057, b = 0.9998792489908653, delta = 0.0008081609266810119, c = 0.0007584979805569865, d = 0.0007615377757245344, m = 0.00022956255109533912
[Iteration 4780] [Rank 3] a = 1.0107208490371704, b = 0.9996673960052413, delta = 0.0008563623414374888, c = 0.0003347919859531065, d = 0.0003359664522678409, m = 0.00022996535823646537
[Iteration 4790] [Rank 3] a = 1.0822056531906128, b = 0.9995770484697795, delta = 0.0009298745426349342, c = 0.0001540968891185316, d = 0.0001547532085297067, m = 0.0002309623257632412
[Iteration 4800] [Rank 3] a = 0.9589377045631409, b = 0.9997150827873772, delta = 0.0008473115740343928, c = 0.0004301655593349191, d = 0.0004312363962689416, m = 0.00023188088787027438
[Iteration 4810] [Rank 3] a = 1.017922282218933, b = 0.9996530260661087, delta = 0.0008408084977418184, c = 0.00030605210436901816, d = 0.00030712294130304067, m = 0.0002325387729737735
[Iteration 4820] [Rank 3] a = 0.9937306642532349, b = 0.9996527669926882, delta = 0.0008089959155768156, c = 0.00030553395746545884, d = 0.000306915682541617, m = 0.00023629838219630582

[Iteration 4730] [Rank 1] a = 0.9138402938842773, b = 1.0027195854382371, delta = 0.0005225794739089906, c = 0.006439184286165764, d = 0.006064322273004073, m = 0.0003992254536112478
[Iteration 4740] [Rank 1] a = 1.053788661956787, b = 0.9997449280468444, delta = 0.000600918720010668, c = 0.0004898560826249488, d = 0.0004904778589092199, m = 0.00040003058278691227
[Iteration 4750] [Rank 1] a = 0.9249564409255981, b = 1.000081568084374, delta = 0.0005704616196453571, c = 0.0011631361691098847, d = 0.0011620653321758622, m = 0.0004010199432415166
[Iteration 4760] [Rank 1] a = 0.9548048973083496, b = 1.0001958712889751, delta = 0.0005685322103090584, c = 0.0013917425829602416, d = 0.001385732078878954, m = 0.000401854843997311
[Iteration 4770] [Rank 1] a = 1.0048408508300781, b = 0.9998633936958793, delta = 0.0005876271752640605, c = 0.0007267873900591583, d = 0.0007285145464043559, m = 0.00040256577470412807

[Iteration 4730] [Rank 2] a = 0.9089385867118835, b = 0.9998162768719999, delta = 0.0011935491347685456, c = 0.0006325537398651761, d = 0.0006344190687179895, m = 0.0001782980403941943
[Iteration 4740] [Rank 2] a = 1.0540927648544312, b = 0.9995529546433244, delta = 0.0012811876367777586, c = 0.00010590922708751801, d = 0.0001063582877372694, m = 0.00017912991649743509
[Iteration 4750] [Rank 2] a = 0.9599320292472839, b = 0.9996538205579321, delta = 0.0011833509197458625, c = 0.00030764108820659995, d = 0.0003100245639629727, m = 0.00017936251446410914
[Iteration 4760] [Rank 2] a = 1.0597776174545288, b = 0.9995846997710448, delta = 0.0011347024701535702, c = 0.00016939949433698252, d = 0.00017026307250958133, m = 0.00018222785830492746
[Iteration 4770] [Rank 2] a = 0.9169366359710693, b = 0.9998109917737671, delta = 0.001139811472967267, c = 0.0006219835430325667, d = 0.000624677906931075, m = 0.00018228563732113697
[Iteration 4830] [Rank 3] a = 0.998202919960022, b = 0.9997256184402588, delta = 0.0008105316665023565, c = 0.00045123686674633, d = 0.00045410394627935807, m = 0.00023662538875454515
[Iteration 4840] [Rank 3] a = 0.9506852030754089, b = 0.9998056548608565, delta = 0.0007586292922496796, c = 0.0006113097168192454, d = 0.0006128641575299232, m = 0.00023824082089205157
[Iteration 4850] [Rank 3] a = 1.0307433605194092, b = 0.9997290382095679, delta = 0.0007569459266960621, c = 0.0004580764058733126, d = 0.0004591126996804312, m = 0.00023960608906123032
[Iteration 4860] [Rank 3] a = 0.9961370825767517, b = 0.9998514763173398, delta = 0.0007469374686479568, c = 0.0007029526324954311, d = 0.0007060960570436908, m = 0.00024018902773501467
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4864 |     0.10907s |  92.9%
- batch.accumulate               |   4864 |     0.00082s |   0.7%
[Iteration 4780] [Rank 1] a = 0.934067964553833, b = 1.0000714814913771, delta = 0.0005786759429611266, c = 0.0011429629829979766, d = 0.0011417194304294343, m = 0.0004034846388565248
[Iteration 4790] [Rank 1] a = 0.9714964032173157, b = 0.9998273479438208, delta = 0.0006174722220748663, c = 0.0006546958842106096, d = 0.0006557321780177282, m = 0.000404227831202086
[Iteration 4800] [Rank 1] a = 0.9944614768028259, b = 0.9998610793064207, delta = 0.0006053459946997464, c = 0.0007221586110540286, d = 0.0007242657417951696, m = 0.000405362090465845
[Iteration 4810] [Rank 1] a = 1.0246120691299438, b = 0.9998836705110469, delta = 0.0005619361763820052, c = 0.0007673410210443983, d = 0.0007683773148515169, m = 0.00040706402648942703
[Iteration 4820] [Rank 1] a = 1.0869171619415283, b = 0.9996733028793001, delta = 0.0006439199205487967, c = 0.00034660573535425827, d = 0.0003473656841461452, m = 0.00040767019521620475
[Iteration 4780] [Rank 2] a = 0.9451836347579956, b = 0.9996057192603208, delta = 0.0011456741485744715, c = 0.00021143847977909256, d = 0.0002121293423171716, m = 0.00018417474789477828
[Iteration 4790] [Rank 2] a = 1.1343132257461548, b = 0.9995641120711398, delta = 0.0010700015118345618, c = 0.00012822408706747126, d = 0.0001288458633517424, m = 0.00019084407805105926
[Iteration 4800] [Rank 2] a = 1.0732064247131348, b = 0.9995989315369577, delta = 0.0010218637762591243, c = 0.00019786303090583927, d = 0.00019865752282463017, m = 0.000192068534688728
[Iteration 4810] [Rank 2] a = 0.9702653288841248, b = 0.9999152083855887, delta = 0.0009663602686487138, c = 0.0008304167707710154, d = 0.0008323511858776367, m = 0.00019239627053696832
[Iteration 4820] [Rank 2] a = 0.9775740504264832, b = 0.9998170195492031, delta = 0.0009524200577288866, c = 0.000634039094322046, d = 0.0006378042951545768, m = 0.00019294501680348268
- batch.backward                 |   4864 |     0.05171s |  44.0%
- batch.evaluate                 |   4864 |     0.00277s |   2.4%
- batch.forward                  |   4864 |     0.02537s |  21.6%
- batch.mom                      |   4864 |     0.00126s |   1.1%
- batch.reduce                   |   4864 |     0.02434s |  20.7%
- batch.reporting.compr_err      |   4864 |     0.00001s |   0.0%
- batch.reporting.lr             |   4864 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   4864 |     0.00001s |   0.0%
- batch.step                     |   4864 |     0.00047s |   0.4%
- batch.update_runavg            |   4864 |     0.00129s |   1.1%
- batch.wd                       |   4864 |     0.00001s |   0.0%
- epoch_metrics.collect          |     34 |     0.01182s |   0.1%
- reduce.combine                 |   4864 |     0.00565s |   4.8%
- reduce.flatpack                |   4864 |     0.00002s |   0.0%
- reduce.flatput                 |   4864 |     0.00015s |   0.1%
[Iteration 4830] [Rank 1] a = 0.9961726665496826, b = 0.999919819892999, delta = 0.0005818406934849918, c = 0.0008396397856543707, d = 0.0008406760794614892, m = 0.0004089891352792071
[Iteration 4840] [Rank 1] a = 1.0946881771087646, b = 0.9997639094939326, delta = 0.0006036557606421411, c = 0.0005278189790923924, d = 0.0005289589022802229, m = 0.00041015048241655237
[Iteration 4850] [Rank 1] a = 1.0572491884231567, b = 0.9997163781545315, delta = 0.0006406483589671552, c = 0.0004327562938527155, d = 0.00043358532889841035, m = 0.00041062883265048395
[Iteration 4860] [Rank 1] a = 1.0645703077316284, b = 0.9997822864364989, delta = 0.0006031009834259748, c = 0.0005645728661181978, d = 0.0005653673580369887, m = 0.0004118128763106498
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4864 |     0.10902s |  92.8%
- batch.accumulate               |   4864 |     0.00083s |   0.7%
[Iteration 4830] [Rank 2] a = 1.1122462749481201, b = 0.9995802955231321, delta = 0.0010232807835564017, c = 0.00016059099697647464, d = 0.00016117823013384183, m = 0.00019424793644116098
[Iteration 4840] [Rank 2] a = 1.102245807647705, b = 0.9996092081156007, delta = 0.0009755133069120347, c = 0.00021841619141369095, d = 0.00021910705395177, m = 0.0001968977927603011
[Iteration 4850] [Rank 2] a = 1.0225218534469604, b = 0.9996440793973456, delta = 0.0009945055935531855, c = 0.0002881587646327708, d = 0.0002889877996784657, m = 0.00019715610378431478
[Iteration 4860] [Rank 2] a = 1.1165896654129028, b = 0.9995947863624028, delta = 0.0010020274203270674, c = 0.0001895726804488907, d = 0.00019047080174839346, m = 0.00019849201285369446
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   4864 |     0.10887s |  92.7%
- batch.accumulate               |   4864 |     0.00083s |   0.7%
- reduce.gather.context          |   4864 |     0.00275s |   2.3%
- reduce.gather.tensors          |   4864 |     0.00239s |   2.0%
- reduce.heur_params             |   4864 |     0.01029s |   8.8%
- batch.backward                 |   4864 |     0.05173s |  44.0%
- batch.evaluate                 |   4864 |     0.00276s |   2.4%
- batch.forward                  |   4864 |     0.02539s |  21.6%
- batch.mom                      |   4864 |     0.00126s |   1.1%
- batch.reduce                   |   4864 |     0.02428s |  20.7%
- batch.reporting.compr_err      |   4864 |     0.00001s |   0.0%
- batch.reporting.lr             |   4864 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   4864 |     0.00001s |   0.0%
- batch.step                     |   4864 |     0.00048s |   0.4%
- batch.update_runavg            |   4864 |     0.00129s |   1.1%
- batch.wd                       |   4864 |     0.00001s |   0.0%
- epoch_metrics.collect          |     34 |     0.01184s |   0.1%
- reduce.combine                 |   4864 |     0.00564s |   4.8%
- reduce.flatpack                |   4864 |     0.00002s |   0.0%
- reduce.flatput                 |   4864 |     0.00021s |   0.2%
- batch.backward                 |   4864 |     0.05214s |  44.4%
- batch.evaluate                 |   4864 |     0.00275s |   2.3%
- batch.forward                  |   4864 |     0.02575s |  21.9%
- batch.mom                      |   4864 |     0.00126s |   1.1%
- batch.reduce                   |   4864 |     0.02331s |  19.9%
- batch.reporting.compr_err      |   4864 |     0.00001s |   0.0%
- batch.reporting.lr             |   4864 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   4864 |     0.00001s |   0.0%
- batch.step                     |   4864 |     0.00048s |   0.4%
- batch.update_runavg            |   4864 |     0.00130s |   1.1%
- batch.wd                       |   4864 |     0.00001s |   0.0%
- epoch_metrics.collect          |     34 |     0.01560s |   0.1%
- reduce.combine                 |   4864 |     0.00587s |   5.0%
- reduce.flatpack                |   4864 |     0.00002s |   0.0%
- reduce.flatput                 |   4864 |     0.00014s |   0.1%
- reduce.heur_params.alpha       |   4863 |     0.00812s |   6.9%
- reduce.heur_params.beta        |   4863 |     0.00210s |   1.8%
- reduce.memory                  |   4864 |     0.00043s |   0.4%
- reduce.pad                     |   4864 |     0.00027s |   0.2%
- reduce.threshold               |   4864 |     0.00220s |   1.9%
- test.last                      |     34 |     0.41605s |   2.6%
- test.runavg                    |     34 |     0.44711s |   2.8%
-----------------------------------------------------------------

[Iteration 4870] [Rank 3] a = 0.9419823884963989, b = 0.9996379825362327, delta = 0.0008815525216050446, c = 0.00027596504083567564, d = 0.00027672498962756257, m = 0.00024043787803923326
[Iteration 4880] [Rank 3] a = 1.0262022018432617, b = 0.999646514687486, delta = 0.0008059445535764098, c = 0.0002930293455262281, d = 0.00029372020806430713, m = 0.00024135811424128318
- reduce.gather.context          |   4864 |     0.00171s |   1.5%
- reduce.gather.tensors          |   4864 |     0.00265s |   2.3%
- reduce.heur_params             |   4864 |     0.01071s |   9.1%
- reduce.gather.context          |   4864 |     0.00114s |   1.0%
- reduce.gather.tensors          |   4864 |     0.00259s |   2.2%
- reduce.heur_params             |   4864 |     0.01048s |   8.9%
[Iteration 4890] [Rank 3] a = 1.077479600906372, b = 0.9995977570708325, delta = 0.0008706309017725289, c = 0.0001955140982763705, d = 0.00019603224517992978, m = 0.00024182982793307124
[Iteration 4900] [Rank 3] a = 1.0816401243209839, b = 0.9996136641782984, delta = 0.0008460063836537302, c = 0.00022732831815491065, d = 0.00022791555131227784, m = 0.00024254912220403988
[Iteration 4910] [Rank 3] a = 0.9956962466239929, b = 0.9998209920086669, delta = 0.0007472946890629828, c = 0.0006419840135099552, d = 0.0006441256873780002, m = 0.00024348514655537178
[Iteration 4920] [Rank 3] a = 1.1398605108261108, b = 0.9995994151406568, delta = 0.0008544790325686336, c = 0.00019883023845914993, d = 0.00019927929910890132, m = 0.000244539885649633
[Iteration 4930] [Rank 3] a = 1.032017469406128, b = 0.9996491572363665, delta = 0.0008089780458249152, c = 0.0002983144439425328, d = 0.00029893622022680394, m = 0.00024753272688223405
- reduce.heur_params.alpha       |   4863 |     0.00822s |   7.0%
- reduce.heur_params.beta        |   4863 |     0.00241s |   2.1%
- reduce.memory                  |   4864 |     0.00045s |   0.4%
- reduce.pad                     |   4864 |     0.00015s |   0.1%
- reduce.threshold               |   4864 |     0.00255s |   2.2%
- test.last                      |     34 |     0.41604s |   2.6%
- test.runavg                    |     34 |     0.44711s |   2.8%
-----------------------------------------------------------------

[Iteration 4870] [Rank 1] a = 1.0322163105010986, b = 0.9997902140837611, delta = 0.000618323334492743, c = 0.000580428161367112, d = 0.0005810153945244791, m = 0.0004136240536298897
[Iteration 4880] [Rank 1] a = 1.1192737817764282, b = 0.9996595374447608, delta = 0.0006677533383481205, c = 0.0003190748632118082, d = 0.0003195930101153675, m = 0.0004143139936963052
- reduce.heur_params.alpha       |   4863 |     0.00836s |   7.1%
- reduce.heur_params.beta        |   4863 |     0.00205s |   1.7%
- reduce.memory                  |   4864 |     0.00043s |   0.4%
- reduce.pad                     |   4864 |     0.00029s |   0.2%
- reduce.threshold               |   4864 |     0.00213s |   1.8%
- test.last                      |     34 |     0.41605s |   2.6%
- test.runavg                    |     34 |     0.44711s |   2.8%
-----------------------------------------------------------------

[Iteration 4870] [Rank 2] a = 0.958910346031189, b = 0.9997186061860388, delta = 0.0008776912000030279, c = 0.0004372123572233254, d = 0.00043873225480709925, m = 0.00020392179324592045
[Iteration 4880] [Rank 2] a = 0.9565743803977966, b = 1.0002592061088533, delta = 0.000824045215267688, c = 0.001518412229317035, d = 0.001509120128179872, m = 0.0002045482193674308
[Iteration 4940] [Rank 3] a = 0.775104284286499, b = 1.0004691937486778, delta = 0.0007031757268123329, c = 0.0019383875662152882, d = 0.001923292219758261, m = 0.0002485487182043211
[Iteration 4950] [Rank 3] a = 0.9403843283653259, b = 1.0038801699192739, delta = 0.0006571526173502207, c = 0.008760378784730653, d = 0.007754552015541367, m = 0.0002516586799352602
[Iteration 4960] [Rank 3] a = 0.8748981356620789, b = 1.0031075359983528, delta = 0.0006456917035393417, c = 0.007215092002682343, d = 0.00642629969983059, m = 0.0002535827378548778
[Iteration 4970] [Rank 3] a = 1.0525822639465332, b = 0.9996532505964065, delta = 0.0007650334155187011, c = 0.0003065011650187695, d = 0.0003075374588258881, m = 0.0002543182161614783
[Iteration 4980] [Rank 3] a = 0.9844757318496704, b = 0.9997779167311569, delta = 0.0007200094987638295, c = 0.0005558334550114978, d = 0.0005573533525952718, m = 0.00025495795132330745
[Iteration 4890] [Rank 1] a = 0.9871199727058411, b = 0.9999477480109766, delta = 0.0005794934695586562, c = 0.0008954960218580617, d = 0.0008964977725382763, m = 0.0004152434864570084
[Iteration 4900] [Rank 1] a = 1.0020420551300049, b = 0.9999464008290311, delta = 0.0005756468162871897, c = 0.0008928016579595534, d = 0.0008936652361321522, m = 0.00041626442819111284
[Iteration 4910] [Rank 1] a = 1.0610612630844116, b = 0.9998440495452275, delta = 0.0005646090721711516, c = 0.0006880990879267315, d = 0.0006892735542414659, m = 0.0004183437843365775
[Iteration 4920] [Rank 1] a = 1.0834732055664062, b = 0.9996871028570866, delta = 0.000636703276541084, c = 0.0003742056937505162, d = 0.0003753456169383466, m = 0.00041897312292879296
[Iteration 4930] [Rank 1] a = 1.0337673425674438, b = 0.9998633936958793, delta = 0.000604857865255326, c = 0.0007267873900591583, d = 0.0007277545976124689, m = 0.0004199081630909353
[Iteration 4890] [Rank 2] a = 1.024233341217041, b = 0.9995986897351083, delta = 0.0009073034743778408, c = 0.00019737942712918393, d = 0.00019807028966726297, m = 0.0002052329140290339
[Iteration 4900] [Rank 2] a = 1.062528371810913, b = 0.9996384143252626, delta = 0.0008963121217675507, c = 0.00027682861900827445, d = 0.00027772674030777716, m = 0.00020571609117252054
[Iteration 4910] [Rank 2] a = 0.9726589322090149, b = 0.9997202297128754, delta = 0.0008866977295838296, c = 0.00044045941115229687, d = 0.0004424629125127261, m = 0.0002061046650734506
[Iteration 4920] [Rank 2] a = 1.0515731573104858, b = 0.9996099162495943, delta = 0.0009209509007632732, c = 0.000219832459616753, d = 0.00022076512404315971, m = 0.00020654044548809014
[Iteration 4930] [Rank 2] a = 0.9240699410438538, b = 0.9997938583834918, delta = 0.0008924732101149857, c = 0.0005877167611438459, d = 0.0005889948568392921, m = 0.000207095853207095
[Iteration 4990] [Rank 3] a = 1.0746670961380005, b = 0.9996824740785413, delta = 0.0006795299705117941, c = 0.00036494813574025696, d = 0.00036570808453214394, m = 0.00025742112618741813
[Iteration 5000] [Rank 3] a = 1.0001564025878906, b = 0.9998834632522885, delta = 0.000660636811517179, c = 0.0007669265035215509, d = 0.0007680318835824773, m = 0.00025815571390737363
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5003 |     0.10920s |  92.9%
- batch.accumulate               |   5003 |     0.00082s |   0.7%
- batch.backward                 |   5003 |     0.05171s |  44.0%
- batch.evaluate                 |   5003 |     0.00277s |   2.4%
- batch.forward                  |   5003 |     0.02537s |  21.6%
- batch.mom                      |   5003 |     0.00126s |   1.1%
- batch.reduce                   |   5003 |     0.02448s |  20.8%
[Iteration 4940] [Rank 1] a = 0.9966601133346558, b = 0.9998071920299461, delta = 0.0006109303794801235, c = 0.0006143840551136972, d = 0.0006154548920477196, m = 0.00042091511129431367
[Iteration 4950] [Rank 1] a = 1.1856024265289307, b = 0.9996720938699879, delta = 0.000652307877317071, c = 0.0003441877164709816, d = 0.0003448440358821567, m = 0.00042211659912329904
[Iteration 4960] [Rank 1] a = 0.9608635306358337, b = 1.000387084751124, delta = 0.0005542135331779718, c = 0.0017741695409138984, d = 0.0017546872173400693, m = 0.0004232537867069281
[Iteration 4970] [Rank 1] a = 0.9591267704963684, b = 0.9999428256154077, delta = 0.0006171559798531234, c = 0.0008856512306904353, d = 0.0008865838951168419, m = 0.00042370687711788433
[Iteration 4980] [Rank 1] a = 0.9615371823310852, b = 0.9997672774486206, delta = 0.0006451915833167732, c = 0.0005345548888386632, d = 0.0005356257257726857, m = 0.00042443901487503434
[Iteration 4940] [Rank 2] a = 1.1063495874404907, b = 0.9995865132848957, delta = 0.0009685795521363616, c = 0.0001730265226618975, d = 0.00017340649705784099, m = 0.00020766197430454556
[Iteration 4950] [Rank 2] a = 0.9450238347053528, b = 1.0005246009105373, delta = 0.0008275818545371294, c = 0.0020492019173231676, d = 0.002013207979089249, m = 0.00020837614890160778
[Iteration 4960] [Rank 2] a = 0.9691466093063354, b = 0.9997164472407796, delta = 0.0008843461400829256, c = 0.0004328944663603313, d = 0.0004350015971014724, m = 0.00020870214330066588
[Iteration 4970] [Rank 2] a = 1.010035753250122, b = 0.999587445949163, delta = 0.0009667203994467854, c = 0.00017489185151471095, d = 0.00017530636903755837, m = 0.00020937742738727792
[Iteration 4980] [Rank 2] a = 0.9830520153045654, b = 0.999665530676596, delta = 0.0009008152410387993, c = 0.00033106132824747966, d = 0.00033195944954698243, m = 0.00020992492770046197
- batch.reporting.compr_err      |   5003 |     0.00001s |   0.0%
- batch.reporting.lr             |   5003 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   5003 |     0.00001s |   0.0%
- batch.step                     |   5003 |     0.00047s |   0.4%
- batch.update_runavg            |   5003 |     0.00129s |   1.1%
[Iteration 4990] [Rank 1] a = 1.0042988061904907, b = 0.9999005793714693, delta = 0.0005886363214813173, c = 0.0008011587422833677, d = 0.0008019186910752546, m = 0.0004259050234894871
[Iteration 5000] [Rank 1] a = 1.0245411396026611, b = 0.9999021165406015, delta = 0.0005672056577168405, c = 0.0008042330805778195, d = 0.0008050966587504183, m = 0.0004272503984768803
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5003 |     0.10915s |  92.8%
- batch.accumulate               |   5003 |     0.00083s |   0.7%
- batch.backward                 |   5003 |     0.05172s |  44.0%
- batch.evaluate                 |   5003 |     0.00276s |   2.3%
- batch.forward                  |   5003 |     0.02540s |  21.6%
- batch.mom                      |   5003 |     0.00126s |   1.1%
- batch.reduce                   |   5003 |     0.02441s |  20.8%
[Iteration 4990] [Rank 2] a = 0.9223472476005554, b = 0.9997190207035289, delta = 0.0008953563519753516, c = 0.00043804139226902023, d = 0.00043997580737564155, m = 0.00021035806406574057
[Iteration 5000] [Rank 2] a = 1.0709949731826782, b = 0.9996673096474338, delta = 0.0008439433295279741, c = 0.00033461927031858677, d = 0.0003353792191104737, m = 0.0002125006204930051
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5003 |     0.10901s |  92.7%
- batch.accumulate               |   5003 |     0.00083s |   0.7%
- batch.backward                 |   5003 |     0.05212s |  44.3%
- batch.evaluate                 |   5003 |     0.00275s |   2.3%
- batch.forward                  |   5003 |     0.02574s |  21.9%
- batch.mom                      |   5003 |     0.00126s |   1.1%
- batch.reduce                   |   5003 |     0.02349s |  20.0%
- batch.wd                       |   5003 |     0.00001s |   0.0%
- epoch_metrics.collect          |     35 |     0.01223s |   0.1%
- reduce.combine                 |   5003 |     0.00568s |   4.8%
- reduce.flatpack                |   5003 |     0.00002s |   0.0%
- reduce.flatput                 |   5003 |     0.00015s |   0.1%
- reduce.gather.context          |   5003 |     0.00274s |   2.3%
- reduce.gather.tensors          |   5003 |     0.00248s |   2.1%
- reduce.heur_params             |   5003 |     0.01030s |   8.8%
- reduce.heur_params.alpha       |   5002 |     0.00812s |   6.9%
- reduce.heur_params.beta        |   5002 |     0.00211s |   1.8%
- reduce.memory                  |   5003 |     0.00043s |   0.4%
- reduce.pad                     |   5003 |     0.00027s |   0.2%
- reduce.threshold               |   5003 |     0.00221s |   1.9%
- test.last                      |     35 |     0.41568s |   2.6%
- test.runavg                    |     35 |     0.44683s |   2.8%
- batch.reporting.compr_err      |   5003 |     0.00001s |   0.0%
- batch.reporting.lr             |   5003 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5003 |     0.00001s |   0.0%
- batch.step                     |   5003 |     0.00048s |   0.4%
- batch.update_runavg            |   5003 |     0.00129s |   1.1%
- batch.reporting.compr_err      |   5003 |     0.00001s |   0.0%
- batch.reporting.lr             |   5003 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   5003 |     0.00001s |   0.0%
- batch.step                     |   5003 |     0.00048s |   0.4%
- batch.update_runavg            |   5003 |     0.00130s |   1.1%
-----------------------------------------------------------------
- batch.wd                       |   5003 |     0.00001s |   0.0%
- epoch_metrics.collect          |     35 |     0.01226s |   0.1%
- reduce.combine                 |   5003 |     0.00567s |   4.8%
- reduce.flatpack                |   5003 |     0.00002s |   0.0%
- reduce.flatput                 |   5003 |     0.00021s |   0.2%
- reduce.gather.context          |   5003 |     0.00168s |   1.4%
- reduce.gather.tensors          |   5003 |     0.00275s |   2.3%
- reduce.heur_params             |   5003 |     0.01072s |   9.1%
- reduce.heur_params.alpha       |   5002 |     0.00822s |   7.0%
- reduce.heur_params.beta        |   5002 |     0.00242s |   2.1%
- reduce.memory                  |   5003 |     0.00045s |   0.4%
- reduce.pad                     |   5003 |     0.00015s |   0.1%
- reduce.threshold               |   5003 |     0.00256s |   2.2%
- test.last                      |     35 |     0.41568s |   2.6%
- test.runavg                    |     35 |     0.44683s |   2.8%
- batch.wd                       |   5003 |     0.00001s |   0.0%
- epoch_metrics.collect          |     35 |     0.01599s |   0.1%
- reduce.combine                 |   5003 |     0.00588s |   5.0%
- reduce.flatpack                |   5003 |     0.00002s |   0.0%
- reduce.flatput                 |   5003 |     0.00014s |   0.1%
- reduce.gather.context          |   5003 |     0.00119s |   1.0%
- reduce.gather.tensors          |   5003 |     0.00270s |   2.3%
- reduce.heur_params             |   5003 |     0.01048s |   8.9%
- reduce.heur_params.alpha       |   5002 |     0.00835s |   7.1%
- reduce.heur_params.beta        |   5002 |     0.00206s |   1.8%
- reduce.memory                  |   5003 |     0.00043s |   0.4%
- reduce.pad                     |   5003 |     0.00029s |   0.2%
- reduce.threshold               |   5003 |     0.00215s |   1.8%
- test.last                      |     35 |     0.41569s |   2.6%
- test.runavg                    |     35 |     0.44684s |   2.8%
-----------------------------------------------------------------
-----------------------------------------------------------------

[Iteration 4870] [Rank 0] a = 1.0305030345916748, b = 0.9995283944852785, delta = 0.001722297864034772, c = 5.678890063009772e-05, d = 5.696161626461749e-05, m = 0.00014199323558520313
[Iteration 4880] [Rank 0] a = 0.984322190284729, b = 0.9995736805155139, delta = 0.001525292289443314, c = 0.0001473609793722609, d = 0.0001480863850372439, m = 0.00014634888203121185
[Iteration 4890] [Rank 0] a = 0.9709835648536682, b = 0.9995804336956154, delta = 0.0014903151895850897, c = 0.00016086734199170625, d = 0.00016176546329120902, m = 0.0001468936548651853
[Iteration 4900] [Rank 0] a = 1.1934902667999268, b = 0.9995136618450341, delta = 0.0017718183808028698, c = 2.732361338102634e-05, d = 2.735815650793029e-05, m = 0.00014691611238921192
[Iteration 4910] [Rank 0] a = 0.9107723832130432, b = 0.9999242414132158, delta = 0.0014648172073066235, c = 0.0008484828261417825, d = 0.0008505899568829236, m = 0.00014702415750809434
[Iteration 4920] [Rank 0] a = 1.1441625356674194, b = 0.9995201732229361, delta = 0.001672422862611711, c = 4.034637222381639e-05, d = 4.04845447314322e-05, m = 0.00014741838512146257
[Iteration 4930] [Rank 0] a = 1.0863134860992432, b = 0.9995472723000988, delta = 0.0015209129778668284, c = 9.454453833611768e-05, d = 9.485542647825325e-05, m = 0.00014797385192213857
[Iteration 4940] [Rank 0] a = 1.0446494817733765, b = 0.9995485676670931, delta = 0.0014514242066070437, c = 9.713527285391412e-05, d = 9.758433350366549e-05, m = 0.00015280806904407917
[Iteration 4950] [Rank 0] a = 1.0259697437286377, b = 0.9995438870743613, delta = 0.0014207552885636687, c = 8.777408546294301e-05, d = 8.794680109746278e-05, m = 0.00015599427030925614
rel_compression_error          - epoch: 35.662, value:  0.998 (weight:encoder.weight)
rel_compression_error          - epoch: 35.662, value:  0.998 (weight:rnn.weight_ih_l0)
rel_compression_error          - epoch: 35.662, value:  0.995 (weight:rnn.weight_hh_l0)
rel_compression_error          - epoch: 35.662, value:  0.949 (weight:rnn.bias_ih_l0)
rel_compression_error          - epoch: 35.662, value:  0.949 (weight:rnn.bias_hh_l0)
rel_compression_error          - epoch: 35.662, value:  0.998 (weight:rnn.weight_ih_l1)
rel_compression_error          - epoch: 35.662, value:  1.000 (weight:rnn.weight_hh_l1)
rel_compression_error          - epoch: 35.662, value:  0.990 (weight:rnn.bias_ih_l1)
rel_compression_error          - epoch: 35.662, value:  0.990 (weight:rnn.bias_hh_l1)
rel_compression_error          - epoch: 35.662, value:  0.981 (weight:rnn.weight_ih_l2)
rel_compression_error          - epoch: 35.662, value:  0.998 (weight:rnn.weight_hh_l2)
rel_compression_error          - epoch: 35.662, value:  0.789 (weight:rnn.bias_ih_l2)
rel_compression_error          - epoch: 35.662, value:  0.789 (weight:rnn.bias_hh_l2)
rel_compression_error          - epoch: 35.662, value:  0.806 (weight:decoder.bias)
rel_compression_error          - epoch: 35.662, value:  0.997 (weight:entire_model)
[Iteration 4960] [Rank 0] a = 0.9686627984046936, b = 0.9996915934631507, delta = 0.0011479780077934265, c = 0.0003831869067455438, d = 0.00038536312374049284, m = 0.00016397235202048844
[Iteration 4970] [Rank 0] a = 1.0415018796920776, b = 0.9996040093758061, delta = 0.0011451335158199072, c = 0.00020801871021560128, d = 0.00020898591776891194, m = 0.00016433486459645387
[Iteration 4980] [Rank 0] a = 1.0531598329544067, b = 0.9995948381770847, delta = 0.0012033645762130618, c = 0.00018967630982960254, d = 0.00019053988800220135, m = 0.0001645424713260987
[Iteration 4990] [Rank 0] a = 0.8924475908279419, b = 1.000185145648461, delta = 0.0011218986473977566, c = 0.0013702913011528872, d = 0.0013649025733558707, m = 0.00016479804668992646
[Iteration 5000] [Rank 0] a = 1.139733910560608, b = 0.999547842261576, delta = 0.0011993406806141138, c = 9.568446152394811e-05, d = 9.602989279298764e-05, m = 0.00016688262588579526
cross_entropy                  - bits:8175897344.000, epoch: 36.000, ratio_transmit_grad:  0.222, value:  5.895 (split:train)
last_cross_entropy             - bits:8175897344.000, epoch: 36.000, ratio_transmit_grad:  0.222, value:  5.895 (split:train)
perplexity                     - bits:8175897344.000, epoch: 36.000, ratio_transmit_grad:  0.222, value:364.102 (split:train)
last_perplexity                - bits:8175897344.000, epoch: 36.000, ratio_transmit_grad:  0.222, value:364.102 (split:train)
last_cross_entropy             - bits:8175897344.000, epoch: 36.000, ratio_transmit_grad:  0.222, value:  5.609 (split:test)
last_perplexity                - bits:8175897344.000, epoch: 36.000, ratio_transmit_grad:  0.222, value:273.719 (split:test)
runavg_cross_entropy           - bits:8175897344.000, epoch: 36.000, ratio_transmit_grad:  0.222, value:  5.750 (split:test)
runavg_perplexity              - bits:8175897344.000, epoch: 36.000, ratio_transmit_grad:  0.222, value:315.081 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5003 |     0.10905s |  92.7%
- batch.accumulate               |   5003 |     0.00083s |   0.7%
- batch.backward                 |   5003 |     0.05177s |  44.0%
- batch.evaluate                 |   5003 |     0.00275s |   2.3%
- batch.forward                  |   5003 |     0.02550s |  21.7%
- batch.mom                      |   5003 |     0.00126s |   1.1%
- batch.reduce                   |   5003 |     0.02409s |  20.5%
- batch.reporting.compr_err      |   5003 |     0.00001s |   0.0%
- batch.reporting.lr             |   5003 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5003 |     0.00001s |   0.0%
- batch.step                     |   5003 |     0.00048s |   0.4%
- batch.update_runavg            |   5003 |     0.00130s |   1.1%
- batch.wd                       |   5003 |     0.00001s |   0.0%
- epoch_metrics.collect          |     35 |     0.00950s |   0.1%
- reduce.combine                 |   5003 |     0.00596s |   5.1%
- reduce.flatpack                |   5003 |     0.00002s |   0.0%
- reduce.flatput                 |   5003 |     0.00013s |   0.1%
- reduce.gather.context          |   5003 |     0.00137s |   1.2%
- reduce.gather.tensors          |   5003 |     0.00276s |   2.3%
- reduce.heur_params             |   5003 |     0.01082s |   9.2%
- reduce.heur_params.alpha       |   5002 |     0.00873s |   7.4%
- reduce.heur_params.beta        |   5002 |     0.00201s |   1.7%
- reduce.memory                  |   5003 |     0.00044s |   0.4%
- reduce.pad                     |   5003 |     0.00029s |   0.2%
- reduce.threshold               |   5003 |     0.00208s |   1.8%
- test.last                      |     35 |     0.41568s |   2.6%
- test.runavg                    |     35 |     0.44684s |   2.8%
-----------------------------------------------------------------

[Iteration 5010] [Rank 0] a = 0.958414614200592, b = 0.9996692613338889, delta = 0.001150441006757319, c = 0.00033852264365873336, d = 0.00033997345498869936, m = 0.00016700778778964558
[Iteration 5020] [Rank 0] a = 0.9690713286399841, b = 0.9996445111863775, delta = 0.0012130524264648557, c = 0.0002890223428053696, d = 0.00029009317973939215, m = 0.00016707658772804334
[Iteration 5030] [Rank 0] a = 1.0534367561340332, b = 0.9995591896765017, delta = 0.0012502252357080579, c = 0.00011837929589984483, d = 0.00011872472716888435, m = 0.00016742303150443032
[Iteration 5040] [Rank 0] a = 0.8786123991012573, b = 0.9996305903080641, delta = 0.0011646002531051636, c = 0.000261180582520784, d = 0.0002622859625817105, m = 0.00016801077292427066
[Iteration 5050] [Rank 0] a = 1.080528736114502, b = 0.9995630585059698, delta = 0.0012284645345062017, c = 0.00012611695632633018, d = 0.0001265314738491776, m = 0.00016853676418412982
[Iteration 5060] [Rank 0] a = 1.0256556272506714, b = 0.9995796564753971, delta = 0.0012555368011817336, c = 0.0001593129012810284, d = 0.00015986559131149163, m = 0.00016866960441308342
[Iteration 5070] [Rank 0] a = 0.9582069516181946, b = 0.9996144586700989, delta = 0.0011828632559627295, c = 0.00022891730199249246, d = 0.000229988138926515, m = 0.0001688695287930807
[Iteration 5080] [Rank 0] a = 1.139906406402588, b = 0.9995608995609525, delta = 0.0011509389150887728, c = 0.00012179906546333612, d = 0.00012210995360547168, m = 0.0001716394471742315
[Iteration 5090] [Rank 0] a = 0.9568694233894348, b = 0.9996809196379882, delta = 0.0010571026941761374, c = 0.00036183925431890125, d = 0.000363462781283387, m = 0.00017262577896494212
timer                          - epoch: -1.000, value:  0.000 (event:reduce.memory)
[Iteration 5100] [Rank 0] a = 0.8509092330932617, b = 0.9998756392341582, delta = 0.0010560055961832404, c = 0.0007512784670340605, d = 0.0007529365371254502, m = 0.00017282041511230975
[Iteration 5110] [Rank 0] a = 1.039955735206604, b = 0.999604147548292, delta = 0.0010722378501668572, c = 0.0002082950552308329, d = 0.00020943497841866332, m = 0.0001748826665979704
[Iteration 5120] [Rank 0] a = 0.9995875954627991, b = 0.999595788112919, delta = 0.0011212206445634365, c = 0.00019157618180931993, d = 0.00019237067372811085, m = 0.00017513954212590303
[Iteration 5130] [Rank 0] a = 0.94724440574646, b = 0.9996594165438306, delta = 0.0010824016062542796, c = 0.0003188330613234805, d = 0.000319972984511311, m = 0.0001756584248314225
timer                          - epoch: -1.000, value:  0.000 (event:batch.reporting.compr_err)
[Iteration 5140] [Rank 0] a = 0.9646777510643005, b = 0.9997959827857071, delta = 0.0010644679423421621, c = 0.0005919655657530321, d = 0.0005940036102403652, m = 0.00017583243109449136
cross_entropy                  - bits:8624307904.000, epoch: 37.000, ratio_transmit_grad:  0.174, value:  5.868 (split:train)
last_cross_entropy             - bits:8624307904.000, epoch: 37.000, ratio_transmit_grad:  0.174, value:  5.868 (split:train)
perplexity                     - bits:8624307904.000, epoch: 37.000, ratio_transmit_grad:  0.174, value:354.531 (split:train)
last_perplexity                - bits:8624307904.000, epoch: 37.000, ratio_transmit_grad:  0.174, value:354.531 (split:train)
last_cross_entropy             - bits:8624307904.000, epoch: 37.000, ratio_transmit_grad:  0.174, value:  5.583 (split:test)
last_perplexity                - bits:8624307904.000, epoch: 37.000, ratio_transmit_grad:  0.174, value:266.667 (split:test)
runavg_cross_entropy           - bits:8624307904.000, epoch: 37.000, ratio_transmit_grad:  0.174, value:  5.726 (split:test)
runavg_perplexity              - bits:8624307904.000, epoch: 37.000, ratio_transmit_grad:  0.174, value:307.637 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5142 |     0.10911s |  92.7%
- batch.accumulate               |   5142 |     0.00083s |   0.7%
- batch.backward                 |   5142 |     0.05177s |  44.0%
- batch.evaluate                 |   5142 |     0.00275s |   2.3%
- batch.forward                  |   5142 |     0.02550s |  21.7%
- batch.mom                      |   5142 |     0.00126s |   1.1%
- batch.reduce                   |   5142 |     0.02416s |  20.5%
- batch.reporting.compr_err      |   5142 |     0.00001s |   0.0%
- batch.reporting.lr             |   5142 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5142 |     0.00001s |   0.0%
- batch.step                     |   5142 |     0.00048s |   0.4%
- batch.update_runavg            |   5142 |     0.00130s |   1.1%
- batch.wd                       |   5142 |     0.00001s |   0.0%
- epoch_metrics.collect          |     36 |     0.00987s |   0.1%
- reduce.combine                 |   5142 |     0.00598s |   5.1%
- reduce.flatpack                |   5142 |     0.00002s |   0.0%
- reduce.flatput                 |   5142 |     0.00013s |   0.1%
- reduce.gather.context          |   5142 |     0.00136s |   1.2%
- reduce.gather.tensors          |   5142 |     0.00279s |   2.4%
- reduce.heur_params             |   5142 |     0.01083s |   9.2%
- reduce.heur_params.alpha       |   5141 |     0.00873s |   7.4%
- reduce.heur_params.beta        |   5141 |     0.00202s |   1.7%
- reduce.memory                  |   5142 |     0.00044s |   0.4%
- reduce.pad                     |   5142 |     0.00029s |   0.2%
- reduce.threshold               |   5142 |     0.00210s |   1.8%
- test.last                      |     36 |     0.41542s |   2.6%
- test.runavg                    |     36 |     0.44666s |   2.8%
-----------------------------------------------------------------

[Iteration 5150] [Rank 0] a = 1.0615694522857666, b = 0.999561383164636, delta = 0.0011517534730955958, c = 0.0001227662730166468, d = 0.0001232498767933021, m = 0.0001761474012981693
timer                          - epoch: -1.000, value:  0.000 (event:reduce.gather.context)
[Iteration 5160] [Rank 0] a = 0.9191398620605469, b = 1.0005895419689406, delta = 0.0009993386920541525, c = 0.0021790840744820286, d = 0.0021502060203903244, m = 0.0001766734696742118
[Iteration 5170] [Rank 0] a = 1.0502839088439941, b = 0.9996013495554544, delta = 0.0010703366715461016, c = 0.0002026990686723926, d = 0.00020373536247951117, m = 0.00017715137683215482
[Iteration 5180] [Rank 0] a = 1.0065181255340576, b = 0.9996120406515773, delta = 0.0010818508453667164, c = 0.00022408126422593914, d = 0.00022508301490615376, m = 0.00017735940821557076
[Iteration 5190] [Rank 0] a = 0.9106441736221313, b = 0.9996162549124319, delta = 0.0011019969824701548, c = 0.0002325097871905035, d = 0.00023330427910929442, m = 0.00017761839621878835
[Iteration 5200] [Rank 0] a = 0.9928203225135803, b = 0.9995861160390043, delta = 0.00115959660615772, c = 0.0001722320307431066, d = 0.00017306106578880145, m = 0.00017768618525481895
[Iteration 5210] [Rank 0] a = 0.9502156376838684, b = 0.9997414564628192, delta = 0.0010546967387199402, c = 0.0004829129141172544, d = 0.000485365476127435, m = 0.00017825353877577843
[Iteration 5220] [Rank 0] a = 0.9157492518424988, b = 1.0000382337318352, delta = 0.0009764850838109851, c = 0.0010764674637078681, d = 0.0010731858666519927, m = 0.00017920970929675645
rel_compression_error          - epoch: 37.590, value:  0.993 (weight:encoder.weight)
rel_compression_error          - epoch: 37.590, value:  0.976 (weight:rnn.weight_ih_l0)
rel_compression_error          - epoch: 37.590, value:  0.982 (weight:rnn.weight_hh_l0)
rel_compression_error          - epoch: 37.590, value:  0.939 (weight:rnn.bias_ih_l0)
rel_compression_error          - epoch: 37.590, value:  0.939 (weight:rnn.bias_hh_l0)
rel_compression_error          - epoch: 37.590, value:  0.978 (weight:rnn.weight_ih_l1)
rel_compression_error          - epoch: 37.590, value:  0.991 (weight:rnn.weight_hh_l1)
rel_compression_error          - epoch: 37.590, value:  0.974 (weight:rnn.bias_ih_l1)
rel_compression_error          - epoch: 37.590, value:  0.974 (weight:rnn.bias_hh_l1)
rel_compression_error          - epoch: 37.590, value:  0.976 (weight:rnn.weight_ih_l2)
rel_compression_error          - epoch: 37.590, value:  0.987 (weight:rnn.weight_hh_l2)
rel_compression_error          - epoch: 37.590, value:  0.854 (weight:rnn.bias_ih_l2)
rel_compression_error          - epoch: 37.590, value:  0.854 (weight:rnn.bias_hh_l2)
rel_compression_error          - epoch: 37.590, value:  0.741 (weight:decoder.bias)
rel_compression_error          - epoch: 37.590, value:  0.989 (weight:entire_model)
[Iteration 5230] [Rank 0] a = 1.0321707725524902, b = 0.9996190874484242, delta = 0.0010581722017377615, c = 0.0002381748600027517, d = 0.00023910752442915842, m = 0.00017950401600879328
[Iteration 5240] [Rank 0] a = 1.0372153520584106, b = 0.9995716424713986, delta = 0.0011408724822103977, c = 0.0001432848903975945, d = 0.00014394120980876958, m = 0.00017974310117534867
[Iteration 5250] [Rank 0] a = 0.9551550149917603, b = 0.9997086750378684, delta = 0.0010761626763269305, c = 0.00041735005925355273, d = 0.0004191808449794622, m = 0.00017996965827764136
[Iteration 5260] [Rank 0] a = 0.9717515110969543, b = 0.9997901968121985, delta = 0.0010703828884288669, c = 0.000580393618240208, d = 0.0005837443015498914, m = 0.00018017013454121815
[Iteration 5270] [Rank 0] a = 1.1086868047714233, b = 0.9995500357496881, delta = 0.001264844206161797, c = 0.00010007143864075006, d = 0.00010041686990978958, m = 0.00018053780797310266

[Iteration 5010] [Rank 3] a = 0.8849999904632568, b = 1.0004700400551, delta = 0.0006341366679407656, c = 0.0019400801794335818, d = 0.0019030844905194488, m = 0.00025954536424852996
[Iteration 5020] [Rank 3] a = 1.0884342193603516, b = 0.9996554613562643, delta = 0.0007305454928427935, c = 0.00031092268526247544, d = 0.00031161354780055446, m = 0.00026251079905459444
[Iteration 5030] [Rank 3] a = 0.8767284154891968, b = 1.000168133158992, delta = 0.000619035679847002, c = 0.0013362663211524942, d = 0.0013281141432031614, m = 0.00026365493052612837
[Iteration 5040] [Rank 3] a = 0.9277408719062805, b = 1.0000497538646353, delta = 0.0006480756564997137, c = 0.0010995077293528045, d = 0.0010989204961954374, m = 0.0002643713436928595
[Iteration 5050] [Rank 3] a = 1.0968410968780518, b = 0.9996807814654946, delta = 0.0006915006088092923, c = 0.00036156290930366964, d = 0.00036211559933413287, m = 0.0002653259629153264

[Iteration 5010] [Rank 1] a = 1.0717322826385498, b = 0.9997857234774654, delta = 0.0006218733033165336, c = 0.0005714469483720843, d = 0.000572379612798491, m = 0.00042825161091035273
[Iteration 5020] [Rank 1] a = 0.9850664734840393, b = 1.0000406862938418, delta = 0.0005776407197117805, c = 0.0010813725877282295, d = 0.0010806817251901503, m = 0.00042935930307695164
[Iteration 5030] [Rank 1] a = 1.0406581163406372, b = 0.9997485896180612, delta = 0.0006276100757531822, c = 0.0004971792255285867, d = 0.0004979046311935697, m = 0.00042995470276023805
[Iteration 5040] [Rank 1] a = 0.920148491859436, b = 1.0017341786234486, delta = 0.0005540527636185288, c = 0.0044683607237876646, d = 0.0043122257901818005, m = 0.00043142437912955584
[Iteration 5050] [Rank 1] a = 1.0299928188323975, b = 0.9997961555013345, delta = 0.0006218451308086514, c = 0.0005923109970220715, d = 0.0005932436614484783, m = 0.0004319941634616439
[Iteration 5060] [Rank 3] a = 1.0799883604049683, b = 0.9997035108408422, delta = 0.0007185101276263595, c = 0.000407021664309271, d = 0.00040764344059354213, m = 0.0002660942791883284
[Iteration 5070] [Rank 3] a = 1.017751932144165, b = 0.9997284682480162, delta = 0.0006938244332559407, c = 0.00045693648268548215, d = 0.00045824912150783237, m = 0.0002669451498925988
[Iteration 5080] [Rank 3] a = 0.9795857071876526, b = 0.9999093360540602, delta = 0.0006597151514142752, c = 0.0008186721076236716, d = 0.0008198811170653099, m = 0.0002678096132081974
[Iteration 5090] [Rank 3] a = 0.9998873472213745, b = 0.9997691945920609, delta = 0.0006780718686059117, c = 0.0005383891759250019, d = 0.0005400127028894877, m = 0.00026848118520293854
[Iteration 5100] [Rank 3] a = 0.9667912721633911, b = 0.9998385571881883, delta = 0.0007028020918369293, c = 0.0006771143735712746, d = 0.0006785306417743367, m = 0.00026897482839490953
[Iteration 5060] [Rank 1] a = 1.0191017389297485, b = 0.9998444640627404, delta = 0.0006217171903699636, c = 0.0006889281229724264, d = 0.0006904134774292964, m = 0.0004325525638003631
[Iteration 5070] [Rank 1] a = 1.0036020278930664, b = 0.9997919239684682, delta = 0.0006378473481163383, c = 0.0005838479309306032, d = 0.0005850569403722416, m = 0.00043308536294647934
[Iteration 5080] [Rank 1] a = 1.113477110862732, b = 0.9996796933571085, delta = 0.0006664881366305053, c = 0.0003593866923087206, d = 0.00036018118422751155, m = 0.0004339264363279082
[Iteration 5090] [Rank 1] a = 0.9259477853775024, b = 1.0000491148167892, delta = 0.0006114057032391429, c = 0.0010982296336573582, d = 0.0010974005986116634, m = 0.0004348045635398609
[Iteration 5100] [Rank 1] a = 1.0590155124664307, b = 0.9997349968985311, delta = 0.0006475631380453706, c = 0.00046999378465517616, d = 0.0004707882765739671, m = 0.0004355450774372503
[Iteration 5110] [Rank 3] a = 0.9552971720695496, b = 0.9999993899856505, delta = 0.0006537549779750407, c = 0.0009987799713008793, d = 0.0009987799713008793, m = 0.0002702101937415526
[Iteration 5120] [Rank 3] a = 0.8624553680419922, b = 1.0001542640939005, delta = 0.0006448531639762223, c = 0.0013085281902486205, d = 0.0013061101713653437, m = 0.0002717683308504071
[Iteration 5130] [Rank 3] a = 1.0160155296325684, b = 0.9997043744189393, delta = 0.0007079116185195744, c = 0.0004087488206544686, d = 0.0004098196575884911, m = 0.00027221341893258723
[Iteration 5140] [Rank 3] a = 1.041980266571045, b = 0.9997990225807502, delta = 0.0006781062111258507, c = 0.0005980451560881276, d = 0.0005990814498952463, m = 0.00027309157139529847
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5142 |     0.10926s |  92.9%
- batch.accumulate               |   5142 |     0.00082s |   0.7%
[Iteration 5110] [Rank 1] a = 1.037735104560852, b = 0.999847849289097, delta = 0.0005872665788047016, c = 0.000695698575845601, d = 0.0006965621540181998, m = 0.0004373090117445252
[Iteration 5120] [Rank 1] a = 0.9740593433380127, b = 1.0002557172532673, delta = 0.0005836159107275307, c = 0.0015114345176824367, d = 0.0015028678222102564, m = 0.0004379666736170545
[Iteration 5130] [Rank 1] a = 1.0125359296798706, b = 0.9998641881877836, delta = 0.0006110277608968318, c = 0.00072837637389674, d = 0.0007293435814500507, m = 0.0004385731315665023
[Iteration 5140] [Rank 1] a = 1.0615479946136475, b = 0.9997152900461217, delta = 0.000679355813190341, c = 0.0004305800768577665, d = 0.0004314436550303653, m = 0.00043892135171829484
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5142 |     0.10921s |  92.8%
- batch.accumulate               |   5142 |     0.00083s |   0.7%
- batch.backward                 |   5142 |     0.05171s |  44.0%
- batch.evaluate                 |   5142 |     0.00277s |   2.4%
- batch.forward                  |   5142 |     0.02537s |  21.6%
- batch.mom                      |   5142 |     0.00126s |   1.1%
- batch.reduce                   |   5142 |     0.02454s |  20.9%
- batch.reporting.compr_err      |   5142 |     0.00001s |   0.0%
- batch.reporting.lr             |   5142 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   5142 |     0.00001s |   0.0%
- batch.step                     |   5142 |     0.00047s |   0.4%
- batch.update_runavg            |   5142 |     0.00129s |   1.1%
- batch.wd                       |   5142 |     0.00001s |   0.0%
- epoch_metrics.collect          |     36 |     0.01191s |   0.1%
- reduce.combine                 |   5142 |     0.00570s |   4.8%
- reduce.flatpack                |   5142 |     0.00002s |   0.0%
- reduce.flatput                 |   5142 |     0.00015s |   0.1%
- batch.backward                 |   5142 |     0.05172s |  44.0%
- batch.evaluate                 |   5142 |     0.00276s |   2.3%
- batch.forward                  |   5142 |     0.02539s |  21.6%
- batch.mom                      |   5142 |     0.00126s |   1.1%
- batch.reduce                   |   5142 |     0.02447s |  20.8%
- batch.reporting.compr_err      |   5142 |     0.00001s |   0.0%
- batch.reporting.lr             |   5142 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5142 |     0.00001s |   0.0%
- batch.step                     |   5142 |     0.00048s |   0.4%
- batch.update_runavg            |   5142 |     0.00129s |   1.1%
- batch.wd                       |   5142 |     0.00001s |   0.0%
- epoch_metrics.collect          |     36 |     0.01257s |   0.1%
- reduce.combine                 |   5142 |     0.00570s |   4.8%
- reduce.flatpack                |   5142 |     0.00002s |   0.0%
- reduce.flatput                 |   5142 |     0.00021s |   0.2%
- reduce.gather.context          |   5142 |     0.00272s |   2.3%
- reduce.gather.tensors          |   5142 |     0.00251s |   2.1%
- reduce.heur_params             |   5142 |     0.01031s |   8.8%
- reduce.gather.context          |   5142 |     0.00166s |   1.4%
- reduce.gather.tensors          |   5142 |     0.00278s |   2.4%
- reduce.heur_params             |   5142 |     0.01073s |   9.1%
- reduce.heur_params.alpha       |   5141 |     0.00812s |   6.9%
- reduce.heur_params.beta        |   5141 |     0.00212s |   1.8%
- reduce.memory                  |   5142 |     0.00043s |   0.4%
- reduce.pad                     |   5142 |     0.00027s |   0.2%
- reduce.threshold               |   5142 |     0.00223s |   1.9%
- test.last                      |     36 |     0.41543s |   2.6%
- test.runavg                    |     36 |     0.44665s |   2.8%
-----------------------------------------------------------------

[Iteration 5150] [Rank 3] a = 1.075029969215393, b = 0.9997288136792596, delta = 0.0006884740432724357, c = 0.0004576273452235612, d = 0.00045824912150783237, m = 0.0002740484639580521
[Iteration 5160] [Rank 3] a = 1.0177843570709229, b = 0.9998018551170432, delta = 0.0006860419525764883, c = 0.0006037102289003759, d = 0.0006047119795805904, m = 0.00027475121235676406
- reduce.heur_params.alpha       |   5141 |     0.00823s |   7.0%
- reduce.heur_params.beta        |   5141 |     0.00242s |   2.1%
- reduce.memory                  |   5142 |     0.00045s |   0.4%
- reduce.pad                     |   5142 |     0.00016s |   0.1%
- reduce.threshold               |   5142 |     0.00256s |   2.2%
- test.last                      |     36 |     0.41543s |   2.6%
- test.runavg                    |     36 |     0.44665s |   2.8%
-----------------------------------------------------------------

[Iteration 5150] [Rank 1] a = 1.014716625213623, b = 0.9997511285377298, delta = 0.0006626912509091198, c = 0.0005022570651834677, d = 0.0005032242727367784, m = 0.00043985203286714457
[Iteration 5160] [Rank 1] a = 0.9934595823287964, b = 0.9998156550957366, delta = 0.0006309263990260661, c = 0.0006313101872966338, d = 0.0006325191967382722, m = 0.00044109534335855986
[Iteration 5170] [Rank 3] a = 1.0656758546829224, b = 0.9996836140016147, delta = 0.0007031948771327734, c = 0.0003672279821159178, d = 0.00036822973279613245, m = 0.00027565372516305894
[Iteration 5180] [Rank 3] a = 1.0663340091705322, b = 0.9996448048029191, delta = 0.0007308202912099659, c = 0.0002896095759627368, d = 0.0002900586366124882, m = 0.00027640007354892785
[Iteration 5190] [Rank 3] a = 0.8877615332603455, b = 1.0009931090623698, delta = 0.0006344486610032618, c = 0.0029862187777197798, d = 0.0029004827367441702, m = 0.00027759558821990454
[Iteration 5200] [Rank 3] a = 1.1807929277420044, b = 0.9996048211391613, delta = 0.000702463963534683, c = 0.00020964223718008702, d = 0.00021012584095674236, m = 0.0002835636653424139
[Iteration 5210] [Rank 3] a = 1.0687614679336548, b = 0.9997167235857725, delta = 0.0006409286870621145, c = 0.0004334471563907946, d = 0.0004343452776902973, m = 0.0002844951448550622
[Iteration 5170] [Rank 1] a = 0.976020336151123, b = 0.9998841023001275, delta = 0.0006017846171744168, c = 0.0007682045992169971, d = 0.0007688954617550761, m = 0.0004433135178072648
[Iteration 5180] [Rank 1] a = 0.9955847859382629, b = 0.9998379181403572, delta = 0.0006030459189787507, c = 0.0006758362778758284, d = 0.0006767689423022352, m = 0.0004441692469730902
[Iteration 5190] [Rank 1] a = 0.9323973655700684, b = 0.9998667789222543, delta = 0.0006084542837925255, c = 0.0007335578429323329, d = 0.000734214162343508, m = 0.00044573342994881805
[Iteration 5200] [Rank 1] a = 1.0715736150741577, b = 0.9997895750359418, delta = 0.0006009282660670578, c = 0.0005791500656716658, d = 0.0005798409282097447, m = 0.00044765712683971057
[Iteration 5210] [Rank 1] a = 0.9425677061080933, b = 1.0004882615503583, delta = 0.0005530149792321026, c = 0.0019765231783172516, d = 0.001956073647190112, m = 0.00044865188610190756
[Iteration 5220] [Rank 3] a = 1.0335184335708618, b = 0.9997556536870791, delta = 0.000633124029263854, c = 0.0005113073644323033, d = 0.0005125163738739415, m = 0.0002853798127477724
[Iteration 5230] [Rank 3] a = 0.9476253390312195, b = 1.0000832088828908, delta = 0.0005972842336632311, c = 0.0011664177661657603, d = 0.0011652432998510258, m = 0.00028686379688814905
[Iteration 5240] [Rank 3] a = 0.9750253558158875, b = 0.9999374368876297, delta = 0.0006157246534712613, c = 0.0008748737750964021, d = 0.0008754610082537693, m = 0.00028772266177494774
[Iteration 5250] [Rank 3] a = 1.1097815036773682, b = 0.9996788815937098, delta = 0.0006720628589391708, c = 0.00035776316534423487, d = 0.00035886854540516134, m = 0.0002889532565515623
[Iteration 5260] [Rank 3] a = 1.0176136493682861, b = 0.9998734802887606, delta = 0.0006156080053187907, c = 0.0007469605761710664, d = 0.0007477550680898573, m = 0.00028978709126001453
[Iteration 5220] [Rank 1] a = 0.9773356914520264, b = 0.9999567464955145, delta = 0.0005703019560314715, c = 0.0009134929909750209, d = 0.0009139765947516762, m = 0.0004497144682428147
[Iteration 5230] [Rank 1] a = 1.0697921514511108, b = 0.9996920425237578, delta = 0.0006736443028785288, c = 0.0003840850280450466, d = 0.0003851558649790691, m = 0.00045034548766295597
[Iteration 5240] [Rank 1] a = 0.9837629795074463, b = 0.9999792858857952, delta = 0.0005873185582458973, c = 0.0009585717715846787, d = 0.0009588481165999104, m = 0.0004512917824748864
[Iteration 5250] [Rank 1] a = 0.9791321754455566, b = 0.9999147765965054, delta = 0.0005977100227028131, c = 0.0008295531925984166, d = 0.0008302440551364956, m = 0.0004520680858175689
[Iteration 5260] [Rank 1] a = 1.060776948928833, b = 0.9997911467481466, delta = 0.0005893480847589672, c = 0.0005822934902199254, d = 0.0005830188958849084, m = 0.0004534116786416483

[Iteration 5010] [Rank 2] a = 1.0702214241027832, b = 0.9996370498719289, delta = 0.0008572288788855076, c = 0.0002740997119828622, d = 0.0002750323764092689, m = 0.0002134900009802752
[Iteration 5020] [Rank 2] a = 0.9243577718734741, b = 0.9999257440392277, delta = 0.0008416565251536667, c = 0.0008514880781824263, d = 0.0008521443975936014, m = 0.00021385468929324483
[Iteration 5030] [Rank 2] a = 1.079931378364563, b = 0.9996314020714356, delta = 0.0008456610958091915, c = 0.00026280410948526975, d = 0.00026332225638882903, m = 0.00021571301149949144
[Iteration 5040] [Rank 2] a = 1.0109407901763916, b = 0.9996740110133261, delta = 0.0008609552169218659, c = 0.0003480220035573203, d = 0.0003493000992527665, m = 0.00021604803770289632
[Iteration 5050] [Rank 2] a = 1.0344812870025635, b = 0.9996724393012197, delta = 0.0008439920493401587, c = 0.0003448785790090606, d = 0.00034594941594308316, m = 0.00021735140003979208
[Iteration 5270] [Rank 3] a = 0.9421467781066895, b = 1.0001489444524798, delta = 0.0006004702881909907, c = 0.001297888907162203, d = 0.0012959544920555816, m = 0.0002914099603291879
[Iteration 5280] [Rank 3] a = 1.0386393070220947, b = 0.9997288309508219, delta = 0.0006541566690430045, c = 0.0004576618883504652, d = 0.00045845638026925607, m = 0.0002922245318777928
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5281 |     0.10934s |  92.9%
- batch.accumulate               |   5281 |     0.00082s |   0.7%
- batch.backward                 |   5281 |     0.05172s |  43.9%
- batch.evaluate                 |   5281 |     0.00277s |   2.4%
- batch.forward                  |   5281 |     0.02537s |  21.6%
- batch.mom                      |   5281 |     0.00126s |   1.1%
- batch.reduce                   |   5281 |     0.02462s |  20.9%
[Iteration 5270] [Rank 1] a = 1.1332752704620361, b = 0.9997265165614909, delta = 0.000639796897303313, c = 0.00045303310934533556, d = 0.00045375851501031853, m = 0.00045420762808750587
[Iteration 5280] [Rank 1] a = 1.0043400526046753, b = 0.9998272270428802, delta = 0.0006060304585844278, c = 0.0006544540823222819, d = 0.000655870350525344, m = 0.00045482368742097456
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5281 |     0.10928s |  92.8%
- batch.accumulate               |   5281 |     0.00083s |   0.7%
- batch.backward                 |   5281 |     0.05173s |  43.9%
- batch.evaluate                 |   5281 |     0.00276s |   2.3%
- batch.forward                  |   5281 |     0.02540s |  21.6%
- batch.mom                      |   5281 |     0.00126s |   1.1%
- batch.reduce                   |   5281 |     0.02454s |  20.8%
[Iteration 5060] [Rank 2] a = 1.060373067855835, b = 0.9996597619750596, delta = 0.0008593297679908574, c = 0.00031952392386155957, d = 0.0003204565882879663, m = 0.00021783824756589057
[Iteration 5070] [Rank 2] a = 1.0850787162780762, b = 0.9996174984648182, delta = 0.0008924025460146368, c = 0.00023499689232758808, d = 0.000235791384246379, m = 0.00021829435383376535
[Iteration 5080] [Rank 2] a = 0.9136892557144165, b = 1.004544629693358, delta = 0.0007386147044599056, c = 0.010089321962979509, d = 0.008980833020631677, m = 0.00022119706609548088
[Iteration 5090] [Rank 2] a = 0.9622446894645691, b = 0.999729124567379, delta = 0.000814958824776113, c = 0.00045824912150783237, d = 0.0004595963034570865, m = 0.00022226329562175879
[Iteration 5100] [Rank 2] a = 1.114111304283142, b = 0.9995942336724633, delta = 0.000849603267852217, c = 0.00018846730038796423, d = 0.0001891236197991393, m = 0.00022472034254691702
- batch.reporting.compr_err      |   5281 |     0.00001s |   0.0%
- batch.reporting.lr             |   5281 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   5281 |     0.00001s |   0.0%
- batch.step                     |   5281 |     0.00047s |   0.4%
- batch.update_runavg            |   5281 |     0.00129s |   1.1%
- batch.reporting.compr_err      |   5281 |     0.00001s |   0.0%
- batch.reporting.lr             |   5281 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5281 |     0.00001s |   0.0%
- batch.step                     |   5281 |     0.00048s |   0.4%
- batch.update_runavg            |   5281 |     0.00129s |   1.1%
[Iteration 5110] [Rank 2] a = 1.0206443071365356, b = 0.9997263956605559, delta = 0.0007378538721241057, c = 0.0004527913074570079, d = 0.000454173032533166, m = 0.00022577007236099166
[Iteration 5120] [Rank 2] a = 1.0039846897125244, b = 0.999661782747751, delta = 0.00080248957965523, c = 0.000323565469709322, d = 0.0003246017635164406, m = 0.0002263342707066675
[Iteration 5130] [Rank 2] a = 0.9979881644248962, b = 0.9996590538410401, delta = 0.0008131782524287701, c = 0.00031810765565849753, d = 0.0003189366907041924, m = 0.00022713115775449986
[Iteration 5140] [Rank 2] a = 0.9825311303138733, b = 0.9997341333204194, delta = 0.000754071690607816, c = 0.00046826662830997854, d = 0.00046899203397496157, m = 0.00022988964969209433
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5142 |     0.10907s |  92.7%
- batch.accumulate               |   5142 |     0.00083s |   0.7%
- batch.wd                       |   5281 |     0.00001s |   0.0%
- epoch_metrics.collect          |     37 |     0.01232s |   0.1%
- reduce.combine                 |   5281 |     0.00572s |   4.9%
- reduce.flatpack                |   5281 |     0.00002s |   0.0%
- reduce.flatput                 |   5281 |     0.00015s |   0.1%
- reduce.gather.context          |   5281 |     0.00271s |   2.3%
- reduce.gather.tensors          |   5281 |     0.00255s |   2.2%
- reduce.heur_params             |   5281 |     0.01032s |   8.8%
- reduce.heur_params.alpha       |   5280 |     0.00812s |   6.9%
- reduce.heur_params.beta        |   5280 |     0.00213s |   1.8%
- reduce.memory                  |   5281 |     0.00043s |   0.4%
- reduce.pad                     |   5281 |     0.00027s |   0.2%
- reduce.threshold               |   5281 |     0.00224s |   1.9%
- test.last                      |     37 |     0.41524s |   2.6%
- test.runavg                    |     37 |     0.44638s |   2.8%
- batch.wd                       |   5281 |     0.00001s |   0.0%
- epoch_metrics.collect          |     37 |     0.01225s |   0.1%
- reduce.combine                 |   5281 |     0.00573s |   4.9%
- reduce.flatpack                |   5281 |     0.00002s |   0.0%
- reduce.flatput                 |   5281 |     0.00021s |   0.2%
- reduce.gather.context          |   5281 |     0.00164s |   1.4%
- reduce.gather.tensors          |   5281 |     0.00283s |   2.4%
- reduce.heur_params             |   5281 |     0.01074s |   9.1%
- reduce.heur_params.alpha       |   5280 |     0.00824s |   7.0%
- reduce.heur_params.beta        |   5280 |     0.00242s |   2.1%
- reduce.memory                  |   5281 |     0.00045s |   0.4%
- reduce.pad                     |   5281 |     0.00016s |   0.1%
- reduce.threshold               |   5281 |     0.00257s |   2.2%
- test.last                      |     37 |     0.41524s |   2.6%
- test.runavg                    |     37 |     0.44638s |   2.8%
- batch.backward                 |   5142 |     0.05210s |  44.3%
- batch.evaluate                 |   5142 |     0.00275s |   2.3%
- batch.forward                  |   5142 |     0.02573s |  21.9%
- batch.mom                      |   5142 |     0.00126s |   1.1%
- batch.reduce                   |   5142 |     0.02360s |  20.1%
- batch.reporting.compr_err      |   5142 |     0.00001s |   0.0%
- batch.reporting.lr             |   5142 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   5142 |     0.00001s |   0.0%
- batch.step                     |   5142 |     0.00048s |   0.4%
- batch.update_runavg            |   5142 |     0.00130s |   1.1%
- batch.wd                       |   5142 |     0.00001s |   0.0%
- epoch_metrics.collect          |     36 |     0.01624s |   0.1%
- reduce.combine                 |   5142 |     0.00590s |   5.0%
- reduce.flatpack                |   5142 |     0.00002s |   0.0%
- reduce.flatput                 |   5142 |     0.00014s |   0.1%
-----------------------------------------------------------------
-----------------------------------------------------------------
- reduce.gather.context          |   5142 |     0.00122s |   1.0%
- reduce.gather.tensors          |   5142 |     0.00273s |   2.3%
- reduce.heur_params             |   5142 |     0.01049s |   8.9%
- reduce.heur_params.alpha       |   5141 |     0.00834s |   7.1%
- reduce.heur_params.beta        |   5141 |     0.00207s |   1.8%
- reduce.memory                  |   5142 |     0.00044s |   0.4%
- reduce.pad                     |   5142 |     0.00029s |   0.2%
- reduce.threshold               |   5142 |     0.00216s |   1.8%
- test.last                      |     36 |     0.41543s |   2.6%
- test.runavg                    |     36 |     0.44665s |   2.8%
-----------------------------------------------------------------

[Iteration 5150] [Rank 2] a = 1.0551893711090088, b = 0.9996629399423705, delta = 0.0007944946410134435, c = 0.0003258798592118868, d = 0.0003266743511306777, m = 0.0002306544772527738
[Iteration 5160] [Rank 2] a = 1.0654544830322266, b = 0.9997033035820991, delta = 0.0007511200965382159, c = 0.00040660714678642353, d = 0.00040785069935496583, m = 0.0002315319175172246
[Iteration 5170] [Rank 2] a = 0.9932995438575745, b = 0.999643768509243, delta = 0.0008138415869325399, c = 0.0002875369883484997, d = 0.0002882278508865787, m = 0.00023197608218550203
[Iteration 5180] [Rank 2] a = 0.8980132341384888, b = 1.0005099719002082, delta = 0.0007046590326353908, c = 0.0020199438888355197, d = 0.001993069336104245, m = 0.00023292015100401697
[Iteration 5190] [Rank 2] a = 1.0808008909225464, b = 0.9996434230780178, delta = 0.0007753492100164294, c = 0.0002868461258104206, d = 0.0002875369883484997, m = 0.0002335536204626161
[Iteration 5200] [Rank 2] a = 1.0018095970153809, b = 0.9996833721997508, delta = 0.0007714683306403458, c = 0.0003667443783392625, d = 0.00036736615462353364, m = 0.00023421438855416598
[Iteration 5210] [Rank 2] a = 1.0294737815856934, b = 0.999646514687486, delta = 0.0008275157888419926, c = 0.0002930293455262281, d = 0.0002937547511912111, m = 0.00023463484244040493
[Iteration 5220] [Rank 2] a = 0.8910157084465027, b = 1.001389905392581, delta = 0.0006987489759922028, c = 0.003779812575211182, d = 0.00364467986276292, m = 0.00023590136516929146
[Iteration 5230] [Rank 2] a = 0.9688156247138977, b = 0.999958041862771, delta = 0.0007346254424192011, c = 0.0009160837254928173, d = 0.0009168782174116082, m = 0.00023639656583022804
[Iteration 5240] [Rank 2] a = 0.9986432194709778, b = 0.9996778798431329, delta = 0.0008050957694649696, c = 0.00035575966398380563, d = 0.00035710684593305976, m = 0.00023705560600896305
[Iteration 5250] [Rank 2] a = 1.011080265045166, b = 0.9998296105185664, delta = 0.0007044725934974849, c = 0.0006592210338350273, d = 0.0006611209058147447, m = 0.00023819655553360895
[Iteration 5260] [Rank 2] a = 1.1098829507827759, b = 0.9996238543992538, delta = 0.0008271049009636045, c = 0.00024770876302824255, d = 0.0002484341686932256, m = 0.00023867131321855423
[Iteration 5270] [Rank 2] a = 1.0715490579605103, b = 0.9996402623823116, delta = 0.0007966553675942123, c = 0.00028052473358699734, d = 0.0002809737942367487, m = 0.00023931857107283458
[Iteration 5280] [Rank 2] a = 0.9908215999603271, b = 0.9997273455964746, delta = 0.0007782121538184583, c = 0.00045469117943672526, d = 0.00045634924952811496, m = 0.0002398922309819492
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5281 |     0.10916s |  92.7%
- batch.accumulate               |   5281 |     0.00083s |   0.7%
- batch.backward                 |   5281 |     0.05209s |  44.2%
- batch.evaluate                 |   5281 |     0.00275s |   2.3%
- batch.forward                  |   5281 |     0.02571s |  21.8%
- batch.mom                      |   5281 |     0.00126s |   1.1%
- batch.reduce                   |   5281 |     0.02371s |  20.1%
- batch.reporting.compr_err      |   5281 |     0.00001s |   0.0%
- batch.reporting.lr             |   5281 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5281 |     0.00001s |   0.0%
- batch.step                     |   5281 |     0.00048s |   0.4%
- batch.update_runavg            |   5281 |     0.00130s |   1.1%
- batch.wd                       |   5281 |     0.00001s |   0.0%
- epoch_metrics.collect          |     37 |     0.01605s |   0.1%
- reduce.combine                 |   5281 |     0.00591s |   5.0%
- reduce.flatpack                |   5281 |     0.00002s |   0.0%
- reduce.flatput                 |   5281 |     0.00014s |   0.1%
- reduce.gather.context          |   5281 |     0.00126s |   1.1%
- reduce.gather.tensors          |   5281 |     0.00278s |   2.4%
- reduce.heur_params             |   5281 |     0.01049s |   8.9%
- reduce.heur_params.alpha       |   5280 |     0.00833s |   7.1%
- reduce.heur_params.beta        |   5280 |     0.00209s |   1.8%
- reduce.memory                  |   5281 |     0.00044s |   0.4%
- reduce.pad                     |   5281 |     0.00029s |   0.2%
- reduce.threshold               |   5281 |     0.00218s |   1.8%
- test.last                      |     37 |     0.41524s |   2.6%
- test.runavg                    |     37 |     0.44638s |   2.8%
-----------------------------------------------------------------
[Iteration 5280] [Rank 0] a = 0.9681258201599121, b = 0.9995705025484204, delta = 0.0011758439941331744, c = 0.00014100504402193365, d = 0.00014159227717930084, m = 0.00018090556069582528
cross_entropy                  - bits:9046577856.000, epoch: 38.000, ratio_transmit_grad:  0.164, value:  5.841 (split:train)
last_cross_entropy             - bits:9046577856.000, epoch: 38.000, ratio_transmit_grad:  0.164, value:  5.841 (split:train)
perplexity                     - bits:9046577856.000, epoch: 38.000, ratio_transmit_grad:  0.164, value:344.935 (split:train)
last_perplexity                - bits:9046577856.000, epoch: 38.000, ratio_transmit_grad:  0.164, value:344.935 (split:train)
last_cross_entropy             - bits:9046577856.000, epoch: 38.000, ratio_transmit_grad:  0.164, value:  5.559 (split:test)
last_perplexity                - bits:9046577856.000, epoch: 38.000, ratio_transmit_grad:  0.164, value:260.320 (split:test)
runavg_cross_entropy           - bits:9046577856.000, epoch: 38.000, ratio_transmit_grad:  0.164, value:  5.703 (split:test)
runavg_perplexity              - bits:9046577856.000, epoch: 38.000, ratio_transmit_grad:  0.164, value:300.596 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5281 |     0.10919s |  92.7%
- batch.accumulate               |   5281 |     0.00083s |   0.7%
- batch.backward                 |   5281 |     0.05176s |  44.0%
- batch.evaluate                 |   5281 |     0.00275s |   2.3%
- batch.forward                  |   5281 |     0.02549s |  21.7%
- batch.mom                      |   5281 |     0.00126s |   1.1%
- batch.reduce                   |   5281 |     0.02426s |  20.6%
- batch.reporting.compr_err      |   5281 |     0.00001s |   0.0%
- batch.reporting.lr             |   5281 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5281 |     0.00001s |   0.0%
- batch.step                     |   5281 |     0.00048s |   0.4%
- batch.update_runavg            |   5281 |     0.00130s |   1.1%
- batch.wd                       |   5281 |     0.00001s |   0.0%
- epoch_metrics.collect          |     37 |     0.01028s |   0.1%
- reduce.combine                 |   5281 |     0.00600s |   5.1%
- reduce.flatpack                |   5281 |     0.00002s |   0.0%
- reduce.flatput                 |   5281 |     0.00014s |   0.1%
- reduce.gather.context          |   5281 |     0.00135s |   1.1%
- reduce.gather.tensors          |   5281 |     0.00284s |   2.4%
- reduce.heur_params             |   5281 |     0.01084s |   9.2%
- reduce.heur_params.alpha       |   5280 |     0.00873s |   7.4%
- reduce.heur_params.beta        |   5280 |     0.00204s |   1.7%
- reduce.memory                  |   5281 |     0.00044s |   0.4%
- reduce.pad                     |   5281 |     0.00029s |   0.2%
- reduce.threshold               |   5281 |     0.00212s |   1.8%
- test.last                      |     37 |     0.41523s |   2.6%
- test.runavg                    |     37 |     0.44639s |   2.8%
-----------------------------------------------------------------

[Iteration 5290] [Rank 0] a = 0.9651110768318176, b = 1.0028085505818143, delta = 0.0009464544127695262, c = 0.0066171159328480235, d = 0.005959725684738905, m = 0.00018318382760738064
[Iteration 5300] [Rank 0] a = 1.0097476243972778, b = 0.9996078263907361, delta = 0.0010666685411706567, c = 0.00021565274126137475, d = 0.0002164126900532617, m = 0.00018339781468303468
[Iteration 5310] [Rank 0] a = 0.9996243715286255, b = 0.9996397442354752, delta = 0.0010297480039298534, c = 0.00027948843977987874, d = 0.00028059381984080526, m = 0.00018373670663823799
[Iteration 5320] [Rank 0] a = 0.9581707715988159, b = 0.9996921634246906, delta = 0.001032710773870349, c = 0.00038432682993337424, d = 0.0003861230725323798, m = 0.00018411105568288285
[Iteration 5330] [Rank 0] a = 0.9507136940956116, b = 0.9997809565261765, delta = 0.0009946045465767384, c = 0.0005619130453465935, d = 0.0005640547192146385, m = 0.00018487730986334653
[Iteration 5340] [Rank 0] a = 0.9016703963279724, b = 1.0001821576680845, delta = 0.0009845527820289135, c = 0.0013643153401985035, d = 0.001360342880604549, m = 0.00018519100024669952
[Iteration 5350] [Rank 0] a = 0.9406015872955322, b = 0.999705825230143, delta = 0.001035030814819038, c = 0.0004116504433144006, d = 0.0004133085134057903, m = 0.0001854313139374553
[Iteration 5360] [Rank 0] a = 1.0094287395477295, b = 0.9996368771563172, delta = 0.0009845594177022576, c = 0.00027375428071382265, d = 0.00027461785888642146, m = 0.0001889044471705931
[Iteration 5370] [Rank 0] a = 0.925925612449646, b = 0.9997345478379129, delta = 0.0009507185313850641, c = 0.0004690956633556734, d = 0.0004702355865435038, m = 0.00018940043430762466
[Iteration 5380] [Rank 0] a = 1.0743157863616943, b = 0.999583749835219, delta = 0.0010357085848227143, c = 0.00016749962235726513, d = 0.00016781051049940068, m = 0.0001924497679237224
[Iteration 5390] [Rank 0] a = 0.9778293967247009, b = 0.9997770531530271, delta = 0.0008958844118751585, c = 0.0005541062986663002, d = 0.0005574224388490797, m = 0.0001930009272071318
[Iteration 5400] [Rank 0] a = 1.0557711124420166, b = 0.9995760467192789, delta = 0.0010146735003218055, c = 0.00015209338775810236, d = 0.0001526460777885656, m = 0.00019343404049508627
[Iteration 5410] [Rank 0] a = 1.1074174642562866, b = 0.9995921092705103, delta = 0.0009820153936743736, c = 0.00018421849577877807, d = 0.00018473664268233738, m = 0.0001939516011202758
[Iteration 5420] [Rank 0] a = 1.0283247232437134, b = 0.9997237012968608, delta = 0.0009564677020534873, c = 0.0004474025796599913, d = 0.00044840433034020594, m = 0.00019427447729043328
cross_entropy                  - bits:9513232640.000, epoch: 39.000, ratio_transmit_grad:  0.181, value:  5.818 (split:train)
last_cross_entropy             - bits:9513232640.000, epoch: 39.000, ratio_transmit_grad:  0.181, value:  5.818 (split:train)
perplexity                     - bits:9513232640.000, epoch: 39.000, ratio_transmit_grad:  0.181, value:337.039 (split:train)
last_perplexity                - bits:9513232640.000, epoch: 39.000, ratio_transmit_grad:  0.181, value:337.039 (split:train)
last_cross_entropy             - bits:9513232640.000, epoch: 39.000, ratio_transmit_grad:  0.181, value:  5.524 (split:test)
last_perplexity                - bits:9513232640.000, epoch: 39.000, ratio_transmit_grad:  0.181, value:251.338 (split:test)
runavg_cross_entropy           - bits:9513232640.000, epoch: 39.000, ratio_transmit_grad:  0.181, value:  5.676 (split:test)
runavg_perplexity              - bits:9513232640.000, epoch: 39.000, ratio_transmit_grad:  0.181, value:292.558 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5420 |     0.10928s |  92.7%
- batch.accumulate               |   5420 |     0.00083s |   0.7%
- batch.backward                 |   5420 |     0.05175s |  43.9%
- batch.evaluate                 |   5420 |     0.00275s |   2.3%
- batch.forward                  |   5420 |     0.02549s |  21.6%
- batch.mom                      |   5420 |     0.00126s |   1.1%
- batch.reduce                   |   5420 |     0.02436s |  20.7%
- batch.reporting.compr_err      |   5420 |     0.00001s |   0.0%
- batch.reporting.lr             |   5420 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5420 |     0.00001s |   0.0%
- batch.step                     |   5420 |     0.00048s |   0.4%
- batch.update_runavg            |   5420 |     0.00130s |   1.1%
- batch.wd                       |   5420 |     0.00001s |   0.0%
- epoch_metrics.collect          |     38 |     0.01004s |   0.1%
- reduce.combine                 |   5420 |     0.00602s |   5.1%
- reduce.flatpack                |   5420 |     0.00002s |   0.0%
- reduce.flatput                 |   5420 |     0.00014s |   0.1%
- reduce.gather.context          |   5420 |     0.00134s |   1.1%
- reduce.gather.tensors          |   5420 |     0.00290s |   2.5%
- reduce.heur_params             |   5420 |     0.01086s |   9.2%
- reduce.heur_params.alpha       |   5419 |     0.00873s |   7.4%
- reduce.heur_params.beta        |   5419 |     0.00205s |   1.7%
- reduce.memory                  |   5420 |     0.00044s |   0.4%
- reduce.pad                     |   5420 |     0.00029s |   0.2%
- reduce.threshold               |   5420 |     0.00213s |   1.8%
- test.last                      |     38 |     0.41510s |   2.6%
- test.runavg                    |     38 |     0.44610s |   2.8%
-----------------------------------------------------------------

[Iteration 5290] [Rank 3] a = 0.9897767901420593, b = 0.9999031010197088, delta = 0.0006167442188598216, c = 0.0008062020388113448, d = 0.0008073074188722712, m = 0.00029337058539714443
[Iteration 5300] [Rank 3] a = 1.0136897563934326, b = 0.9997919239684682, delta = 0.000653215276543051, c = 0.0005838479309306032, d = 0.0005849187678646258, m = 0.00029398408731802874
[Iteration 5310] [Rank 3] a = 0.9163430333137512, b = 1.0001359735085906, delta = 0.0006211891304701567, c = 0.0012719470188573348, d = 0.0012681472748979, m = 0.00029481131168698245
[Iteration 5320] [Rank 3] a = 1.1212831735610962, b = 0.9997310589823447, delta = 0.000638252473436296, c = 0.000462117951721075, d = 0.00046301607302057777, m = 0.00029654543464880154
[Iteration 5330] [Rank 3] a = 1.0275115966796875, b = 0.9997447207880964, delta = 0.0006629581330344081, c = 0.0004894415651021014, d = 0.0004902360570208923, m = 0.0002975593549040092

[Iteration 5290] [Rank 1] a = 0.9725832343101501, b = 0.999931547284518, delta = 0.0006077538128010929, c = 0.0008630945688221543, d = 0.0008636127157257137, m = 0.00045617662529480045
[Iteration 5300] [Rank 1] a = 0.9453094005584717, b = 1.000056161614658, delta = 0.0005849956069141626, c = 0.0011123232294341708, d = 0.0011112869356270521, m = 0.00045698009655991496
[Iteration 5310] [Rank 1] a = 1.046575665473938, b = 0.9997577608176953, delta = 0.0006243056268431246, c = 0.0005155216259145854, d = 0.0005164888334678961, m = 0.00045767870788090644
[Iteration 5320] [Rank 1] a = 1.053735613822937, b = 0.999720644230366, delta = 0.0006740078097209334, c = 0.0004412884461979917, d = 0.0004420483949898787, m = 0.0004585510379150721
[Iteration 5330] [Rank 1] a = 1.0877987146377563, b = 0.9996858593046403, delta = 0.0006534897838719189, c = 0.00037171858861343164, d = 0.0003726857961667423, m = 0.00045919536084529963
[Iteration 5340] [Rank 3] a = 1.0819635391235352, b = 0.9998093337037353, delta = 0.0006395186064764857, c = 0.0006186674028497872, d = 0.0006193928085147703, m = 0.00029874187067363767
[Iteration 5350] [Rank 3] a = 0.9419568777084351, b = 1.0001202218429812, delta = 0.0006078662700019777, c = 0.0012404436871209302, d = 0.0012380947544914614, m = 0.0002995530580898308
[Iteration 5360] [Rank 3] a = 1.0219794511795044, b = 0.9997943419872481, delta = 0.0006451812805607915, c = 0.0005886839686971566, d = 0.000589789348758083, m = 0.00030013363152846397
[Iteration 5370] [Rank 3] a = 1.0559018850326538, b = 0.9998372963640894, delta = 0.0006136989104561508, c = 0.0006745927253072861, d = 0.000675490846606789, m = 0.00030157531898111523
[Iteration 5380] [Rank 3] a = 1.0180351734161377, b = 0.999916952813485, delta = 0.0006204251549206674, c = 0.0008339056265883146, d = 0.000834354687238066, m = 0.0003024846679130964
[Iteration 5340] [Rank 1] a = 0.9070495367050171, b = 1.000069305274393, delta = 0.0005995915271341801, c = 0.0011386105490080786, d = 0.0011373669964395362, m = 0.0004600850553949505
[Iteration 5350] [Rank 1] a = 1.0799378156661987, b = 0.9997093486287861, delta = 0.000667845772113651, c = 0.00041869724120280685, d = 0.0004195953625023096, m = 0.0004605004606047774
[Iteration 5360] [Rank 1] a = 1.0126229524612427, b = 0.9998315967483064, delta = 0.0006453485693782568, c = 0.0006631934934289819, d = 0.0006642988734899083, m = 0.0004610713355693751
[Iteration 5370] [Rank 1] a = 0.9473061561584473, b = 1.000241813645549, delta = 0.0005897300434298813, c = 0.001483627300524755, d = 0.0014792057802810491, m = 0.00046285868344664484
[Iteration 5380] [Rank 1] a = 0.9460347890853882, b = 0.9999640523668432, delta = 0.0006246384582482278, c = 0.0009281047336553927, d = 0.000928553794305144, m = 0.00046358914484400147
[Iteration 5390] [Rank 3] a = 1.1058902740478516, b = 0.9997012655377923, delta = 0.0006406619213521481, c = 0.00040253105781175714, d = 0.00040339463598435595, m = 0.00030370999578521
[Iteration 5400] [Rank 3] a = 0.9580941200256348, b = 1.0007990286603043, delta = 0.000559355306904763, c = 0.002598057660700067, d = 0.0024704898930437706, m = 0.0003058291441862752
[Iteration 5410] [Rank 3] a = 1.0148309469223022, b = 0.9997620268936221, delta = 0.0006467654020525515, c = 0.0005240537782598616, d = 0.000525331873955308, m = 0.0003064975070605896
[Iteration 5420] [Rank 3] a = 1.0228008031845093, b = 0.9999656240791154, delta = 0.0006319466046988964, c = 0.0009312481582036524, d = 0.000931455416965076, m = 0.00030731363898960383
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5420 |     0.10943s |  92.9%
- batch.accumulate               |   5420 |     0.00082s |   0.7%
[Iteration 5390] [Rank 1] a = 0.9445355534553528, b = 1.0002013291028107, delta = 0.0006088344962336123, c = 0.0014026582110618906, d = 0.0013984784927065124, m = 0.00046422786334091704
[Iteration 5400] [Rank 1] a = 0.9877290725708008, b = 0.9999213743337, delta = 0.0006206262041814625, c = 0.0008427486670757264, d = 0.0008434395296138055, m = 0.0004649577152579901
[Iteration 5410] [Rank 1] a = 1.0455282926559448, b = 0.9997688318892477, delta = 0.0006358415121212602, c = 0.0005376637702600189, d = 0.0005385618915595216, m = 0.00046637953045647367
[Iteration 5420] [Rank 1] a = 1.0545836687088013, b = 0.999863497325258, delta = 0.0006716774660162628, c = 0.0007269946488205819, d = 0.0007273746232165254, m = 0.0004669200517097479
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5420 |     0.10937s |  92.8%
- batch.accumulate               |   5420 |     0.00083s |   0.7%
- batch.backward                 |   5420 |     0.05172s |  43.9%
- batch.evaluate                 |   5420 |     0.00277s |   2.4%
- batch.forward                  |   5420 |     0.02537s |  21.5%
- batch.mom                      |   5420 |     0.00126s |   1.1%
- batch.reduce                   |   5420 |     0.02470s |  21.0%
- batch.reporting.compr_err      |   5420 |     0.00001s |   0.0%
- batch.reporting.lr             |   5420 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   5420 |     0.00001s |   0.0%
- batch.step                     |   5420 |     0.00047s |   0.4%
- batch.update_runavg            |   5420 |     0.00129s |   1.1%
- batch.wd                       |   5420 |     0.00001s |   0.0%
- epoch_metrics.collect          |     38 |     0.01204s |   0.1%
- reduce.combine                 |   5420 |     0.00574s |   4.9%
- reduce.flatpack                |   5420 |     0.00002s |   0.0%
- reduce.flatput                 |   5420 |     0.00016s |   0.1%
- batch.backward                 |   5420 |     0.05173s |  43.9%
- batch.evaluate                 |   5420 |     0.00276s |   2.3%
- batch.forward                  |   5420 |     0.02539s |  21.6%
- batch.mom                      |   5420 |     0.00126s |   1.1%
- batch.reduce                   |   5420 |     0.02462s |  20.9%
- batch.reporting.compr_err      |   5420 |     0.00001s |   0.0%
- batch.reporting.lr             |   5420 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5420 |     0.00001s |   0.0%
- batch.step                     |   5420 |     0.00048s |   0.4%
- batch.update_runavg            |   5420 |     0.00129s |   1.1%
- batch.wd                       |   5420 |     0.00001s |   0.0%
- epoch_metrics.collect          |     38 |     0.01194s |   0.1%
- reduce.combine                 |   5420 |     0.00575s |   4.9%
- reduce.flatpack                |   5420 |     0.00002s |   0.0%
- reduce.flatput                 |   5420 |     0.00021s |   0.2%
- reduce.gather.context          |   5420 |     0.00270s |   2.3%
- reduce.gather.tensors          |   5420 |     0.00260s |   2.2%
- reduce.heur_params             |   5420 |     0.01033s |   8.8%
- reduce.gather.context          |   5420 |     0.00162s |   1.4%
- reduce.gather.tensors          |   5420 |     0.00288s |   2.4%
- reduce.heur_params             |   5420 |     0.01075s |   9.1%
- reduce.heur_params.alpha       |   5419 |     0.00811s |   6.9%
- reduce.heur_params.beta        |   5419 |     0.00214s |   1.8%
- reduce.memory                  |   5420 |     0.00043s |   0.4%
- reduce.pad                     |   5420 |     0.00027s |   0.2%
- reduce.threshold               |   5420 |     0.00225s |   1.9%
- test.last                      |     38 |     0.41511s |   2.6%
- test.runavg                    |     38 |     0.44609s |   2.8%
-----------------------------------------------------------------

[Iteration 5430] [Rank 3] a = 1.0125203132629395, b = 0.9997419746096884, delta = 0.0006817723042331636, c = 0.00048394920792437293, d = 0.0004850545879852994, m = 0.0003077622403850701
[Iteration 5440] [Rank 3] a = 1.0479779243469238, b = 0.9997416809931293, delta = 0.0006524689379148185, c = 0.00048336197476700574, d = 0.0004840528373050848, m = 0.00030896188507307387
- reduce.heur_params.alpha       |   5419 |     0.00824s |   7.0%
- reduce.heur_params.beta        |   5419 |     0.00243s |   2.1%
- reduce.memory                  |   5420 |     0.00046s |   0.4%
- reduce.pad                     |   5420 |     0.00016s |   0.1%
- reduce.threshold               |   5420 |     0.00257s |   2.2%
- test.last                      |     38 |     0.41511s |   2.6%
- test.runavg                    |     38 |     0.44609s |   2.8%
-----------------------------------------------------------------

[Iteration 5430] [Rank 1] a = 1.0034950971603394, b = 0.9998038068036376, delta = 0.0006645785761065781, c = 0.0006076136022405224, d = 0.0006085117235400253, m = 0.00046741709381703446
[Iteration 5440] [Rank 1] a = 1.0770407915115356, b = 0.9996810232673584, delta = 0.0006959718302823603, c = 0.00036204651308032495, d = 0.00036291009125292376, m = 0.00046840741647065175
[Iteration 5450] [Rank 3] a = 1.0368236303329468, b = 0.9997451180340298, delta = 0.0006649972056038678, c = 0.0004902360570208923, d = 0.0004910650920665872, m = 0.0003096951970539968
[Iteration 5460] [Rank 3] a = 1.1300392150878906, b = 0.999648656361088, delta = 0.0007117942441254854, c = 0.0002973126932623182, d = 0.0002978308401658775, m = 0.0003103818490719358
[Iteration 5470] [Rank 3] a = 1.0426090955734253, b = 0.9997184334704181, delta = 0.0006923113251104951, c = 0.00043686692595428585, d = 0.00043735052973094117, m = 0.0003110888849936942
[Iteration 5480] [Rank 3] a = 1.1209115982055664, b = 0.9997155491195526, delta = 0.0006454793619923294, c = 0.0004310982237613258, d = 0.00043192725880702065, m = 0.0003130362632976922
[Iteration 5490] [Rank 3] a = 0.9524281620979309, b = 0.9999935349256404, delta = 0.0006371145718730986, c = 0.0009870698512804395, d = 0.0009871389375342473, m = 0.0003135607711035667
[Iteration 5450] [Rank 1] a = 1.029388427734375, b = 0.9997999207020134, delta = 0.00064095389097929, c = 0.0005998413986871332, d = 0.0006008086062404439, m = 0.00046988556093085685
[Iteration 5460] [Rank 1] a = 0.9574598073959351, b = 0.9999192672029722, delta = 0.0006377825047820807, c = 0.0008385344055934442, d = 0.0008391907250046192, m = 0.0004706317287168448
[Iteration 5470] [Rank 1] a = 1.0485485792160034, b = 0.9997355323169606, delta = 0.0006625789683312178, c = 0.0004710646215891987, d = 0.00047213545852322123, m = 0.00047149392617167144
[Iteration 5480] [Rank 1] a = 0.9559433460235596, b = 0.9999300792016317, delta = 0.000649512279778719, c = 0.0008601584030353184, d = 0.0008609183518272053, m = 0.00047200214511993756
[Iteration 5490] [Rank 1] a = 0.9621304869651794, b = 0.9998566232431388, delta = 0.0006602791254408658, c = 0.0007132464843128089, d = 0.0007140409762315998, m = 0.0004724583622130509

[Iteration 5290] [Rank 2] a = 1.0530933141708374, b = 0.999639139730833, delta = 0.0008115447126328945, c = 0.00027827943033824045, d = 0.0002791084653839353, m = 0.00024060777075381705
[Iteration 5300] [Rank 2] a = 1.119603157043457, b = 0.9996517306990063, delta = 0.0008280896581709385, c = 0.00030346136985122174, d = 0.00030415223238930075, m = 0.00024139619393136712
[Iteration 5310] [Rank 2] a = 1.0763550996780396, b = 0.9996754790960642, delta = 0.000782431976404041, c = 0.0003509581693441562, d = 0.00035189083377056295, m = 0.0002421348317782816
[Iteration 5320] [Rank 2] a = 0.988292396068573, b = 0.9997670183751829, delta = 0.0007794703706167638, c = 0.0005340367419351038, d = 0.0005356257257726857, m = 0.0002425614281330863
[Iteration 5330] [Rank 2] a = 1.047793984413147, b = 0.9996646498269589, delta = 0.0007877710158936679, c = 0.0003292996287753781, d = 0.00033026683632868877, m = 0.00024446182573335215
[Iteration 5500] [Rank 3] a = 1.003556728363037, b = 0.9997784694211601, delta = 0.0006471574888564646, c = 0.0005569388350724243, d = 0.0005575951544835994, m = 0.00031505174120231914
[Iteration 5510] [Rank 3] a = 1.0798313617706299, b = 0.9997329761257502, delta = 0.0006419030833058059, c = 0.00046595223880741373, d = 0.0004666431013454928, m = 0.00031595986419076955
[Iteration 5520] [Rank 3] a = 0.9870451092720032, b = 1.0000079221379956, delta = 0.0006279026856645942, c = 0.0010158442759914319, d = 0.001015637017230008, m = 0.00031668889729704
[Iteration 5530] [Rank 3] a = 1.0354121923446655, b = 0.9997471215352611, delta = 0.0006456863484345376, c = 0.0004942430597417507, d = 0.0004952102672950615, m = 0.00031762220949847016
[Iteration 5540] [Rank 3] a = 0.9550207853317261, b = 1.0001082008349755, delta = 0.0006287295836955309, c = 0.0012164016707957794, d = 0.0012142945400546383, m = 0.0003183009999172604
[Iteration 5500] [Rank 1] a = 0.9298024773597717, b = 0.9998786617577166, delta = 0.0006618392653763294, c = 0.0007573235142422521, d = 0.0007582561786686589, m = 0.00047293244337445766
[Iteration 5510] [Rank 1] a = 0.972000002861023, b = 0.9999402003377716, delta = 0.0006376611418090761, c = 0.0008804006754010345, d = 0.0008809533654314977, m = 0.0004738633482282174
[Iteration 5520] [Rank 1] a = 0.9421516060829163, b = 1.0000884594381416, delta = 0.0006275627529248595, c = 0.0011769188767445618, d = 0.001176055298571963, m = 0.00047523312171843376
[Iteration 5530] [Rank 1] a = 1.1020437479019165, b = 0.9996733201508617, delta = 0.0006949190865270793, c = 0.0003466402784811622, d = 0.0003477456585420887, m = 0.0004757010449239855
[Iteration 5540] [Rank 1] a = 0.9676742553710938, b = 1.0003100881306493, delta = 0.0006169279222376645, c = 0.0016201762811760788, d = 0.001608466161155639, m = 0.00047639496707554003
[Iteration 5340] [Rank 2] a = 1.011483907699585, b = 0.9996968785610729, delta = 0.0008091715280897915, c = 0.0003937571035781533, d = 0.0003946206817507521, m = 0.00024498085847140773
[Iteration 5350] [Rank 2] a = 0.9751901626586914, b = 0.9998205256764686, delta = 0.000742220610845834, c = 0.0006410513490835484, d = 0.00064281304855565, m = 0.0002459132563508346
[Iteration 5360] [Rank 2] a = 1.0834153890609741, b = 0.999705859773267, delta = 0.0007048584520816803, c = 0.0004117195295682085, d = 0.0004127212802484231, m = 0.0002492328681594648
[Iteration 5370] [Rank 2] a = 1.0594642162322998, b = 0.9996345627671216, delta = 0.0008146347827278078, c = 0.00026912550170869303, d = 0.00026988545050058, m = 0.00024964174392944646
[Iteration 5380] [Rank 2] a = 1.0831187963485718, b = 0.9997062397476301, delta = 0.0007274698582477868, c = 0.00041247947836009545, d = 0.0004133085134057903, m = 0.00025059713591788515
[Iteration 5550] [Rank 3] a = 0.842884361743927, b = 1.0007463676947932, delta = 0.0006069545052014291, c = 0.002492735666769916, d = 0.002454150994018201, m = 0.0003192748101061619
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5559 |     0.10948s |  92.9%
- batch.accumulate               |   5559 |     0.00082s |   0.7%
- batch.backward                 |   5559 |     0.05172s |  43.9%
- batch.evaluate                 |   5559 |     0.00277s |   2.4%
- batch.forward                  |   5559 |     0.02537s |  21.5%
- batch.mom                      |   5559 |     0.00126s |   1.1%
- batch.reduce                   |   5559 |     0.02475s |  21.0%
- batch.reporting.compr_err      |   5559 |     0.00001s |   0.0%
- batch.reporting.lr             |   5559 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   5559 |     0.00001s |   0.0%
[Iteration 5550] [Rank 1] a = 0.9047117829322815, b = 1.0002227112974023, delta = 0.0006308421725407243, c = 0.0014454226021689838, d = 0.001439308468706984, m = 0.000476904065318215
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5559 |     0.10941s |  92.8%
- batch.accumulate               |   5559 |     0.00083s |   0.7%
- batch.backward                 |   5559 |     0.05174s |  43.9%
- batch.evaluate                 |   5559 |     0.00276s |   2.3%
- batch.forward                  |   5559 |     0.02540s |  21.5%
- batch.mom                      |   5559 |     0.00126s |   1.1%
- batch.reduce                   |   5559 |     0.02466s |  20.9%
- batch.reporting.compr_err      |   5559 |     0.00001s |   0.0%
- batch.reporting.lr             |   5559 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5559 |     0.00001s |   0.0%
[Iteration 5390] [Rank 2] a = 0.9791305065155029, b = 0.9997941692716208, delta = 0.0007205589790828526, c = 0.0005883385374281171, d = 0.0005902384094078344, m = 0.0002512175527479348
[Iteration 5400] [Rank 2] a = 1.1101086139678955, b = 0.9996779662009414, delta = 0.0007223664433695376, c = 0.0003559323796183254, d = 0.00035641598339498074, m = 0.0002527966183351759
[Iteration 5410] [Rank 2] a = 0.956525981426239, b = 1.0003408833250191, delta = 0.0006697715725749731, c = 0.001681766676445826, d = 0.0016697802114101544, m = 0.0002535005109961289
[Iteration 5420] [Rank 2] a = 0.9219582676887512, b = 1.0001369925308154, delta = 0.0006808660109527409, c = 0.0012739850633446679, d = 0.0012709452681771202, m = 0.0002542885245869504
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5420 |     0.10925s |  92.7%
- batch.accumulate               |   5420 |     0.00083s |   0.7%
- batch.step                     |   5559 |     0.00047s |   0.4%
- batch.update_runavg            |   5559 |     0.00129s |   1.1%
- batch.wd                       |   5559 |     0.00001s |   0.0%
- epoch_metrics.collect          |     39 |     0.01177s |   0.1%
- reduce.combine                 |   5559 |     0.00576s |   4.9%
- batch.step                     |   5559 |     0.00048s |   0.4%
- batch.update_runavg            |   5559 |     0.00129s |   1.1%
- batch.wd                       |   5559 |     0.00001s |   0.0%
- epoch_metrics.collect          |     39 |     0.01167s |   0.1%
- reduce.combine                 |   5559 |     0.00578s |   4.9%
- batch.backward                 |   5420 |     0.05207s |  44.2%
- batch.evaluate                 |   5420 |     0.00275s |   2.3%
- batch.forward                  |   5420 |     0.02570s |  21.8%
- batch.mom                      |   5420 |     0.00126s |   1.1%
- batch.reduce                   |   5420 |     0.02384s |  20.2%
- batch.reporting.compr_err      |   5420 |     0.00001s |   0.0%
- batch.reporting.lr             |   5420 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5420 |     0.00001s |   0.0%
- batch.step                     |   5420 |     0.00048s |   0.4%
- batch.update_runavg            |   5420 |     0.00130s |   1.1%
- batch.wd                       |   5420 |     0.00001s |   0.0%
- epoch_metrics.collect          |     38 |     0.01569s |   0.1%
- reduce.combine                 |   5420 |     0.00592s |   5.0%
- reduce.flatpack                |   5420 |     0.00002s |   0.0%
- reduce.flatput                 |   5420 |     0.00015s |   0.1%
- reduce.flatpack                |   5559 |     0.00002s |   0.0%
- reduce.flatput                 |   5559 |     0.00016s |   0.1%
- reduce.gather.context          |   5559 |     0.00269s |   2.3%
- reduce.gather.tensors          |   5559 |     0.00262s |   2.2%
- reduce.heur_params             |   5559 |     0.01034s |   8.8%
- reduce.heur_params.alpha       |   5558 |     0.00811s |   6.9%
- reduce.heur_params.beta        |   5558 |     0.00215s |   1.8%
- reduce.memory                  |   5559 |     0.00043s |   0.4%
- reduce.pad                     |   5559 |     0.00027s |   0.2%
- reduce.threshold               |   5559 |     0.00226s |   1.9%
- test.last                      |     39 |     0.41488s |   2.6%
- test.runavg                    |     39 |     0.44589s |   2.8%
-----------------------------------------------------------------
- reduce.flatpack                |   5559 |     0.00002s |   0.0%
- reduce.flatput                 |   5559 |     0.00021s |   0.2%
- reduce.gather.context          |   5559 |     0.00160s |   1.4%
- reduce.gather.tensors          |   5559 |     0.00290s |   2.5%
- reduce.heur_params             |   5559 |     0.01076s |   9.1%
- reduce.heur_params.alpha       |   5558 |     0.00825s |   7.0%
- reduce.heur_params.beta        |   5558 |     0.00243s |   2.1%
- reduce.memory                  |   5559 |     0.00046s |   0.4%
- reduce.pad                     |   5559 |     0.00016s |   0.1%
- reduce.threshold               |   5559 |     0.00258s |   2.2%
- test.last                      |     39 |     0.41488s |   2.6%
- test.runavg                    |     39 |     0.44589s |   2.8%
-----------------------------------------------------------------
- reduce.gather.context          |   5420 |     0.00130s |   1.1%
- reduce.gather.tensors          |   5420 |     0.00283s |   2.4%
- reduce.heur_params             |   5420 |     0.01050s |   8.9%
- reduce.heur_params.alpha       |   5419 |     0.00832s |   7.1%
- reduce.heur_params.beta        |   5419 |     0.00210s |   1.8%
- reduce.memory                  |   5420 |     0.00044s |   0.4%
- reduce.pad                     |   5420 |     0.00029s |   0.2%
- reduce.threshold               |   5420 |     0.00219s |   1.9%
- test.last                      |     38 |     0.41511s |   2.6%
- test.runavg                    |     38 |     0.44609s |   2.8%
-----------------------------------------------------------------

[Iteration 5430] [Rank 2] a = 0.8165026307106018, b = 1.0079636749530134, delta = 0.0006214926252141595, c = 0.016927686623647346, d = 0.014949436288984898, m = 0.0002575417493636962
[Iteration 5440] [Rank 2] a = 1.0442906618118286, b = 0.9996714375506475, delta = 0.0007297544507309794, c = 0.00034287507764863137, d = 0.0003438077420750381, m = 0.0002580852999558576
[Iteration 5450] [Rank 2] a = 0.997840404510498, b = 0.9998306813554696, delta = 0.000693762965966016, c = 0.0006613627077030724, d = 0.0006628826052868463, m = 0.0002589505261557796
[Iteration 5460] [Rank 2] a = 1.1755908727645874, b = 0.9995966689625114, delta = 0.0007986982818692923, c = 0.0001933378812814215, d = 0.00019375239880426893, m = 0.00025969730912759394
[Iteration 5470] [Rank 2] a = 1.0207009315490723, b = 0.9997388139137897, delta = 0.0007358424481935799, c = 0.00047762781570094966, d = 0.00047887136826949196, m = 0.00026015191585629106
[Iteration 5480] [Rank 2] a = 1.1017016172409058, b = 0.9996973621648052, delta = 0.0007035964517854154, c = 0.0003947243111314639, d = 0.00039555334617715876, m = 0.0002616691462392161
[Iteration 5490] [Rank 2] a = 1.060657262802124, b = 0.9997473287940094, delta = 0.0006729900487698615, c = 0.0004946575772645982, d = 0.0004958320435793325, m = 0.00026279900759564783
[Iteration 5500] [Rank 2] a = 1.0102134943008423, b = 0.999794652875377, delta = 0.000682649202644825, c = 0.0005893057449814277, d = 0.0005907565563113938, m = 0.0002634382436815118
[Iteration 5510] [Rank 2] a = 0.9656357765197754, b = 0.9999495269820073, delta = 0.0006758138770237565, c = 0.0008990539639291687, d = 0.0008997102833403439, m = 0.0002641521814951345
[Iteration 5520] [Rank 2] a = 0.9395197033882141, b = 0.9998391962360194, delta = 0.0007000654004514217, c = 0.000678392469266721, d = 0.0006793251336931277, m = 0.00026491830401744127
[Iteration 5530] [Rank 2] a = 0.9603947401046753, b = 0.999914327535859, delta = 0.0006890015210956335, c = 0.0008286550712989138, d = 0.0008295877357253205, m = 0.00026589852039043813
[Iteration 5540] [Rank 2] a = 1.0638333559036255, b = 0.9997401092809605, delta = 0.000677321688272059, c = 0.0004802185502187461, d = 0.0004814275596603844, m = 0.00026714875085495025
[Iteration 5550] [Rank 2] a = 1.0090049505233765, b = 0.9997014727965353, delta = 0.0007291149813681841, c = 0.0004029455753346046, d = 0.00040377461038029945, m = 0.00026773793958461003
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5559 |     0.10931s |  92.7%
- batch.accumulate               |   5559 |     0.00083s |   0.7%
- batch.backward                 |   5559 |     0.05205s |  44.2%
- batch.evaluate                 |   5559 |     0.00275s |   2.3%
- batch.forward                  |   5559 |     0.02569s |  21.8%
- batch.mom                      |   5559 |     0.00126s |   1.1%
- batch.reduce                   |   5559 |     0.02393s |  20.3%
- batch.reporting.compr_err      |   5559 |     0.00001s |   0.0%
- batch.reporting.lr             |   5559 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5559 |     0.00001s |   0.0%
- batch.step                     |   5559 |     0.00048s |   0.4%
- batch.update_runavg            |   5559 |     0.00130s |   1.1%
- batch.wd                       |   5559 |     0.00001s |   0.0%
- epoch_metrics.collect          |     39 |     0.01536s |   0.1%
- reduce.combine                 |   5559 |     0.00593s |   5.0%
- reduce.flatpack                |   5559 |     0.00002s |   0.0%
- reduce.flatput                 |   5559 |     0.00015s |   0.1%
- reduce.gather.context          |   5559 |     0.00133s |   1.1%
- reduce.gather.tensors          |   5559 |     0.00285s |   2.4%
- reduce.heur_params             |   5559 |     0.01050s |   8.9%
- reduce.heur_params.alpha       |   5558 |     0.00832s |   7.1%
- reduce.heur_params.beta        |   5558 |     0.00211s |   1.8%
- reduce.memory                  |   5559 |     0.00044s |   0.4%
- reduce.pad                     |   5559 |     0.00029s |   0.2%
- reduce.threshold               |   5559 |     0.00220s |   1.9%
- test.last                      |     39 |     0.41488s |   2.6%
- test.runavg                    |     39 |     0.44589s |   2.8%
-----------------------------------------------------------------

[Iteration 5430] [Rank 0] a = 1.03538978099823, b = 0.9996512643668498, delta = 0.0009216060861945152, c = 0.000302528705424815, d = 0.00030366862861264544, m = 0.00019487321546416398
[Iteration 5440] [Rank 0] a = 1.0438435077667236, b = 0.9995762367064428, delta = 0.0010405408684164286, c = 0.00015247336215404582, d = 0.00015295696593070116, m = 0.00019518968111320394
[Iteration 5450] [Rank 0] a = 1.0230932235717773, b = 0.9996440103111006, delta = 0.0009306126739829779, c = 0.000288020592125155, d = 0.00028905688593227355, m = 0.00019626809026413215
[Iteration 5460] [Rank 0] a = 1.1237151622772217, b = 0.9995634039371729, delta = 0.0010440718615427613, c = 0.00012680781886440922, d = 0.00012701507762583292, m = 0.00019705867132948244
[Iteration 5470] [Rank 0] a = 0.9993245005607605, b = 0.9996979148547852, delta = 0.000899624836165458, c = 0.00039582969119239037, d = 0.00039755684753758804, m = 0.0001976270819655362
[Iteration 5480] [Rank 0] a = 1.0912721157073975, b = 0.9995867896298638, delta = 0.0010316509287804365, c = 0.00017357921269236075, d = 0.00017406281646901607, m = 0.0001979536459539378
[Iteration 5490] [Rank 0] a = 1.0583043098449707, b = 0.999608793598141, delta = 0.0009832094656303525, c = 0.0002175871563679961, d = 0.0002184507345405949, m = 0.00019838553737722728
timer                          - epoch: 39.547, value:  0.028 (event:batch.reduce)
[Iteration 5500] [Rank 0] a = 1.0697332620620728, b = 0.9996077227613714, delta = 0.0009886216139420867, c = 0.00021544548249995103, d = 0.00021606725878422218, m = 0.0001994141686380135
[Iteration 5510] [Rank 0] a = 0.9049212336540222, b = 0.9999845882557734, delta = 0.0009008515044115484, c = 0.0009691765115441921, d = 0.0009693492271787119, m = 0.00019982853545347796
[Iteration 5520] [Rank 0] a = 1.0171881914138794, b = 0.9996784152615447, delta = 0.0009402802679687738, c = 0.00035683050091782814, d = 0.0003579013378518507, m = 0.00020013250370707456
[Iteration 5530] [Rank 0] a = 0.932580828666687, b = 1.0002158026723535, delta = 0.0008852402097545564, c = 0.0014316053514074028, d = 0.001423418630331166, m = 0.00020071188645689255
[Iteration 5540] [Rank 0] a = 0.9438745975494385, b = 0.9997551700833314, delta = 0.0009250661823898554, c = 0.0005103401568789925, d = 0.0005126200032546534, m = 0.0002010502811502076
[Iteration 5550] [Rank 0] a = 1.1725224256515503, b = 0.9995514347460454, delta = 0.001065142103470862, c = 0.0001028694319199702, d = 0.00010311123380829787, m = 0.00020140781783908445
cross_entropy                  - bits:9887694272.000, epoch: 40.000, ratio_transmit_grad:  0.145, value:  5.791 (split:train)
last_cross_entropy             - bits:9887694272.000, epoch: 40.000, ratio_transmit_grad:  0.145, value:  5.791 (split:train)
perplexity                     - bits:9887694272.000, epoch: 40.000, ratio_transmit_grad:  0.145, value:328.053 (split:train)
last_perplexity                - bits:9887694272.000, epoch: 40.000, ratio_transmit_grad:  0.145, value:328.053 (split:train)
last_cross_entropy             - bits:9887694272.000, epoch: 40.000, ratio_transmit_grad:  0.145, value:  5.517 (split:test)
last_perplexity                - bits:9887694272.000, epoch: 40.000, ratio_transmit_grad:  0.145, value:249.589 (split:test)
runavg_cross_entropy           - bits:9887694272.000, epoch: 40.000, ratio_transmit_grad:  0.145, value:  5.667 (split:test)
runavg_perplexity              - bits:9887694272.000, epoch: 40.000, ratio_transmit_grad:  0.145, value:290.064 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5559 |     0.10933s |  92.8%
- batch.accumulate               |   5559 |     0.00083s |   0.7%
- batch.backward                 |   5559 |     0.05175s |  43.9%
- batch.evaluate                 |   5559 |     0.00275s |   2.3%
- batch.forward                  |   5559 |     0.02549s |  21.6%
- batch.mom                      |   5559 |     0.00126s |   1.1%
- batch.reduce                   |   5559 |     0.02442s |  20.7%
- batch.reporting.compr_err      |   5559 |     0.00001s |   0.0%
- batch.reporting.lr             |   5559 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5559 |     0.00001s |   0.0%
- batch.step                     |   5559 |     0.00048s |   0.4%
- batch.update_runavg            |   5559 |     0.00130s |   1.1%
- batch.wd                       |   5559 |     0.00001s |   0.0%
- epoch_metrics.collect          |     39 |     0.00980s |   0.1%
- reduce.combine                 |   5559 |     0.00604s |   5.1%
- reduce.flatpack                |   5559 |     0.00002s |   0.0%
- reduce.flatput                 |   5559 |     0.00014s |   0.1%
- reduce.gather.context          |   5559 |     0.00132s |   1.1%
- reduce.gather.tensors          |   5559 |     0.00292s |   2.5%
- reduce.heur_params             |   5559 |     0.01087s |   9.2%
- reduce.heur_params.alpha       |   5558 |     0.00873s |   7.4%
- reduce.heur_params.beta        |   5558 |     0.00206s |   1.8%
- reduce.memory                  |   5559 |     0.00044s |   0.4%
- reduce.pad                     |   5559 |     0.00029s |   0.2%
- reduce.threshold               |   5559 |     0.00215s |   1.8%
- test.last                      |     39 |     0.41487s |   2.6%
- test.runavg                    |     39 |     0.44590s |   2.8%
-----------------------------------------------------------------

[Iteration 5560] [Rank 0] a = 1.0010080337524414, b = 0.9997227513609439, delta = 0.0009368007304146886, c = 0.00044550270768027394, d = 0.00044695351901023994, m = 0.00020197358846730544
[Iteration 5570] [Rank 0] a = 0.9313709735870361, b = 0.999870975912101, delta = 0.0008474139031022787, c = 0.0007419518227699933, d = 0.0007431608322116316, m = 0.00020490785702717467
[Iteration 5580] [Rank 0] a = 1.061529278755188, b = 0.9996333537578419, delta = 0.0008968012989498675, c = 0.0002667074828254164, d = 0.00026764014725182307, m = 0.00020537736484872938
[Iteration 5590] [Rank 0] a = 1.0193482637405396, b = 0.9996602283072189, delta = 0.0009283755789510906, c = 0.0003204565882879663, d = 0.00032100927831842953, m = 0.0002056646495597817
[Iteration 5600] [Rank 0] a = 1.1301723718643188, b = 0.9996053047428625, delta = 0.0009056167327798903, c = 0.0002106094447333977, d = 0.00021092033287553328, m = 0.0002082507307435885
[Iteration 5610] [Rank 0] a = 1.0475472211837769, b = 0.9996351500002008, delta = 0.0008776868926361203, c = 0.0002702999680234274, d = 0.0002709908305615065, m = 0.00020911789085952738
[Iteration 5620] [Rank 0] a = 0.9772259593009949, b = 0.9997942210863091, delta = 0.0008349777781404555, c = 0.0005884421668088289, d = 0.0005903420387885463, m = 0.0002098987572304745
learning_rate                  - epoch: 40.453, value: 10.000 (weight:encoder.weight)
effective_lr                   - epoch: 40.453, value:  0.000 (weight:encoder.weight)
grad_norm                      - epoch: 40.453, value:  0.092 (weight:encoder.weight)
learning_rate                  - epoch: 40.453, value: 10.000 (weight:rnn.weight_ih_l0)
effective_lr                   - epoch: 40.453, value:  0.001 (weight:rnn.weight_ih_l0)
grad_norm                      - epoch: 40.453, value:  0.050 (weight:rnn.weight_ih_l0)
learning_rate                  - epoch: 40.453, value: 10.000 (weight:rnn.weight_hh_l0)
effective_lr                   - epoch: 40.453, value:  0.000 (weight:rnn.weight_hh_l0)
grad_norm                      - epoch: 40.453, value:  0.043 (weight:rnn.weight_hh_l0)
learning_rate                  - epoch: 40.453, value: 10.000 (weight:rnn.bias_ih_l0)
effective_lr                   - epoch: 40.453, value:  0.013 (weight:rnn.bias_ih_l0)
grad_norm                      - epoch: 40.453, value:  0.006 (weight:rnn.bias_ih_l0)
learning_rate                  - epoch: 40.453, value: 10.000 (weight:rnn.bias_hh_l0)
effective_lr                   - epoch: 40.453, value:  0.013 (weight:rnn.bias_hh_l0)
grad_norm                      - epoch: 40.453, value:  0.006 (weight:rnn.bias_hh_l0)
learning_rate                  - epoch: 40.453, value: 10.000 (weight:rnn.weight_ih_l1)
effective_lr                   - epoch: 40.453, value:  0.000 (weight:rnn.weight_ih_l1)
grad_norm                      - epoch: 40.453, value:  0.038 (weight:rnn.weight_ih_l1)
learning_rate                  - epoch: 40.453, value: 10.000 (weight:rnn.weight_hh_l1)
effective_lr                   - epoch: 40.453, value:  0.000 (weight:rnn.weight_hh_l1)
grad_norm                      - epoch: 40.453, value:  0.018 (weight:rnn.weight_hh_l1)
learning_rate                  - epoch: 40.453, value: 10.000 (weight:rnn.bias_ih_l1)
effective_lr                   - epoch: 40.453, value:  0.001 (weight:rnn.bias_ih_l1)
grad_norm                      - epoch: 40.453, value:  0.004 (weight:rnn.bias_ih_l1)
learning_rate                  - epoch: 40.453, value: 10.000 (weight:rnn.bias_hh_l1)
effective_lr                   - epoch: 40.453, value:  0.001 (weight:rnn.bias_hh_l1)
grad_norm                      - epoch: 40.453, value:  0.004 (weight:rnn.bias_hh_l1)
learning_rate                  - epoch: 40.453, value: 10.000 (weight:rnn.weight_ih_l2)
effective_lr                   - epoch: 40.453, value:  0.000 (weight:rnn.weight_ih_l2)
grad_norm                      - epoch: 40.453, value:  0.044 (weight:rnn.weight_ih_l2)
learning_rate                  - epoch: 40.453, value: 10.000 (weight:rnn.weight_hh_l2)
effective_lr                   - epoch: 40.453, value:  0.000 (weight:rnn.weight_hh_l2)
grad_norm                      - epoch: 40.453, value:  0.022 (weight:rnn.weight_hh_l2)
learning_rate                  - epoch: 40.453, value: 10.000 (weight:rnn.bias_ih_l2)
effective_lr                   - epoch: 40.453, value:  0.001 (weight:rnn.bias_ih_l2)
grad_norm                      - epoch: 40.453, value:  0.010 (weight:rnn.bias_ih_l2)
learning_rate                  - epoch: 40.453, value: 10.000 (weight:rnn.bias_hh_l2)
effective_lr                   - epoch: 40.453, value:  0.001 (weight:rnn.bias_hh_l2)
grad_norm                      - epoch: 40.453, value:  0.010 (weight:rnn.bias_hh_l2)
learning_rate                  - epoch: 40.453, value: 10.000 (weight:decoder.bias)
effective_lr                   - epoch: 40.453, value:  0.000 (weight:decoder.bias)
grad_norm                      - epoch: 40.453, value:  0.050 (weight:decoder.bias)
grad_norm                      - epoch: 40.453, value:  0.141 (weight:entire_model)
[Iteration 5630] [Rank 0] a = 1.0043952465057373, b = 0.9996929924596578, delta = 0.0008350983844138682, c = 0.00038598490002476394, d = 0.00038691756445117067, m = 0.00021353434765733316
[Iteration 5640] [Rank 0] a = 1.0303984880447388, b = 0.9996702458128983, delta = 0.0008711362024769187, c = 0.0003404916018922587, d = 0.0003413551800648575, m = 0.00021397748227489262
[Iteration 5650] [Rank 0] a = 1.0051798820495605, b = 0.9996486736326494, delta = 0.0008759407792240381, c = 0.00029734723638922216, d = 0.00029827990081562883, m = 0.00021462782327431838
[Iteration 5660] [Rank 0] a = 1.0884144306182861, b = 0.9996217299972515, delta = 0.0008295817533507943, c = 0.00024345995841905643, d = 0.00024408173470332755, m = 0.00021681840246533026
[Iteration 5670] [Rank 0] a = 1.0334337949752808, b = 0.999687292844266, delta = 0.0007975685875862837, c = 0.0003745856681464597, d = 0.000375829220715002, m = 0.00021735198169216618
[Iteration 5680] [Rank 0] a = 0.9872412085533142, b = 0.9996619209202429, delta = 0.0008685372886247933, c = 0.0003238418147245536, d = 0.00032477447915096034, m = 0.0002177155697278074
[Iteration 5690] [Rank 0] a = 0.82000732421875, b = 1.0000653328148172, delta = 0.0007629198953509331, c = 0.0011306656298201694, d = 0.0011294911635054351, m = 0.00021856918025811502
cross_entropy                  - bits:10398949376.000, epoch: 41.000, ratio_transmit_grad:  0.199, value:  5.767 (split:train)
last_cross_entropy             - bits:10398949376.000, epoch: 41.000, ratio_transmit_grad:  0.199, value:  5.767 (split:train)
perplexity                     - bits:10398949376.000, epoch: 41.000, ratio_transmit_grad:  0.199, value:320.472 (split:train)
last_perplexity                - bits:10398949376.000, epoch: 41.000, ratio_transmit_grad:  0.199, value:320.472 (split:train)
last_cross_entropy             - bits:10398949376.000, epoch: 41.000, ratio_transmit_grad:  0.199, value:  5.472 (split:test)
last_perplexity                - bits:10398949376.000, epoch: 41.000, ratio_transmit_grad:  0.199, value:238.583 (split:test)
runavg_cross_entropy           - bits:10398949376.000, epoch: 41.000, ratio_transmit_grad:  0.199, value:  5.633 (split:test)
runavg_perplexity              - bits:10398949376.000, epoch: 41.000, ratio_transmit_grad:  0.199, value:280.162 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5698 |     0.10943s |  92.8%
- batch.accumulate               |   5698 |     0.00083s |   0.7%
- batch.backward                 |   5698 |     0.05174s |  43.9%
- batch.evaluate                 |   5698 |     0.00275s |   2.3%
- batch.forward                  |   5698 |     0.02548s |  21.6%
- batch.mom                      |   5698 |     0.00126s |   1.1%
- batch.reduce                   |   5698 |     0.02453s |  20.8%
- batch.reporting.compr_err      |   5698 |     0.00001s |   0.0%
- batch.reporting.lr             |   5698 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5698 |     0.00001s |   0.0%
- batch.step                     |   5698 |     0.00048s |   0.4%
- batch.update_runavg            |   5698 |     0.00130s |   1.1%
- batch.wd                       |   5698 |     0.00001s |   0.0%
- epoch_metrics.collect          |     40 |     0.00957s |   0.1%
- reduce.combine                 |   5698 |     0.00606s |   5.1%
- reduce.flatpack                |   5698 |     0.00002s |   0.0%
- reduce.flatput                 |   5698 |     0.00015s |   0.1%
- reduce.gather.context          |   5698 |     0.00131s |   1.1%
- reduce.gather.tensors          |   5698 |     0.00299s |   2.5%
- reduce.heur_params             |   5698 |     0.01088s |   9.2%
- reduce.heur_params.alpha       |   5697 |     0.00873s |   7.4%
- reduce.heur_params.beta        |   5697 |     0.00208s |   1.8%
- reduce.memory                  |   5698 |     0.00044s |   0.4%
- reduce.pad                     |   5698 |     0.00029s |   0.2%
- reduce.threshold               |   5698 |     0.00216s |   1.8%
- test.last                      |     40 |     0.41493s |   2.6%
- test.runavg                    |     40 |     0.44567s |   2.8%
-----------------------------------------------------------------

[Iteration 5700] [Rank 0] a = 0.8419904708862305, b = 0.99997097826378, delta = 0.0007409847457893193, c = 0.0009419565275438776, d = 0.0009422674156860132, m = 0.00022187833250611453
[Iteration 5710] [Rank 0] a = 1.0727812051773071, b = 0.9996445284579386, delta = 0.0008262545452453196, c = 0.00028905688593227355, d = 0.0002895750328358329, m = 0.00022250950658787158
[Iteration 5720] [Rank 0] a = 1.017634630203247, b = 0.9997333388285566, delta = 0.0007717004045844078, c = 0.00046667764447239676, d = 0.0004677139382795153, m = 0.000223097591175851
[Iteration 5730] [Rank 0] a = 1.0703227519989014, b = 0.9995882404409469, delta = 0.0008867194410413504, c = 0.00017648083535229275, d = 0.00017710261163656388, m = 0.00022436881420939933
timer                          - epoch: 42.000, value:  0.052 (event:batch.backward)
[Iteration 5740] [Rank 0] a = 1.1220104694366455, b = 0.9996171530335995, delta = 0.0008442729595117271, c = 0.00023430602978950904, d = 0.0002348241766930683, m = 0.0002251396341056259
[Iteration 5750] [Rank 0] a = 1.0725733041763306, b = 0.9996397960501588, delta = 0.0008072785567492247, c = 0.0002795920691605906, d = 0.0002802483885717657, m = 0.0002258053632851707
[Iteration 5760] [Rank 0] a = 0.8979878425598145, b = 1.000698801833891, delta = 0.0007028902764432132, c = 0.002397603895276431, d = 0.0023563594017531123, m = 0.0002268281533443193
[Iteration 5770] [Rank 0] a = 1.012450098991394, b = 0.9996881564223544, delta = 0.0008225280907936394, c = 0.0003763128244916573, d = 0.0003774872908063917, m = 0.00022715488424362342

[Iteration 5560] [Rank 3] a = 1.004806399345398, b = 0.9997703863298759, delta = 0.0006838836707174778, c = 0.0005407726516813746, d = 0.0005414980573463577, m = 0.0003198602674494888
[Iteration 5570] [Rank 3] a = 1.6257319450378418, b = 0.9995277036228943, delta = 0.001026476500555873, c = 5.540717555393963e-05, d = 5.551080493465149e-05, m = 0.0003213052231943952
[Iteration 5580] [Rank 3] a = 0.9735819101333618, b = 0.9998492137425782, delta = 0.0006514888955280185, c = 0.0006984274828710133, d = 0.0006995674060588438, m = 0.0003220976436766409
[Iteration 5590] [Rank 3] a = 0.9472020864486694, b = 0.9998884374624978, delta = 0.0006575776496902108, c = 0.0007768749240698892, d = 0.0007775657866079682, m = 0.00032292220514113624
[Iteration 5600] [Rank 3] a = 0.9419087171554565, b = 1.0001113097163596, delta = 0.000626385968644172, c = 0.0012226194336384909, d = 0.001220235957882118, m = 0.00032396301478345774

[Iteration 5560] [Rank 1] a = 0.9108302593231201, b = 0.9999774551000703, delta = 0.0006532231927849352, c = 0.0009549102001328597, d = 0.0009551174588942835, m = 0.00047776682678474523
[Iteration 5570] [Rank 1] a = 1.0015323162078857, b = 1.000062880252817, delta = 0.0006283203838393092, c = 0.0011257605057998082, d = 0.001125138729515537, m = 0.0004786696403767098
[Iteration 5580] [Rank 1] a = 1.008023977279663, b = 0.9998435313983368, delta = 0.0006543432828038931, c = 0.000687062794119613, d = 0.0006880645447998276, m = 0.0004792029104905528
[Iteration 5590] [Rank 1] a = 0.9189442992210388, b = 1.0002601042300923, delta = 0.0006336844526231289, c = 0.0015202084719160406, d = 0.001514854287245928, m = 0.00047995987527021966
[Iteration 5600] [Rank 1] a = 1.0544447898864746, b = 0.9997410246737619, delta = 0.0006811006460338831, c = 0.0004820493359446556, d = 0.0004829129141172544, m = 0.00048054539320274985
[Iteration 5610] [Rank 3] a = 1.046470284461975, b = 0.9997492286658687, delta = 0.0006609524134546518, c = 0.0004984573212240329, d = 0.0004995281581580555, m = 0.00032488507133269406
[Iteration 5620] [Rank 3] a = 0.9736207723617554, b = 0.9999181100082285, delta = 0.000659297511447221, c = 0.0008362200160908793, d = 0.0008374635686594216, m = 0.0003254598415825505
[Iteration 5630] [Rank 3] a = 0.927573025226593, b = 1.0000203576636784, delta = 0.0006594444857910275, c = 0.0010407153273622775, d = 0.0010405771548546616, m = 0.0003264744353141856
[Iteration 5640] [Rank 3] a = 0.9550037384033203, b = 1.0002616068560104, delta = 0.0006170734413899481, c = 0.0015232137239566844, d = 0.0015175141080175324, m = 0.00032759825883461207
[Iteration 5650] [Rank 3] a = 1.033068060874939, b = 0.9997893505056267, delta = 0.0006621853681281209, c = 0.0005787010050219143, d = 0.0005798063850828408, m = 0.0003282141395895095
[Iteration 5610] [Rank 1] a = 0.9273839592933655, b = 0.9999262967292551, delta = 0.0006579345790669322, c = 0.0008525934582433528, d = 0.0008533879501621437, m = 0.000481574831213013
[Iteration 5620] [Rank 1] a = 0.9641302227973938, b = 0.9998503363941772, delta = 0.0006636102334596217, c = 0.0007006727861197702, d = 0.0007017781661806967, m = 0.0004823122840524601
[Iteration 5630] [Rank 1] a = 1.0213733911514282, b = 0.9998413206382698, delta = 0.0006144357612356544, c = 0.0006826412738759071, d = 0.0006838157401906415, m = 0.0004834383978312877
[Iteration 5640] [Rank 1] a = 1.0536922216415405, b = 0.9997692291351861, delta = 0.000644355546683073, c = 0.0005384582621788098, d = 0.0005393909266052165, m = 0.00048404145356586975
[Iteration 5650] [Rank 1] a = 0.92780601978302, b = 1.000025141886752, delta = 0.0006338570383377373, c = 0.0010502837735146724, d = 0.0010501801441339604, m = 0.00048472048363435496

[Iteration 5560] [Rank 2] a = 1.1232852935791016, b = 0.9996550641103521, delta = 0.0007879612385295331, c = 0.00031012819334368455, d = 0.00031054271086653195, m = 0.0002687571245107237
[Iteration 5570] [Rank 2] a = 1.0189220905303955, b = 0.9997847562699568, delta = 0.0007272767252288759, c = 0.000569512533265463, d = 0.000570237938930446, m = 0.00026926720231525207
[Iteration 5580] [Rank 2] a = 0.9023758172988892, b = 0.9998982995251168, delta = 0.0007217068923637271, c = 0.0007965990495320459, d = 0.0007972553689432211, m = 0.0002700289459053723
[Iteration 5590] [Rank 2] a = 1.0869771242141724, b = 0.9996718866112487, delta = 0.0007308470667339861, c = 0.00034377319894813413, d = 0.0003446713202476369, m = 0.0002716012386909755
[Iteration 5600] [Rank 2] a = 1.095961570739746, b = 0.9996529224367403, delta = 0.0007673937361687422, c = 0.0003058448456075944, d = 0.00030657025127257744, m = 0.0002721514080846352
[Iteration 5660] [Rank 3] a = 0.9611634016036987, b = 1.002445746627979, delta = 0.000579548766836524, c = 0.005891503009103599, d = 0.005525034975779568, m = 0.00033050376886261567
[Iteration 5670] [Rank 3] a = 1.0342087745666504, b = 0.9998073992886999, delta = 0.0006432142690755427, c = 0.0006147985726365446, d = 0.0006153858057939117, m = 0.00033112200866190815
[Iteration 5680] [Rank 3] a = 1.034824252128601, b = 0.9997335806304279, delta = 0.0006695655174553394, c = 0.0004671612482490521, d = 0.0004682320851830746, m = 0.00033174567860655733
[Iteration 5690] [Rank 3] a = 1.0720018148422241, b = 0.9997492113943063, delta = 0.0006388017791323364, c = 0.000498422778097129, d = 0.0004992863562697278, m = 0.00033300428960655014
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5698 |     0.10958s |  92.9%
- batch.accumulate               |   5698 |     0.00082s |   0.7%
[Iteration 5660] [Rank 1] a = 1.0718122720718384, b = 0.999748382359313, delta = 0.0006431139190681279, c = 0.0004967647080057392, d = 0.000497697372432146, m = 0.0004885265475089413
[Iteration 5670] [Rank 1] a = 0.974068820476532, b = 1.0000700134084912, delta = 0.000606403686106205, c = 0.0011400268172111407, d = 0.0011387832646425984, m = 0.0004892428157302543
[Iteration 5680] [Rank 1] a = 0.9201086163520813, b = 1.0001096689178517, delta = 0.0006150833214633167, c = 0.0012193378365826153, d = 0.0012181979133947848, m = 0.000489766566005643
[Iteration 5690] [Rank 1] a = 1.050658941268921, b = 0.9997876751640467, delta = 0.0006259196088649333, c = 0.0005753503217122309, d = 0.0005762484430117338, m = 0.0004905996854950736
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5698 |     0.10951s |  92.8%
- batch.accumulate               |   5698 |     0.00083s |   0.7%
[Iteration 5610] [Rank 2] a = 0.9732925891876221, b = 0.9997407310572032, delta = 0.0007292146910913289, c = 0.0004814621027872884, d = 0.00048229113783298323, m = 0.00027314804914447524
[Iteration 5620] [Rank 2] a = 0.9673665761947632, b = 1.0002514857204938, delta = 0.000668889784719795, c = 0.0015029714515909683, d = 0.001495199248037579, m = 0.000273990367407698
[Iteration 5630] [Rank 2] a = 0.9406237006187439, b = 0.9999019438249687, delta = 0.0006521667819470167, c = 0.0008038876493087799, d = 0.0008049239431158986, m = 0.00027665849824903165
[Iteration 5640] [Rank 2] a = 1.0167858600616455, b = 0.9997177771510591, delta = 0.0007136855274438858, c = 0.00043555428713193563, d = 0.00043672875344667, m = 0.0002772025126871444
[Iteration 5650] [Rank 2] a = 0.9696106314659119, b = 0.9997741688020758, delta = 0.0007100371294654906, c = 0.0005483375964733402, d = 0.0005497884078033062, m = 0.00027800910637769025
- batch.backward                 |   5698 |     0.05172s |  43.8%
- batch.evaluate                 |   5698 |     0.00277s |   2.4%
- batch.forward                  |   5698 |     0.02537s |  21.5%
- batch.mom                      |   5698 |     0.00126s |   1.1%
- batch.reduce                   |   5698 |     0.02485s |  21.1%
- batch.reporting.compr_err      |   5698 |     0.00001s |   0.0%
- batch.reporting.lr             |   5698 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   5698 |     0.00001s |   0.0%
- batch.step                     |   5698 |     0.00047s |   0.4%
- batch.update_runavg            |   5698 |     0.00129s |   1.1%
- batch.wd                       |   5698 |     0.00001s |   0.0%
- epoch_metrics.collect          |     40 |     0.01158s |   0.1%
- reduce.combine                 |   5698 |     0.00578s |   4.9%
- reduce.flatpack                |   5698 |     0.00002s |   0.0%
- reduce.flatput                 |   5698 |     0.00016s |   0.1%
- batch.backward                 |   5698 |     0.05174s |  43.9%
- batch.evaluate                 |   5698 |     0.00276s |   2.3%
- batch.forward                  |   5698 |     0.02540s |  21.5%
- batch.mom                      |   5698 |     0.00126s |   1.1%
- batch.reduce                   |   5698 |     0.02475s |  21.0%
- batch.reporting.compr_err      |   5698 |     0.00001s |   0.0%
- batch.reporting.lr             |   5698 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5698 |     0.00001s |   0.0%
- batch.step                     |   5698 |     0.00048s |   0.4%
- batch.update_runavg            |   5698 |     0.00129s |   1.1%
- batch.wd                       |   5698 |     0.00001s |   0.0%
- epoch_metrics.collect          |     40 |     0.01148s |   0.1%
- reduce.combine                 |   5698 |     0.00580s |   4.9%
- reduce.flatpack                |   5698 |     0.00002s |   0.0%
- reduce.flatput                 |   5698 |     0.00021s |   0.2%
[Iteration 5660] [Rank 2] a = 0.9893759489059448, b = 0.9998139279394505, delta = 0.0006649408023804426, c = 0.0006278558746062385, d = 0.0006291685134285888, m = 0.00027939645901765543
[Iteration 5670] [Rank 2] a = 0.9955583214759827, b = 0.9997837717908857, delta = 0.0006755911163054407, c = 0.0005675435750319378, d = 0.000568752584473576, m = 0.0002802805013146755
[Iteration 5680] [Rank 2] a = 0.9704740047454834, b = 0.9998506472823127, delta = 0.0006694496260024607, c = 0.0007012945624040414, d = 0.000702261769957352, m = 0.00028110449385174683
[Iteration 5690] [Rank 2] a = 1.1030617952346802, b = 0.9996950823186401, delta = 0.0006815057713538408, c = 0.0003901646183801422, d = 0.00039089002404512523, m = 0.0002822772676889317
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5698 |     0.10941s |  92.7%
- batch.accumulate               |   5698 |     0.00083s |   0.7%
- reduce.gather.context          |   5698 |     0.00269s |   2.3%
- reduce.gather.tensors          |   5698 |     0.00268s |   2.3%
- reduce.heur_params             |   5698 |     0.01034s |   8.8%
- reduce.gather.context          |   5698 |     0.00158s |   1.3%
- reduce.gather.tensors          |   5698 |     0.00297s |   2.5%
- reduce.heur_params             |   5698 |     0.01077s |   9.1%
- batch.backward                 |   5698 |     0.05203s |  44.1%
- batch.evaluate                 |   5698 |     0.00275s |   2.3%
- batch.forward                  |   5698 |     0.02568s |  21.8%
- batch.mom                      |   5698 |     0.00126s |   1.1%
- batch.reduce                   |   5698 |     0.02406s |  20.4%
- batch.reporting.compr_err      |   5698 |     0.00001s |   0.0%
- batch.reporting.lr             |   5698 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5698 |     0.00001s |   0.0%
- batch.step                     |   5698 |     0.00048s |   0.4%
- batch.update_runavg            |   5698 |     0.00130s |   1.1%
- batch.wd                       |   5698 |     0.00001s |   0.0%
- epoch_metrics.collect          |     40 |     0.01512s |   0.1%
- reduce.combine                 |   5698 |     0.00594s |   5.0%
- reduce.flatpack                |   5698 |     0.00002s |   0.0%
- reduce.flatput                 |   5698 |     0.00015s |   0.1%
- reduce.heur_params.alpha       |   5697 |     0.00811s |   6.9%
- reduce.heur_params.beta        |   5697 |     0.00216s |   1.8%
- reduce.memory                  |   5698 |     0.00044s |   0.4%
- reduce.pad                     |   5698 |     0.00027s |   0.2%
- reduce.threshold               |   5698 |     0.00227s |   1.9%
- test.last                      |     40 |     0.41493s |   2.6%
- test.runavg                    |     40 |     0.44566s |   2.8%
-----------------------------------------------------------------

[Iteration 5700] [Rank 3] a = 1.1571177244186401, b = 0.9996681041392648, delta = 0.0007139461231417954, c = 0.00033620825415616855, d = 0.00033676094418663184, m = 0.00033394731833989624
[Iteration 5710] [Rank 3] a = 0.9885554909706116, b = 0.9997813537721169, delta = 0.0006798650720156729, c = 0.0005627075372653844, d = 0.0005639510898339267, m = 0.00033500685375911993
- reduce.heur_params.alpha       |   5697 |     0.00825s |   7.0%
- reduce.heur_params.beta        |   5697 |     0.00244s |   2.1%
- reduce.memory                  |   5698 |     0.00046s |   0.4%
- reduce.pad                     |   5698 |     0.00017s |   0.1%
- reduce.threshold               |   5698 |     0.00258s |   2.2%
- test.last                      |     40 |     0.41493s |   2.6%
- test.runavg                    |     40 |     0.44566s |   2.8%
-----------------------------------------------------------------

[Iteration 5700] [Rank 1] a = 1.0668667554855347, b = 0.9997554464283299, delta = 0.0006508638616651297, c = 0.0005108928469094557, d = 0.0005116873388282467, m = 0.0004911368867536051
[Iteration 5710] [Rank 1] a = 0.9660435914993286, b = 1.0000990123633178, delta = 0.0005918349488638341, c = 0.0011980247272828767, d = 0.001196263027810775, m = 0.000492285569511835
- reduce.gather.context          |   5698 |     0.00137s |   1.2%
- reduce.gather.tensors          |   5698 |     0.00293s |   2.5%
- reduce.heur_params             |   5698 |     0.01050s |   8.9%
[Iteration 5720] [Rank 3] a = 1.134690523147583, b = 0.9996830267685164, delta = 0.0007095508044585586, c = 0.0003660535158011834, d = 0.0003667443783392625, m = 0.0003356997619388401
[Iteration 5730] [Rank 3] a = 1.0325366258621216, b = 0.999697517608862, delta = 0.0007070210995152593, c = 0.0003950351992735995, d = 0.00039600240682691017, m = 0.0003363455044689825
[Iteration 5740] [Rank 3] a = 1.0107356309890747, b = 0.9998002834048314, delta = 0.0006677932688035071, c = 0.0006005668043521162, d = 0.0006015685550323308, m = 0.0003373230867954564
[Iteration 5750] [Rank 3] a = 0.9654414653778076, b = 0.9998860194436452, delta = 0.0006558283930644393, c = 0.0007720388863033358, d = 0.0007729024644759346, m = 0.00033819451698865354
[Iteration 5760] [Rank 3] a = 1.0287401676177979, b = 0.9997504894899216, delta = 0.0006681820377707481, c = 0.0005009789694880215, d = 0.0005019461770413321, m = 0.0003389067193389693
[Iteration 5720] [Rank 1] a = 0.9898226857185364, b = 0.9999426356282103, delta = 0.0006472782697528601, c = 0.0008852712562944918, d = 0.0008859966619594748, m = 0.0004926007487066837
[Iteration 5730] [Rank 1] a = 0.93459153175354, b = 0.9998749656431941, delta = 0.000639879610389471, c = 0.0007499312850848064, d = 0.0007506221476228853, m = 0.0004932392898768372
[Iteration 5740] [Rank 1] a = 0.832798182964325, b = 1.0047138528451478, delta = 0.0005621283198706806, c = 0.010427775520384435, d = 0.009740919985026245, m = 0.0004951436900961083
[Iteration 5750] [Rank 1] a = 1.0252110958099365, b = 0.9998283496944713, delta = 0.0006165721570141613, c = 0.0006566993855710388, d = 0.0006576320499974455, m = 0.0004957145092536057
[Iteration 5760] [Rank 1] a = 1.1398136615753174, b = 0.9996838730750407, delta = 0.0006465956685133278, c = 0.0003677461290194771, d = 0.000368575164065172, m = 0.0004967679338696996
- reduce.heur_params.alpha       |   5697 |     0.00831s |   7.0%
- reduce.heur_params.beta        |   5697 |     0.00212s |   1.8%
- reduce.memory                  |   5698 |     0.00044s |   0.4%
- reduce.pad                     |   5698 |     0.00029s |   0.2%
- reduce.threshold               |   5698 |     0.00221s |   1.9%
- test.last                      |     40 |     0.41494s |   2.6%
- test.runavg                    |     40 |     0.44567s |   2.8%
-----------------------------------------------------------------

[Iteration 5700] [Rank 2] a = 1.0456732511520386, b = 0.9996995901962882, delta = 0.0007247328758239746, c = 0.0003991803745020738, d = 0.0004002512114360963, m = 0.0002829337788917893
[Iteration 5710] [Rank 2] a = 1.194293737411499, b = 0.9996205037164225, delta = 0.0007945618708617985, c = 0.0002410073964088758, d = 0.0002414564570586272, m = 0.0002837075945189757
[Iteration 5770] [Rank 3] a = 1.0114216804504395, b = 0.9998365709584437, delta = 0.0006542984629049897, c = 0.0006731419139773202, d = 0.0006742472940382467, m = 0.0003396903102867313
[Iteration 5780] [Rank 3] a = 1.047715663909912, b = 0.9997304890207919, delta = 0.0006740663084201515, c = 0.0004609780285332446, d = 0.00046166889107132365, m = 0.00034097910155522234
[Iteration 5790] [Rank 3] a = 1.1569011211395264, b = 0.9997193488632088, delta = 0.0006245953845791519, c = 0.0004386977116801953, d = 0.00043931948796446644, m = 0.00034542692057820353
[Iteration 5800] [Rank 3] a = 0.8805972337722778, b = 1.0000868359111896, delta = 0.0005784783861599863, c = 0.0011736718228155902, d = 0.0011726009858815678, m = 0.00034653504133553783
[Iteration 5810] [Rank 3] a = 0.9832049608230591, b = 1.0000148134918119, delta = 0.0005945564480498433, c = 0.0010296269836261088, d = 0.0010294197248646852, m = 0.0003473098064326896
[Iteration 5770] [Rank 1] a = 1.032422661781311, b = 0.9997699545408125, delta = 0.0006586089148186147, c = 0.0005399090735087758, d = 0.0005408071948082786, m = 0.0004971023519574855
[Iteration 5780] [Rank 1] a = 0.8942539691925049, b = 0.999983724677601, delta = 0.0006358959944918752, c = 0.0009674493551989945, d = 0.0009677257002142261, m = 0.000497817577255521
[Iteration 5790] [Rank 1] a = 1.012644648551941, b = 0.9999417029637869, delta = 0.000611840863712132, c = 0.0008834059274416783, d = 0.0008840622468528534, m = 0.0004985903042099074
[Iteration 5800] [Rank 1] a = 1.0071604251861572, b = 0.9997131656439907, delta = 0.0006864588940516114, c = 0.00042633127224858035, d = 0.0004269530485328515, m = 0.0004990843793137802
[Iteration 5810] [Rank 1] a = 1.0654442310333252, b = 0.9997577435461329, delta = 0.0006755495560355484, c = 0.0005154870827876815, d = 0.0005162470315795684, m = 0.0004995538321840579
[Iteration 5720] [Rank 2] a = 0.9077520966529846, b = 1.001450683901745, delta = 0.0006184644298627973, c = 0.0039013698387861903, d = 0.0037568413958200537, m = 0.00028523553817838695
[Iteration 5730] [Rank 2] a = 0.9930943846702576, b = 0.9998553624190331, delta = 0.0006638471968472004, c = 0.0007107248360488204, d = 0.0007122792767594983, m = 0.0002867018415019538
[Iteration 5740] [Rank 2] a = 1.0182255506515503, b = 0.9997592807151905, delta = 0.0007010807166807353, c = 0.0005185614210821332, d = 0.0005192868267471162, m = 0.00028724004742255744
[Iteration 5750] [Rank 2] a = 1.039153814315796, b = 0.9997788321239748, delta = 0.0006910556694492698, c = 0.0005576642407374074, d = 0.0005588387070521417, m = 0.0002880463598202377
[Iteration 5760] [Rank 2] a = 0.931265115737915, b = 0.9999165037528384, delta = 0.0006797270034439862, c = 0.0008330075052888119, d = 0.0008341474284766422, m = 0.000288889536744305
[Iteration 5820] [Rank 3] a = 1.0403448343276978, b = 0.9999532749112678, delta = 0.0005669138627126813, c = 0.0009065498224673264, d = 0.0009069643399901738, m = 0.00034889138540250433
[Iteration 5830] [Rank 3] a = 0.9991493821144104, b = 0.9998594212363617, delta = 0.0006159324548207223, c = 0.0007188424708712491, d = 0.0007205350840895428, m = 0.00034948635726219767
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5837 |     0.10965s |  92.9%
- batch.accumulate               |   5837 |     0.00082s |   0.7%
- batch.backward                 |   5837 |     0.05172s |  43.8%
- batch.evaluate                 |   5837 |     0.00277s |   2.3%
- batch.forward                  |   5837 |     0.02537s |  21.5%
- batch.mom                      |   5837 |     0.00126s |   1.1%
- batch.reduce                   |   5837 |     0.02492s |  21.1%
[Iteration 5820] [Rank 1] a = 0.9860283136367798, b = 0.9999814275596625, delta = 0.0006141905323602259, c = 0.0009628551193207689, d = 0.0009630278349552886, m = 0.0005010247639065616
[Iteration 5830] [Rank 1] a = 0.989801287651062, b = 0.9997836681615099, delta = 0.0006403439329005778, c = 0.000567336316270514, d = 0.0005682344375700167, m = 0.0005017231543868047
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5837 |     0.10958s |  92.8%
- batch.accumulate               |   5837 |     0.00083s |   0.7%
- batch.backward                 |   5837 |     0.05174s |  43.8%
- batch.evaluate                 |   5837 |     0.00276s |   2.3%
- batch.forward                  |   5837 |     0.02540s |  21.5%
- batch.mom                      |   5837 |     0.00126s |   1.1%
- batch.reduce                   |   5837 |     0.02483s |  21.0%
[Iteration 5770] [Rank 2] a = 0.9586063623428345, b = 0.9998290923716778, delta = 0.0006944938795641065, c = 0.0006581847400279088, d = 0.0006592555769619313, m = 0.0002896399949838646
[Iteration 5780] [Rank 2] a = 0.9339583516120911, b = 0.999788348754991, delta = 0.0007123771938495338, c = 0.0005766975036614851, d = 0.0005777683405955076, m = 0.0002903329918575665
[Iteration 5790] [Rank 2] a = 0.9264674186706543, b = 0.9999636378493209, delta = 0.000656680844258517, c = 0.0009272756986096978, d = 0.0009275865867518334, m = 0.00029181137670337634
[Iteration 5800] [Rank 2] a = 0.8882306218147278, b = 1.000175974448567, delta = 0.0006264439434744418, c = 0.0013519489007668885, d = 0.0013490472781069564, m = 0.00029329880692575587
[Iteration 5810] [Rank 2] a = 0.9187932014465332, b = 1.0000437433605673, delta = 0.0006393463700078428, c = 0.001087486721190229, d = 0.001086830401779054, m = 0.00029409715674151175
- batch.reporting.compr_err      |   5837 |     0.00001s |   0.0%
- batch.reporting.lr             |   5837 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   5837 |     0.00001s |   0.0%
- batch.step                     |   5837 |     0.00047s |   0.4%
- batch.update_runavg            |   5837 |     0.00129s |   1.1%
- batch.reporting.compr_err      |   5837 |     0.00001s |   0.0%
- batch.reporting.lr             |   5837 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5837 |     0.00001s |   0.0%
- batch.step                     |   5837 |     0.00048s |   0.4%
- batch.update_runavg            |   5837 |     0.00129s |   1.1%
- batch.wd                       |   5837 |     0.00001s |   0.0%
[Iteration 5820] [Rank 2] a = 0.9215834140777588, b = 0.9999108732231953, delta = 0.000673408096190542, c = 0.0008217464459181233, d = 0.0008223682222023945, m = 0.0002947659491584955
[Iteration 5830] [Rank 2] a = 0.9704645872116089, b = 1.0001393587349632, delta = 0.0006475414265878499, c = 0.0012787174717305094, d = 0.001274675925882747, m = 0.0002955698559606959
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5837 |     0.10949s |  92.8%
- batch.accumulate               |   5837 |     0.00083s |   0.7%
- batch.backward                 |   5837 |     0.05202s |  44.1%
- batch.evaluate                 |   5837 |     0.00275s |   2.3%
- batch.forward                  |   5837 |     0.02567s |  21.7%
- batch.mom                      |   5837 |     0.00126s |   1.1%
- batch.reduce                   |   5837 |     0.02417s |  20.5%
- batch.wd                       |   5837 |     0.00001s |   0.0%
- epoch_metrics.collect          |     41 |     0.01132s |   0.1%
- reduce.combine                 |   5837 |     0.00580s |   4.9%
- reduce.flatpack                |   5837 |     0.00002s |   0.0%
- reduce.flatput                 |   5837 |     0.00016s |   0.1%
- reduce.gather.context          |   5837 |     0.00267s |   2.3%
- reduce.gather.tensors          |   5837 |     0.00273s |   2.3%
- reduce.heur_params             |   5837 |     0.01035s |   8.8%
- reduce.heur_params.alpha       |   5836 |     0.00811s |   6.9%
- reduce.heur_params.beta        |   5836 |     0.00217s |   1.8%
- reduce.memory                  |   5837 |     0.00044s |   0.4%
- reduce.pad                     |   5837 |     0.00027s |   0.2%
- reduce.threshold               |   5837 |     0.00228s |   1.9%
- test.last                      |     41 |     0.41482s |   2.6%
- test.runavg                    |     41 |     0.44550s |   2.8%
- epoch_metrics.collect          |     41 |     0.01179s |   0.1%
- reduce.combine                 |   5837 |     0.00582s |   4.9%
- reduce.flatpack                |   5837 |     0.00002s |   0.0%
- reduce.flatput                 |   5837 |     0.00021s |   0.2%
- reduce.gather.context          |   5837 |     0.00156s |   1.3%
- reduce.gather.tensors          |   5837 |     0.00302s |   2.6%
- reduce.heur_params             |   5837 |     0.01078s |   9.1%
- reduce.heur_params.alpha       |   5836 |     0.00826s |   7.0%
- reduce.heur_params.beta        |   5836 |     0.00244s |   2.1%
- reduce.memory                  |   5837 |     0.00046s |   0.4%
- reduce.pad                     |   5837 |     0.00017s |   0.1%
- reduce.threshold               |   5837 |     0.00259s |   2.2%
- test.last                      |     41 |     0.41482s |   2.6%
- test.runavg                    |     41 |     0.44550s |   2.8%
-----------------------------------------------------------------
- batch.reporting.compr_err      |   5837 |     0.00001s |   0.0%
- batch.reporting.lr             |   5837 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5837 |     0.00001s |   0.0%
- batch.step                     |   5837 |     0.00048s |   0.4%
- batch.update_runavg            |   5837 |     0.00130s |   1.1%
-----------------------------------------------------------------
- batch.wd                       |   5837 |     0.00001s |   0.0%
- epoch_metrics.collect          |     41 |     0.01539s |   0.1%
- reduce.combine                 |   5837 |     0.00595s |   5.0%
- reduce.flatpack                |   5837 |     0.00002s |   0.0%
- reduce.flatput                 |   5837 |     0.00015s |   0.1%
- reduce.gather.context          |   5837 |     0.00140s |   1.2%
- reduce.gather.tensors          |   5837 |     0.00298s |   2.5%
- reduce.heur_params             |   5837 |     0.01051s |   8.9%
- reduce.heur_params.alpha       |   5836 |     0.00830s |   7.0%
- reduce.heur_params.beta        |   5836 |     0.00213s |   1.8%
- reduce.memory                  |   5837 |     0.00044s |   0.4%
- reduce.pad                     |   5837 |     0.00029s |   0.2%
- reduce.threshold               |   5837 |     0.00222s |   1.9%
- test.last                      |     41 |     0.41482s |   2.6%
- test.runavg                    |     41 |     0.44551s |   2.8%
-----------------------------------------------------------------
[Iteration 5780] [Rank 0] a = 1.1031383275985718, b = 0.9996822668198009, delta = 0.000762605806812644, c = 0.00036453361821740956, d = 0.00036553536889762415, m = 0.00022847320680519746
[Iteration 5790] [Rank 0] a = 0.8283289074897766, b = 1.004382746554983, delta = 0.000667949381750077, c = 0.009765549234508763, d = 0.00875668267015193, m = 0.00023049112288264087
[Iteration 5800] [Rank 0] a = 1.055130958557129, b = 0.9996240962011081, delta = 0.0008174640242941678, c = 0.0002481923668048979, d = 0.0002489177724698809, m = 0.0002308400280527236
[Iteration 5810] [Rank 0] a = 1.0009729862213135, b = 0.9998024250786149, delta = 0.0007524879765696824, c = 0.0006048501520882063, d = 0.0006059900752760368, m = 0.0002314943464704924
[Iteration 5820] [Rank 0] a = 1.0090826749801636, b = 0.9997310417107824, delta = 0.0007799901068210602, c = 0.0004620834085941711, d = 0.00046291244363986595, m = 0.0002321410878230981
[Iteration 5830] [Rank 0] a = 1.0921440124511719, b = 0.9996362899232374, delta = 0.0008204926853068173, c = 0.00027257981439908827, d = 0.00027333976319097525, m = 0.00023271690377476325
timer                          - epoch: 41.942, value:  0.027 (event:batch.reduce)
cross_entropy                  - bits:10850623040.000, epoch: 42.000, ratio_transmit_grad:  0.175, value:  5.745 (split:train)
last_cross_entropy             - bits:10850623040.000, epoch: 42.000, ratio_transmit_grad:  0.175, value:  5.745 (split:train)
perplexity                     - bits:10850623040.000, epoch: 42.000, ratio_transmit_grad:  0.175, value:313.351 (split:train)
last_perplexity                - bits:10850623040.000, epoch: 42.000, ratio_transmit_grad:  0.175, value:313.351 (split:train)
last_cross_entropy             - bits:10850623040.000, epoch: 42.000, ratio_transmit_grad:  0.175, value:  5.461 (split:test)
last_perplexity                - bits:10850623040.000, epoch: 42.000, ratio_transmit_grad:  0.175, value:235.916 (split:test)
runavg_cross_entropy           - bits:10850623040.000, epoch: 42.000, ratio_transmit_grad:  0.175, value:  5.620 (split:test)
runavg_perplexity              - bits:10850623040.000, epoch: 42.000, ratio_transmit_grad:  0.175, value:276.698 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5837 |     0.10950s |  92.8%
- batch.accumulate               |   5837 |     0.00083s |   0.7%
- batch.backward                 |   5837 |     0.05174s |  43.8%
- batch.evaluate                 |   5837 |     0.00275s |   2.3%
- batch.forward                  |   5837 |     0.02548s |  21.6%
- batch.mom                      |   5837 |     0.00126s |   1.1%
- batch.reduce                   |   5837 |     0.02462s |  20.9%
- batch.reporting.compr_err      |   5837 |     0.00001s |   0.0%
- batch.reporting.lr             |   5837 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5837 |     0.00001s |   0.0%
- batch.step                     |   5837 |     0.00048s |   0.4%
- batch.update_runavg            |   5837 |     0.00130s |   1.1%
- batch.wd                       |   5837 |     0.00001s |   0.0%
- epoch_metrics.collect          |     41 |     0.00995s |   0.1%
- reduce.combine                 |   5837 |     0.00608s |   5.2%
- reduce.flatpack                |   5837 |     0.00002s |   0.0%
- reduce.flatput                 |   5837 |     0.00015s |   0.1%
- reduce.gather.context          |   5837 |     0.00130s |   1.1%
- reduce.gather.tensors          |   5837 |     0.00304s |   2.6%
- reduce.heur_params             |   5837 |     0.01089s |   9.2%
- reduce.heur_params.alpha       |   5836 |     0.00873s |   7.4%
- reduce.heur_params.beta        |   5836 |     0.00209s |   1.8%
- reduce.memory                  |   5837 |     0.00044s |   0.4%
- reduce.pad                     |   5837 |     0.00029s |   0.2%
- reduce.threshold               |   5837 |     0.00218s |   1.8%
- test.last                      |     41 |     0.41481s |   2.6%
- test.runavg                    |     41 |     0.44551s |   2.8%
-----------------------------------------------------------------

[Iteration 5840] [Rank 0] a = 1.2170162200927734, b = 0.9995895530795473, delta = 0.0008493787609040737, c = 0.0001791061129969931, d = 0.00017952063051984056, m = 0.00023383034473343698
[Iteration 5850] [Rank 0] a = 1.0745456218719482, b = 0.999654010545107, delta = 0.0007827038643881679, c = 0.00030802106260254344, d = 0.00030888464077514225, m = 0.00023475013715204963
[Iteration 5860] [Rank 0] a = 0.9381935000419617, b = 0.9999560210898507, delta = 0.0007335083791986108, c = 0.0009120421796450549, d = 0.0009126984990562299, m = 0.00023532552058437697
timer                          - epoch: -1.000, value:  0.003 (event:reduce.threshold)
[Iteration 5870] [Rank 0] a = 1.0878236293792725, b = 0.9996364799104103, delta = 0.0007916918839327991, c = 0.00027295978879503176, d = 0.00027385791009453453, m = 0.0002359240202044438
[Iteration 5880] [Rank 0] a = 0.9933524131774902, b = 0.999761249673311, delta = 0.0007920995121821761, c = 0.0005224993375491838, d = 0.0005237428901177261, m = 0.0002365157032800961
[Iteration 5890] [Rank 0] a = 1.1612892150878906, b = 0.9996317129595357, delta = 0.0008383020758628845, c = 0.0002634258857695409, d = 0.00026411674830762, m = 0.0002372677379054565
[Iteration 5900] [Rank 0] a = 1.02913236618042, b = 0.9997140810367785, delta = 0.0007846640655770898, c = 0.00042816205797448984, d = 0.0004288874636394728, m = 0.00023788554302188434
[Iteration 5910] [Rank 0] a = 1.0676227807998657, b = 0.9996555995287556, delta = 0.0008263131021521986, c = 0.00031119903027770706, d = 0.0003118898928157861, m = 0.0002385682402408742
timer                          - epoch: -1.000, value:  0.007 (event:reduce.combine)
[Iteration 5920] [Rank 0] a = 1.0070383548736572, b = 0.9997972608813497, delta = 0.0007223230204544961, c = 0.0005945217571439246, d = 0.0005954198784434273, m = 0.00023967312510644496
[Iteration 5930] [Rank 0] a = 0.9932041168212891, b = 0.9997132174586767, delta = 0.0007777786813676357, c = 0.0004264349016292922, d = 0.0004276093679440266, m = 0.00024049046675595306
[Iteration 5940] [Rank 0] a = 0.9482424855232239, b = 0.9998591276197889, delta = 0.0007694821106269956, c = 0.000718255237713882, d = 0.0007192915315210005, m = 0.00024123392396722973
[Iteration 5950] [Rank 0] a = 1.0076555013656616, b = 0.9997734952111357, delta = 0.0007460434571839869, c = 0.0005469904145240861, d = 0.0005488557433768994, m = 0.00024189697915356873
[Iteration 5960] [Rank 0] a = 0.8888689875602722, b = 1.0012930811821905, delta = 0.0006980074685998261, c = 0.003586163805787625, d = 0.0034890630760606146, m = 0.00024295062548899545
[Iteration 5970] [Rank 0] a = 1.0562492609024048, b = 0.9996462037993828, delta = 0.0008286747615784407, c = 0.00029240756924195696, d = 0.0002931675180338439, m = 0.0002437816937162661
cross_entropy                  - bits:11277257024.000, epoch: 43.000, ratio_transmit_grad:  0.166, value:  5.722 (split:train)
last_cross_entropy             - bits:11277257024.000, epoch: 43.000, ratio_transmit_grad:  0.166, value:  5.722 (split:train)
perplexity                     - bits:11277257024.000, epoch: 43.000, ratio_transmit_grad:  0.166, value:306.351 (split:train)
last_perplexity                - bits:11277257024.000, epoch: 43.000, ratio_transmit_grad:  0.166, value:306.351 (split:train)
last_cross_entropy             - bits:11277257024.000, epoch: 43.000, ratio_transmit_grad:  0.166, value:  5.436 (split:test)
last_perplexity                - bits:11277257024.000, epoch: 43.000, ratio_transmit_grad:  0.166, value:230.103 (split:test)
runavg_cross_entropy           - bits:11277257024.000, epoch: 43.000, ratio_transmit_grad:  0.166, value:  5.604 (split:test)
runavg_perplexity              - bits:11277257024.000, epoch: 43.000, ratio_transmit_grad:  0.166, value:272.121 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5976 |     0.10956s |  92.8%
- batch.accumulate               |   5976 |     0.00083s |   0.7%
- batch.backward                 |   5976 |     0.05173s |  43.8%
- batch.evaluate                 |   5976 |     0.00275s |   2.3%
- batch.forward                  |   5976 |     0.02547s |  21.6%
- batch.mom                      |   5976 |     0.00126s |   1.1%
- batch.reduce                   |   5976 |     0.02469s |  20.9%
- batch.reporting.compr_err      |   5976 |     0.00001s |   0.0%
- batch.reporting.lr             |   5976 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5976 |     0.00001s |   0.0%
- batch.step                     |   5976 |     0.00048s |   0.4%
- batch.update_runavg            |   5976 |     0.00130s |   1.1%
- batch.wd                       |   5976 |     0.00001s |   0.0%
- epoch_metrics.collect          |     42 |     0.01033s |   0.1%
- reduce.combine                 |   5976 |     0.00609s |   5.2%
- reduce.flatpack                |   5976 |     0.00002s |   0.0%
- reduce.flatput                 |   5976 |     0.00015s |   0.1%
- reduce.gather.context          |   5976 |     0.00130s |   1.1%
- reduce.gather.tensors          |   5976 |     0.00308s |   2.6%
- reduce.heur_params             |   5976 |     0.01090s |   9.2%
- reduce.heur_params.alpha       |   5975 |     0.00872s |   7.4%
- reduce.heur_params.beta        |   5975 |     0.00210s |   1.8%
- reduce.memory                  |   5976 |     0.00044s |   0.4%
- reduce.pad                     |   5976 |     0.00029s |   0.2%
- reduce.threshold               |   5976 |     0.00219s |   1.9%
- test.last                      |     42 |     0.41466s |   2.6%
- test.runavg                    |     42 |     0.44532s |   2.8%
-----------------------------------------------------------------

[Iteration 5840] [Rank 3] a = 1.0514065027236938, b = 0.999777830373344, delta = 0.0006187811959534883, c = 0.0005556607393769781, d = 0.0005566279469302887, m = 0.000350873446721999
[Iteration 5850] [Rank 3] a = 0.9545757174491882, b = 0.9999083515749516, delta = 0.0006327389273792505, c = 0.0008167031493901463, d = 0.0008174285550551293, m = 0.00035156901769680993
[Iteration 5860] [Rank 3] a = 0.9817479848861694, b = 1.00014267487508, delta = 0.0005946275778114796, c = 0.0012853497520960682, d = 0.0012810664043599782, m = 0.00035250936261192
[Iteration 5870] [Rank 3] a = 0.993615448474884, b = 0.9997725107320695, delta = 0.0006525496719405055, c = 0.0005450214562905608, d = 0.0005459886638438714, m = 0.00035495975907289294
[Iteration 5880] [Rank 3] a = 0.9119575619697571, b = 1.0004180699309329, delta = 0.0005833505420014262, c = 0.001836139910579589, d = 0.0018259842312698272, m = 0.00035587498786641703

[Iteration 5840] [Rank 1] a = 1.0661429166793823, b = 0.9998100072946857, delta = 0.0006161307101137936, c = 0.0006200145847990413, d = 0.0006210854217330639, m = 0.0005028927154920017
[Iteration 5850] [Rank 1] a = 0.9985309839248657, b = 0.9998751729019523, delta = 0.0006508029182441533, c = 0.0007503458026076538, d = 0.0007515893551761961, m = 0.0005032007106756828
[Iteration 5860] [Rank 1] a = 0.9985024333000183, b = 0.9997734433964478, delta = 0.0006666640401817858, c = 0.0005468867851433742, d = 0.000547681277062165, m = 0.0005043191560720583
[Iteration 5870] [Rank 1] a = 0.9418537020683289, b = 0.9998368818465774, delta = 0.0006421844009310007, c = 0.0006737636902615913, d = 0.0006750763290839415, m = 0.0005051018808445483
[Iteration 5880] [Rank 1] a = 1.0590463876724243, b = 0.9997429245456153, delta = 0.0006894901744090021, c = 0.0004858490799040903, d = 0.00048691991683811285, m = 0.000505559854485878
[Iteration 5890] [Rank 3] a = 0.8740817904472351, b = 1.000293524702808, delta = 0.0006036752020008862, c = 0.0015870494224751884, d = 0.001580728030251765, m = 0.0003564421003678606
[Iteration 5900] [Rank 3] a = 0.9154735803604126, b = 0.9999169355419216, delta = 0.0006382815772667527, c = 0.0008338710834614107, d = 0.0008348037478878173, m = 0.0003571278258630428
[Iteration 5910] [Rank 3] a = 0.9736886620521545, b = 0.9998174167951493, delta = 0.0006592994905076921, c = 0.0006348335862408369, d = 0.0006358353369210516, m = 0.0003576326132456004
[Iteration 5920] [Rank 3] a = 1.0492804050445557, b = 0.9997709735630025, delta = 0.0006690844893455505, c = 0.000541947117996109, d = 0.0005428452392956118, m = 0.0003584326696003363
[Iteration 5930] [Rank 3] a = 0.9492601752281189, b = 0.9998762610104327, delta = 0.0006203787052072585, c = 0.0007525220196026028, d = 0.0007532819683944897, m = 0.0003596425246122764
[Iteration 5890] [Rank 1] a = 0.9744361639022827, b = 0.9998053957874145, delta = 0.0006614741287194192, c = 0.0006107915699156861, d = 0.0006114478893268612, m = 0.0005061879158776583
[Iteration 5900] [Rank 1] a = 0.9738067984580994, b = 0.9999575928021223, delta = 0.000631757837254554, c = 0.0009151856041933145, d = 0.000915565578589258, m = 0.000506723794132322
[Iteration 5910] [Rank 1] a = 1.0651981830596924, b = 0.9997015246112211, delta = 0.0006979363970458508, c = 0.00040304920471531647, d = 0.00040367098099958757, m = 0.0005075813233854915
[Iteration 5920] [Rank 1] a = 1.05586576461792, b = 0.9998569341312745, delta = 0.0006462964811362326, c = 0.00071386826059708, d = 0.000714628209388967, m = 0.0005083438255072423
[Iteration 5930] [Rank 1] a = 0.9752870798110962, b = 0.9998864685042893, delta = 0.0006902357563376427, c = 0.0007729370076028386, d = 0.0007736624132678216, m = 0.0005085013512768828
[Iteration 5940] [Rank 3] a = 1.0490131378173828, b = 0.9997272937817882, delta = 0.0006562937051057816, c = 0.0004545875500560134, d = 0.00045548567135551615, m = 0.0003604499124280255
[Iteration 5950] [Rank 3] a = 1.0559073686599731, b = 0.999760766069562, delta = 0.0006249169236980379, c = 0.0005215321299958731, d = 0.0005222575356608561, m = 0.00036154296472560963
[Iteration 5960] [Rank 3] a = 1.0617049932479858, b = 0.9997141155799026, delta = 0.0006835524109192193, c = 0.00042823114422829776, d = 0.0004291983517816084, m = 0.00036207599150450996
[Iteration 5970] [Rank 3] a = 0.981789231300354, b = 0.9997413010187588, delta = 0.0006805869052186608, c = 0.0004826020259751188, d = 0.00048356923352842944, m = 0.00036295153606303026
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5976 |     0.10970s |  92.9%
- batch.accumulate               |   5976 |     0.00082s |   0.7%
[Iteration 5940] [Rank 1] a = 1.008233666419983, b = 0.9998378145109792, delta = 0.0006585474475286901, c = 0.0006756290191144047, d = 0.0006766998560484272, m = 0.0005094839455035306
[Iteration 5950] [Rank 1] a = 1.0790399312973022, b = 0.9997283473470808, delta = 0.0006528084049932659, c = 0.0004566946807971545, d = 0.0004574546295890415, m = 0.0005115383639749467
[Iteration 5960] [Rank 1] a = 0.8555542826652527, b = 1.0003564622733587, delta = 0.0006069228984415531, c = 0.001712924576913191, d = 0.0017044615108217226, m = 0.0005121461174487781
[Iteration 5970] [Rank 1] a = 0.9616392850875854, b = 0.9999466771740454, delta = 0.0006377382087521255, c = 0.0008933543479900166, d = 0.000893837951766672, m = 0.0005126295198253716
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5976 |     0.10963s |  92.8%
- batch.accumulate               |   5976 |     0.00083s |   0.7%
- batch.backward                 |   5976 |     0.05172s |  43.8%
- batch.evaluate                 |   5976 |     0.00277s |   2.3%
- batch.forward                  |   5976 |     0.02537s |  21.5%
- batch.mom                      |   5976 |     0.00126s |   1.1%
- batch.reduce                   |   5976 |     0.02497s |  21.2%
- batch.reporting.compr_err      |   5976 |     0.00001s |   0.0%
- batch.reporting.lr             |   5976 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   5976 |     0.00001s |   0.0%
- batch.step                     |   5976 |     0.00047s |   0.4%
- batch.update_runavg            |   5976 |     0.00129s |   1.1%
- batch.wd                       |   5976 |     0.00001s |   0.0%
- epoch_metrics.collect          |     42 |     0.01166s |   0.1%
- reduce.combine                 |   5976 |     0.00581s |   4.9%
- reduce.flatpack                |   5976 |     0.00002s |   0.0%
- reduce.flatput                 |   5976 |     0.00016s |   0.1%
- batch.backward                 |   5976 |     0.05174s |  43.8%
- batch.evaluate                 |   5976 |     0.00276s |   2.3%
- batch.forward                  |   5976 |     0.02540s |  21.5%
- batch.mom                      |   5976 |     0.00126s |   1.1%
- batch.reduce                   |   5976 |     0.02487s |  21.1%
- batch.reporting.compr_err      |   5976 |     0.00001s |   0.0%
- batch.reporting.lr             |   5976 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5976 |     0.00001s |   0.0%
- batch.step                     |   5976 |     0.00048s |   0.4%
- batch.update_runavg            |   5976 |     0.00129s |   1.1%
- batch.wd                       |   5976 |     0.00001s |   0.0%
- epoch_metrics.collect          |     42 |     0.01153s |   0.1%
- reduce.combine                 |   5976 |     0.00584s |   4.9%
- reduce.flatpack                |   5976 |     0.00002s |   0.0%
- reduce.flatput                 |   5976 |     0.00022s |   0.2%
- reduce.gather.context          |   5976 |     0.00266s |   2.3%
- reduce.gather.tensors          |   5976 |     0.00276s |   2.3%
- reduce.heur_params             |   5976 |     0.01036s |   8.8%
- reduce.gather.context          |   5976 |     0.00154s |   1.3%
- reduce.gather.tensors          |   5976 |     0.00305s |   2.6%
- reduce.heur_params             |   5976 |     0.01078s |   9.1%
- reduce.heur_params.alpha       |   5975 |     0.00811s |   6.9%
- reduce.heur_params.beta        |   5975 |     0.00218s |   1.8%
- reduce.memory                  |   5976 |     0.00044s |   0.4%
- reduce.pad                     |   5976 |     0.00027s |   0.2%
- reduce.threshold               |   5976 |     0.00229s |   1.9%
- test.last                      |     42 |     0.41467s |   2.6%
- test.runavg                    |     42 |     0.44531s |   2.8%
-----------------------------------------------------------------

[Iteration 5980] [Rank 3] a = 0.9774332642555237, b = 0.9998069502280665, delta = 0.0006739292293787003, c = 0.0006139004513370419, d = 0.0006146604001289287, m = 0.0003640113129705356
[Iteration 5990] [Rank 3] a = 0.9213978052139282, b = 0.9999076434408563, delta = 0.0006514558335766196, c = 0.0008152868811870843, d = 0.0008159777437251632, m = 0.00036464519868675534
- reduce.heur_params.alpha       |   5975 |     0.00827s |   7.0%
- reduce.heur_params.beta        |   5975 |     0.00244s |   2.1%
- reduce.memory                  |   5976 |     0.00046s |   0.4%
- reduce.pad                     |   5976 |     0.00017s |   0.1%
- reduce.threshold               |   5976 |     0.00259s |   2.2%
- test.last                      |     42 |     0.41467s |   2.6%
- test.runavg                    |     42 |     0.44531s |   2.8%
-----------------------------------------------------------------

[Iteration 5980] [Rank 1] a = 1.0227406024932861, b = 0.9998947588546471, delta = 0.0006286321440711617, c = 0.0007895177085167357, d = 0.0007903467435624306, m = 0.0005133046802570507
[Iteration 5990] [Rank 1] a = 1.0323067903518677, b = 0.999811544463778, delta = 0.0006392773357219994, c = 0.0006230889230934932, d = 0.0006238488718853801, m = 0.0005138852814953999
[Iteration 6000] [Rank 3] a = 1.1026561260223389, b = 0.9996714202790858, delta = 0.000726986036170274, c = 0.00034284053452172746, d = 0.00034356594018671044, m = 0.0003660813701906341
[Iteration 6010] [Rank 3] a = 0.9331827163696289, b = 1.0031672777482523, delta = 0.0005514580407179892, c = 0.0073345766786431146, d = 0.006848589426231408, m = 0.0003681017146231105
[Iteration 6020] [Rank 3] a = 1.2190577983856201, b = 0.9996682077686341, delta = 0.0006639164639636874, c = 0.0003364155129175923, d = 0.00033676094418663184, m = 0.00036945722719955275
[Iteration 6030] [Rank 3] a = 0.969923198223114, b = 0.9998270888703767, delta = 0.0006390333874151111, c = 0.0006541777373070503, d = 0.0006548685998451294, m = 0.000370072529289265
[Iteration 6040] [Rank 3] a = 0.9210395812988281, b = 1.0003005715000743, delta = 0.0006098540616221726, c = 0.001601143018252001, d = 0.0015948907122823857, m = 0.00037071612888707695
[Iteration 6000] [Rank 1] a = 1.1029211282730103, b = 0.9997044089620631, delta = 0.0006807649624533951, c = 0.0004088179069082765, d = 0.0004096814850808753, m = 0.0005148447510116298
[Iteration 6010] [Rank 1] a = 0.9927237033843994, b = 0.9999525149624776, delta = 0.0006355941877700388, c = 0.0009050299248835526, d = 0.0009055135286602079, m = 0.0005153176255050091
[Iteration 6020] [Rank 1] a = 1.066280484199524, b = 0.9997193661347709, delta = 0.0006928013172000647, c = 0.00043873225480709925, d = 0.000439664919233506, m = 0.0005158551469475424
[Iteration 6030] [Rank 1] a = 1.0281620025634766, b = 0.9997997479863858, delta = 0.0006774397916160524, c = 0.0005994959674180937, d = 0.0006004286318445004, m = 0.00051620989385202
[Iteration 6040] [Rank 1] a = 0.9680418372154236, b = 1.0000298052088805, delta = 0.0006411649519577622, c = 0.0010596104177787394, d = 0.0010590922708751801, m = 0.0005170835459184253

[Iteration 5840] [Rank 2] a = 1.0905143022537231, b = 0.9996740455564495, delta = 0.0007375720306299627, c = 0.0003480910898111282, d = 0.0003486437798415914, m = 0.0002961351044050393
[Iteration 5850] [Rank 2] a = 1.0446343421936035, b = 0.9997735642973858, delta = 0.0006729785818606615, c = 0.0005471285870317018, d = 0.0005483030533464362, m = 0.0002971916004446932
[Iteration 5860] [Rank 2] a = 0.990803062915802, b = 0.9998414069960848, delta = 0.0006810238701291382, c = 0.0006828139895104268, d = 0.0006842993439672968, m = 0.0002978543797067164
[Iteration 5870] [Rank 2] a = 0.9971853494644165, b = 0.9997311453401557, delta = 0.000690924352966249, c = 0.0004622906673555948, d = 0.00046339604741652126, m = 0.0003002573786280605
[Iteration 5880] [Rank 2] a = 1.0957180261611938, b = 0.9997246512327785, delta = 0.0006875786930322647, c = 0.0004493024516397087, d = 0.00045006240043159564, m = 0.00030141708751305193
[Iteration 6050] [Rank 3] a = 1.1442022323608398, b = 0.9996686222861113, delta = 0.0006966067594476044, c = 0.00033724454796328716, d = 0.00033783178112065435, m = 0.000371524962142051
[Iteration 6060] [Rank 3] a = 1.0126997232437134, b = 0.9998074511033881, delta = 0.0006521029863506556, c = 0.0006149022020172564, d = 0.0006156621508091434, m = 0.00037283364029395234
[Iteration 6070] [Rank 3] a = 0.9848809838294983, b = 1.0000055386622393, delta = 0.0006085458444431424, c = 0.0010110773244786863, d = 0.0010110427813517825, m = 0.0003736960531844179
[Iteration 6080] [Rank 3] a = 1.029191255569458, b = 0.9998391444213304, delta = 0.0006278006476350129, c = 0.000678288839886009, d = 0.0006790833318047999, m = 0.00037447575613158376
[Iteration 6090] [Rank 3] a = 1.1465932130813599, b = 0.9996393297180062, delta = 0.00071073102299124, c = 0.0002786594047341839, d = 0.0002792120947646471, m = 0.00037507186932126405
[Iteration 6050] [Rank 1] a = 1.015506386756897, b = 0.9997558782173906, delta = 0.0006682474631816149, c = 0.0005117564250820546, d = 0.0005126545463815574, m = 0.0005181791061338793
[Iteration 6060] [Rank 1] a = 0.9095520377159119, b = 1.0017579787653224, delta = 0.0005861188983544707, c = 0.004515961152661311, d = 0.004265661655115272, m = 0.0005194456248241538
[Iteration 6070] [Rank 1] a = 0.903156042098999, b = 1.0001986520105828, delta = 0.0006429306231439114, c = 0.001397304026391778, d = 0.0013946096624932697, m = 0.0005197602855072553
[Iteration 6080] [Rank 1] a = 1.0195368528366089, b = 0.9998199557148932, delta = 0.0006661166553385556, c = 0.000639911425895718, d = 0.0006410858922104523, m = 0.0005201437473724806
[Iteration 6090] [Rank 1] a = 0.9318501353263855, b = 1.001140055356789, delta = 0.0006146362866275012, c = 0.003280111701418607, d = 0.003216794149803662, m = 0.0005209312009508893
[Iteration 5890] [Rank 2] a = 0.9945476055145264, b = 0.9997779685458448, delta = 0.0007092372397892177, c = 0.0005559370843922097, d = 0.0005573878957221757, m = 0.00030186435859202564
[Iteration 5900] [Rank 2] a = 1.0377627611160278, b = 0.9997294527270605, delta = 0.0006957828882150352, c = 0.0004589054409190075, d = 0.00045956176033018254, m = 0.0003030544446746879
[Iteration 5910] [Rank 2] a = 1.069361925125122, b = 0.999661782747751, delta = 0.000721710326615721, c = 0.000323565469709322, d = 0.000324325418501209, m = 0.00030405280475249784
[Iteration 5920] [Rank 2] a = 1.0027257204055786, b = 0.9997235285812395, delta = 0.0007282572914846241, c = 0.00044705714839095176, d = 0.00044771346780212687, m = 0.00030469802079518616
[Iteration 5930] [Rank 2] a = 0.9784597754478455, b = 0.999727777385529, delta = 0.0007152848411351442, c = 0.00045555475760932407, d = 0.00045672922392405845, m = 0.0003053211890432614
[Iteration 6100] [Rank 3] a = 1.1128299236297607, b = 0.9996777243990781, delta = 0.0006846662727184594, c = 0.00035544877584167006, d = 0.00035610509525284517, m = 0.0003760599932620405
[Iteration 6110] [Rank 3] a = 1.1203742027282715, b = 0.9997800584049203, delta = 0.0006727057043462992, c = 0.000560116802747588, d = 0.0005609112946663788, m = 0.00037685099295559917
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6115 |     0.10976s |  92.9%
- batch.accumulate               |   6115 |     0.00082s |   0.7%
- batch.backward                 |   6115 |     0.05172s |  43.8%
- batch.evaluate                 |   6115 |     0.00277s |   2.3%
- batch.forward                  |   6115 |     0.02537s |  21.5%
- batch.mom                      |   6115 |     0.00126s |   1.1%
- batch.reduce                   |   6115 |     0.02503s |  21.2%
[Iteration 6100] [Rank 1] a = 1.003172755241394, b = 0.9998408370345054, delta = 0.0006376479868777096, c = 0.0006816740663225963, d = 0.000682710360129715, m = 0.0005218022469436412
[Iteration 6110] [Rank 1] a = 0.875758171081543, b = 1.000486758924695, delta = 0.0006342825363390148, c = 0.0019735179262766077, d = 0.0019613587456064163, m = 0.0005221544319732879
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6115 |     0.10969s |  92.8%
- batch.accumulate               |   6115 |     0.00083s |   0.7%
- batch.backward                 |   6115 |     0.05174s |  43.8%
- batch.evaluate                 |   6115 |     0.00276s |   2.3%
- batch.forward                  |   6115 |     0.02540s |  21.5%
- batch.mom                      |   6115 |     0.00126s |   1.1%
- batch.reduce                   |   6115 |     0.02493s |  21.1%
[Iteration 5940] [Rank 2] a = 1.0793111324310303, b = 0.9997311971548424, delta = 0.000678323965985328, c = 0.0004623942967363067, d = 0.00046339604741652126, m = 0.0003068634695674384
[Iteration 5950] [Rank 2] a = 1.069541335105896, b = 0.9997153245892458, delta = 0.0006972482078708708, c = 0.0004306491631115744, d = 0.00043147819815726924, m = 0.00030783692933558936
[Iteration 5960] [Rank 2] a = 0.9331714510917664, b = 0.9999374541591933, delta = 0.0006740392418578267, c = 0.0008749083182233061, d = 0.000875599180761385, m = 0.00030848338187909564
[Iteration 5970] [Rank 2] a = 1.0086848735809326, b = 0.9998871593668186, delta = 0.0006585933733731508, c = 0.0007743187326789967, d = 0.0007752168539784995, m = 0.0003092820226855486
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   5976 |     0.10954s |  92.8%
- batch.accumulate               |   5976 |     0.00083s |   0.7%
- batch.reporting.compr_err      |   6115 |     0.00001s |   0.0%
- batch.reporting.lr             |   6115 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   6115 |     0.00001s |   0.0%
- batch.step                     |   6115 |     0.00047s |   0.4%
- batch.update_runavg            |   6115 |     0.00129s |   1.1%
- batch.reporting.compr_err      |   6115 |     0.00001s |   0.0%
- batch.reporting.lr             |   6115 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6115 |     0.00001s |   0.0%
- batch.step                     |   6115 |     0.00048s |   0.4%
- batch.update_runavg            |   6115 |     0.00129s |   1.1%
- batch.wd                       |   6115 |     0.00001s |   0.0%
- batch.backward                 |   5976 |     0.05201s |  44.0%
- batch.evaluate                 |   5976 |     0.00275s |   2.3%
- batch.forward                  |   5976 |     0.02566s |  21.7%
- batch.mom                      |   5976 |     0.00126s |   1.1%
- batch.reduce                   |   5976 |     0.02425s |  20.5%
- batch.reporting.compr_err      |   5976 |     0.00001s |   0.0%
- batch.reporting.lr             |   5976 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   5976 |     0.00001s |   0.0%
- batch.step                     |   5976 |     0.00048s |   0.4%
- batch.update_runavg            |   5976 |     0.00130s |   1.1%
- batch.wd                       |   5976 |     0.00001s |   0.0%
- epoch_metrics.collect          |     42 |     0.01564s |   0.1%
- reduce.combine                 |   5976 |     0.00596s |   5.0%
- reduce.flatpack                |   5976 |     0.00002s |   0.0%
- reduce.flatput                 |   5976 |     0.00016s |   0.1%
- batch.wd                       |   6115 |     0.00001s |   0.0%
- epoch_metrics.collect          |     43 |     0.01141s |   0.1%
- reduce.combine                 |   6115 |     0.00583s |   4.9%
- reduce.flatpack                |   6115 |     0.00002s |   0.0%
- reduce.flatput                 |   6115 |     0.00017s |   0.1%
- reduce.gather.context          |   6115 |     0.00265s |   2.2%
- reduce.gather.tensors          |   6115 |     0.00279s |   2.4%
- reduce.heur_params             |   6115 |     0.01037s |   8.8%
- reduce.heur_params.alpha       |   6114 |     0.00811s |   6.9%
- reduce.heur_params.beta        |   6114 |     0.00219s |   1.9%
- reduce.memory                  |   6115 |     0.00044s |   0.4%
- reduce.pad                     |   6115 |     0.00027s |   0.2%
- reduce.threshold               |   6115 |     0.00230s |   1.9%
- test.last                      |     43 |     0.41440s |   2.6%
- test.runavg                    |     43 |     0.44516s |   2.8%
- epoch_metrics.collect          |     43 |     0.01127s |   0.1%
- reduce.combine                 |   6115 |     0.00586s |   5.0%
- reduce.flatpack                |   6115 |     0.00002s |   0.0%
- reduce.flatput                 |   6115 |     0.00022s |   0.2%
- reduce.gather.context          |   6115 |     0.00153s |   1.3%
- reduce.gather.tensors          |   6115 |     0.00308s |   2.6%
- reduce.heur_params             |   6115 |     0.01079s |   9.1%
- reduce.heur_params.alpha       |   6114 |     0.00827s |   7.0%
- reduce.heur_params.beta        |   6114 |     0.00245s |   2.1%
- reduce.memory                  |   6115 |     0.00046s |   0.4%
- reduce.pad                     |   6115 |     0.00017s |   0.1%
- reduce.threshold               |   6115 |     0.00259s |   2.2%
- test.last                      |     43 |     0.41440s |   2.6%
- test.runavg                    |     43 |     0.44516s |   2.8%
-----------------------------------------------------------------
- reduce.gather.context          |   5976 |     0.00142s |   1.2%
- reduce.gather.tensors          |   5976 |     0.00301s |   2.5%
- reduce.heur_params             |   5976 |     0.01051s |   8.9%
-----------------------------------------------------------------
- reduce.heur_params.alpha       |   5975 |     0.00830s |   7.0%
- reduce.heur_params.beta        |   5975 |     0.00214s |   1.8%
- reduce.memory                  |   5976 |     0.00044s |   0.4%
- reduce.pad                     |   5976 |     0.00029s |   0.2%
- reduce.threshold               |   5976 |     0.00223s |   1.9%
- test.last                      |     42 |     0.41468s |   2.6%
- test.runavg                    |     42 |     0.44531s |   2.8%
-----------------------------------------------------------------

[Iteration 5980] [Rank 2] a = 1.070164442062378, b = 0.9997658093658074, delta = 0.0006914965924806893, c = 0.0005316187230518273, d = 0.0005324823012244261, m = 0.0003100468804054339
[Iteration 5990] [Rank 2] a = 1.085140585899353, b = 0.9997165681417141, delta = 0.0007231975323520601, c = 0.000433136268248659, d = 0.0004339998464212578, m = 0.00031059965426851946
[Iteration 6000] [Rank 2] a = 1.1234420537948608, b = 0.9996381379802833, delta = 0.0007699315319769084, c = 0.0002762759289778112, d = 0.0002768977052620823, m = 0.0003112065306433727
[Iteration 6010] [Rank 2] a = 0.944923460483551, b = 0.9998746029403673, delta = 0.0006871309014968574, c = 0.0007492058794198233, d = 0.0007501040007193261, m = 0.00031195108891600285
[Iteration 6020] [Rank 2] a = 0.8706448078155518, b = 1.0012824246452126, delta = 0.0006288213189691305, c = 0.0035648506964878865, d = 0.0034471968062530244, m = 0.00031341162627410114
[Iteration 6030] [Rank 2] a = 0.9253419637680054, b = 1.0003025750012526, delta = 0.0006490977248176932, c = 0.0016051500209728596, d = 0.0015973087311656623, m = 0.0003141139638689817
[Iteration 6040] [Rank 2] a = 1.1422568559646606, b = 0.9996583629785826, delta = 0.0007188705494627357, c = 0.00031672593058233945, d = 0.00031741679312041846, m = 0.000315532628799964
[Iteration 6050] [Rank 2] a = 0.9664433598518372, b = 1.0000221193631496, delta = 0.0006452266243286431, c = 0.0010442387263064807, d = 0.001043927838164345, m = 0.000316406930428416
[Iteration 6060] [Rank 2] a = 0.9531583189964294, b = 0.9998926344523663, delta = 0.0006970195681788027, c = 0.0007852689039075496, d = 0.0007860288526994366, m = 0.00031700173986849554
[Iteration 6070] [Rank 2] a = 0.8504636287689209, b = 1.0008395649925106, delta = 0.0006354578072205186, c = 0.002679130379543643, d = 0.0026337407107918497, m = 0.0003179981771039338
[Iteration 6080] [Rank 2] a = 1.1981724500656128, b = 0.9996009350379974, delta = 0.0007910501444712281, c = 0.00020187003362669774, d = 0.00020228455114954517, m = 0.00031864591721628637
[Iteration 6090] [Rank 2] a = 1.0320945978164673, b = 0.9996960667976655, delta = 0.0007164638955146074, c = 0.0003921335766136675, d = 0.00039303169791317025, m = 0.000319410766906854
[Iteration 6100] [Rank 2] a = 0.9919611215591431, b = 0.9998127707447395, delta = 0.0006946614012122154, c = 0.0006255414851036738, d = 0.0006269577533067358, m = 0.00032007586086204816
[Iteration 6110] [Rank 2] a = 0.8653833270072937, b = 1.0020683648935382, delta = 0.0006243427051231265, c = 0.00513673568625224, d = 0.004905676710391702, m = 0.0003214605660982747
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6115 |     0.10961s |  92.8%
- batch.accumulate               |   6115 |     0.00083s |   0.7%
- batch.backward                 |   6115 |     0.05199s |  44.0%
- batch.evaluate                 |   6115 |     0.00275s |   2.3%
- batch.forward                  |   6115 |     0.02565s |  21.7%
- batch.mom                      |   6115 |     0.00126s |   1.1%
- batch.reduce                   |   6115 |     0.02434s |  20.6%
- batch.reporting.compr_err      |   6115 |     0.00001s |   0.0%
- batch.reporting.lr             |   6115 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6115 |     0.00001s |   0.0%
- batch.step                     |   6115 |     0.00048s |   0.4%
- batch.update_runavg            |   6115 |     0.00130s |   1.1%
- batch.wd                       |   6115 |     0.00001s |   0.0%
- epoch_metrics.collect          |     43 |     0.01536s |   0.1%
- reduce.combine                 |   6115 |     0.00597s |   5.1%
- reduce.flatpack                |   6115 |     0.00002s |   0.0%
- reduce.flatput                 |   6115 |     0.00016s |   0.1%
- reduce.gather.context          |   6115 |     0.00145s |   1.2%
- reduce.gather.tensors          |   6115 |     0.00305s |   2.6%
- reduce.heur_params             |   6115 |     0.01051s |   8.9%
- reduce.heur_params.alpha       |   6114 |     0.00829s |   7.0%
- reduce.heur_params.beta        |   6114 |     0.00215s |   1.8%
- reduce.memory                  |   6115 |     0.00044s |   0.4%
- reduce.pad                     |   6115 |     0.00028s |   0.2%
- reduce.threshold               |   6115 |     0.00225s |   1.9%
- test.last                      |     43 |     0.41441s |   2.6%
- test.runavg                    |     43 |     0.44517s |   2.8%
-----------------------------------------------------------------

[Iteration 5980] [Rank 0] a = 1.0716181993484497, b = 0.9996694340495045, delta = 0.0007992993923835456, c = 0.0003388680749277729, d = 0.00033986982560798754, m = 0.00024438045391578846
[Iteration 5990] [Rank 0] a = 1.0484371185302734, b = 0.9996774135109683, delta = 0.0007907281978987157, c = 0.0003548269995573989, d = 0.0003559323796183254, m = 0.0002451893403771715
[Iteration 6000] [Rank 0] a = 0.9807194471359253, b = 0.9998927035386195, delta = 0.0007281325524672866, c = 0.0007854070764151654, d = 0.0007861670252070523, m = 0.0002460582048149752
[Iteration 6010] [Rank 0] a = 0.9761501550674438, b = 0.9999082134024452, delta = 0.0006998730241321027, c = 0.0008164268043749146, d = 0.0008175667275627451, m = 0.0002472450484151568
[Iteration 6020] [Rank 0] a = 0.9590124487876892, b = 0.999773719741449, delta = 0.0007675887318328023, c = 0.0005474394751738374, d = 0.0005482339670926283, m = 0.0002485291063554094
[Iteration 6030] [Rank 0] a = 0.9908326864242554, b = 0.9996810578104818, delta = 0.0008029336459003389, c = 0.00036211559933413287, d = 0.00036349732441029095, m = 0.00024924957206224507
[Iteration 6040] [Rank 0] a = 0.8221674561500549, b = 0.9998576595369247, delta = 0.0007336238049902022, c = 0.000715319071927046, d = 0.000716079020718933, m = 0.0002502434142835541
[Iteration 6050] [Rank 0] a = 1.1275607347488403, b = 0.9996121097378207, delta = 0.0008412143215537071, c = 0.00022421943673355495, d = 0.00022463395425640237, m = 0.0002506943315948223
[Iteration 6060] [Rank 0] a = 1.071890950202942, b = 0.9997180880391765, delta = 0.0007634274079464376, c = 0.0004361760634162068, d = 0.00043697055533499767, m = 0.00025142954964068427
[Iteration 6070] [Rank 0] a = 1.0321108102798462, b = 0.9997290554811301, delta = 0.0007132189348340034, c = 0.00045811094900021653, d = 0.000459216329061143, m = 0.00025379855527843316
[Iteration 6080] [Rank 0] a = 0.970551073551178, b = 0.9997036490133377, delta = 0.0007872282294556499, c = 0.0004072980093245026, d = 0.00040840338938542906, m = 0.00025417572377165316
[Iteration 6090] [Rank 0] a = 1.0404127836227417, b = 0.9997952401085097, delta = 0.0006917552673257887, c = 0.0005904802112961621, d = 0.0005915165051032806, m = 0.0002553052849225893
[Iteration 6100] [Rank 0] a = 0.939653217792511, b = 0.9999805467099266, delta = 0.0007120964583009481, c = 0.0009610934198486672, d = 0.0009612315923562831, m = 0.0002559535523407569
[Iteration 6110] [Rank 0] a = 1.0267953872680664, b = 0.9997665002283076, delta = 0.0007383565534837544, c = 0.0005330004481279853, d = 0.000533967655681296, m = 0.0002573746772115991
cross_entropy                  - bits:11737309184.000, epoch: 44.000, ratio_transmit_grad:  0.179, value:  5.699 (split:train)
last_cross_entropy             - bits:11737309184.000, epoch: 44.000, ratio_transmit_grad:  0.179, value:  5.699 (split:train)
perplexity                     - bits:11737309184.000, epoch: 44.000, ratio_transmit_grad:  0.179, value:299.457 (split:train)
last_perplexity                - bits:11737309184.000, epoch: 44.000, ratio_transmit_grad:  0.179, value:299.457 (split:train)
last_cross_entropy             - bits:11737309184.000, epoch: 44.000, ratio_transmit_grad:  0.179, value:  5.421 (split:test)
last_perplexity                - bits:11737309184.000, epoch: 44.000, ratio_transmit_grad:  0.179, value:226.753 (split:test)
runavg_cross_entropy           - bits:11737309184.000, epoch: 44.000, ratio_transmit_grad:  0.179, value:  5.587 (split:test)
runavg_perplexity              - bits:11737309184.000, epoch: 44.000, ratio_transmit_grad:  0.179, value:267.470 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6115 |     0.10962s |  92.8%
- batch.accumulate               |   6115 |     0.00083s |   0.7%
- batch.backward                 |   6115 |     0.05172s |  43.8%
- batch.evaluate                 |   6115 |     0.00275s |   2.3%
- batch.forward                  |   6115 |     0.02547s |  21.6%
- batch.mom                      |   6115 |     0.00126s |   1.1%
- batch.reduce                   |   6115 |     0.02476s |  21.0%
- batch.reporting.compr_err      |   6115 |     0.00001s |   0.0%
- batch.reporting.lr             |   6115 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6115 |     0.00001s |   0.0%
- batch.step                     |   6115 |     0.00048s |   0.4%
- batch.update_runavg            |   6115 |     0.00130s |   1.1%
- batch.wd                       |   6115 |     0.00001s |   0.0%
- epoch_metrics.collect          |     43 |     0.01012s |   0.1%
- reduce.combine                 |   6115 |     0.00611s |   5.2%
- reduce.flatpack                |   6115 |     0.00002s |   0.0%
- reduce.flatput                 |   6115 |     0.00015s |   0.1%
- reduce.gather.context          |   6115 |     0.00128s |   1.1%
- reduce.gather.tensors          |   6115 |     0.00312s |   2.6%
- reduce.heur_params             |   6115 |     0.01091s |   9.2%
- reduce.heur_params.alpha       |   6114 |     0.00872s |   7.4%
- reduce.heur_params.beta        |   6114 |     0.00211s |   1.8%
- reduce.memory                  |   6115 |     0.00044s |   0.4%
- reduce.pad                     |   6115 |     0.00029s |   0.2%
- reduce.threshold               |   6115 |     0.00220s |   1.9%
- test.last                      |     43 |     0.41439s |   2.6%
- test.runavg                    |     43 |     0.44517s |   2.8%
-----------------------------------------------------------------

[Iteration 6120] [Rank 0] a = 1.0579367876052856, b = 0.9997072069551001, delta = 0.0007428826647810638, c = 0.00041441389346671677, d = 0.0004155538166545472, m = 0.00025825853646985983
[Iteration 6130] [Rank 0] a = 0.9887403845787048, b = 0.9997135456183552, delta = 0.0007850401452742517, c = 0.0004270912210404673, d = 0.00042798934233997005, m = 0.0002587413115294207
[Iteration 6140] [Rank 0] a = 1.036028504371643, b = 0.9997582616930062, delta = 0.0007138060173019767, c = 0.0005165233765948, d = 0.0005176632997826305, m = 0.0002595760568073459
[Iteration 6150] [Rank 0] a = 0.8660352230072021, b = 1.000634033499733, delta = 0.0006313787307590246, c = 0.0022680671693866097, d = 0.0022486539320665886, m = 0.00026270146849511846
[Iteration 6160] [Rank 0] a = 0.9993292689323425, b = 0.9997577262745706, delta = 0.0006862098816782236, c = 0.0005154525396607776, d = 0.0005165233765948, m = 0.0002636277003861472
[Iteration 6170] [Rank 0] a = 1.0821595191955566, b = 0.9996948750598976, delta = 0.0007229879265651107, c = 0.00038975010085729475, d = 0.00039071730841060544, m = 0.0002643079753860993
[Iteration 6180] [Rank 0] a = 0.8434569835662842, b = 1.0005649299992236, delta = 0.0006686564884148538, c = 0.0021298601186438963, d = 0.0021135557627452307, m = 0.0002650198322825302
[Iteration 6190] [Rank 0] a = 1.1246974468231201, b = 0.9996677932511571, delta = 0.0007534149335697293, c = 0.00033558647787189746, d = 0.0003359664522678409, m = 0.00026573479055336165
[Iteration 6200] [Rank 0] a = 1.0390018224716187, b = 0.9997357395757073, delta = 0.0007026530802249908, c = 0.0004714791391120461, d = 0.00047279177793439634, m = 0.00026680894525299756
[Iteration 6210] [Rank 0] a = 1.0084824562072754, b = 0.9997675883367458, delta = 0.0007002655765973032, c = 0.0005351766651229343, d = 0.0005363511314376687, m = 0.0002681345961576791
[Iteration 6220] [Rank 0] a = 1.0054682493209839, b = 0.9997636849636202, delta = 0.000716531474608928, c = 0.0005273699184426411, d = 0.0005284407553766636, m = 0.0002686279107697378
[Iteration 6230] [Rank 0] a = 1.0274230241775513, b = 0.9997753087252057, delta = 0.0007098233327269554, c = 0.0005506174428490011, d = 0.0005515501072754078, m = 0.00026938334721911397
timer                          - epoch: -1.000, value:  0.000 (event:reduce.pad)
[Iteration 6240] [Rank 0] a = 0.9489014744758606, b = 0.9998645854337355, delta = 0.0007345590856857598, c = 0.0007291708658155309, d = 0.0007302762458764574, m = 0.0002700277796959554

[Iteration 6120] [Rank 3] a = 1.0628952980041504, b = 0.999755895488953, delta = 0.0006783569697290659, c = 0.0005117909682089586, d = 0.0005126545463815574, m = 0.0003775383295320449
[Iteration 6130] [Rank 3] a = 1.017307996749878, b = 0.9998137552238221, delta = 0.0006553487037308514, c = 0.000627510443337199, d = 0.0006285121940174137, m = 0.0003782283256728158
[Iteration 6140] [Rank 3] a = 1.02591872215271, b = 0.9997966736482166, delta = 0.0006280362140387297, c = 0.0005933472908291902, d = 0.000594176325874885, m = 0.0003811438166329331
[Iteration 6150] [Rank 3] a = 0.9935842752456665, b = 0.9997919930547191, delta = 0.0006554403807967901, c = 0.000583986103438219, d = 0.0005847805953570099, m = 0.0003816819529531364
[Iteration 6160] [Rank 3] a = 1.0342434644699097, b = 0.9997394529615939, delta = 0.0006725978455506265, c = 0.00047890591139639586, d = 0.00047973494644209077, m = 0.0003821927475916776
[Iteration 6250] [Rank 0] a = 1.0443475246429443, b = 0.9997353423297759, delta = 0.000710749882273376, c = 0.00047068464719325523, d = 0.0004714100528582382, m = 0.00027082452510571197
cross_entropy                  - bits:12184015296.000, epoch: 45.000, ratio_transmit_grad:  0.173, value:  5.681 (split:train)
last_cross_entropy             - bits:12184015296.000, epoch: 45.000, ratio_transmit_grad:  0.173, value:  5.681 (split:train)
perplexity                     - bits:12184015296.000, epoch: 45.000, ratio_transmit_grad:  0.173, value:293.999 (split:train)
last_perplexity                - bits:12184015296.000, epoch: 45.000, ratio_transmit_grad:  0.173, value:293.999 (split:train)
last_cross_entropy             - bits:12184015296.000, epoch: 45.000, ratio_transmit_grad:  0.173, value:  5.401 (split:test)
last_perplexity                - bits:12184015296.000, epoch: 45.000, ratio_transmit_grad:  0.173, value:222.251 (split:test)
[Iteration 6170] [Rank 3] a = 1.126253366470337, b = 0.9996351327286396, delta = 0.0007347682840190828, c = 0.00027026542489652346, d = 0.0002706799424193709, m = 0.0003829747724269123
[Iteration 6180] [Rank 3] a = 1.0311267375946045, b = 0.99975185394335, delta = 0.0006747953593730927, c = 0.0005037078765134337, d = 0.0005045023684322246, m = 0.00038360523569252206
[Iteration 6190] [Rank 3] a = 0.9586451053619385, b = 1.0001098243619209, delta = 0.0006389868794940412, c = 0.001219648724724751, d = 0.0012174725077298018, m = 0.00038422607403196447
[Iteration 6200] [Rank 3] a = 1.0013002157211304, b = 0.9999493197232465, delta = 0.000603294582106173, c = 0.0008986394464063213, d = 0.0008992957658174965, m = 0.00038566710437136297
[Iteration 6210] [Rank 3] a = 1.0238028764724731, b = 0.9998219246730639, delta = 0.000636640761513263, c = 0.0006438493423627685, d = 0.0006446092911546555, m = 0.0003863115330698571

[Iteration 6120] [Rank 1] a = 0.9959562420845032, b = 0.9999952448104221, delta = 0.0006352888885885477, c = 0.0009904896208439307, d = 0.0009905932502246426, m = 0.0005229297694026745
[Iteration 6130] [Rank 1] a = 1.0119366645812988, b = 0.9998009569957792, delta = 0.0006862524896860123, c = 0.0006019139863013704, d = 0.0006031920819968166, m = 0.0005232407780762068
[Iteration 6140] [Rank 1] a = 1.1126422882080078, b = 0.9996890890866903, delta = 0.000710363790858537, c = 0.0003781781533444707, d = 0.000378730843374934, m = 0.000523897217626232
[Iteration 6150] [Rank 1] a = 0.967173159122467, b = 0.9998270543272509, delta = 0.0006981008918955922, c = 0.0006541086510532424, d = 0.0006551794879872649, m = 0.0005241677969731651
[Iteration 6160] [Rank 1] a = 0.8859421014785767, b = 0.9998320458089437, delta = 0.0007048175320960581, c = 0.0006640916147284846, d = 0.0006650242791548913, m = 0.0005250498829526078
runavg_cross_entropy           - bits:12184015296.000, epoch: 45.000, ratio_transmit_grad:  0.173, value:  5.571 (split:test)
runavg_perplexity              - bits:12184015296.000, epoch: 45.000, ratio_transmit_grad:  0.173, value:263.424 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6254 |     0.10968s |  92.8%
- batch.accumulate               |   6254 |     0.00083s |   0.7%
- batch.backward                 |   6254 |     0.05172s |  43.8%
- batch.evaluate                 |   6254 |     0.00275s |   2.3%
- batch.forward                  |   6254 |     0.02547s |  21.5%
- batch.mom                      |   6254 |     0.00126s |   1.1%
- batch.reduce                   |   6254 |     0.02483s |  21.0%
- batch.reporting.compr_err      |   6254 |     0.00001s |   0.0%
- batch.reporting.lr             |   6254 |     0.00001s |   0.0%
[Iteration 6220] [Rank 3] a = 0.9936462044715881, b = 0.9998684369923164, delta = 0.0006467651692219079, c = 0.0007368739831151123, d = 0.0007389120276024455, m = 0.00038697772757285677
[Iteration 6230] [Rank 3] a = 0.9951260089874268, b = 0.9998217519574348, delta = 0.000661732570733875, c = 0.000643503911093729, d = 0.0006446438342815594, m = 0.00038757592396356644
[Iteration 6240] [Rank 3] a = 0.8918914198875427, b = 1.0000831570682007, delta = 0.0006121263140812516, c = 0.0011663141367850485, d = 0.0011652778429779298, m = 0.000388882443485125
[Iteration 6250] [Rank 3] a = 0.9518532752990723, b = 0.9997530974958424, delta = 0.0007244546432048082, c = 0.0005061949816505183, d = 0.0005068513010616934, m = 0.00038962211832344577
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6254 |     0.10982s |  92.9%
- batch.accumulate               |   6254 |     0.00082s |   0.7%
[Iteration 6170] [Rank 1] a = 1.050196886062622, b = 0.9997352559719646, delta = 0.0006715032504871488, c = 0.00047051193155873543, d = 0.0004712718803506224, m = 0.0005263265547976875
[Iteration 6180] [Rank 1] a = 1.0924019813537598, b = 0.9997200224541304, delta = 0.0006661629304289818, c = 0.00044004489362944947, d = 0.0004409084718020483, m = 0.0005277278346405762
[Iteration 6190] [Rank 1] a = 1.0976369380950928, b = 0.9997244094309088, delta = 0.0006788976606912911, c = 0.00044881884786305334, d = 0.00044992422792397986, m = 0.0005283196284598558
[Iteration 6200] [Rank 1] a = 0.9802208542823792, b = 0.9999288011059425, delta = 0.0006591950077563524, c = 0.0008576022116444259, d = 0.0008585348760708326, m = 0.0005286581358703217
[Iteration 6210] [Rank 1] a = 0.9935293793678284, b = 0.9998593003354199, delta = 0.0006661213701590896, c = 0.0007186006689829215, d = 0.0007191879021402887, m = 0.0005292432059518062
- batch.reporting.memory_norm    |   6254 |     0.00001s |   0.0%
- batch.step                     |   6254 |     0.00048s |   0.4%
- batch.update_runavg            |   6254 |     0.00130s |   1.1%
- batch.wd                       |   6254 |     0.00001s |   0.0%
- epoch_metrics.collect          |     44 |     0.00991s |   0.1%
- reduce.combine                 |   6254 |     0.00612s |   5.2%
- reduce.flatpack                |   6254 |     0.00002s |   0.0%
- reduce.flatput                 |   6254 |     0.00016s |   0.1%
- reduce.gather.context          |   6254 |     0.00127s |   1.1%
- reduce.gather.tensors          |   6254 |     0.00316s |   2.7%
- reduce.heur_params             |   6254 |     0.01092s |   9.2%
- reduce.heur_params.alpha       |   6253 |     0.00872s |   7.4%
- reduce.heur_params.beta        |   6253 |     0.00212s |   1.8%
- reduce.memory                  |   6254 |     0.00045s |   0.4%
- reduce.pad                     |   6254 |     0.00029s |   0.2%
- batch.backward                 |   6254 |     0.05173s |  43.8%
- batch.evaluate                 |   6254 |     0.00277s |   2.3%
- batch.forward                  |   6254 |     0.02537s |  21.5%
- batch.mom                      |   6254 |     0.00126s |   1.1%
- batch.reduce                   |   6254 |     0.02509s |  21.2%
- batch.reporting.compr_err      |   6254 |     0.00001s |   0.0%
- batch.reporting.lr             |   6254 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   6254 |     0.00001s |   0.0%
- batch.step                     |   6254 |     0.00047s |   0.4%
- batch.update_runavg            |   6254 |     0.00129s |   1.1%
- batch.wd                       |   6254 |     0.00001s |   0.0%
- epoch_metrics.collect          |     44 |     0.01118s |   0.1%
- reduce.combine                 |   6254 |     0.00584s |   4.9%
- reduce.flatpack                |   6254 |     0.00002s |   0.0%
- reduce.flatput                 |   6254 |     0.00017s |   0.1%
[Iteration 6220] [Rank 1] a = 1.0178937911987305, b = 0.9998121316969143, delta = 0.0006639601197093725, c = 0.0006242633894082276, d = 0.0006254033125960579, m = 0.0005297583804918864
[Iteration 6230] [Rank 1] a = 0.9464082717895508, b = 1.000283938985891, delta = 0.0006368631147779524, c = 0.001567877987043495, d = 0.0015607966460281847, m = 0.0005304065924770729
[Iteration 6240] [Rank 1] a = 0.926299512386322, b = 0.9999612025588775, delta = 0.0006646009860560298, c = 0.0009224051177162406, d = 0.0009228887214928959, m = 0.0005307215260757012
[Iteration 6250] [Rank 1] a = 0.9278054237365723, b = 1.0001743509216523, delta = 0.0006511785322800279, c = 0.001348701846837917, d = 0.0013441421540865953, m = 0.0005311505644902891
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6254 |     0.10974s |  92.8%
- batch.accumulate               |   6254 |     0.00083s |   0.7%
- reduce.threshold               |   6254 |     0.00222s |   1.9%
- test.last                      |     44 |     0.41428s |   2.6%
- test.runavg                    |     44 |     0.44487s |   2.8%
-----------------------------------------------------------------

[Iteration 6260] [Rank 0] a = 1.1085671186447144, b = 0.9996241652873521, delta = 0.0008127828477881849, c = 0.0002483305393125137, d = 0.00024905594497749673, m = 0.0002713662643100392
[Iteration 6270] [Rank 0] a = 1.0597033500671387, b = 0.9996948750598976, delta = 0.000780734175350517, c = 0.00038975010085729475, d = 0.0003907518515375094, m = 0.0002729034765025209
[Iteration 6280] [Rank 0] a = 1.0214169025421143, b = 0.9998065529821223, delta = 0.0007032605935819447, c = 0.0006131059594182509, d = 0.0006142113394791773, m = 0.0002736074902982536
[Iteration 6290] [Rank 0] a = 1.0835834741592407, b = 0.9996824395354179, delta = 0.0007896151510067284, c = 0.00036487904948644904, d = 0.0003655008257707202, m = 0.0002741217468848284
- reduce.gather.context          |   6254 |     0.00264s |   2.2%
- reduce.gather.tensors          |   6254 |     0.00283s |   2.4%
- reduce.heur_params             |   6254 |     0.01038s |   8.8%
- batch.backward                 |   6254 |     0.05175s |  43.8%
- batch.evaluate                 |   6254 |     0.00276s |   2.3%
- batch.forward                  |   6254 |     0.02540s |  21.5%
- batch.mom                      |   6254 |     0.00126s |   1.1%
- batch.reduce                   |   6254 |     0.02498s |  21.1%
- batch.reporting.compr_err      |   6254 |     0.00001s |   0.0%
- batch.reporting.lr             |   6254 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6254 |     0.00001s |   0.0%
- batch.step                     |   6254 |     0.00048s |   0.4%
- batch.update_runavg            |   6254 |     0.00129s |   1.1%
- batch.wd                       |   6254 |     0.00001s |   0.0%
- epoch_metrics.collect          |     44 |     0.01103s |   0.1%
- reduce.combine                 |   6254 |     0.00588s |   5.0%
- reduce.flatpack                |   6254 |     0.00002s |   0.0%
- reduce.flatput                 |   6254 |     0.00022s |   0.2%
[Iteration 6300] [Rank 0] a = 1.0433098077774048, b = 0.9996432158192827, delta = 0.0008115597884170711, c = 0.00028643160828757317, d = 0.00028701884144494036, m = 0.0002748910735849639
[Iteration 6310] [Rank 0] a = 1.0926140546798706, b = 0.9997181743969867, delta = 0.0007187161245383322, c = 0.0004363487790507265, d = 0.0004377995903806925, m = 0.0002762518894573931
[Iteration 6320] [Rank 0] a = 0.9630411267280579, b = 0.9998716149599381, delta = 0.0006939686136320233, c = 0.0007432299184654395, d = 0.0007439553241304225, m = 0.0002772694714984614
[Iteration 6330] [Rank 0] a = 0.985034704208374, b = 0.9999670748904439, delta = 0.0006956849829293787, c = 0.0009341497808635844, d = 0.0009347024708940476, m = 0.0002778458598065248
[Iteration 6340] [Rank 0] a = 1.0940107107162476, b = 0.9997030790517941, delta = 0.0007229936309158802, c = 0.0004061580861366722, d = 0.0004070907505630789, m = 0.0002788897666971852
- reduce.heur_params.alpha       |   6253 |     0.00811s |   6.9%
- reduce.heur_params.beta        |   6253 |     0.00220s |   1.9%
- reduce.memory                  |   6254 |     0.00044s |   0.4%
- reduce.pad                     |   6254 |     0.00027s |   0.2%
- reduce.threshold               |   6254 |     0.00231s |   2.0%
- test.last                      |     44 |     0.41429s |   2.6%
- test.runavg                    |     44 |     0.44486s |   2.8%
-----------------------------------------------------------------

[Iteration 6260] [Rank 3] a = 1.0722347497940063, b = 0.999735705032583, delta = 0.0006588681135326624, c = 0.0004714100528582382, d = 0.00047223908790393305, m = 0.00039052058748217846
[Iteration 6270] [Rank 3] a = 1.022997498512268, b = 0.9998471411550119, delta = 0.0006352240452542901, c = 0.000694282307642539, d = 0.0006951804289420418, m = 0.00039144915889435485
- reduce.gather.context          |   6254 |     0.00151s |   1.3%
- reduce.gather.tensors          |   6254 |     0.00312s |   2.6%
- reduce.heur_params             |   6254 |     0.01080s |   9.1%
[Iteration 6350] [Rank 0] a = 1.047071933746338, b = 0.99969896842006, delta = 0.000736599147785455, c = 0.0003979368219335315, d = 0.00039876585697922633, m = 0.00027970118105931916
[Iteration 6360] [Rank 0] a = 1.0230181217193604, b = 0.9996922843256233, delta = 0.0007400564500130713, c = 0.0003845686318217019, d = 0.00038557038250191654, m = 0.00028052922457362734
[Iteration 6370] [Rank 0] a = 0.8962880969047546, b = 1.000713759000379, delta = 0.0006583714857697487, c = 0.002427518243175254, d = 0.0023951858763931544, m = 0.00028142013307678375
[Iteration 6380] [Rank 0] a = 0.9928655624389648, b = 0.9998454139987074, delta = 0.0007083493983373046, c = 0.0006908279949521438, d = 0.0006920024612668781, m = 0.0002820689753866763
[Iteration 6390] [Rank 0] a = 1.0189961194992065, b = 0.9998527371414442, delta = 0.0006715335766784847, c = 0.0007054742807594196, d = 0.0007064760314396343, m = 0.0002832813788892478
[Iteration 6280] [Rank 3] a = 0.9460477828979492, b = 0.9999664185710332, delta = 0.0006333781639114022, c = 0.0009328371420412342, d = 0.0009332516595640816, m = 0.0003926446400038618
[Iteration 6290] [Rank 3] a = 0.9842514991760254, b = 0.9998800089396462, delta = 0.0006411754293367267, c = 0.0007600178781407604, d = 0.0007609505425671671, m = 0.00039347192922767213
[Iteration 6300] [Rank 3] a = 1.0035995244979858, b = 1.0000955753222236, delta = 0.0005687435041181743, c = 0.00119115064502899, d = 0.0011890089711609451, m = 0.0003951944452266724
[Iteration 6310] [Rank 3] a = 1.0501923561096191, b = 0.99974755332432, delta = 0.0006613910663872957, c = 0.0004951066379143495, d = 0.0004956938710717168, m = 0.0003956727118104225
[Iteration 6320] [Rank 3] a = 0.9475653767585754, b = 1.0001194100795108, delta = 0.0006063730106689036, c = 0.0012388201601564444, d = 0.001237058460684343, m = 0.00039651705078088247
- reduce.heur_params.alpha       |   6253 |     0.00827s |   7.0%
- reduce.heur_params.beta        |   6253 |     0.00245s |   2.1%
- reduce.memory                  |   6254 |     0.00046s |   0.4%
- reduce.pad                     |   6254 |     0.00017s |   0.1%
- reduce.threshold               |   6254 |     0.00260s |   2.2%
- test.last                      |     44 |     0.41429s |   2.6%
- test.runavg                    |     44 |     0.44486s |   2.8%
-----------------------------------------------------------------

[Iteration 6260] [Rank 1] a = 0.9664897322654724, b = 0.9999057608404563, delta = 0.0006644832319580019, c = 0.0008115216803545535, d = 0.0008123852585271523, m = 0.0005318418878721657
[Iteration 6270] [Rank 1] a = 1.0330673456192017, b = 0.9997801793058587, delta = 0.0006796923698857427, c = 0.0005603586046359156, d = 0.0005613603553161303, m = 0.0005327749345551187
cross_entropy                  - bits:12642825536.000, epoch: 46.000, ratio_transmit_grad:  0.178, value:  5.659 (split:train)
last_cross_entropy             - bits:12642825536.000, epoch: 46.000, ratio_transmit_grad:  0.178, value:  5.659 (split:train)
perplexity                     - bits:12642825536.000, epoch: 46.000, ratio_transmit_grad:  0.178, value:287.718 (split:train)
last_perplexity                - bits:12642825536.000, epoch: 46.000, ratio_transmit_grad:  0.178, value:287.718 (split:train)
last_cross_entropy             - bits:12642825536.000, epoch: 46.000, ratio_transmit_grad:  0.178, value:  5.388 (split:test)
last_perplexity                - bits:12642825536.000, epoch: 46.000, ratio_transmit_grad:  0.178, value:219.462 (split:test)
runavg_cross_entropy           - bits:12642825536.000, epoch: 46.000, ratio_transmit_grad:  0.178, value:  5.560 (split:test)
runavg_perplexity              - bits:12642825536.000, epoch: 46.000, ratio_transmit_grad:  0.178, value:260.418 (split:test)

[Iteration 6120] [Rank 2] a = 1.014125108718872, b = 0.9996821631904308, delta = 0.0007384092314168811, c = 0.0003643263594559858, d = 0.00036515539450168065, m = 0.00032206137923197856
[Iteration 6130] [Rank 2] a = 0.9194455146789551, b = 1.0004960510235883, delta = 0.0006372774951159954, c = 0.001992102128550934, d = 0.0019752105394949013, m = 0.00032319983992292026
[Iteration 6140] [Rank 2] a = 0.9445814490318298, b = 1.0000329831765526, delta = 0.0006516006542369723, c = 0.0010659663531290668, d = 0.0010654827493524113, m = 0.0003240392241104349
[Iteration 6150] [Rank 2] a = 1.0942426919937134, b = 0.9996974830657385, delta = 0.0007571896421723068, c = 0.00039496611301979156, d = 0.0003958987774461983, m = 0.0003244873910042436
[Iteration 6160] [Rank 2] a = 1.0266727209091187, b = 0.9997634604333081, delta = 0.0006988804670982063, c = 0.0005269208577928897, d = 0.0005281989534883359, m = 0.0003252620020390762
[Iteration 6330] [Rank 3] a = 1.013419508934021, b = 0.9997932193356713, delta = 0.0006852589431218803, c = 0.0005864386654483996, d = 0.0005874058730017104, m = 0.0003969445541082475
[Iteration 6340] [Rank 3] a = 1.102944254875183, b = 0.9996747191473526, delta = 0.0007007400854490697, c = 0.00034943827176038236, d = 0.0003499909617908456, m = 0.0003981286422433484
[Iteration 6350] [Rank 3] a = 0.9917389750480652, b = 0.9998610620348575, delta = 0.0006625888054259121, c = 0.0007221240679271246, d = 0.0007235748792570907, m = 0.00039857691135089854
[Iteration 6360] [Rank 3] a = 1.1547905206680298, b = 0.9996821977335542, delta = 0.0006806486053392291, c = 0.0003643954457097937, d = 0.00036512085137477675, m = 0.0003997080518548898
[Iteration 6370] [Rank 3] a = 0.9327458739280701, b = 1.0001035893275858, delta = 0.0006295895436778665, c = 0.0012071786559124241, d = 0.0012059005602169778, m = 0.00040025143373529715
[Iteration 6280] [Rank 1] a = 0.9259406924247742, b = 1.0009580305503882, delta = 0.000625021115411073, c = 0.0029160616869778524, d = 0.002866354127363065, m = 0.000533428577215725
[Iteration 6290] [Rank 1] a = 1.1145740747451782, b = 0.9996651852453659, delta = 0.0007616715156473219, c = 0.00033037046570940065, d = 0.00033099224199367174, m = 0.0005336182050880009
[Iteration 6300] [Rank 1] a = 0.8796324133872986, b = 1.000337498098972, delta = 0.0006568895187228918, c = 0.0016749962235726513, d = 0.0016667058731157027, m = 0.0005341823098844265
[Iteration 6310] [Rank 1] a = 0.9390224814414978, b = 0.9998539979655491, delta = 0.000688619795255363, c = 0.0007079959290234081, d = 0.0007087558778152951, m = 0.0005346481569233477
[Iteration 6320] [Rank 1] a = 1.0331851243972778, b = 0.9997252211943295, delta = 0.0007071545114740729, c = 0.00045044237482753913, d = 0.0004513404961270419, m = 0.0005357212344309517
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6393 |     0.10974s |  92.8%
- batch.accumulate               |   6393 |     0.00083s |   0.7%
- batch.backward                 |   6393 |     0.05172s |  43.7%
- batch.evaluate                 |   6393 |     0.00275s |   2.3%
- batch.forward                  |   6393 |     0.02546s |  21.5%
- batch.mom                      |   6393 |     0.00126s |   1.1%
- batch.reduce                   |   6393 |     0.02490s |  21.1%
- batch.reporting.compr_err      |   6393 |     0.00001s |   0.0%
- batch.reporting.lr             |   6393 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6393 |     0.00001s |   0.0%
- batch.step                     |   6393 |     0.00048s |   0.4%
- batch.update_runavg            |   6393 |     0.00130s |   1.1%
- batch.wd                       |   6393 |     0.00001s |   0.0%
[Iteration 6380] [Rank 3] a = 1.0621131658554077, b = 0.9997549628245823, delta = 0.0006518364534713328, c = 0.0005099256393561451, d = 0.000510720131274936, m = 0.0004008954967819051
[Iteration 6390] [Rank 3] a = 0.8850219249725342, b = 1.0009632292861896, delta = 0.0005894264904782176, c = 0.002926459168175942, d = 0.002841586705372931, m = 0.0004021868156348667
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6393 |     0.10988s |  92.9%
- batch.accumulate               |   6393 |     0.00082s |   0.7%
- batch.backward                 |   6393 |     0.05173s |  43.7%
- batch.evaluate                 |   6393 |     0.00277s |   2.3%
- batch.forward                  |   6393 |     0.02537s |  21.5%
- batch.mom                      |   6393 |     0.00126s |   1.1%
- batch.reduce                   |   6393 |     0.02515s |  21.3%
[Iteration 6330] [Rank 1] a = 0.9655942320823669, b = 0.9999589054409421, delta = 0.0006791363121010363, c = 0.000917810881838015, d = 0.0009181217699801505, m = 0.000536131361636916
[Iteration 6340] [Rank 1] a = 1.011438250541687, b = 0.9997975890410418, delta = 0.0006846842006780207, c = 0.0005951780765550996, d = 0.0005965252585043538, m = 0.0005369515586422461
[Iteration 6350] [Rank 1] a = 1.0607830286026, b = 0.999732803410128, delta = 0.0007264281157404184, c = 0.0004656068075383742, d = 0.00046650492883787696, m = 0.000537213404248835
[Iteration 6360] [Rank 1] a = 0.9952321648597717, b = 0.9998352237765308, delta = 0.000686394632793963, c = 0.0006704475500788118, d = 0.0006715874732666423, m = 0.0005379918783762797
[Iteration 6370] [Rank 1] a = 0.9300693273544312, b = 0.9998953979024877, delta = 0.0006959703750908375, c = 0.0007907958042121819, d = 0.0007916939255116848, m = 0.0005383561400951123
- epoch_metrics.collect          |     45 |     0.00971s |   0.1%
- reduce.combine                 |   6393 |     0.00614s |   5.2%
- reduce.flatpack                |   6393 |     0.00002s |   0.0%
[Iteration 6170] [Rank 2] a = 1.056687593460083, b = 0.9997125956824436, delta = 0.0007125585107132792, c = 0.0004251913490607499, d = 0.00042595129785263686, m = 0.00032681757272279695
[Iteration 6180] [Rank 2] a = 1.0749255418777466, b = 0.9997755159839568, delta = 0.0006679081707261503, c = 0.0005510319603718485, d = 0.0005518264522906393, m = 0.00032784396095337576
[Iteration 6190] [Rank 2] a = 1.0294125080108643, b = 0.9997489005061837, delta = 0.0006865731556899846, c = 0.0004978010018128579, d = 0.0004989754681275923, m = 0.0003284924656498037
[Iteration 6200] [Rank 2] a = 0.8741790652275085, b = 1.000285493426476, delta = 0.0006383382133208215, c = 0.0015709868684648505, d = 0.0015581022821296764, m = 0.0003293610332081897
[Iteration 6210] [Rank 2] a = 1.0438008308410645, b = 0.9997363440803861, delta = 0.0006856580730527639, c = 0.00047268814855368446, d = 0.00047358626985318723, m = 0.0003303523237548106
- batch.reporting.compr_err      |   6393 |     0.00001s |   0.0%
- batch.reporting.lr             |   6393 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   6393 |     0.00001s |   0.0%
- batch.step                     |   6393 |     0.00047s |   0.4%
- batch.update_runavg            |   6393 |     0.00129s |   1.1%
[Iteration 6380] [Rank 1] a = 1.0978256464004517, b = 0.9997184507419801, delta = 0.0007025597151368856, c = 0.0004369014690811898, d = 0.00043773050412688466, m = 0.0005396565205391079
[Iteration 6390] [Rank 1] a = 0.9697737693786621, b = 1.0000695988909705, delta = 0.0006323155830614269, c = 0.0011391977821654457, d = 0.001138230574612135, m = 0.0005409660413043793
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6393 |     0.10980s |  92.8%
- batch.accumulate               |   6393 |     0.00083s |   0.7%
- batch.backward                 |   6393 |     0.05175s |  43.8%
- batch.evaluate                 |   6393 |     0.00276s |   2.3%
- batch.forward                  |   6393 |     0.02540s |  21.5%
- batch.mom                      |   6393 |     0.00126s |   1.1%
- batch.reduce                   |   6393 |     0.02503s |  21.2%
- reduce.flatput                 |   6393 |     0.00016s |   0.1%
- reduce.gather.context          |   6393 |     0.00127s |   1.1%
- reduce.gather.tensors          |   6393 |     0.00320s |   2.7%
- reduce.heur_params             |   6393 |     0.01093s |   9.2%
- reduce.heur_params.alpha       |   6392 |     0.00872s |   7.4%
- reduce.heur_params.beta        |   6392 |     0.00213s |   1.8%
- reduce.memory                  |   6393 |     0.00045s |   0.4%
- reduce.pad                     |   6393 |     0.00029s |   0.2%
- reduce.threshold               |   6393 |     0.00223s |   1.9%
- test.last                      |     45 |     0.41410s |   2.6%
- test.runavg                    |     45 |     0.44476s |   2.8%
-----------------------------------------------------------------
[Iteration 6220] [Rank 2] a = 0.9234336614608765, b = 0.9999549329813555, delta = 0.0006725510465912521, c = 0.0009098659626501058, d = 0.0009102113939191454, m = 0.00033098848839235607
[Iteration 6230] [Rank 2] a = 1.0642297267913818, b = 0.9996826813372819, delta = 0.0007204015273600817, c = 0.0003653626532631044, d = 0.00036619168830879926, m = 0.0003319111800868715
[Iteration 6240] [Rank 2] a = 0.9972506165504456, b = 0.9998855358398748, delta = 0.0006751043838448822, c = 0.0007710716787500252, d = 0.0007728679213490307, m = 0.0003325717169237037
[Iteration 6250] [Rank 2] a = 0.9088701605796814, b = 1.0004535802586414, delta = 0.0006311382749117911, c = 0.0019071605794941152, d = 0.0018842584863567949, m = 0.00033371051143801095
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6254 |     0.10967s |  92.8%
- batch.accumulate               |   6254 |     0.00083s |   0.7%
- batch.wd                       |   6393 |     0.00001s |   0.0%
- epoch_metrics.collect          |     45 |     0.01097s |   0.1%
- reduce.combine                 |   6393 |     0.00586s |   5.0%
- reduce.flatpack                |   6393 |     0.00002s |   0.0%
- reduce.flatput                 |   6393 |     0.00017s |   0.1%
- reduce.gather.context          |   6393 |     0.00262s |   2.2%
- reduce.gather.tensors          |   6393 |     0.00286s |   2.4%
- reduce.heur_params             |   6393 |     0.01039s |   8.8%
- reduce.heur_params.alpha       |   6392 |     0.00811s |   6.9%
- reduce.heur_params.beta        |   6392 |     0.00220s |   1.9%
- reduce.memory                  |   6393 |     0.00044s |   0.4%
- reduce.pad                     |   6393 |     0.00027s |   0.2%
- reduce.threshold               |   6393 |     0.00232s |   2.0%
- test.last                      |     45 |     0.41411s |   2.6%
- test.runavg                    |     45 |     0.44476s |   2.8%
- batch.reporting.compr_err      |   6393 |     0.00001s |   0.0%
- batch.reporting.lr             |   6393 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6393 |     0.00001s |   0.0%
- batch.step                     |   6393 |     0.00048s |   0.4%
- batch.update_runavg            |   6393 |     0.00129s |   1.1%
- batch.backward                 |   6254 |     0.05198s |  44.0%
- batch.evaluate                 |   6254 |     0.00275s |   2.3%
- batch.forward                  |   6254 |     0.02564s |  21.7%
- batch.mom                      |   6254 |     0.00126s |   1.1%
- batch.reduce                   |   6254 |     0.02443s |  20.7%
- batch.reporting.compr_err      |   6254 |     0.00001s |   0.0%
- batch.reporting.lr             |   6254 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6254 |     0.00001s |   0.0%
- batch.step                     |   6254 |     0.00048s |   0.4%
- batch.update_runavg            |   6254 |     0.00130s |   1.1%
- batch.wd                       |   6254 |     0.00001s |   0.0%
- epoch_metrics.collect          |     44 |     0.01510s |   0.1%
- reduce.combine                 |   6254 |     0.00598s |   5.1%
- reduce.flatpack                |   6254 |     0.00002s |   0.0%
- reduce.flatput                 |   6254 |     0.00016s |   0.1%
-----------------------------------------------------------------
- batch.wd                       |   6393 |     0.00001s |   0.0%
- epoch_metrics.collect          |     45 |     0.01082s |   0.1%
- reduce.combine                 |   6393 |     0.00590s |   5.0%
- reduce.flatpack                |   6393 |     0.00002s |   0.0%
- reduce.flatput                 |   6393 |     0.00022s |   0.2%
- reduce.gather.context          |   6393 |     0.00150s |   1.3%
- reduce.gather.tensors          |   6393 |     0.00316s |   2.7%
- reduce.heur_params             |   6393 |     0.01081s |   9.1%
- reduce.heur_params.alpha       |   6392 |     0.00828s |   7.0%
- reduce.heur_params.beta        |   6392 |     0.00245s |   2.1%
- reduce.memory                  |   6393 |     0.00046s |   0.4%
- reduce.pad                     |   6393 |     0.00018s |   0.1%
- reduce.threshold               |   6393 |     0.00260s |   2.2%
- test.last                      |     45 |     0.41411s |   2.6%
- test.runavg                    |     45 |     0.44476s |   2.8%
- reduce.gather.context          |   6254 |     0.00148s |   1.3%
- reduce.gather.tensors          |   6254 |     0.00309s |   2.6%
- reduce.heur_params             |   6254 |     0.01052s |   8.9%
-----------------------------------------------------------------
- reduce.heur_params.alpha       |   6253 |     0.00829s |   7.0%
- reduce.heur_params.beta        |   6253 |     0.00215s |   1.8%
- reduce.memory                  |   6254 |     0.00044s |   0.4%
- reduce.pad                     |   6254 |     0.00028s |   0.2%
- reduce.threshold               |   6254 |     0.00225s |   1.9%
- test.last                      |     44 |     0.41429s |   2.6%
- test.runavg                    |     44 |     0.44486s |   2.8%
-----------------------------------------------------------------

[Iteration 6260] [Rank 2] a = 1.048030138015747, b = 0.999758797111442, delta = 0.0007073813467286527, c = 0.0005175942135288226, d = 0.0005182850760669016, m = 0.0003342435165730321
[Iteration 6270] [Rank 2] a = 1.028494954109192, b = 0.9997776576577181, delta = 0.0007081504445523024, c = 0.0005553153081079386, d = 0.0005562825156612492, m = 0.00033520965427623974
[Iteration 6280] [Rank 2] a = 0.9699031710624695, b = 1.0000749876187391, delta = 0.0006443075253628194, c = 0.001149975237759479, d = 0.001147764477637626, m = 0.0003360763787159478
[Iteration 6290] [Rank 2] a = 0.9637011289596558, b = 1.000368725081797, delta = 0.000640172918792814, c = 0.0017374501970149972, d = 0.0017240474637762635, m = 0.00033697525872902447
[Iteration 6300] [Rank 2] a = 0.9427163004875183, b = 0.999759177085816, delta = 0.0007297823904082179, c = 0.0005183541623207096, d = 0.0005193559130009241, m = 0.00033774986111663566
[Iteration 6310] [Rank 2] a = 0.9955927729606628, b = 0.9998357591949832, delta = 0.0006686064298264682, c = 0.0006715183870128344, d = 0.0006723474220585293, m = 0.00033985377189364664
[Iteration 6320] [Rank 2] a = 0.9643147587776184, b = 0.9998279179053979, delta = 0.0006867166957817972, c = 0.00065583580739844, d = 0.0006567339286979428, m = 0.0003404299696528631
[Iteration 6330] [Rank 2] a = 1.0312210321426392, b = 0.9998773491189138, delta = 0.0006506175850518048, c = 0.0007546982365975517, d = 0.0007556999872777664, m = 0.00034155034245724906
[Iteration 6340] [Rank 2] a = 0.968616247177124, b = 0.9998770727739026, delta = 0.0006690472364425659, c = 0.0007541455465670885, d = 0.0007552509266280149, m = 0.0003421378071468099
[Iteration 6350] [Rank 2] a = 0.8893249034881592, b = 1.0002580143710549, delta = 0.0006244744872674346, c = 0.0015160287535606624, d = 0.001511158172667205, m = 0.0003435137366074283
[Iteration 6360] [Rank 2] a = 1.06151282787323, b = 0.9997092622709761, delta = 0.0007150461315177381, c = 0.0004185245255682871, d = 0.0004194226468677899, m = 0.00034405872686347555
[Iteration 6370] [Rank 2] a = 0.988660454750061, b = 0.9998053094296004, delta = 0.0006957778823561966, c = 0.0006106188542811664, d = 0.0006117933205959008, m = 0.00034477022170390105
[Iteration 6380] [Rank 2] a = 1.1122394800186157, b = 0.9996631126579852, delta = 0.0007417112938128412, c = 0.00032622529048092634, d = 0.0003267779805113896, m = 0.0003453244024248542
[Iteration 6390] [Rank 2] a = 0.8918706774711609, b = 1.0006460372314148, delta = 0.0006479484145529568, c = 0.0022920746425848567, d = 0.002263576562889096, m = 0.00034617330037472446
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6393 |     0.10974s |  92.8%
- batch.accumulate               |   6393 |     0.00083s |   0.7%
- batch.backward                 |   6393 |     0.05197s |  43.9%
- batch.evaluate                 |   6393 |     0.00275s |   2.3%
- batch.forward                  |   6393 |     0.02563s |  21.7%
- batch.mom                      |   6393 |     0.00126s |   1.1%
- batch.reduce                   |   6393 |     0.02452s |  20.7%
- batch.reporting.compr_err      |   6393 |     0.00001s |   0.0%
- batch.reporting.lr             |   6393 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6393 |     0.00001s |   0.0%
- batch.step                     |   6393 |     0.00048s |   0.4%
- batch.update_runavg            |   6393 |     0.00130s |   1.1%
- batch.wd                       |   6393 |     0.00001s |   0.0%
- epoch_metrics.collect          |     45 |     0.01486s |   0.1%
- reduce.combine                 |   6393 |     0.00598s |   5.1%
- reduce.flatpack                |   6393 |     0.00002s |   0.0%
- reduce.flatput                 |   6393 |     0.00016s |   0.1%
- reduce.gather.context          |   6393 |     0.00151s |   1.3%
- reduce.gather.tensors          |   6393 |     0.00312s |   2.6%
- reduce.heur_params             |   6393 |     0.01052s |   8.9%
- reduce.heur_params.alpha       |   6392 |     0.00828s |   7.0%
- reduce.heur_params.beta        |   6392 |     0.00216s |   1.8%
- reduce.memory                  |   6393 |     0.00044s |   0.4%
- reduce.pad                     |   6393 |     0.00028s |   0.2%
- reduce.threshold               |   6393 |     0.00226s |   1.9%
- test.last                      |     45 |     0.41411s |   2.6%
- test.runavg                    |     45 |     0.44476s |   2.8%
-----------------------------------------------------------------

[Iteration 6400] [Rank 0] a = 1.0698338747024536, b = 0.9997033899399089, delta = 0.0007489741547033191, c = 0.0004067798624209433, d = 0.0004079543287356777, m = 0.000284159592262973
[Iteration 6410] [Rank 0] a = 1.0447957515716553, b = 0.9996921979678143, delta = 0.0007579026860184968, c = 0.00038439591618718216, d = 0.0003852940374866849, m = 0.00028486718342244966
[Iteration 6420] [Rank 0] a = 0.9828662276268005, b = 0.9997906804159538, delta = 0.000728518352843821, c = 0.0005813608257935187, d = 0.0005821207745854056, m = 0.00028590923293085325
[Iteration 6430] [Rank 0] a = 1.047379732131958, b = 0.9997954991819505, delta = 0.0006895463448017836, c = 0.0005909983581997214, d = 0.0005917583069916083, m = 0.00028677355355298046
[Iteration 6440] [Rank 0] a = 0.9330270886421204, b = 0.9998170368207661, delta = 0.000732238928321749, c = 0.00063407363744895, d = 0.0006348681293677409, m = 0.00028728786595586816
[Iteration 6450] [Rank 0] a = 1.0755281448364258, b = 0.9996807469223714, delta = 0.0007906368118710816, c = 0.0003614938230498617, d = 0.0003623919443493645, m = 0.00028775676102832013
[Iteration 6460] [Rank 0] a = 0.9813632369041443, b = 0.9997990571238756, delta = 0.0007297344272956252, c = 0.0005981142423419355, d = 0.0005991505361490542, m = 0.0002886270349180227
[Iteration 6470] [Rank 0] a = 1.0666662454605103, b = 0.9997587452967547, delta = 0.0006970509421080351, c = 0.0005174905841481107, d = 0.0005183887054476135, m = 0.0002898924174986678
[Iteration 6480] [Rank 0] a = 1.1115596294403076, b = 0.9997016109690307, delta = 0.0007177393999882042, c = 0.0004032219203498362, d = 0.0004038091535072034, m = 0.00029137457997714417
timer                          - epoch: -1.000, value:  0.000 (event:reduce.memory)
[Iteration 6490] [Rank 0] a = 0.8843941688537598, b = 1.0004560155485844, delta = 0.0006573747959919274, c = 0.0019120311603875726, d = 0.0018989738584178784, m = 0.00029214260201217043
[Iteration 6500] [Rank 0] a = 1.0299818515777588, b = 0.9997330624835613, delta = 0.0007218830287456512, c = 0.0004661249544419335, d = 0.0004671267051221481, m = 0.00029278611961728717
[Iteration 6510] [Rank 0] a = 0.9948393106460571, b = 0.999814480629462, delta = 0.0007151241879910231, c = 0.0006289612546671651, d = 0.000630412065997131, m = 0.0002933562505167935
[Iteration 6520] [Rank 0] a = 1.1656138896942139, b = 0.999669658579805, delta = 0.0007441263878718019, c = 0.0003393171355775243, d = 0.00034014617062321916, m = 0.00029470565921968213
[Iteration 6530] [Rank 0] a = 1.1395560503005981, b = 0.9996378616353044, delta = 0.0007675792439840734, c = 0.0002757232389473479, d = 0.0002760341270894835, m = 0.00029533282361081733
cross_entropy                  - bits:13056531648.000, epoch: 47.000, ratio_transmit_grad:  0.161, value:  5.643 (split:train)
last_cross_entropy             - bits:13056531648.000, epoch: 47.000, ratio_transmit_grad:  0.161, value:  5.643 (split:train)
perplexity                     - bits:13056531648.000, epoch: 47.000, ratio_transmit_grad:  0.161, value:283.074 (split:train)
last_perplexity                - bits:13056531648.000, epoch: 47.000, ratio_transmit_grad:  0.161, value:283.074 (split:train)
last_cross_entropy             - bits:13056531648.000, epoch: 47.000, ratio_transmit_grad:  0.161, value:  5.368 (split:test)
last_perplexity                - bits:13056531648.000, epoch: 47.000, ratio_transmit_grad:  0.161, value:215.127 (split:test)
runavg_cross_entropy           - bits:13056531648.000, epoch: 47.000, ratio_transmit_grad:  0.161, value:  5.543 (split:test)
runavg_perplexity              - bits:13056531648.000, epoch: 47.000, ratio_transmit_grad:  0.161, value:256.036 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6532 |     0.10979s |  92.8%
- batch.accumulate               |   6532 |     0.00083s |   0.7%
- batch.backward                 |   6532 |     0.05171s |  43.7%
- batch.evaluate                 |   6532 |     0.00275s |   2.3%
- batch.forward                  |   6532 |     0.02546s |  21.5%
- batch.mom                      |   6532 |     0.00126s |   1.1%
- batch.reduce                   |   6532 |     0.02496s |  21.1%
- batch.reporting.compr_err      |   6532 |     0.00001s |   0.0%
- batch.reporting.lr             |   6532 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6532 |     0.00001s |   0.0%
- batch.step                     |   6532 |     0.00048s |   0.4%
- batch.update_runavg            |   6532 |     0.00130s |   1.1%
- batch.wd                       |   6532 |     0.00001s |   0.0%
- epoch_metrics.collect          |     46 |     0.00951s |   0.1%
- reduce.combine                 |   6532 |     0.00615s |   5.2%
- reduce.flatpack                |   6532 |     0.00002s |   0.0%
- reduce.flatput                 |   6532 |     0.00016s |   0.1%
- reduce.gather.context          |   6532 |     0.00127s |   1.1%
- reduce.gather.tensors          |   6532 |     0.00323s |   2.7%
- reduce.heur_params             |   6532 |     0.01093s |   9.2%
- reduce.heur_params.alpha       |   6531 |     0.00872s |   7.4%
- reduce.heur_params.beta        |   6531 |     0.00214s |   1.8%
- reduce.memory                  |   6532 |     0.00045s |   0.4%
- reduce.pad                     |   6532 |     0.00029s |   0.2%
- reduce.threshold               |   6532 |     0.00224s |   1.9%
- test.last                      |     46 |     0.41386s |   2.6%
- test.runavg                    |     46 |     0.44455s |   2.8%
-----------------------------------------------------------------

[Iteration 6540] [Rank 0] a = 0.9979354739189148, b = 0.9999899251688791, delta = 0.0006609568954445422, c = 0.0009798503377575134, d = 0.0009803339415341687, m = 0.0002962593312108716
[Iteration 6550] [Rank 0] a = 1.0681352615356445, b = 0.999686705611166, delta = 0.0007215957739390433, c = 0.0003734112018317253, d = 0.00037396389186218854, m = 0.00029784529333498876
[Iteration 6560] [Rank 0] a = 1.0085721015930176, b = 0.9997414046481325, delta = 0.0007263792213052511, c = 0.0004828092847365425, d = 0.00048394920792437293, m = 0.00029829640633351466
[Iteration 6570] [Rank 0] a = 1.0023823976516724, b = 0.9998756910488475, delta = 0.0006885461043566465, c = 0.0007513820964147723, d = 0.0007524183902218909, m = 0.0002991525471504426
[Iteration 6580] [Rank 0] a = 0.9371358752250671, b = 1.0002319343118091, delta = 0.0006754199275746942, c = 0.0014638686319356942, d = 0.001457443610331559, m = 0.00029982233200277666
[Iteration 6590] [Rank 0] a = 0.9983053803443909, b = 0.9997649112445572, delta = 0.0007211812189780176, c = 0.0005298224804528217, d = 0.0005312042055289798, m = 0.00030030392051042827
[Iteration 6600] [Rank 0] a = 0.971199095249176, b = 0.9998755356047789, delta = 0.0007173808407969773, c = 0.0007510712082726367, d = 0.0007521420452066593, m = 0.00030096724724206115
[Iteration 6610] [Rank 0] a = 0.9661259651184082, b = 0.9998221492033815, delta = 0.0006961167091503739, c = 0.0006442984030125199, d = 0.0006456110418348701, m = 0.0003036792878138084
[Iteration 6620] [Rank 0] a = 0.9524479508399963, b = 1.0002328151614974, delta = 0.0006625059759244323, c = 0.0014656303314077958, d = 0.0014615887855600335, m = 0.00030434023965725357
[Iteration 6630] [Rank 0] a = 1.0771242380142212, b = 0.9996527151780041, delta = 0.0007760109147056937, c = 0.000305430328084747, d = 0.00030619027687663395, m = 0.0003047977320033752
[Iteration 6640] [Rank 0] a = 0.972917377948761, b = 1.0003984839812436, delta = 0.000659261189866811, c = 0.0017969680046705072, d = 0.00178038730375661, m = 0.0003056343567179066
[Iteration 6650] [Rank 0] a = 1.0431205034255981, b = 0.9997439435677918, delta = 0.0007052290602587163, c = 0.0004878871243914235, d = 0.0004886470731833105, m = 0.00030658626337004406
[Iteration 6660] [Rank 0] a = 0.9211593866348267, b = 1.0006017702315257, delta = 0.0006582124624401331, c = 0.002203540608330027, d = 0.002183021990949079, m = 0.0003072834908700464

[Iteration 6400] [Rank 3] a = 1.0001857280731201, b = 0.9999152947434053, delta = 0.0006369511829689145, c = 0.0008305894864055352, d = 0.00083141852145123, m = 0.000402750852690007
[Iteration 6410] [Rank 3] a = 0.9332552552223206, b = 1.0007311859988053, delta = 0.0006095913704484701, c = 0.002462372258221342, d = 0.00243062712459661, m = 0.0004035940173395206
[Iteration 6420] [Rank 3] a = 1.0257887840270996, b = 0.999817589510778, delta = 0.0006863778689876199, c = 0.0006351790175098765, d = 0.0006360771388093792, m = 0.00040407916122240604
[Iteration 6430] [Rank 3] a = 1.0252690315246582, b = 0.9998372100062743, delta = 0.0006684428662993014, c = 0.0006744200096727664, d = 0.0006755944759875008, m = 0.00040466856351521334
[Iteration 6440] [Rank 3] a = 1.0029702186584473, b = 0.9997603688236254, delta = 0.00071572489105165, c = 0.0005207376380770822, d = 0.0005215666731227771, m = 0.0004051257180505441

[Iteration 6400] [Rank 1] a = 0.9233245849609375, b = 0.99985629508344, delta = 0.0007016918971203268, c = 0.0007125901649016338, d = 0.0007133501136935207, m = 0.0005418218809478258
[Iteration 6410] [Rank 1] a = 1.0038591623306274, b = 0.9998692142126585, delta = 0.0006624159868806601, c = 0.0007384284238257902, d = 0.0007393265451252929, m = 0.0005423070755902356
[Iteration 6420] [Rank 1] a = 1.030583381652832, b = 0.9998288160266708, delta = 0.0006607162649743259, c = 0.0006576320499974455, d = 0.0006585301712969482, m = 0.0005432208077079181
[Iteration 6430] [Rank 1] a = 0.9536381959915161, b = 1.0001267504938665, delta = 0.0006341859116218984, c = 0.0012535009890906241, d = 0.00125084116831902, m = 0.0005437836671764066
[Iteration 6440] [Rank 1] a = 1.0808100700378418, b = 0.9997478123977552, delta = 0.0006744872080162168, c = 0.0004956247848179089, d = 0.0004965919923712195, m = 0.0005443915550509633
[Iteration 6450] [Rank 3] a = 0.9628254771232605, b = 1.0002702426371255, delta = 0.0006292426260188222, c = 0.0015404852874086605, d = 0.0015319876781902883, m = 0.00040616100979925097
[Iteration 6460] [Rank 3] a = 1.0515553951263428, b = 0.99970729331291, delta = 0.0007040482014417648, c = 0.00041458660910123656, d = 0.00041548473040073933, m = 0.00040674846832696815
[Iteration 6470] [Rank 3] a = 0.9577613472938538, b = 0.999844757679312, delta = 0.0007018618052825332, c = 0.0006895153561297935, d = 0.0006903789343023924, m = 0.0004071995632811776
[Iteration 6480] [Rank 3] a = 1.0003626346588135, b = 0.9998196448267612, delta = 0.0006702297832816839, c = 0.0006392896496114468, d = 0.0006403950296723733, m = 0.00040847781087608885
[Iteration 6490] [Rank 3] a = 1.013705849647522, b = 0.9998703886789533, delta = 0.000672492606099695, c = 0.0007407773564552589, d = 0.0007416409346278578, m = 0.00040894959759050896
[Iteration 6450] [Rank 1] a = 1.0534052848815918, b = 0.9997508867358564, delta = 0.0007022959180176258, c = 0.0005017734614068123, d = 0.0005027061258332191, m = 0.0005447237888863459
[Iteration 6460] [Rank 1] a = 0.9891050457954407, b = 0.9997892468762507, delta = 0.0006932686665095389, c = 0.0005784937462604906, d = 0.0005794264106868973, m = 0.0005450416496647007
[Iteration 6470] [Rank 1] a = 0.9234771728515625, b = 1.0001252651394332, delta = 0.0006509644445031881, c = 0.0012505302801768842, d = 0.0012475595712631443, m = 0.000545632209308404
[Iteration 6480] [Rank 1] a = 0.9885312914848328, b = 0.9998991976464071, delta = 0.0006880386499688029, c = 0.0007983952921310515, d = 0.0007996388446995938, m = 0.000545895017378866
[Iteration 6490] [Rank 1] a = 0.9685626029968262, b = 0.9999950375516605, delta = 0.0006670830771327019, c = 0.0009900751033210832, d = 0.0009901441895748913, m = 0.0005471971251508513
[Iteration 6500] [Rank 3] a = 0.9942454099655151, b = 0.9999051563357407, delta = 0.0006350934854708612, c = 0.0008103126709129151, d = 0.0008113144215931297, m = 0.0004103064175899407
[Iteration 6510] [Rank 3] a = 1.007493019104004, b = 0.999883428709162, delta = 0.0006517880246974528, c = 0.000766857417267743, d = 0.0007679973404555734, m = 0.0004107605400003964
[Iteration 6520] [Rank 3] a = 0.9883524775505066, b = 0.9997929429906679, delta = 0.0007097572088241577, c = 0.0005858859754179364, d = 0.0005868186398443431, m = 0.0004111569708296613
[Iteration 6530] [Rank 3] a = 0.9681981205940247, b = 1.0002145073051547, delta = 0.0006494828849099576, c = 0.0014290146168896062, d = 0.0014230041128083185, m = 0.0004118741194492612
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6532 |     0.10993s |  92.9%
- batch.accumulate               |   6532 |     0.00082s |   0.7%
[Iteration 6500] [Rank 1] a = 1.0378879308700562, b = 0.9997857407490283, delta = 0.0006969300447963178, c = 0.0005714814914989883, d = 0.0005721378109101634, m = 0.0005475217495588525
[Iteration 6510] [Rank 1] a = 0.9676189422607422, b = 0.9998856567408175, delta = 0.0006882795132696629, c = 0.0007713134806383528, d = 0.0007722461450647596, m = 0.0005479208400932433
[Iteration 6520] [Rank 1] a = 1.1100220680236816, b = 0.9997031135949179, delta = 0.0007394799613393843, c = 0.0004062271723904801, d = 0.0004068144055478473, m = 0.0005491143480253163
[Iteration 6530] [Rank 1] a = 0.8771399259567261, b = 1.0001908279926357, delta = 0.0006622053333558142, c = 0.0013816559899042875, d = 0.00137844347910222, m = 0.0005495206787356673
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6532 |     0.10985s |  92.8%
- batch.accumulate               |   6532 |     0.00083s |   0.7%
- batch.backward                 |   6532 |     0.05173s |  43.7%
- batch.evaluate                 |   6532 |     0.00277s |   2.3%
- batch.forward                  |   6532 |     0.02537s |  21.4%
- batch.mom                      |   6532 |     0.00126s |   1.1%
- batch.reduce                   |   6532 |     0.02519s |  21.3%
- batch.reporting.compr_err      |   6532 |     0.00001s |   0.0%
- batch.reporting.lr             |   6532 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   6532 |     0.00001s |   0.0%
- batch.step                     |   6532 |     0.00047s |   0.4%
- batch.update_runavg            |   6532 |     0.00129s |   1.1%
- batch.wd                       |   6532 |     0.00001s |   0.0%
- epoch_metrics.collect          |     46 |     0.01079s |   0.1%
- reduce.combine                 |   6532 |     0.00588s |   5.0%
- reduce.flatpack                |   6532 |     0.00002s |   0.0%
- reduce.flatput                 |   6532 |     0.00017s |   0.1%
- batch.backward                 |   6532 |     0.05176s |  43.7%
- batch.evaluate                 |   6532 |     0.00276s |   2.3%
- batch.forward                  |   6532 |     0.02540s |  21.5%
- batch.mom                      |   6532 |     0.00126s |   1.1%
- batch.reduce                   |   6532 |     0.02507s |  21.2%
- batch.reporting.compr_err      |   6532 |     0.00001s |   0.0%
- batch.reporting.lr             |   6532 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6532 |     0.00001s |   0.0%
- batch.step                     |   6532 |     0.00048s |   0.4%
- batch.update_runavg            |   6532 |     0.00129s |   1.1%
- batch.wd                       |   6532 |     0.00001s |   0.0%
- epoch_metrics.collect          |     46 |     0.01065s |   0.1%
- reduce.combine                 |   6532 |     0.00592s |   5.0%
- reduce.flatpack                |   6532 |     0.00002s |   0.0%
- reduce.flatput                 |   6532 |     0.00022s |   0.2%
- reduce.gather.context          |   6532 |     0.00261s |   2.2%
- reduce.gather.tensors          |   6532 |     0.00288s |   2.4%
- reduce.heur_params             |   6532 |     0.01040s |   8.8%
- reduce.gather.context          |   6532 |     0.00148s |   1.3%
- reduce.gather.tensors          |   6532 |     0.00318s |   2.7%
- reduce.heur_params             |   6532 |     0.01081s |   9.1%
- reduce.heur_params.alpha       |   6531 |     0.00811s |   6.9%
- reduce.heur_params.beta        |   6531 |     0.00221s |   1.9%
- reduce.memory                  |   6532 |     0.00044s |   0.4%
- reduce.pad                     |   6532 |     0.00027s |   0.2%
- reduce.threshold               |   6532 |     0.00233s |   2.0%
- test.last                      |     46 |     0.41387s |   2.6%
- test.runavg                    |     46 |     0.44454s |   2.8%
-----------------------------------------------------------------

[Iteration 6540] [Rank 3] a = 1.222305417060852, b = 0.9996258924434543, delta = 0.000769806036259979, c = 0.00025178485200290894, d = 0.00025254480079479587, m = 0.0004128263090984265
[Iteration 6550] [Rank 3] a = 1.01652991771698, b = 0.9998315276620547, delta = 0.0006602031644433737, c = 0.000663055320921366, d = 0.0006644715891244281, m = 0.0004135493292515712
- reduce.heur_params.alpha       |   6531 |     0.00828s |   7.0%
- reduce.heur_params.beta        |   6531 |     0.00245s |   2.1%
- reduce.memory                  |   6532 |     0.00046s |   0.4%
- reduce.pad                     |   6532 |     0.00018s |   0.1%
- reduce.threshold               |   6532 |     0.00260s |   2.2%
- test.last                      |     46 |     0.41387s |   2.6%
- test.runavg                    |     46 |     0.44454s |   2.8%
-----------------------------------------------------------------

[Iteration 6540] [Rank 1] a = 0.9973283410072327, b = 0.9997836336183846, delta = 0.0006924064946360886, c = 0.0005672672300167061, d = 0.0005681653513162089, m = 0.0005500857818250099
[Iteration 6550] [Rank 1] a = 1.0217722654342651, b = 0.9998784717705214, delta = 0.0006633964367210865, c = 0.0007569435398463087, d = 0.0007578071180189075, m = 0.0005509359135001412
[Iteration 6560] [Rank 3] a = 0.9174039959907532, b = 1.001412928341445, delta = 0.0006171385175548494, c = 0.0038258585633741504, d = 0.0036836445099105784, m = 0.0004145625536909611
[Iteration 6570] [Rank 3] a = 1.004559874534607, b = 0.999848540151619, delta = 0.0006794739165343344, c = 0.0006970803009217592, d = 0.0006980129653481659, m = 0.0004149898978736562
[Iteration 6580] [Rank 3] a = 1.0139847993850708, b = 0.9997842208515147, delta = 0.000680482538882643, c = 0.0005684416963314405, d = 0.0005694434470116551, m = 0.00041611244845976526
[Iteration 6590] [Rank 3] a = 0.9474144577980042, b = 0.9999164173950218, delta = 0.0006680990336462855, c = 0.000832834789654292, d = 0.0008335256521923711, m = 0.00041678765249463054
[Iteration 6600] [Rank 3] a = 0.9869629740715027, b = 0.9999752443399498, delta = 0.0006528406520374119, c = 0.0009504886798891539, d = 0.0009507650249043855, m = 0.00041752576293919644
[Iteration 6560] [Rank 1] a = 0.9892613291740417, b = 0.9997936338531765, delta = 0.0007047982071526349, c = 0.0005872677004940945, d = 0.0005882694511743092, m = 0.0005511466408154124
[Iteration 6570] [Rank 1] a = 1.02952241897583, b = 0.999821682871183, delta = 0.0006689432775601745, c = 0.0006433657385861132, d = 0.0006443329461394238, m = 0.000551881055769433
[Iteration 6580] [Rank 1] a = 0.9502729177474976, b = 0.9999695792671416, delta = 0.0006877033738419414, c = 0.0009391585342646575, d = 0.0009393312498991773, m = 0.0005521585670556592
[Iteration 6590] [Rank 1] a = 0.904664158821106, b = 1.0017384101437374, delta = 0.0006046763155609369, c = 0.004476823789879133, d = 0.004176333128941652, m = 0.00055399699857351
[Iteration 6600] [Rank 1] a = 1.0477688312530518, b = 0.9998224946346396, delta = 0.0006585763767361641, c = 0.000644989265550599, d = 0.0006459219299770057, m = 0.0005544550476663593
[Iteration 6610] [Rank 3] a = 0.9982367157936096, b = 0.9998912009126166, delta = 0.0006504777120426297, c = 0.0007824018243745215, d = 0.0007835072044354481, m = 0.0004182596653197991
[Iteration 6620] [Rank 3] a = 0.9824774861335754, b = 1.0000424825364376, delta = 0.0006557824672199786, c = 0.0010849650729262406, d = 0.0010842742103881614, m = 0.0004188313338546258
[Iteration 6630] [Rank 3] a = 0.974301278591156, b = 0.9998175376960894, delta = 0.000692921516019851, c = 0.0006350753881291646, d = 0.0006361116819362832, m = 0.0004193707149673076
[Iteration 6640] [Rank 3] a = 1.092249870300293, b = 0.999690678070375, delta = 0.0007292322115972638, c = 0.0003813561210196343, d = 0.00038235787169984897, m = 0.0004199313166478419
[Iteration 6650] [Rank 3] a = 1.0983699560165405, b = 0.9997020600296405, delta = 0.0007084308890625834, c = 0.000404120041649339, d = 0.00040463818855289825, m = 0.0004208272916280607
[Iteration 6610] [Rank 1] a = 1.0235322713851929, b = 0.9998074165602625, delta = 0.0006888792850077152, c = 0.0006148331157634485, d = 0.000615973038951279, m = 0.0005546618834013933
[Iteration 6620] [Rank 1] a = 1.00197434425354, b = 0.9998686787942008, delta = 0.0006605534581467509, c = 0.0007373575868917676, d = 0.0007384629669526941, m = 0.0005554425766531279
[Iteration 6630] [Rank 1] a = 0.9908522367477417, b = 0.9998055685030426, delta = 0.0006842815200798213, c = 0.0006111370011847256, d = 0.0006124150968801719, m = 0.0005560204963282659
[Iteration 6640] [Rank 1] a = 1.0098270177841187, b = 0.9997906458728285, delta = 0.0006973496056161821, c = 0.0005812917395397108, d = 0.0005822244039661175, m = 0.0005567800698469335
[Iteration 6650] [Rank 1] a = 0.9327632784843445, b = 1.0004472934108204, delta = 0.0006323499255813658, c = 0.0018945868813010766, d = 0.001881184148062343, m = 0.0005574151521242199

[Iteration 6400] [Rank 2] a = 1.069607138633728, b = 0.9997377948916158, delta = 0.0007320080767385662, c = 0.00047558977121361646, d = 0.00047655697876692715, m = 0.00034666111984284117
[Iteration 6410] [Rank 2] a = 1.016863465309143, b = 0.9997543583198978, delta = 0.0007133425096981227, c = 0.0005087166299145068, d = 0.0005097529237216254, m = 0.0003475512665700973
[Iteration 6420] [Rank 2] a = 1.0815681219100952, b = 0.9996784498046679, delta = 0.0007432754500769079, c = 0.00035689958717163606, d = 0.00035786679472494675, m = 0.00034835958044771546
[Iteration 6430] [Rank 2] a = 1.0206934213638306, b = 0.9998944825096348, delta = 0.000675269344355911, c = 0.0007889650184862725, d = 0.0007898976829126792, m = 0.00034908199037217907
[Iteration 6440] [Rank 2] a = 1.0424916744232178, b = 0.9997246339612162, delta = 0.0007283083396032453, c = 0.00044926790851280475, d = 0.0004502005729392115, m = 0.0003496500568995597
[Iteration 6660] [Rank 3] a = 1.0749949216842651, b = 0.9997250139355838, delta = 0.0007069006678648293, c = 0.0004500278573046917, d = 0.0004510641511118103, m = 0.00042139072868809793
[Iteration 6670] [Rank 3] a = 0.9429132342338562, b = 0.9999703046728059, delta = 0.0006916340789757669, c = 0.0009406093455946235, d = 0.0009410238631174709, m = 0.00042198401118384853
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6671 |     0.10997s |  92.9%
- batch.accumulate               |   6671 |     0.00082s |   0.7%
- batch.backward                 |   6671 |     0.05173s |  43.7%
- batch.evaluate                 |   6671 |     0.00277s |   2.3%
- batch.forward                  |   6671 |     0.02537s |  21.4%
- batch.mom                      |   6671 |     0.00126s |   1.1%
- batch.reduce                   |   6671 |     0.02524s |  21.3%
[Iteration 6660] [Rank 1] a = 0.913234293460846, b = 1.0002439898624156, delta = 0.0006477484712377191, c = 0.001487979734514653, d = 0.0014834545848902351, m = 0.0005579025317869855
[Iteration 6670] [Rank 1] a = 1.0184274911880493, b = 0.9997583135076935, delta = 0.0007283752784132957, c = 0.0005166270059755119, d = 0.000517248782259783, m = 0.0005580638453228418
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6671 |     0.10989s |  92.8%
- batch.accumulate               |   6671 |     0.00083s |   0.7%
- batch.backward                 |   6671 |     0.05176s |  43.7%
- batch.evaluate                 |   6671 |     0.00276s |   2.3%
- batch.forward                  |   6671 |     0.02540s |  21.5%
- batch.mom                      |   6671 |     0.00126s |   1.1%
- batch.reduce                   |   6671 |     0.02512s |  21.2%
[Iteration 6450] [Rank 2] a = 1.0811121463775635, b = 0.9996892272591847, delta = 0.0007549574947915971, c = 0.0003784544983597023, d = 0.0003791453608977814, m = 0.0003502617057968171
[Iteration 6460] [Rank 2] a = 1.0190584659576416, b = 0.9997404892553309, delta = 0.0007129789446480572, c = 0.000480978499010633, d = 0.0004821529653253674, m = 0.0003509948403405095
[Iteration 6470] [Rank 2] a = 1.1274957656860352, b = 0.9996869474130308, delta = 0.0007109866128303111, c = 0.0003738948056083806, d = 0.00037451658189265177, m = 0.00035263878775389657
[Iteration 6480] [Rank 2] a = 0.8737822771072388, b = 1.0005815797809194, delta = 0.0006028352654539049, c = 0.0021631596929793063, d = 0.0021426410755983586, m = 0.0003547656310088467
[Iteration 6490] [Rank 2] a = 0.9701517224311829, b = 0.9998381426706762, delta = 0.0006788104656152427, c = 0.0006762853385255798, d = 0.0006773907185865063, m = 0.0003553954258421003
- batch.reporting.compr_err      |   6671 |     0.00001s |   0.0%
- batch.reporting.lr             |   6671 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   6671 |     0.00001s |   0.0%
- batch.step                     |   6671 |     0.00047s |   0.4%
- batch.update_runavg            |   6671 |     0.00129s |   1.1%
- batch.reporting.compr_err      |   6671 |     0.00001s |   0.0%
- batch.reporting.lr             |   6671 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6671 |     0.00001s |   0.0%
- batch.step                     |   6671 |     0.00048s |   0.4%
- batch.update_runavg            |   6671 |     0.00129s |   1.1%
- batch.wd                       |   6671 |     0.00001s |   0.0%
[Iteration 6500] [Rank 2] a = 0.9342591762542725, b = 0.999932946281151, delta = 0.0006605436210520566, c = 0.0008658925621013745, d = 0.0008663070796242219, m = 0.0003563814455815874
[Iteration 6510] [Rank 2] a = 0.8920256495475769, b = 1.0002826436187362, delta = 0.000631412141956389, c = 0.0015652872525256985, d = 0.0015598639816017778, m = 0.0003572539738696757
[Iteration 6520] [Rank 2] a = 0.9509156346321106, b = 0.9999966092639349, delta = 0.0006552478298544884, c = 0.000993218527869343, d = 0.000993218527869343, m = 0.0003581789541982374
[Iteration 6530] [Rank 2] a = 1.006697416305542, b = 0.9998460875896659, delta = 0.0006717470241710544, c = 0.0006921751769013979, d = 0.0006930732982009007, m = 0.00035876220271498753
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6532 |     0.10979s |  92.8%
- batch.accumulate               |   6532 |     0.00083s |   0.7%
- batch.wd                       |   6671 |     0.00001s |   0.0%
- epoch_metrics.collect          |     47 |     0.01057s |   0.1%
- reduce.combine                 |   6671 |     0.00589s |   5.0%
- reduce.flatpack                |   6671 |     0.00002s |   0.0%
- reduce.flatput                 |   6671 |     0.00017s |   0.1%
- reduce.gather.context          |   6671 |     0.00260s |   2.2%
- reduce.gather.tensors          |   6671 |     0.00291s |   2.5%
- reduce.heur_params             |   6671 |     0.01040s |   8.8%
- reduce.heur_params.alpha       |   6670 |     0.00811s |   6.9%
- reduce.heur_params.beta        |   6670 |     0.00222s |   1.9%
- reduce.memory                  |   6671 |     0.00044s |   0.4%
- reduce.pad                     |   6671 |     0.00027s |   0.2%
- reduce.threshold               |   6671 |     0.00234s |   2.0%
- test.last                      |     47 |     0.41365s |   2.6%
- test.runavg                    |     47 |     0.44446s |   2.8%
- epoch_metrics.collect          |     47 |     0.01093s |   0.1%
- reduce.combine                 |   6671 |     0.00594s |   5.0%
- reduce.flatpack                |   6671 |     0.00002s |   0.0%
- reduce.flatput                 |   6671 |     0.00022s |   0.2%
- reduce.gather.context          |   6671 |     0.00147s |   1.2%
- reduce.gather.tensors          |   6671 |     0.00321s |   2.7%
- reduce.heur_params             |   6671 |     0.01082s |   9.1%
- reduce.heur_params.alpha       |   6670 |     0.00828s |   7.0%
- reduce.heur_params.beta        |   6670 |     0.00246s |   2.1%
- reduce.memory                  |   6671 |     0.00046s |   0.4%
- reduce.pad                     |   6671 |     0.00018s |   0.2%
- reduce.threshold               |   6671 |     0.00261s |   2.2%
- test.last                      |     47 |     0.41366s |   2.6%
- test.runavg                    |     47 |     0.44446s |   2.8%
-----------------------------------------------------------------
- batch.backward                 |   6532 |     0.05196s |  43.9%
- batch.evaluate                 |   6532 |     0.00275s |   2.3%
- batch.forward                  |   6532 |     0.02562s |  21.7%
- batch.mom                      |   6532 |     0.00126s |   1.1%
- batch.reduce                   |   6532 |     0.02459s |  20.8%
- batch.reporting.compr_err      |   6532 |     0.00001s |   0.0%
- batch.reporting.lr             |   6532 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6532 |     0.00001s |   0.0%
- batch.step                     |   6532 |     0.00048s |   0.4%
- batch.update_runavg            |   6532 |     0.00130s |   1.1%
- batch.wd                       |   6532 |     0.00001s |   0.0%
- epoch_metrics.collect          |     46 |     0.01466s |   0.1%
- reduce.combine                 |   6532 |     0.00599s |   5.1%
- reduce.flatpack                |   6532 |     0.00002s |   0.0%
- reduce.flatput                 |   6532 |     0.00016s |   0.1%
-----------------------------------------------------------------
- reduce.gather.context          |   6532 |     0.00153s |   1.3%
- reduce.gather.tensors          |   6532 |     0.00315s |   2.7%
- reduce.heur_params             |   6532 |     0.01052s |   8.9%
- reduce.heur_params.alpha       |   6531 |     0.00828s |   7.0%
- reduce.heur_params.beta        |   6531 |     0.00217s |   1.8%
- reduce.memory                  |   6532 |     0.00044s |   0.4%
- reduce.pad                     |   6532 |     0.00028s |   0.2%
- reduce.threshold               |   6532 |     0.00227s |   1.9%
- test.last                      |     46 |     0.41387s |   2.6%
- test.runavg                    |     46 |     0.44454s |   2.8%
-----------------------------------------------------------------

[Iteration 6540] [Rank 2] a = 0.983753502368927, b = 0.9999508741639533, delta = 0.000699697295203805, c = 0.0009017483278276771, d = 0.0009025773628733719, m = 0.000359202358438582
[Iteration 6550] [Rank 2] a = 1.0776132345199585, b = 0.9997297118004932, delta = 0.0007071616128087044, c = 0.00045942358782256675, d = 0.00046042533850278134, m = 0.00036011199251460857
[Iteration 6560] [Rank 2] a = 1.0333625078201294, b = 0.9997197115660124, delta = 0.0007222284912131727, c = 0.0004394231173451783, d = 0.00044056304053300874, m = 0.00036069123368720983
[Iteration 6570] [Rank 2] a = 0.931892991065979, b = 1.001771623257953, delta = 0.000623048807028681, c = 0.004543250222915434, d = 0.004374921565512474, m = 0.0003619208520081129
[Iteration 6580] [Rank 2] a = 1.0071473121643066, b = 0.9997681582983093, delta = 0.0007111558225005865, c = 0.0005363165883107648, d = 0.0005371110802295557, m = 0.00036274918043414835
[Iteration 6590] [Rank 2] a = 0.9651337265968323, b = 0.9999762806337562, delta = 0.0006676965276710689, c = 0.0009525612675033911, d = 0.0009530448712800464, m = 0.00036334289446379644
[Iteration 6600] [Rank 2] a = 0.9534231424331665, b = 0.9999925331749602, delta = 0.0006677510682493448, c = 0.0009850663499200102, d = 0.000985135436173818, m = 0.00036408922541634835
[Iteration 6610] [Rank 2] a = 1.061120867729187, b = 0.9996943569130425, delta = 0.0007291890797205269, c = 0.0003887138070501762, d = 0.00038940466958825527, m = 0.00036504549500263885
[Iteration 6620] [Rank 2] a = 1.09674870967865, b = 0.9997002119725162, delta = 0.0007338994764722884, c = 0.0004004239270706161, d = 0.000401218418989407, m = 0.0003656240979354222
[Iteration 6630] [Rank 2] a = 1.104957103729248, b = 0.9997389175431635, delta = 0.0006740031531080604, c = 0.00047783507446237336, d = 0.00047849139387354847, m = 0.00036724384455317133
[Iteration 6640] [Rank 2] a = 0.9774324893951416, b = 0.9998945688674511, delta = 0.000653931638225913, c = 0.0007891377341207922, d = 0.0007898631397857753, m = 0.0003680641900229296
[Iteration 6650] [Rank 2] a = 1.056371808052063, b = 0.9997698854545622, delta = 0.0006912944372743368, c = 0.00053977090100116, d = 0.000540496306666143, m = 0.00036859431314183714
[Iteration 6660] [Rank 2] a = 0.9457064270973206, b = 0.9999889579613258, delta = 0.0006719070370309055, c = 0.000977915922650892, d = 0.000977950465777796, m = 0.0003691485250014819
[Iteration 6670] [Rank 2] a = 1.0664581060409546, b = 0.9997600233923761, delta = 0.0006880044820718467, c = 0.0005200467755390032, d = 0.0005209794399654099, m = 0.0003702607505973311
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6671 |     0.10984s |  92.8%
- batch.accumulate               |   6671 |     0.00083s |   0.7%
- batch.backward                 |   6671 |     0.05195s |  43.9%
- batch.evaluate                 |   6671 |     0.00275s |   2.3%
- batch.forward                  |   6671 |     0.02561s |  21.6%
- batch.mom                      |   6671 |     0.00126s |   1.1%
- batch.reduce                   |   6671 |     0.02466s |  20.8%
- batch.reporting.compr_err      |   6671 |     0.00001s |   0.0%
- batch.reporting.lr             |   6671 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6671 |     0.00001s |   0.0%
- batch.step                     |   6671 |     0.00048s |   0.4%
- batch.update_runavg            |   6671 |     0.00130s |   1.1%
- batch.wd                       |   6671 |     0.00001s |   0.0%
- epoch_metrics.collect          |     47 |     0.01488s |   0.1%
- reduce.combine                 |   6671 |     0.00600s |   5.1%
- reduce.flatpack                |   6671 |     0.00002s |   0.0%
- reduce.flatput                 |   6671 |     0.00016s |   0.1%
- reduce.gather.context          |   6671 |     0.00155s |   1.3%
- reduce.gather.tensors          |   6671 |     0.00318s |   2.7%
- reduce.heur_params             |   6671 |     0.01052s |   8.9%
- reduce.heur_params.alpha       |   6670 |     0.00827s |   7.0%
- reduce.heur_params.beta        |   6670 |     0.00218s |   1.8%
- reduce.memory                  |   6671 |     0.00044s |   0.4%
- reduce.pad                     |   6671 |     0.00028s |   0.2%
- reduce.threshold               |   6671 |     0.00228s |   1.9%
- test.last                      |     47 |     0.41366s |   2.6%
- test.runavg                    |     47 |     0.44446s |   2.8%
-----------------------------------------------------------------
[Iteration 6670] [Rank 0] a = 1.1799055337905884, b = 0.9996382243380894, delta = 0.000768402824178338, c = 0.00027644864461233095, d = 0.00027682861900827445, m = 0.0003080115038239109
cross_entropy                  - bits:13506305024.000, epoch: 48.000, ratio_transmit_grad:  0.175, value:  5.623 (split:train)
last_cross_entropy             - bits:13506305024.000, epoch: 48.000, ratio_transmit_grad:  0.175, value:  5.623 (split:train)
perplexity                     - bits:13506305024.000, epoch: 48.000, ratio_transmit_grad:  0.175, value:277.317 (split:train)
last_perplexity                - bits:13506305024.000, epoch: 48.000, ratio_transmit_grad:  0.175, value:277.317 (split:train)
last_cross_entropy             - bits:13506305024.000, epoch: 48.000, ratio_transmit_grad:  0.175, value:  5.363 (split:test)
last_perplexity                - bits:13506305024.000, epoch: 48.000, ratio_transmit_grad:  0.175, value:213.995 (split:test)
runavg_cross_entropy           - bits:13506305024.000, epoch: 48.000, ratio_transmit_grad:  0.175, value:  5.534 (split:test)
runavg_perplexity              - bits:13506305024.000, epoch: 48.000, ratio_transmit_grad:  0.175, value:253.810 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6671 |     0.10984s |  92.8%
- batch.accumulate               |   6671 |     0.00083s |   0.7%
- batch.backward                 |   6671 |     0.05170s |  43.7%
- batch.evaluate                 |   6671 |     0.00275s |   2.3%
- batch.forward                  |   6671 |     0.02546s |  21.5%
- batch.mom                      |   6671 |     0.00126s |   1.1%
- batch.reduce                   |   6671 |     0.02501s |  21.1%
- batch.reporting.compr_err      |   6671 |     0.00001s |   0.0%
- batch.reporting.lr             |   6671 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6671 |     0.00001s |   0.0%
- batch.step                     |   6671 |     0.00048s |   0.4%
- batch.update_runavg            |   6671 |     0.00130s |   1.1%
- batch.wd                       |   6671 |     0.00001s |   0.0%
- epoch_metrics.collect          |     47 |     0.00984s |   0.1%
- reduce.combine                 |   6671 |     0.00616s |   5.2%
- reduce.flatpack                |   6671 |     0.00002s |   0.0%
- reduce.flatput                 |   6671 |     0.00016s |   0.1%
- reduce.gather.context          |   6671 |     0.00126s |   1.1%
- reduce.gather.tensors          |   6671 |     0.00326s |   2.8%
- reduce.heur_params             |   6671 |     0.01094s |   9.2%
- reduce.heur_params.alpha       |   6670 |     0.00872s |   7.4%
- reduce.heur_params.beta        |   6670 |     0.00215s |   1.8%
- reduce.memory                  |   6671 |     0.00045s |   0.4%
- reduce.pad                     |   6671 |     0.00029s |   0.2%
- reduce.threshold               |   6671 |     0.00225s |   1.9%
- test.last                      |     47 |     0.41365s |   2.6%
- test.runavg                    |     47 |     0.44447s |   2.8%
-----------------------------------------------------------------

[Iteration 6680] [Rank 0] a = 0.9611873626708984, b = 0.9999381104786018, delta = 0.0006971449474804103, c = 0.0008762209570456562, d = 0.0008767391039492155, m = 0.0003086966674295781
[Iteration 6690] [Rank 0] a = 1.0382208824157715, b = 0.9997183298410456, delta = 0.0007546394481323659, c = 0.0004366596671928621, d = 0.0004376268747461728, m = 0.0003092557561058097
[Iteration 6700] [Rank 0] a = 1.0609509944915771, b = 0.9997922003134716, delta = 0.0006808956968598068, c = 0.0005844006209610664, d = 0.000585471457895089, m = 0.00031047028422379286
[Iteration 6710] [Rank 0] a = 1.069703459739685, b = 0.9996734755949161, delta = 0.0007415518630295992, c = 0.00034695116662329775, d = 0.00034771111541518474, m = 0.00031113248161316595
[Iteration 6720] [Rank 0] a = 0.9393119812011719, b = 0.9999789577260899, delta = 0.0006722551770508289, c = 0.0009579154521735037, d = 0.0009583299696963511, m = 0.00031191199301600824
[Iteration 6730] [Rank 0] a = 0.7989228963851929, b = 1.0014551572272359, delta = 0.0006482626195065677, c = 0.0039103165086543145, d = 0.003800987512003305, m = 0.0003128746567555393
[Iteration 6740] [Rank 0] a = 1.0096607208251953, b = 0.9999606325972845, delta = 0.0006516350549645722, c = 0.0009212651945284102, d = 0.0009217142551781615, m = 0.00031376266219971806
[Iteration 6750] [Rank 0] a = 1.0473442077636719, b = 0.9997331315698101, delta = 0.000724582641851157, c = 0.0004662631269495493, d = 0.00046723033450286, m = 0.00031440184485321887
timer                          - epoch: 48.583, value:  0.000 (event:batch.wd)
[Iteration 6760] [Rank 0] a = 0.9256129264831543, b = 1.0001132268598785, delta = 0.0006867451011203229, c = 0.0012264537207248294, d = 0.0012240357018415528, m = 0.00031503017011272685
[Iteration 6770] [Rank 0] a = 1.0041476488113403, b = 0.9997462752287064, delta = 0.000728224404156208, c = 0.0004925504465234571, d = 0.0004936212834574796, m = 0.0003157067323324887
[Iteration 6780] [Rank 0] a = 1.0174154043197632, b = 0.999709607702216, delta = 0.0007431771955452859, c = 0.0004192153881063662, d = 0.00042021713878658077, m = 0.0003166830993463857
[Iteration 6790] [Rank 0] a = 0.9569218158721924, b = 0.9998447231361859, delta = 0.0007253944058902562, c = 0.0006894462698759857, d = 0.0006903098480485845, m = 0.0003172545304568593
[Iteration 6800] [Rank 0] a = 0.9827366471290588, b = 1.0002030908022108, delta = 0.0006760035175830126, c = 0.0014061816100060937, d = 0.0013995493296405349, m = 0.00031802816227823467
[Iteration 6810] [Rank 0] a = 1.0317472219467163, b = 0.9998820297125415, delta = 0.0007313804235309362, c = 0.0007640594239885229, d = 0.0007645775708920821, m = 0.00031896137450960246
cross_entropy                  - bits:13947245312.000, epoch: 49.000, ratio_transmit_grad:  0.171, value:  5.605 (split:train)
last_cross_entropy             - bits:13947245312.000, epoch: 49.000, ratio_transmit_grad:  0.171, value:  5.605 (split:train)
perplexity                     - bits:13947245312.000, epoch: 49.000, ratio_transmit_grad:  0.171, value:272.547 (split:train)
last_perplexity                - bits:13947245312.000, epoch: 49.000, ratio_transmit_grad:  0.171, value:272.547 (split:train)
last_cross_entropy             - bits:13947245312.000, epoch: 49.000, ratio_transmit_grad:  0.171, value:  5.334 (split:test)
last_perplexity                - bits:13947245312.000, epoch: 49.000, ratio_transmit_grad:  0.171, value:207.824 (split:test)
runavg_cross_entropy           - bits:13947245312.000, epoch: 49.000, ratio_transmit_grad:  0.171, value:  5.512 (split:test)
runavg_perplexity              - bits:13947245312.000, epoch: 49.000, ratio_transmit_grad:  0.171, value:248.178 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6810 |     0.10989s |  92.8%
- batch.accumulate               |   6810 |     0.00083s |   0.7%
- batch.backward                 |   6810 |     0.05170s |  43.7%
- batch.evaluate                 |   6810 |     0.00275s |   2.3%
- batch.forward                  |   6810 |     0.02545s |  21.5%
- batch.mom                      |   6810 |     0.00126s |   1.1%
- batch.reduce                   |   6810 |     0.02508s |  21.2%
- batch.reporting.compr_err      |   6810 |     0.00001s |   0.0%
- batch.reporting.lr             |   6810 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6810 |     0.00001s |   0.0%
- batch.step                     |   6810 |     0.00048s |   0.4%
- batch.update_runavg            |   6810 |     0.00130s |   1.1%
- batch.wd                       |   6810 |     0.00001s |   0.0%
- epoch_metrics.collect          |     48 |     0.00966s |   0.1%
- reduce.combine                 |   6810 |     0.00618s |   5.2%
- reduce.flatpack                |   6810 |     0.00002s |   0.0%
- reduce.flatput                 |   6810 |     0.00017s |   0.1%
- reduce.gather.context          |   6810 |     0.00126s |   1.1%
- reduce.gather.tensors          |   6810 |     0.00329s |   2.8%
- reduce.heur_params             |   6810 |     0.01095s |   9.2%
- reduce.heur_params.alpha       |   6809 |     0.00872s |   7.4%
- reduce.heur_params.beta        |   6809 |     0.00216s |   1.8%
- reduce.memory                  |   6810 |     0.00045s |   0.4%
- reduce.pad                     |   6810 |     0.00029s |   0.2%
- reduce.threshold               |   6810 |     0.00226s |   1.9%
- test.last                      |     48 |     0.41354s |   2.6%
- test.runavg                    |     48 |     0.44442s |   2.7%
-----------------------------------------------------------------

[Iteration 6680] [Rank 3] a = 0.9631341695785522, b = 1.0000725350567423, delta = 0.0006699311197735369, c = 0.0011450701137391177, d = 0.0011438956474243832, m = 0.00042261580503941376
[Iteration 6690] [Rank 3] a = 1.1466953754425049, b = 0.9996988993338123, delta = 0.0007299604476429522, c = 0.0003977986494259157, d = 0.0003985240550908987, m = 0.0004235512913695658
[Iteration 6700] [Rank 3] a = 0.9991673231124878, b = 0.9999228424165844, delta = 0.0006519617163576186, c = 0.0008456848328625623, d = 0.0008465138679082572, m = 0.0004246199466663628
[Iteration 6710] [Rank 3] a = 0.8992930054664612, b = 1.0008863018084002, delta = 0.0006303903646767139, c = 0.0027726040809457385, d = 0.0027203057868131542, m = 0.00042539616288322685
[Iteration 6720] [Rank 3] a = 1.0792160034179688, b = 0.9997661029823699, delta = 0.0006622385117225349, c = 0.0005322059562091944, d = 0.0005333458793970249, m = 0.00042646434629140217

[Iteration 6680] [Rank 1] a = 1.1283257007598877, b = 0.9997083986928765, delta = 0.0007046694518066943, c = 0.0004167973692230895, d = 0.0004172809729997448, m = 0.0005591440629168057
[Iteration 6690] [Rank 1] a = 0.9920663833618164, b = 0.9999092324246805, delta = 0.000661588623188436, c = 0.0008184648488622478, d = 0.0008195702289231743, m = 0.0005599098434184406
[Iteration 6700] [Rank 1] a = 1.0919005870819092, b = 0.9996605737384481, delta = 0.0007472234428860247, c = 0.0003211474508260453, d = 0.00032156196834889276, m = 0.0005605429239980373
[Iteration 6710] [Rank 1] a = 0.9473666548728943, b = 0.9999442591551695, delta = 0.0006790637853555381, c = 0.0008885183102234633, d = 0.0008891400865077344, m = 0.0005609418898602869
[Iteration 6720] [Rank 1] a = 0.953730583190918, b = 0.9998620637855186, delta = 0.0006733006448484957, c = 0.0007241275692875539, d = 0.0007249566043332487, m = 0.0005615923406038946
[Iteration 6730] [Rank 3] a = 0.7864482402801514, b = 1.0003359954731221, delta = 0.0006251862505450845, c = 0.0016719909715320073, d = 0.0016662568124659514, m = 0.0004275656129744866
[Iteration 6740] [Rank 3] a = 1.000535488128662, b = 0.9999045172878991, delta = 0.0006510757957585156, c = 0.0008090345752174689, d = 0.0008096908946286439, m = 0.00042814272386711713
[Iteration 6750] [Rank 3] a = 1.001639485359192, b = 0.999876364639812, delta = 0.0006587926764041185, c = 0.0007527292783640264, d = 0.0007537310290442411, m = 0.00042866197392542733
[Iteration 6760] [Rank 3] a = 1.0651894807815552, b = 0.9997449280468444, delta = 0.0006950172246433794, c = 0.0004898560826249488, d = 0.0004906851176706437, m = 0.00042924189727349
[Iteration 6770] [Rank 3] a = 1.0011080503463745, b = 0.9999326526645739, delta = 0.0006554092396982014, c = 0.0008653053289440073, d = 0.0008658580189744705, m = 0.00043014974938804777
[Iteration 6730] [Rank 1] a = 0.9916121959686279, b = 0.9998495246307133, delta = 0.0006658473866991699, c = 0.0006990492591552845, d = 0.0006998782942009794, m = 0.0005626422999708959
[Iteration 6740] [Rank 1] a = 1.0278087854385376, b = 0.9997752741820807, delta = 0.0006800863775424659, c = 0.0005505483565951931, d = 0.0005517228229099275, m = 0.0005631378582303579
[Iteration 6750] [Rank 1] a = 1.0514525175094604, b = 0.9997141673945888, delta = 0.0007204758003354073, c = 0.0004283347736090096, d = 0.0004291292655278005, m = 0.0005635157983375598
[Iteration 6760] [Rank 1] a = 1.018951654434204, b = 0.9998510617998262, delta = 0.0006718603544868529, c = 0.0007021235974497362, d = 0.000702987175622335, m = 0.0005640347627801338
[Iteration 6770] [Rank 1] a = 0.9281197786331177, b = 1.000068597140295, delta = 0.0006464133039116859, c = 0.0011371942808050166, d = 0.0011364688751400334, m = 0.0005650077595454692

[Iteration 6680] [Rank 2] a = 0.9952458739280701, b = 0.9998628582774224, delta = 0.0006797068053856492, c = 0.0007257165531251357, d = 0.0007267183038053503, m = 0.0003709449332163334
[Iteration 6690] [Rank 2] a = 0.9777456521987915, b = 1.0003449766850758, delta = 0.000644851301331073, c = 0.0016899533975220627, d = 0.001675134396080267, m = 0.00037175997738168664
[Iteration 6700] [Rank 2] a = 1.0515220165252686, b = 0.999735998649141, delta = 0.0007240258273668587, c = 0.0004719972860156054, d = 0.0004731372092034358, m = 0.0003722118836419277
[Iteration 6710] [Rank 2] a = 0.9988418221473694, b = 0.9997730288789464, delta = 0.0007226297166198492, c = 0.0005460577500976794, d = 0.0005473703889200295, m = 0.0003727830738534304
[Iteration 6720] [Rank 2] a = 0.9388778805732727, b = 1.000159670093128, delta = 0.0006724480190314353, c = 0.0013193401889695575, d = 0.001315264099994891, m = 0.0003735213687600384
[Iteration 6780] [Rank 3] a = 1.0508334636688232, b = 0.99968416669159, delta = 0.0007381151081062853, c = 0.00036833336217684427, d = 0.0003691278540956352, m = 0.00043075164631863294
[Iteration 6790] [Rank 3] a = 0.9863674640655518, b = 0.9999856763642705, delta = 0.0006725529674440622, c = 0.0009713527285391411, d = 0.0009716981598081806, m = 0.0004312037199256607
[Iteration 6800] [Rank 3] a = 0.9725241661071777, b = 1.000020737638074, delta = 0.0006549979443661869, c = 0.0010414752761541645, d = 0.0010408534998698933, m = 0.0004319224031638344
[Iteration 6810] [Rank 3] a = 1.0593594312667847, b = 0.9998367609456364, delta = 0.0007215755758807063, c = 0.0006735218883732637, d = 0.0006742127509113426, m = 0.0004326441339273785
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6810 |     0.11003s |  92.9%
- batch.accumulate               |   6810 |     0.00082s |   0.7%
[Iteration 6780] [Rank 1] a = 1.1070399284362793, b = 0.9996942360121097, delta = 0.0007177285733632743, c = 0.00038847200516184855, d = 0.0003891974108268315, m = 0.0005653613317106167
[Iteration 6790] [Rank 1] a = 1.031915307044983, b = 0.9998905445932131, delta = 0.000681108795106411, c = 0.0007810891855521714, d = 0.0007817800480902505, m = 0.0005657097780365349
[Iteration 6800] [Rank 1] a = 0.9903092384338379, b = 1.000231606152121, delta = 0.0006462278543040156, c = 0.001463212312524519, d = 0.0014513985631233674, m = 0.0005662749417457577
[Iteration 6810] [Rank 1] a = 1.0736925601959229, b = 0.9998987831288882, delta = 0.0007117181667126715, c = 0.0007975662570853567, d = 0.0007979807746082041, m = 0.0005669974680258055
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6810 |     0.10994s |  92.8%
- batch.accumulate               |   6810 |     0.00083s |   0.7%
[Iteration 6730] [Rank 2] a = 1.06793212890625, b = 0.9997653430336197, delta = 0.0007021050550974905, c = 0.0005306860586254205, d = 0.0005316187230518273, m = 0.0003742504032619697
[Iteration 6740] [Rank 2] a = 1.036010503768921, b = 0.9997561891055143, delta = 0.0007154835038818419, c = 0.0005123782013663257, d = 0.0005135526676810601, m = 0.0003749018599729672
[Iteration 6750] [Rank 2] a = 0.9534171223640442, b = 0.9998674870563433, delta = 0.0007197765517048538, c = 0.0007349741111353949, d = 0.0007360104049425135, m = 0.00037539847800249277
[Iteration 6760] [Rank 2] a = 1.0685746669769287, b = 0.999790455885639, delta = 0.0006690407753922045, c = 0.0005809117651437673, d = 0.0005819480589508858, m = 0.0003770874877052998
[Iteration 6770] [Rank 2] a = 1.0810691118240356, b = 0.9997230795206242, delta = 0.0007187325390987098, c = 0.00044615902709144905, d = 0.00044729895027927947, m = 0.00037756342751085476
- batch.backward                 |   6810 |     0.05174s |  43.7%
- batch.evaluate                 |   6810 |     0.00277s |   2.3%
- batch.forward                  |   6810 |     0.02537s |  21.4%
- batch.mom                      |   6810 |     0.00126s |   1.1%
- batch.reduce                   |   6810 |     0.02529s |  21.4%
- batch.reporting.compr_err      |   6810 |     0.00001s |   0.0%
- batch.reporting.lr             |   6810 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   6810 |     0.00001s |   0.0%
- batch.step                     |   6810 |     0.00047s |   0.4%
- batch.update_runavg            |   6810 |     0.00129s |   1.1%
- batch.wd                       |   6810 |     0.00001s |   0.0%
- epoch_metrics.collect          |     48 |     0.01037s |   0.1%
- reduce.combine                 |   6810 |     0.00590s |   5.0%
- reduce.flatpack                |   6810 |     0.00002s |   0.0%
- reduce.flatput                 |   6810 |     0.00017s |   0.1%
- batch.backward                 |   6810 |     0.05176s |  43.7%
- batch.evaluate                 |   6810 |     0.00276s |   2.3%
- batch.forward                  |   6810 |     0.02540s |  21.5%
- batch.mom                      |   6810 |     0.00126s |   1.1%
- batch.reduce                   |   6810 |     0.02516s |  21.3%
- batch.reporting.compr_err      |   6810 |     0.00001s |   0.0%
- batch.reporting.lr             |   6810 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6810 |     0.00001s |   0.0%
- batch.step                     |   6810 |     0.00048s |   0.4%
- batch.update_runavg            |   6810 |     0.00129s |   1.1%
- batch.wd                       |   6810 |     0.00001s |   0.0%
- epoch_metrics.collect          |     48 |     0.01072s |   0.1%
- reduce.combine                 |   6810 |     0.00595s |   5.0%
- reduce.flatpack                |   6810 |     0.00002s |   0.0%
- reduce.flatput                 |   6810 |     0.00022s |   0.2%
[Iteration 6780] [Rank 2] a = 0.9273087978363037, b = 1.0000095974796503, delta = 0.0006409010384231806, c = 0.001019194959301115, d = 0.0010190222436665954, m = 0.00037910997214942626
[Iteration 6790] [Rank 2] a = 0.9438744783401489, b = 1.000109755275668, delta = 0.0006420960417017341, c = 0.0012195105522171351, d = 0.0012180251977602652, m = 0.00037987774538327944
[Iteration 6800] [Rank 2] a = 1.061299443244934, b = 0.9997192970485224, delta = 0.0007136547355912626, c = 0.00043859408229948347, d = 0.000439630376106602, m = 0.00038045225015100205
[Iteration 6810] [Rank 2] a = 0.9863572716712952, b = 0.9998779708951888, delta = 0.0007450002594850957, c = 0.000755941789166094, d = 0.0007564599360696533, m = 0.00038106029065811597
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6810 |     0.10990s |  92.8%
- batch.accumulate               |   6810 |     0.00083s |   0.7%
- reduce.gather.context          |   6810 |     0.00260s |   2.2%
- reduce.gather.tensors          |   6810 |     0.00294s |   2.5%
- reduce.heur_params             |   6810 |     0.01041s |   8.8%
- reduce.gather.context          |   6810 |     0.00145s |   1.2%
- reduce.gather.tensors          |   6810 |     0.00324s |   2.7%
- reduce.heur_params             |   6810 |     0.01082s |   9.1%
- batch.backward                 |   6810 |     0.05194s |  43.9%
- batch.evaluate                 |   6810 |     0.00275s |   2.3%
- batch.forward                  |   6810 |     0.02560s |  21.6%
- batch.mom                      |   6810 |     0.00126s |   1.1%
- batch.reduce                   |   6810 |     0.02474s |  20.9%
- batch.reporting.compr_err      |   6810 |     0.00001s |   0.0%
- batch.reporting.lr             |   6810 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6810 |     0.00001s |   0.0%
- batch.step                     |   6810 |     0.00048s |   0.4%
- batch.update_runavg            |   6810 |     0.00130s |   1.1%
- batch.wd                       |   6810 |     0.00001s |   0.0%
- epoch_metrics.collect          |     48 |     0.01466s |   0.1%
- reduce.combine                 |   6810 |     0.00601s |   5.1%
- reduce.flatpack                |   6810 |     0.00002s |   0.0%
- reduce.flatput                 |   6810 |     0.00017s |   0.1%
- reduce.heur_params.alpha       |   6809 |     0.00811s |   6.8%
- reduce.heur_params.beta        |   6809 |     0.00222s |   1.9%
- reduce.memory                  |   6810 |     0.00044s |   0.4%
- reduce.pad                     |   6810 |     0.00027s |   0.2%
- reduce.threshold               |   6810 |     0.00235s |   2.0%
- test.last                      |     48 |     0.41355s |   2.6%
- test.runavg                    |     48 |     0.44441s |   2.7%
-----------------------------------------------------------------

[Iteration 6820] [Rank 3] a = 0.9598978757858276, b = 0.9999404421396592, delta = 0.0006941364845260978, c = 0.0008808842791776898, d = 0.0008813333398274412, m = 0.0004331704416866238
[Iteration 6830] [Rank 3] a = 1.0533493757247925, b = 0.9997031826811656, delta = 0.0007272834191098809, c = 0.00040636534489809587, d = 0.0004072289230706947, m = 0.00043404089261670355
- reduce.heur_params.alpha       |   6809 |     0.00829s |   7.0%
- reduce.heur_params.beta        |   6809 |     0.00246s |   2.1%
- reduce.memory                  |   6810 |     0.00046s |   0.4%
- reduce.pad                     |   6810 |     0.00018s |   0.2%
- reduce.threshold               |   6810 |     0.00261s |   2.2%
- test.last                      |     48 |     0.41356s |   2.6%
- test.runavg                    |     48 |     0.44441s |   2.7%
-----------------------------------------------------------------

[Iteration 6820] [Rank 1] a = 0.9917671084403992, b = 1.0000507038006228, delta = 0.0006458017742261291, c = 0.0011014076013325217, d = 0.0011004403937792111, m = 0.0005677423157550305
[Iteration 6830] [Rank 1] a = 1.0880554914474487, b = 0.9997316116723352, delta = 0.0007112856837920845, c = 0.0004632233317820015, d = 0.00046436325496983195, m = 0.0005681204467682787
- reduce.gather.context          |   6810 |     0.00158s |   1.3%
- reduce.gather.tensors          |   6810 |     0.00321s |   2.7%
- reduce.heur_params             |   6810 |     0.01053s |   8.9%
[Iteration 6840] [Rank 3] a = 1.0372505187988281, b = 0.9997335115441789, delta = 0.0007064584642648697, c = 0.0004670230757414363, d = 0.0004681975420561706, m = 0.00043525487633630836
[Iteration 6850] [Rank 3] a = 1.0098985433578491, b = 0.9998917363310773, delta = 0.0006567349191755056, c = 0.0007834726613085441, d = 0.0007844744119887587, m = 0.0004358794997556862
[Iteration 6860] [Rank 3] a = 0.945709228515625, b = 1.000732360464491, delta = 0.0006412587244994938, c = 0.002464721190850811, d = 0.002428036390078813, m = 0.0004364863473934657
[Iteration 6870] [Rank 3] a = 1.098445177078247, b = 0.9996801596892739, delta = 0.0007220207480713725, c = 0.00036031935673512734, d = 0.0003611483917808222, m = 0.0004369556441263836
[Iteration 6880] [Rank 3] a = 0.9634023904800415, b = 1.000013932642076, delta = 0.0006629616837017238, c = 0.0010278652841540072, d = 0.0010276925685194875, m = 0.00043757382762773297
[Iteration 6840] [Rank 1] a = 1.0379972457885742, b = 0.9998137724953848, delta = 0.0006802546558901668, c = 0.000627544986464103, d = 0.0006287885390326453, m = 0.0005686625279513809
[Iteration 6850] [Rank 1] a = 0.9720582962036133, b = 1.0004420946712493, delta = 0.0006433206726796925, c = 0.0018841894001029869, d = 0.0018628762908032483, m = 0.0005691729255713133
[Iteration 6860] [Rank 1] a = 0.9436830878257751, b = 0.9999006657292856, delta = 0.0006917879218235612, c = 0.0008013314579178875, d = 0.000802367751725006, m = 0.0005695200400140725
[Iteration 6870] [Rank 1] a = 1.0524362325668335, b = 0.9997762068464601, delta = 0.0007417761371470988, c = 0.0005524136854480066, d = 0.0005530354617322777, m = 0.0005697432950276538
[Iteration 6880] [Rank 1] a = 0.9381399750709534, b = 0.9998440840883537, delta = 0.000710615306161344, c = 0.0006881681741805394, d = 0.0006888590367186185, m = 0.000570476467730742
- reduce.heur_params.alpha       |   6809 |     0.00827s |   7.0%
- reduce.heur_params.beta        |   6809 |     0.00218s |   1.8%
- reduce.memory                  |   6810 |     0.00044s |   0.4%
- reduce.pad                     |   6810 |     0.00028s |   0.2%
- reduce.threshold               |   6810 |     0.00229s |   1.9%
- test.last                      |     48 |     0.41356s |   2.6%
- test.runavg                    |     48 |     0.44441s |   2.7%
-----------------------------------------------------------------

[Iteration 6820] [Rank 2] a = 0.9113360643386841, b = 1.0000564034165456, delta = 0.0006828183541074395, c = 0.0011128068332108261, d = 0.0011124959450686906, m = 0.00038184591835210385
[Iteration 6830] [Rank 2] a = 0.8826095461845398, b = 1.0006961074713032, delta = 0.0006549486424773932, c = 0.0023922151674794145, d = 0.002364442493448637, m = 0.00038255240750602673
[Iteration 6890] [Rank 3] a = 0.9106207489967346, b = 1.0007569378856538, delta = 0.0005972014041617513, c = 0.0025138760604351347, d = 0.0024832017637444253, m = 0.0004405465334198344
[Iteration 6900] [Rank 3] a = 0.9642068147659302, b = 0.9998782645117631, delta = 0.0006603054353035986, c = 0.0007565290223234613, d = 0.000757461686749868, m = 0.0004412608257119396
[Iteration 6910] [Rank 3] a = 0.9334637522697449, b = 0.9999842082813775, delta = 0.0006711995811201632, c = 0.0009684165627523052, d = 0.000968520192133017, m = 0.00044163905068890307
[Iteration 6920] [Rank 3] a = 0.995842456817627, b = 1.0000178187438518, delta = 0.0006226139958016574, c = 0.0010356374877073964, d = 0.0010353611426921648, m = 0.00044251062205615704
[Iteration 6930] [Rank 3] a = 1.054935097694397, b = 0.9997180016813659, delta = 0.0007007996900938451, c = 0.00043600334778168704, d = 0.0004368323828273819, m = 0.00044293549697707824
[Iteration 6890] [Rank 1] a = 0.9488382935523987, b = 1.0000573533525323, delta = 0.0006369962939061224, c = 0.0011147067051905436, d = 0.0011139812995255606, m = 0.0005719366176230611
[Iteration 6900] [Rank 1] a = 1.0538556575775146, b = 0.9997026127196219, delta = 0.0007393562700599432, c = 0.00040522542171026545, d = 0.0004061235430097682, m = 0.0005721180490981039
[Iteration 6910] [Rank 1] a = 1.067158818244934, b = 0.9997061879329442, delta = 0.0007329607615247369, c = 0.0004123758489793836, d = 0.00041355031529411796, m = 0.0005725372336213689
[Iteration 6920] [Rank 1] a = 0.9654898047447205, b = 0.9998855185683116, delta = 0.0006975893047638237, c = 0.0007710371356231213, d = 0.0007720388863033358, m = 0.0005729355969286146
[Iteration 6930] [Rank 1] a = 1.06739342212677, b = 0.9996986229888222, delta = 0.0007421130430884659, c = 0.00039724595939545247, d = 0.0003979022788066275, m = 0.0005733267204483522
[Iteration 6840] [Rank 2] a = 0.8717160224914551, b = 1.000066610910507, delta = 0.0006800142000429332, c = 0.001133221821211062, d = 0.0011328073036882145, m = 0.0003833804108690956
[Iteration 6850] [Rank 2] a = 0.9702374339103699, b = 0.999926624888959, delta = 0.0007127579301595688, c = 0.000853249777654528, d = 0.0008543206145885504, m = 0.00038374844558460735
[Iteration 6860] [Rank 2] a = 0.9656890630722046, b = 1.0000740722258814, delta = 0.0006740254466421902, c = 0.0011481444520335695, d = 0.0011465209250690837, m = 0.0003846662145189263
[Iteration 6870] [Rank 2] a = 0.8998764157295227, b = 1.0000729495742628, delta = 0.0006872449303045869, c = 0.0011458991487848125, d = 0.0011447246824700782, m = 0.00038516526115199703
[Iteration 6880] [Rank 2] a = 0.9615551829338074, b = 1.000041929846408, delta = 0.0006911410018801689, c = 0.0010838596928653141, d = 0.001083030657819619, m = 0.0003858038661281784
[Iteration 6940] [Rank 3] a = 0.9478815197944641, b = 0.9999286974765623, delta = 0.0007033729343675077, c = 0.0008573949528830021, d = 0.000858223987928697, m = 0.0004431965993710788
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6949 |     0.11008s |  92.9%
- batch.accumulate               |   6949 |     0.00082s |   0.7%
- batch.backward                 |   6949 |     0.05174s |  43.7%
- batch.evaluate                 |   6949 |     0.00277s |   2.3%
- batch.forward                  |   6949 |     0.02537s |  21.4%
- batch.mom                      |   6949 |     0.00126s |   1.1%
- batch.reduce                   |   6949 |     0.02534s |  21.4%
- batch.reporting.compr_err      |   6949 |     0.00001s |   0.0%
- batch.reporting.lr             |   6949 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   6949 |     0.00001s |   0.0%
[Iteration 6940] [Rank 1] a = 1.0560271739959717, b = 0.999724478517157, delta = 0.0007355257403105497, c = 0.00044895702037066917, d = 0.0004500969435584996, m = 0.0005738273535176945
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6949 |     0.10999s |  92.8%
- batch.accumulate               |   6949 |     0.00083s |   0.7%
- batch.backward                 |   6949 |     0.05176s |  43.7%
- batch.evaluate                 |   6949 |     0.00276s |   2.3%
- batch.forward                  |   6949 |     0.02540s |  21.4%
- batch.mom                      |   6949 |     0.00126s |   1.1%
- batch.reduce                   |   6949 |     0.02521s |  21.3%
- batch.reporting.compr_err      |   6949 |     0.00001s |   0.0%
- batch.reporting.lr             |   6949 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6949 |     0.00001s |   0.0%
[Iteration 6890] [Rank 2] a = 0.9501675367355347, b = 1.0002435062586676, delta = 0.0006575047154910862, c = 0.0014870125269613424, d = 0.0014807602209917269, m = 0.0003867199903975083
[Iteration 6900] [Rank 2] a = 0.8998717665672302, b = 1.0002895867866755, delta = 0.000667289481498301, c = 0.0015791735895410873, d = 0.0015733703442212233, m = 0.0003875274275863291
[Iteration 6910] [Rank 2] a = 1.001009225845337, b = 0.9998288160266708, delta = 0.0006986805819906294, c = 0.0006576320499974455, d = 0.0006585301712969482, m = 0.0003881794207283986
[Iteration 6920] [Rank 2] a = 0.8405357003211975, b = 1.004359309491174, delta = 0.0006214958848431706, c = 0.0097186742113001, d = 0.008979036778032672, m = 0.0003898271228966512
[Iteration 6930] [Rank 2] a = 0.9479186534881592, b = 0.9999566428661338, delta = 0.0006633826997131109, c = 0.0009132857322135972, d = 0.0009135275341019248, m = 0.00039053101674410144
- batch.step                     |   6949 |     0.00047s |   0.4%
- batch.update_runavg            |   6949 |     0.00129s |   1.1%
- batch.wd                       |   6949 |     0.00001s |   0.0%
- epoch_metrics.collect          |     49 |     0.01020s |   0.1%
- reduce.combine                 |   6949 |     0.00591s |   5.0%
- batch.step                     |   6949 |     0.00048s |   0.4%
- batch.update_runavg            |   6949 |     0.00129s |   1.1%
- batch.wd                       |   6949 |     0.00001s |   0.0%
- epoch_metrics.collect          |     49 |     0.01051s |   0.1%
- reduce.combine                 |   6949 |     0.00597s |   5.0%
[Iteration 6940] [Rank 2] a = 0.9160189032554626, b = 1.0001476663568123, delta = 0.0006706238491460681, c = 0.0012953327157713104, d = 0.0012930874125225537, m = 0.00039109878078684017
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6949 |     0.10996s |  92.8%
- batch.accumulate               |   6949 |     0.00083s |   0.7%
- batch.backward                 |   6949 |     0.05193s |  43.8%
- batch.evaluate                 |   6949 |     0.00275s |   2.3%
- batch.forward                  |   6949 |     0.02559s |  21.6%
- batch.mom                      |   6949 |     0.00126s |   1.1%
- batch.reduce                   |   6949 |     0.02482s |  21.0%
- batch.reporting.compr_err      |   6949 |     0.00001s |   0.0%
- batch.reporting.lr             |   6949 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6949 |     0.00001s |   0.0%
- reduce.flatpack                |   6949 |     0.00002s |   0.0%
- reduce.flatput                 |   6949 |     0.00018s |   0.1%
- reduce.gather.context          |   6949 |     0.00259s |   2.2%
- reduce.gather.tensors          |   6949 |     0.00297s |   2.5%
- reduce.heur_params             |   6949 |     0.01041s |   8.8%
- reduce.heur_params.alpha       |   6948 |     0.00811s |   6.8%
- reduce.heur_params.beta        |   6948 |     0.00223s |   1.9%
- reduce.memory                  |   6949 |     0.00044s |   0.4%
- reduce.pad                     |   6949 |     0.00027s |   0.2%
- reduce.threshold               |   6949 |     0.00235s |   2.0%
- test.last                      |     49 |     0.41340s |   2.6%
- test.runavg                    |     49 |     0.44424s |   2.7%
-----------------------------------------------------------------
- reduce.flatpack                |   6949 |     0.00002s |   0.0%
- reduce.flatput                 |   6949 |     0.00022s |   0.2%
- reduce.gather.context          |   6949 |     0.00144s |   1.2%
- reduce.gather.tensors          |   6949 |     0.00328s |   2.8%
- reduce.heur_params             |   6949 |     0.01083s |   9.1%
- reduce.heur_params.alpha       |   6948 |     0.00829s |   7.0%
- reduce.heur_params.beta        |   6948 |     0.00246s |   2.1%
- reduce.memory                  |   6949 |     0.00046s |   0.4%
- reduce.pad                     |   6949 |     0.00018s |   0.2%
- reduce.threshold               |   6949 |     0.00261s |   2.2%
- test.last                      |     49 |     0.41340s |   2.6%
- test.runavg                    |     49 |     0.44423s |   2.7%
-----------------------------------------------------------------
- batch.step                     |   6949 |     0.00048s |   0.4%
- batch.update_runavg            |   6949 |     0.00130s |   1.1%
- batch.wd                       |   6949 |     0.00001s |   0.0%
- epoch_metrics.collect          |     49 |     0.01443s |   0.1%
- reduce.combine                 |   6949 |     0.00601s |   5.1%
- reduce.flatpack                |   6949 |     0.00002s |   0.0%
- reduce.flatput                 |   6949 |     0.00017s |   0.1%
- reduce.gather.context          |   6949 |     0.00160s |   1.4%
- reduce.gather.tensors          |   6949 |     0.00325s |   2.7%
- reduce.heur_params             |   6949 |     0.01053s |   8.9%
- reduce.heur_params.alpha       |   6948 |     0.00826s |   7.0%
- reduce.heur_params.beta        |   6948 |     0.00219s |   1.8%
- reduce.memory                  |   6949 |     0.00044s |   0.4%
- reduce.pad                     |   6949 |     0.00028s |   0.2%
- reduce.threshold               |   6949 |     0.00230s |   1.9%
- test.last                      |     49 |     0.41340s |   2.6%
- test.runavg                    |     49 |     0.44424s |   2.7%
-----------------------------------------------------------------

[Iteration 6820] [Rank 0] a = 1.0200538635253906, b = 0.9997928566328544, delta = 0.000712730863597244, c = 0.0005857132597834166, d = 0.0005868531829712471, m = 0.00031949954971263977
[Iteration 6830] [Rank 0] a = 1.0499871969223022, b = 0.999678087101873, delta = 0.0007672117790207267, c = 0.00035617418150665303, d = 0.0003568650440447321, m = 0.00032018795492088796
[Iteration 6840] [Rank 0] a = 0.976197361946106, b = 1.0000760411841039, delta = 0.0006884803296998143, c = 0.00115208236850062, d = 0.0011502861259016144, m = 0.00032089985219606017
[Iteration 6850] [Rank 0] a = 1.0645275115966797, b = 0.9997575017442589, delta = 0.0007039793999865651, c = 0.0005150034790110261, d = 0.0005161779453257605, m = 0.0003218460630044773
[Iteration 6860] [Rank 0] a = 1.1033756732940674, b = 0.9996552713690887, delta = 0.0007654196233488619, c = 0.00031054271086653195, d = 0.0003111644871508031, m = 0.0003225218352989358
[Iteration 6870] [Rank 0] a = 0.9400294423103333, b = 1.0000290798032163, delta = 0.0007121447124518454, c = 0.0010581596064487735, d = 0.0010578832614335418, m = 0.000323045995577485
[Iteration 6880] [Rank 0] a = 0.9670826196670532, b = 0.9999373505298129, delta = 0.0007173917256295681, c = 0.0008747010594618823, d = 0.0008757718963959049, m = 0.0003236764785983256
[Iteration 6890] [Rank 0] a = 0.859150230884552, b = 1.0009512601036852, delta = 0.0006849946221336722, c = 0.002902520781231503, d = 0.0028580637769061164, m = 0.00032443020583611054
[Iteration 6900] [Rank 0] a = 1.0130183696746826, b = 0.9998734457456342, delta = 0.0006931048701517284, c = 0.0007468914899172585, d = 0.0007480659562319929, m = 0.0003251258820111321
[Iteration 6910] [Rank 0] a = 0.9734780788421631, b = 1.000210431216364, delta = 0.0006454492686316371, c = 0.0014208624389402736, d = 0.001414644676097562, m = 0.0003272335339294603
[Iteration 6920] [Rank 0] a = 0.986098051071167, b = 0.9999048799907282, delta = 0.000690170971211046, c = 0.0008097599808824518, d = 0.0008112107922124179, m = 0.0003277187753746888
[Iteration 6930] [Rank 0] a = 1.2191970348358154, b = 0.9996339928056039, delta = 0.0007628845050930977, c = 0.0002679855785208626, d = 0.0002682964666629982, m = 0.000329116212795532
[Iteration 6940] [Rank 0] a = 0.9933375120162964, b = 0.9999044654732089, delta = 0.0006988071836531162, c = 0.000808930945836757, d = 0.000809621808374836, m = 0.00032970493446594007
cross_entropy                  - bits:14410523072.000, epoch: 50.000, ratio_transmit_grad:  0.180, value:  5.587 (split:train)
last_cross_entropy             - bits:14410523072.000, epoch: 50.000, ratio_transmit_grad:  0.180, value:  5.587 (split:train)
perplexity                     - bits:14410523072.000, epoch: 50.000, ratio_transmit_grad:  0.180, value:267.486 (split:train)
last_perplexity                - bits:14410523072.000, epoch: 50.000, ratio_transmit_grad:  0.180, value:267.486 (split:train)
last_cross_entropy             - bits:14410523072.000, epoch: 50.000, ratio_transmit_grad:  0.180, value:  5.330 (split:test)
last_perplexity                - bits:14410523072.000, epoch: 50.000, ratio_transmit_grad:  0.180, value:206.968 (split:test)
runavg_cross_entropy           - bits:14410523072.000, epoch: 50.000, ratio_transmit_grad:  0.180, value:  5.505 (split:test)
runavg_perplexity              - bits:14410523072.000, epoch: 50.000, ratio_transmit_grad:  0.180, value:246.488 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   6949 |     0.10995s |  92.8%
- batch.accumulate               |   6949 |     0.00083s |   0.7%
- batch.backward                 |   6949 |     0.05170s |  43.6%
- batch.evaluate                 |   6949 |     0.00275s |   2.3%
- batch.forward                  |   6949 |     0.02545s |  21.5%
- batch.mom                      |   6949 |     0.00126s |   1.1%
- batch.reduce                   |   6949 |     0.02514s |  21.2%
- batch.reporting.compr_err      |   6949 |     0.00001s |   0.0%
- batch.reporting.lr             |   6949 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   6949 |     0.00001s |   0.0%
- batch.step                     |   6949 |     0.00048s |   0.4%
- batch.update_runavg            |   6949 |     0.00130s |   1.1%
- batch.wd                       |   6949 |     0.00001s |   0.0%
- epoch_metrics.collect          |     49 |     0.00948s |   0.1%
- reduce.combine                 |   6949 |     0.00619s |   5.2%
- reduce.flatpack                |   6949 |     0.00002s |   0.0%
- reduce.flatput                 |   6949 |     0.00017s |   0.1%
- reduce.gather.context          |   6949 |     0.00125s |   1.1%
- reduce.gather.tensors          |   6949 |     0.00333s |   2.8%
- reduce.heur_params             |   6949 |     0.01096s |   9.3%
- reduce.heur_params.alpha       |   6948 |     0.00871s |   7.4%
- reduce.heur_params.beta        |   6948 |     0.00217s |   1.8%
- reduce.memory                  |   6949 |     0.00045s |   0.4%
- reduce.pad                     |   6949 |     0.00029s |   0.2%
- reduce.threshold               |   6949 |     0.00227s |   1.9%
- test.last                      |     49 |     0.41339s |   2.6%
- test.runavg                    |     49 |     0.44424s |   2.7%
-----------------------------------------------------------------

[Iteration 6950] [Rank 0] a = 1.0834659337997437, b = 0.9997279501011508, delta = 0.0007093028398230672, c = 0.0004559001888783636, d = 0.00045693648268548215, m = 0.0003310055304876074
[Iteration 6960] [Rank 0] a = 1.0632318258285522, b = 0.9997506622055455, delta = 0.0007249363698065281, c = 0.000501324400757061, d = 0.0005019807201682361, m = 0.00033155722383929753
[Iteration 6970] [Rank 0] a = 0.9908164739608765, b = 0.9997954300956996, delta = 0.0007418497116304934, c = 0.0005908601856921056, d = 0.0005921728245144558, m = 0.0003321121360151072
[Iteration 6980] [Rank 0] a = 0.9996317028999329, b = 0.9997820100914967, delta = 0.000734635628759861, c = 0.0005640201760877346, d = 0.0005655400736715085, m = 0.00033262390373836614
[Iteration 6990] [Rank 0] a = 1.08211088180542, b = 0.9997180707676142, delta = 0.0007324604666791856, c = 0.0004361415202893028, d = 0.0004371087278426135, m = 0.00033342652692955506
[Iteration 7000] [Rank 0] a = 0.9448935389518738, b = 0.9999122204051338, delta = 0.0007417530287057161, c = 0.0008244408098166316, d = 0.0008254080173699423, m = 0.0003338361710694182
[Iteration 7010] [Rank 0] a = 0.9981576204299927, b = 0.9998607338751584, delta = 0.0007175703067332506, c = 0.0007214677485159496, d = 0.0007230567323535314, m = 0.0003345597128634434
[Iteration 7020] [Rank 0] a = 1.0864614248275757, b = 0.9996781561881197, delta = 0.0007654961082153022, c = 0.00035631235401426887, d = 0.00035693413029854, m = 0.00033522921406900247
[Iteration 7030] [Rank 0] a = 1.0318270921707153, b = 0.9997050134667314, delta = 0.0007581757963635027, c = 0.0004100269163499148, d = 0.0004108904945225136, m = 0.0003361247237559957
[Iteration 7040] [Rank 0] a = 1.015908122062683, b = 0.9998079865218354, delta = 0.000714907655492425, c = 0.000615973038951279, d = 0.0006171129621391093, m = 0.00033691753871406446
[Iteration 7050] [Rank 0] a = 0.9206535220146179, b = 1.000036886549888, delta = 0.0006962885381653905, c = 0.0010737730998093599, d = 0.0010732549529058008, m = 0.00033750877765405035
[Iteration 7060] [Rank 0] a = 0.9316177368164062, b = 1.0001017239987526, delta = 0.0007084245444275439, c = 0.0012034479982067972, d = 0.001201444496846368, m = 0.0003380118349070453
[Iteration 7070] [Rank 0] a = 0.752442479133606, b = 1.000767197188386, delta = 0.0006930992822162807, c = 0.0025343946778160825, d = 0.0024996788352776105, m = 0.00033868529093169993
[Iteration 7080] [Rank 0] a = 1.0248022079467773, b = 0.9998247917525072, delta = 0.0007308499189093709, c = 0.0006495835014288246, d = 0.000650688881489751, m = 0.0003391789825830441
cross_entropy                  - bits:14855240640.000, epoch: 51.000, ratio_transmit_grad:  0.173, value:  5.573 (split:train)

[Iteration 6950] [Rank 3] a = 0.9724680185317993, b = 0.9998799225818301, delta = 0.0007102334056980908, c = 0.0007598451625062407, d = 0.0007604323956636078, m = 0.00044381350355204895
[Iteration 6960] [Rank 3] a = 1.082277774810791, b = 0.9997969499932204, delta = 0.0006764254067093134, c = 0.0005938999808596534, d = 0.0005946253865246364, m = 0.0004448419866380756
[Iteration 6970] [Rank 3] a = 0.9546963572502136, b = 0.9998180040282874, delta = 0.0006914881523698568, c = 0.0006360080525555713, d = 0.0006367680013474583, m = 0.00044637252948218135
[Iteration 6980] [Rank 3] a = 1.0452653169631958, b = 0.9998211819958588, delta = 0.0006412757793441415, c = 0.0006423639879058985, d = 0.0006430548504439776, m = 0.00044779214359610823
[Iteration 6990] [Rank 3] a = 0.9969757795333862, b = 0.9999505978189389, delta = 0.0006417560507543385, c = 0.0009011956377972138, d = 0.000901817414081485, m = 0.00044831044477958626

[Iteration 6950] [Rank 1] a = 0.882135808467865, b = 1.0004646513284803, delta = 0.0006884604808874428, c = 0.0019293027238395488, d = 0.001918870699514555, m = 0.0005742054588224661
[Iteration 6960] [Rank 1] a = 0.9983808398246765, b = 0.999844239532421, delta = 0.0007087791454978287, c = 0.000688479062322675, d = 0.0006893771836221778, m = 0.000574682896494704
[Iteration 6970] [Rank 1] a = 1.1607153415679932, b = 0.9996508498493774, delta = 0.0007788946968503296, c = 0.00030169967037912016, d = 0.00030221781728267944, m = 0.0005753039949738248
[Iteration 6980] [Rank 1] a = 0.9896060228347778, b = 0.9998929453405048, delta = 0.0006899582222104073, c = 0.0007858906801918208, d = 0.0007869269739989393, m = 0.0005757393957801943
[Iteration 6990] [Rank 1] a = 0.9498074650764465, b = 0.9999305455338425, delta = 0.0006944924243725836, c = 0.0008610910674617251, d = 0.0008616092143652844, m = 0.0005763198515756032
last_cross_entropy             - bits:14855240640.000, epoch: 51.000, ratio_transmit_grad:  0.173, value:  5.573 (split:train)
perplexity                     - bits:14855240640.000, epoch: 51.000, ratio_transmit_grad:  0.173, value:264.039 (split:train)
last_perplexity                - bits:14855240640.000, epoch: 51.000, ratio_transmit_grad:  0.173, value:264.039 (split:train)
last_cross_entropy             - bits:14855240640.000, epoch: 51.000, ratio_transmit_grad:  0.173, value:  5.310 (split:test)
last_perplexity                - bits:14855240640.000, epoch: 51.000, ratio_transmit_grad:  0.173, value:202.873 (split:test)
runavg_cross_entropy           - bits:14855240640.000, epoch: 51.000, ratio_transmit_grad:  0.173, value:  5.498 (split:test)
runavg_perplexity              - bits:14855240640.000, epoch: 51.000, ratio_transmit_grad:  0.173, value:244.945 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
[Iteration 7000] [Rank 3] a = 0.96324622631073, b = 0.9999271948505498, delta = 0.0006572286947630346, c = 0.0008543897008423583, d = 0.0008548387614921097, m = 0.0004489580861206222
[Iteration 7010] [Rank 3] a = 1.0005768537521362, b = 0.9998431341523872, delta = 0.0006720233941450715, c = 0.0006862683022008221, d = 0.0006872355097541327, m = 0.00044957343608981946
[Iteration 7020] [Rank 3] a = 0.8190386295318604, b = 1.0017808980582636, delta = 0.0006044541369192302, c = 0.004561799882062856, d = 0.00442943061976691, m = 0.0004504649427413858
[Iteration 7030] [Rank 3] a = 0.9188733100891113, b = 1.000071809651081, delta = 0.000647353008389473, c = 0.0011436193024091516, d = 0.0011431011555055924, m = 0.0004508646401118908
[Iteration 7040] [Rank 3] a = 0.9308347702026367, b = 1.0002255783767913, delta = 0.0006329156458377838, c = 0.0014511567612350397, d = 0.0014464243528491982, m = 0.00045159668239941895
[Iteration 7000] [Rank 1] a = 0.984001100063324, b = 0.9998988176720149, delta = 0.0007061162614263594, c = 0.0007976353433391646, d = 0.0007986370940193791, m = 0.000576753391391586
[Iteration 7010] [Rank 1] a = 1.151049256324768, b = 0.9996528706220563, delta = 0.0007676815148442984, c = 0.0003057412162268826, d = 0.00030615573374973, m = 0.0005771692432462148
[Iteration 7020] [Rank 1] a = 0.9119834303855896, b = 0.999994363960686, delta = 0.0006916418205946684, c = 0.000988727921371829, d = 0.0009887624644987331, m = 0.00057799059051313
[Iteration 7030] [Rank 1] a = 1.0610512495040894, b = 0.9997216805240925, delta = 0.0007382275653071702, c = 0.00044336103381222887, d = 0.000444017353223404, m = 0.0005782528041427793
[Iteration 7040] [Rank 1] a = 1.0266860723495483, b = 0.9997526657067825, delta = 0.0007397668086923659, c = 0.0005053314034779195, d = 0.0005062986110312301, m = 0.0005785836977207631
- batch                          |   7088 |     0.11000s |  92.8%
- batch.accumulate               |   7088 |     0.00083s |   0.7%
- batch.backward                 |   7088 |     0.05169s |  43.6%
- batch.evaluate                 |   7088 |     0.00275s |   2.3%
- batch.forward                  |   7088 |     0.02545s |  21.5%
- batch.mom                      |   7088 |     0.00126s |   1.1%
- batch.reduce                   |   7088 |     0.02520s |  21.3%
- batch.reporting.compr_err      |   7088 |     0.00001s |   0.0%
- batch.reporting.lr             |   7088 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7088 |     0.00001s |   0.0%
- batch.step                     |   7088 |     0.00048s |   0.4%
- batch.update_runavg            |   7088 |     0.00130s |   1.1%
- batch.wd                       |   7088 |     0.00001s |   0.0%
- epoch_metrics.collect          |     50 |     0.00930s |   0.1%
- reduce.combine                 |   7088 |     0.00620s |   5.2%
[Iteration 7050] [Rank 3] a = 0.9465247988700867, b = 1.0000646764954086, delta = 0.0006536488072015345, c = 0.0011293529909978193, d = 0.0011285584990790285, m = 0.0004521007045680191
[Iteration 7060] [Rank 3] a = 0.8551364541053772, b = 1.0021775034110099, delta = 0.0006017720443196595, c = 0.005355013705158315, d = 0.005104886923246795, m = 0.0004532895924295063
[Iteration 7070] [Rank 3] a = 1.0633111000061035, b = 0.9997306271932896, delta = 0.0007117866189219058, c = 0.0004612543735484762, d = 0.00046215249484797896, m = 0.00045363290230743746
[Iteration 7080] [Rank 3] a = 0.8563902378082275, b = 1.0002607432778967, delta = 0.0006501366733573377, c = 0.0015214865676114867, d = 0.001516961417987069, m = 0.0004542421236652589
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7088 |     0.11012s |  92.9%
- batch.accumulate               |   7088 |     0.00082s |   0.7%
[Iteration 7050] [Rank 1] a = 1.0401204824447632, b = 0.9997373285594348, delta = 0.0007221818086691201, c = 0.00047465710678720974, d = 0.00047600428873646386, m = 0.0005791762853306055
[Iteration 7060] [Rank 1] a = 0.9820039868354797, b = 0.999851510860466, delta = 0.0007077055051922798, c = 0.000703021718749239, d = 0.0007038852969218378, m = 0.0005798647184981073
[Iteration 7070] [Rank 1] a = 0.9675431847572327, b = 1.0001560430648933, delta = 0.0006893397076055408, c = 0.0013120861323197275, d = 0.0013077682414567335, m = 0.0005800912742826219
[Iteration 7080] [Rank 1] a = 1.0264910459518433, b = 0.999798193545738, delta = 0.0007055440219119191, c = 0.0005963870859967379, d = 0.0005975270091845684, m = 0.0005805726610086904
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7088 |     0.11003s |  92.9%
- batch.accumulate               |   7088 |     0.00083s |   0.7%
- reduce.flatpack                |   7088 |     0.00002s |   0.0%
- reduce.flatput                 |   7088 |     0.00017s |   0.1%
- reduce.gather.context          |   7088 |     0.00125s |   1.1%
- reduce.gather.tensors          |   7088 |     0.00336s |   2.8%
- reduce.heur_params             |   7088 |     0.01097s |   9.3%
- reduce.heur_params.alpha       |   7087 |     0.00871s |   7.4%
- reduce.heur_params.beta        |   7087 |     0.00217s |   1.8%
- reduce.memory                  |   7088 |     0.00045s |   0.4%
- reduce.pad                     |   7088 |     0.00029s |   0.2%
- reduce.threshold               |   7088 |     0.00228s |   1.9%
- test.last                      |     50 |     0.41327s |   2.6%
- test.runavg                    |     50 |     0.44407s |   2.7%
-----------------------------------------------------------------

- batch.backward                 |   7088 |     0.05173s |  43.7%
- batch.evaluate                 |   7088 |     0.00277s |   2.3%
- batch.forward                  |   7088 |     0.02537s |  21.4%
- batch.mom                      |   7088 |     0.00126s |   1.1%
- batch.reduce                   |   7088 |     0.02539s |  21.4%
- batch.reporting.compr_err      |   7088 |     0.00001s |   0.0%
- batch.reporting.lr             |   7088 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   7088 |     0.00001s |   0.0%
- batch.step                     |   7088 |     0.00047s |   0.4%
- batch.update_runavg            |   7088 |     0.00129s |   1.1%
- batch.wd                       |   7088 |     0.00001s |   0.0%
- epoch_metrics.collect          |     50 |     0.01001s |   0.1%
- reduce.combine                 |   7088 |     0.00593s |   5.0%
- reduce.flatpack                |   7088 |     0.00002s |   0.0%
- reduce.flatput                 |   7088 |     0.00018s |   0.1%
- batch.backward                 |   7088 |     0.05176s |  43.7%
- batch.evaluate                 |   7088 |     0.00276s |   2.3%
- batch.forward                  |   7088 |     0.02541s |  21.4%
- batch.mom                      |   7088 |     0.00126s |   1.1%
- batch.reduce                   |   7088 |     0.02525s |  21.3%
- batch.reporting.compr_err      |   7088 |     0.00001s |   0.0%
- batch.reporting.lr             |   7088 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7088 |     0.00001s |   0.0%
- batch.step                     |   7088 |     0.00048s |   0.4%
- batch.update_runavg            |   7088 |     0.00129s |   1.1%
- batch.wd                       |   7088 |     0.00001s |   0.0%
- epoch_metrics.collect          |     50 |     0.01032s |   0.1%
- reduce.combine                 |   7088 |     0.00598s |   5.0%
- reduce.flatpack                |   7088 |     0.00002s |   0.0%
- reduce.flatput                 |   7088 |     0.00022s |   0.2%
[Iteration 7090] [Rank 0] a = 1.1205514669418335, b = 0.9997297290720556, delta = 0.000793974322732538, c = 0.0004594581309494707, d = 0.0004600453641068379, m = 0.0003403442516592047
[Iteration 7100] [Rank 0] a = 1.0256341695785522, b = 0.9998908727529147, delta = 0.0006593589787371457, c = 0.0007817455049633465, d = 0.0007829199712780808, m = 0.00034192331502250363
[Iteration 7110] [Rank 0] a = 0.972152829170227, b = 0.9999363487791366, delta = 0.0007019370095804334, c = 0.000872697558101453, d = 0.0008736302225278598, m = 0.00034234673928392194
[Iteration 7120] [Rank 0] a = 1.0053921937942505, b = 0.9998501464069836, delta = 0.000711082189809531, c = 0.0007002928117238268, d = 0.0007015363642923691, m = 0.000342888432125302
[Iteration 7130] [Rank 0] a = 1.0273610353469849, b = 0.9997719234989427, delta = 0.0007213585777208209, c = 0.0005438469899758264, d = 0.0005447105681484252, m = 0.0003437709803599814
- reduce.gather.context          |   7088 |     0.00258s |   2.2%
- reduce.gather.tensors          |   7088 |     0.00300s |   2.5%
- reduce.heur_params             |   7088 |     0.01042s |   8.8%
- reduce.gather.context          |   7088 |     0.00143s |   1.2%
- reduce.gather.tensors          |   7088 |     0.00331s |   2.8%
- reduce.heur_params             |   7088 |     0.01084s |   9.1%
- reduce.heur_params.alpha       |   7087 |     0.00830s |   7.0%
[Iteration 7140] [Rank 0] a = 1.0051300525665283, b = 0.9998913908998125, delta = 0.000717099173925817, c = 0.000782781798770465, d = 0.0007833690319278322, m = 0.00034437866870939895
- reduce.heur_params.alpha       |   7087 |     0.00811s |   6.8%
- reduce.heur_params.beta        |   7087 |     0.00224s |   1.9%
- reduce.memory                  |   7088 |     0.00044s |   0.4%
- reduce.pad                     |   7088 |     0.00027s |   0.2%
- reduce.threshold               |   7088 |     0.00236s |   2.0%
- test.last                      |     50 |     0.41328s |   2.6%
- test.runavg                    |     50 |     0.44406s |   2.7%
-----------------------------------------------------------------

[Iteration 7090] [Rank 3] a = 1.0757126808166504, b = 0.9998639809290257, delta = 0.0006902533350512385, c = 0.0007279618563738926, d = 0.000728445460150548, m = 0.00045487653149363936
[Iteration 7100] [Rank 3] a = 0.9654805064201355, b = 1.0004395902950354, delta = 0.0006414312520064414, c = 0.0018791806467019139, d = 0.0018633598945799036, m = 0.00045542490833648395
- reduce.heur_params.beta        |   7087 |     0.00246s |   2.1%
- reduce.memory                  |   7088 |     0.00046s |   0.4%
- reduce.pad                     |   7088 |     0.00018s |   0.2%
- reduce.threshold               |   7088 |     0.00261s |   2.2%
- test.last                      |     50 |     0.41328s |   2.6%
- test.runavg                    |     50 |     0.44406s |   2.7%
-----------------------------------------------------------------

[Iteration 7090] [Rank 1] a = 0.994685173034668, b = 1.000034641246642, delta = 0.000672218156978488, c = 0.0010692824933118462, d = 0.0010687643464082869, m = 0.0005813438294644014
[Iteration 7100] [Rank 1] a = 0.9516032934188843, b = 1.000022136634713, delta = 0.0006709864246658981, c = 0.0010442732694333845, d = 0.001043893295037441, m = 0.0005820914948951031
[Iteration 7110] [Rank 1] a = 1.0520001649856567, b = 0.9997514912405399, delta = 0.000702902500052005, c = 0.0005029824708484507, d = 0.0005040533077824732, m = 0.0005827188792823605
[Iteration 7150] [Rank 0] a = 0.987302303314209, b = 1.0000977860823246, delta = 0.00070380320539698, c = 0.0011955721652726961, d = 0.001192705085739668, m = 0.00034493100959211484
[Iteration 7160] [Rank 0] a = 0.9672629833221436, b = 1.0013678669195196, delta = 0.0006574115832336247, c = 0.0037357355452817386, d = 0.003590343524143003, m = 0.00034613916918746604
[Iteration 7170] [Rank 0] a = 0.9659199118614197, b = 1.0003050275630365, delta = 0.000670151028316468, c = 0.0016100551449932208, d = 0.0016001758106986904, m = 0.0003468374214196194
[Iteration 7180] [Rank 0] a = 0.9568144083023071, b = 1.0007540708077571, delta = 0.0006649796850979328, c = 0.002508141901369079, d = 0.002460057868718777, m = 0.00034758264538451794
[Iteration 7190] [Rank 0] a = 0.9413953423500061, b = 0.9998913390851225, delta = 0.000714591471478343, c = 0.0007826781693897532, d = 0.0007837144631968717, m = 0.0003482580458560008
[Iteration 7110] [Rank 3] a = 0.9000858664512634, b = 1.0003360300162452, delta = 0.0006676753982901573, c = 0.0016720600577858154, d = 0.0016654277774202563, m = 0.0004558216592496869
[Iteration 7120] [Rank 3] a = 0.9363170266151428, b = 0.9999150356699555, delta = 0.0006890735239721835, c = 0.0008300713395019758, d = 0.0008307276589131509, m = 0.0004562973014385201
[Iteration 7130] [Rank 3] a = 1.0629818439483643, b = 0.9997268965358586, delta = 0.0007030841079540551, c = 0.0004537930581372225, d = 0.0004547257225636292, m = 0.00045732531205772495
[Iteration 7140] [Rank 3] a = 0.9949778914451599, b = 0.9998756392341582, delta = 0.000677326403092593, c = 0.0007512784670340605, d = 0.0007526947352371225, m = 0.00045784768403191916
[Iteration 7150] [Rank 3] a = 0.9283055067062378, b = 1.0000920691948736, delta = 0.0006483366596512496, c = 0.0011841383902674878, d = 0.0011824457770491942, m = 0.00045843583119054807
[Iteration 7120] [Rank 1] a = 0.9485822319984436, b = 1.000024088321382, delta = 0.0006620475905947387, c = 0.0010481766427735313, d = 0.0010479693840121074, m = 0.0005836220302317137
[Iteration 7130] [Rank 1] a = 1.0177104473114014, b = 0.9998468129953141, delta = 0.000685797305777669, c = 0.0006936259882313639, d = 0.0006948004545460983, m = 0.0005840932060235289
[Iteration 7140] [Rank 1] a = 0.9823276996612549, b = 0.9998602502713911, delta = 0.0007196764345280826, c = 0.0007205005409626388, d = 0.0007219168091657009, m = 0.0005843794868171867
[Iteration 7150] [Rank 1] a = 0.9876397252082825, b = 1.0010863581325729, delta = 0.0006292182370088995, c = 0.003172717119874219, d = 0.0029807264205420517, m = 0.000585664572861858
[Iteration 7160] [Rank 1] a = 1.0042749643325806, b = 0.9999039473263102, delta = 0.0006633240263909101, c = 0.0008078946520296384, d = 0.0008086546008215254, m = 0.0005864473627333886
[Iteration 7200] [Rank 0] a = 0.9175124764442444, b = 1.000147338197114, delta = 0.0006893163663335145, c = 0.0012946763963601355, d = 0.0012923620068575707, m = 0.0003490836350670235
[Iteration 7210] [Rank 0] a = 1.0002676248550415, b = 1.0000595641126466, delta = 0.0006637425976805389, c = 0.0011191282254342494, d = 0.0011171938103276282, m = 0.0003498900102090445
[Iteration 7220] [Rank 0] a = 0.9666125774383545, b = 0.9999119613316839, delta = 0.0007075925241224468, c = 0.0008239226629130724, d = 0.0008247516979587671, m = 0.0003504592624982639
cross_entropy                  - bits:15284153472.000, epoch: 52.000, ratio_transmit_grad:  0.167, value:  5.554 (split:train)
last_cross_entropy             - bits:15284153472.000, epoch: 52.000, ratio_transmit_grad:  0.167, value:  5.554 (split:train)
perplexity                     - bits:15284153472.000, epoch: 52.000, ratio_transmit_grad:  0.167, value:259.015 (split:train)
[Iteration 7160] [Rank 3] a = 0.9598326086997986, b = 0.999965693165369, delta = 0.0006613032892346382, c = 0.0009313863307112682, d = 0.0009318699344879236, m = 0.00045937099891466297
[Iteration 7170] [Rank 3] a = 0.9836744070053101, b = 1.0000519646247514, delta = 0.0006540387403219938, c = 0.0011039292495965104, d = 0.0011029965851701037, m = 0.0004598623640523026
[Iteration 7180] [Rank 3] a = 0.9084672927856445, b = 1.0006860381546197, delta = 0.0006315899081528187, c = 0.0023720765244944104, d = 0.002336738905671667, m = 0.0004606572406897917
[Iteration 7190] [Rank 3] a = 0.9783374667167664, b = 1.0002110011779326, delta = 0.0006477730930782855, c = 0.0014220023621281039, d = 0.0014159573149199122, m = 0.0004611508642592929
[Iteration 7200] [Rank 3] a = 0.9750828742980957, b = 0.9998455176280856, delta = 0.0007002579513937235, c = 0.0006910352537135675, d = 0.0006917952025054544, m = 0.00046156122742179947
[Iteration 7170] [Rank 1] a = 1.051077127456665, b = 0.9997826145961889, delta = 0.0007142257527448237, c = 0.0005652291855293729, d = 0.0005659545911943559, m = 0.0005867646936055759
[Iteration 7180] [Rank 1] a = 0.9485610723495483, b = 0.9999562801633023, delta = 0.0007113548927009106, c = 0.0009125603265486142, d = 0.0009129057578176537, m = 0.0005869758613399187
[Iteration 7190] [Rank 1] a = 0.9968873858451843, b = 1.0000745212865285, delta = 0.0006570163532160223, c = 0.0011490425733330723, d = 0.0011452082862467336, m = 0.0005876507060001862
[Iteration 7200] [Rank 1] a = 0.9584149718284607, b = 0.9999458481390022, delta = 0.000658580451272428, c = 0.0008916962778986269, d = 0.0008920762522945704, m = 0.0005887698636048559
[Iteration 7210] [Rank 1] a = 0.9530399441719055, b = 0.9998080037933982, delta = 0.0007170096505433321, c = 0.0006160075820781829, d = 0.0006170438758853015, m = 0.0005890991664479918
last_perplexity                - bits:15284153472.000, epoch: 52.000, ratio_transmit_grad:  0.167, value:259.015 (split:train)
last_cross_entropy             - bits:15284153472.000, epoch: 52.000, ratio_transmit_grad:  0.167, value:  5.306 (split:test)
last_perplexity                - bits:15284153472.000, epoch: 52.000, ratio_transmit_grad:  0.167, value:202.106 (split:test)
runavg_cross_entropy           - bits:15284153472.000, epoch: 52.000, ratio_transmit_grad:  0.167, value:  5.489 (split:test)
runavg_perplexity              - bits:15284153472.000, epoch: 52.000, ratio_transmit_grad:  0.167, value:242.840 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7227 |     0.11005s |  92.8%
- batch.accumulate               |   7227 |     0.00083s |   0.7%
- batch.backward                 |   7227 |     0.05169s |  43.6%

[Iteration 6950] [Rank 2] a = 0.9689967632293701, b = 1.000089029399731, delta = 0.0006681488594040275, c = 0.001178058799932392, d = 0.0011769534198714656, m = 0.00039190299092983213
[Iteration 6960] [Rank 2] a = 0.9834259152412415, b = 0.9999918941271124, delta = 0.0006751162582077086, c = 0.000983788254224564, d = 0.0009838918836052757, m = 0.000392943446947956
[Iteration 6970] [Rank 2] a = 0.9925181865692139, b = 0.9998906482225927, delta = 0.000676280353218317, c = 0.000781296444313595, d = 0.0007822636518669058, m = 0.0003936564671753002
[Iteration 6980] [Rank 2] a = 1.1269832849502563, b = 0.9996754618245025, delta = 0.000733918568585068, c = 0.0003509236262172523, d = 0.0003515454025015234, m = 0.0003943042170287544
[Iteration 6990] [Rank 2] a = 0.9826846718788147, b = 0.9998768309720182, delta = 0.0006983700441196561, c = 0.0007536619427904332, d = 0.0007549745816127834, m = 0.00039484677592910625
[Iteration 7210] [Rank 3] a = 0.9219454526901245, b = 1.0000182332613745, delta = 0.0006458457792177796, c = 0.0010364665227530915, d = 0.0010363283502454756, m = 0.0004634029215514701
[Iteration 7220] [Rank 3] a = 1.0583819150924683, b = 0.9997005055890684, delta = 0.0007221200503408909, c = 0.0004010111602279833, d = 0.0004017020227660623, m = 0.0004639738088398819
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7227 |     0.11018s |  92.9%
- batch.accumulate               |   7227 |     0.00082s |   0.7%
- batch.backward                 |   7227 |     0.05174s |  43.6%
- batch.evaluate                 |   7227 |     0.00277s |   2.3%
- batch.forward                  |   7227 |     0.02537s |  21.4%
- batch.mom                      |   7227 |     0.00126s |   1.1%
- batch.reduce                   |   7227 |     0.02543s |  21.5%
[Iteration 7220] [Rank 1] a = 1.0347018241882324, b = 0.9997678128670587, delta = 0.0007112231687642634, c = 0.0005356257257726857, d = 0.0005363165883107648, m = 0.0005894465389588596
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7227 |     0.11009s |  92.9%
- batch.accumulate               |   7227 |     0.00083s |   0.7%
- batch.backward                 |   7227 |     0.05176s |  43.7%
- batch.evaluate                 |   7227 |     0.00276s |   2.3%
- batch.forward                  |   7227 |     0.02541s |  21.4%
- batch.mom                      |   7227 |     0.00126s |   1.1%
- batch.reduce                   |   7227 |     0.02530s |  21.3%
- batch.reporting.compr_err      |   7227 |     0.00001s |   0.0%
- batch.reporting.lr             |   7227 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7227 |     0.00001s |   0.0%
- batch.evaluate                 |   7227 |     0.00275s |   2.3%
- batch.forward                  |   7227 |     0.02545s |  21.5%
- batch.mom                      |   7227 |     0.00126s |   1.1%
- batch.reduce                   |   7227 |     0.02526s |  21.3%
- batch.reporting.compr_err      |   7227 |     0.00001s |   0.0%
- batch.reporting.lr             |   7227 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7227 |     0.00001s |   0.0%
- batch.step                     |   7227 |     0.00048s |   0.4%
- batch.update_runavg            |   7227 |     0.00130s |   1.1%
- batch.wd                       |   7227 |     0.00001s |   0.0%
- epoch_metrics.collect          |     51 |     0.00915s |   0.1%
- reduce.combine                 |   7227 |     0.00622s |   5.2%
- reduce.flatpack                |   7227 |     0.00002s |   0.0%
- reduce.flatput                 |   7227 |     0.00017s |   0.1%
- reduce.gather.context          |   7227 |     0.00124s |   1.0%
[Iteration 7000] [Rank 2] a = 1.01116943359375, b = 0.9997670701898707, delta = 0.0007205276633612812, c = 0.0005341403713158158, d = 0.0005351766651229343, m = 0.00039555376063547375
[Iteration 7010] [Rank 2] a = 0.9621579051017761, b = 1.0003971022563862, delta = 0.0006606279639527202, c = 0.001794204554518191, d = 0.0017771057067007346, m = 0.00039625772837580364
[Iteration 7020] [Rank 2] a = 1.0512627363204956, b = 0.9997230622490622, delta = 0.0007276355754584074, c = 0.0004461244839645451, d = 0.00044722986402547155, m = 0.00039706195242405156
[Iteration 7030] [Rank 2] a = 1.0630943775177002, b = 0.9997294181839362, delta = 0.000716238166205585, c = 0.00045883635466519956, d = 0.00045963084658399045, m = 0.00039768054150801364
[Iteration 7040] [Rank 2] a = 1.0652658939361572, b = 0.9998231336824672, delta = 0.0006494029657915235, c = 0.0006462673612460452, d = 0.0006472691119262598, m = 0.00039966107883433223
- batch.reporting.compr_err      |   7227 |     0.00001s |   0.0%
- batch.reporting.lr             |   7227 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   7227 |     0.00001s |   0.0%
- batch.step                     |   7227 |     0.00047s |   0.4%
- batch.update_runavg            |   7227 |     0.00129s |   1.1%
- batch.step                     |   7227 |     0.00048s |   0.4%
- batch.update_runavg            |   7227 |     0.00130s |   1.1%
- batch.wd                       |   7227 |     0.00001s |   0.0%
- reduce.gather.tensors          |   7227 |     0.00339s |   2.9%
- reduce.heur_params             |   7227 |     0.01097s |   9.3%
- reduce.heur_params.alpha       |   7226 |     0.00871s |   7.4%
- reduce.heur_params.beta        |   7226 |     0.00218s |   1.8%
[Iteration 7050] [Rank 2] a = 1.0227282047271729, b = 0.9997702827005006, delta = 0.0007131042657420039, c = 0.0005405653929199509, d = 0.0005414980573463577, m = 0.0004001264622964734
[Iteration 7060] [Rank 2] a = 1.0993494987487793, b = 0.9997536156427144, delta = 0.0006890631630085409, c = 0.0005072312754576369, d = 0.000507853051741908, m = 0.00040103745038008384
[Iteration 7070] [Rank 2] a = 1.0008124113082886, b = 0.9997907495022046, delta = 0.0006957193836569786, c = 0.0005814989983011345, d = 0.0005827425508696767, m = 0.0004016415148930836
[Iteration 7080] [Rank 2] a = 0.8872730135917664, b = 1.0006088688415036, delta = 0.0006516115972772241, c = 0.002217737833487551, d = 0.0021976337336294506, m = 0.00040227274781137707
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7088 |     0.11001s |  92.8%
- batch.accumulate               |   7088 |     0.00083s |   0.7%
- batch.wd                       |   7227 |     0.00001s |   0.0%
- epoch_metrics.collect          |     51 |     0.00986s |   0.1%
- reduce.combine                 |   7227 |     0.00594s |   5.0%
- reduce.flatpack                |   7227 |     0.00002s |   0.0%
- reduce.flatput                 |   7227 |     0.00018s |   0.1%
- reduce.gather.context          |   7227 |     0.00257s |   2.2%
- reduce.gather.tensors          |   7227 |     0.00302s |   2.5%
- reduce.heur_params             |   7227 |     0.01043s |   8.8%
- reduce.heur_params.alpha       |   7226 |     0.00811s |   6.8%
- reduce.heur_params.beta        |   7226 |     0.00224s |   1.9%
- reduce.memory                  |   7227 |     0.00044s |   0.4%
- reduce.pad                     |   7227 |     0.00027s |   0.2%
- reduce.threshold               |   7227 |     0.00237s |   2.0%
- test.last                      |     51 |     0.41313s |   2.5%
- test.runavg                    |     51 |     0.44384s |   2.7%
- epoch_metrics.collect          |     51 |     0.01013s |   0.1%
- reduce.combine                 |   7227 |     0.00600s |   5.1%
- reduce.flatpack                |   7227 |     0.00002s |   0.0%
- reduce.flatput                 |   7227 |     0.00022s |   0.2%
- reduce.gather.context          |   7227 |     0.00142s |   1.2%
- reduce.gather.tensors          |   7227 |     0.00333s |   2.8%
- reduce.heur_params             |   7227 |     0.01084s |   9.1%
- reduce.heur_params.alpha       |   7226 |     0.00830s |   7.0%
- reduce.heur_params.beta        |   7226 |     0.00247s |   2.1%
- reduce.memory                  |   7227 |     0.00046s |   0.4%
- reduce.pad                     |   7227 |     0.00018s |   0.2%
- reduce.threshold               |   7227 |     0.00262s |   2.2%
- test.last                      |     51 |     0.41313s |   2.5%
- test.runavg                    |     51 |     0.44384s |   2.7%
-----------------------------------------------------------------
- reduce.memory                  |   7227 |     0.00045s |   0.4%
- reduce.pad                     |   7227 |     0.00029s |   0.2%
- reduce.threshold               |   7227 |     0.00229s |   1.9%
- test.last                      |     51 |     0.41312s |   2.5%
- test.runavg                    |     51 |     0.44385s |   2.7%
-----------------------------------------------------------------
- batch.backward                 |   7088 |     0.05192s |  43.8%
- batch.evaluate                 |   7088 |     0.00275s |   2.3%
- batch.forward                  |   7088 |     0.02559s |  21.6%
- batch.mom                      |   7088 |     0.00126s |   1.1%
- batch.reduce                   |   7088 |     0.02489s |  21.0%
- batch.reporting.compr_err      |   7088 |     0.00001s |   0.0%
- batch.reporting.lr             |   7088 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7088 |     0.00001s |   0.0%
- batch.step                     |   7088 |     0.00048s |   0.4%
- batch.update_runavg            |   7088 |     0.00130s |   1.1%
- batch.wd                       |   7088 |     0.00001s |   0.0%
- epoch_metrics.collect          |     50 |     0.01422s |   0.1%
- reduce.combine                 |   7088 |     0.00602s |   5.1%
- reduce.flatpack                |   7088 |     0.00002s |   0.0%
- reduce.flatput                 |   7088 |     0.00017s |   0.1%
-----------------------------------------------------------------
- reduce.gather.context          |   7088 |     0.00162s |   1.4%
- reduce.gather.tensors          |   7088 |     0.00328s |   2.8%
- reduce.heur_params             |   7088 |     0.01053s |   8.9%
- reduce.heur_params.alpha       |   7087 |     0.00826s |   7.0%
- reduce.heur_params.beta        |   7087 |     0.00220s |   1.9%
- reduce.memory                  |   7088 |     0.00045s |   0.4%
- reduce.pad                     |   7088 |     0.00028s |   0.2%
- reduce.threshold               |   7088 |     0.00231s |   1.9%
- test.last                      |     50 |     0.41328s |   2.6%
- test.runavg                    |     50 |     0.44407s |   2.7%
-----------------------------------------------------------------

[Iteration 7090] [Rank 2] a = 0.9086323380470276, b = 1.0007313587143474, delta = 0.0006542333867400885, c = 0.0024627176894903816, d = 0.0024386756731652305, m = 0.000402964559196619
[Iteration 7100] [Rank 2] a = 1.0042245388031006, b = 0.9998100936524997, delta = 0.0007044275989755988, c = 0.0006201873004335612, d = 0.0006206709042102165, m = 0.0004035409760613382
[Iteration 7110] [Rank 2] a = 1.149622917175293, b = 0.9996427840302515, delta = 0.0007417559390887618, c = 0.00028556803011497436, d = 0.0002861207201454376, m = 0.00040432806307015275
[Iteration 7120] [Rank 2] a = 0.9867653846740723, b = 0.9999272466652398, delta = 0.0006667753914371133, c = 0.0008544933302230701, d = 0.0008554950809032848, m = 0.00040506675422846477
[Iteration 7130] [Rank 2] a = 0.9826445579528809, b = 1.0000603586045627, delta = 0.000677823496516794, c = 0.0011207172092718312, d = 0.001119508199830193, m = 0.0004055579822615677
[Iteration 7140] [Rank 2] a = 1.0442081689834595, b = 0.9998144288147732, delta = 0.0006813124637119472, c = 0.0006288576252864532, d = 0.0006297902897128599, m = 0.00040634456387678505
[Iteration 7150] [Rank 2] a = 1.105883002281189, b = 0.9996837694456704, delta = 0.000722101831343025, c = 0.0003675388702580534, d = 0.0003680915602885166, m = 0.0004070692112255224
[Iteration 7160] [Rank 2] a = 0.938526451587677, b = 1.0000079912242494, delta = 0.0006587193929590285, c = 0.0010159824484990475, d = 0.0010158442759914319, m = 0.00040799713983067433
[Iteration 7170] [Rank 2] a = 0.9683942794799805, b = 0.999951409582419, delta = 0.0006989259854890406, c = 0.0009028191647616995, d = 0.000903233682284547, m = 0.00040839680446638305
[Iteration 7180] [Rank 2] a = 1.017634630203247, b = 0.9998409233923204, delta = 0.0006918144645169377, c = 0.0006818467819571162, d = 0.0006828485326373307, m = 0.0004089694570006184
[Iteration 7190] [Rank 2] a = 0.9532753229141235, b = 1.0000214285006117, delta = 0.0006842257571406662, c = 0.0010428570012303226, d = 0.001042546113088187, m = 0.00040987292538632685
[Iteration 7200] [Rank 2] a = 0.9186608195304871, b = 0.9999199062508156, delta = 0.00072384875966236, c = 0.0008398125012888904, d = 0.0008403651913193536, m = 0.0004103003495920549
[Iteration 7210] [Rank 2] a = 1.0166915655136108, b = 0.9998348783452711, delta = 0.0007028539548628032, c = 0.0006697566875407329, d = 0.0006707584382209474, m = 0.00041092884596808174
[Iteration 7220] [Rank 2] a = 1.0099214315414429, b = 0.9998807688884273, delta = 0.0006865438772365451, c = 0.0007615377757245344, d = 0.0007624358970240371, m = 0.0004114916195564253
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7227 |     0.11006s |  92.8%
- batch.accumulate               |   7227 |     0.00083s |   0.7%
- batch.backward                 |   7227 |     0.05191s |  43.8%
- batch.evaluate                 |   7227 |     0.00275s |   2.3%
- batch.forward                  |   7227 |     0.02558s |  21.6%
- batch.mom                      |   7227 |     0.00126s |   1.1%
- batch.reduce                   |   7227 |     0.02496s |  21.1%
- batch.reporting.compr_err      |   7227 |     0.00001s |   0.0%
- batch.reporting.lr             |   7227 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7227 |     0.00001s |   0.0%
- batch.step                     |   7227 |     0.00048s |   0.4%
- batch.update_runavg            |   7227 |     0.00130s |   1.1%
- batch.wd                       |   7227 |     0.00001s |   0.0%
- epoch_metrics.collect          |     51 |     0.01403s |   0.1%
- reduce.combine                 |   7227 |     0.00603s |   5.1%
- reduce.flatpack                |   7227 |     0.00002s |   0.0%
- reduce.flatput                 |   7227 |     0.00017s |   0.1%
- reduce.gather.context          |   7227 |     0.00165s |   1.4%
- reduce.gather.tensors          |   7227 |     0.00331s |   2.8%
- reduce.heur_params             |   7227 |     0.01054s |   8.9%
- reduce.heur_params.alpha       |   7226 |     0.00826s |   7.0%
- reduce.heur_params.beta        |   7226 |     0.00220s |   1.9%
- reduce.memory                  |   7227 |     0.00045s |   0.4%
- reduce.pad                     |   7227 |     0.00028s |   0.2%
- reduce.threshold               |   7227 |     0.00231s |   2.0%
- test.last                      |     51 |     0.41313s |   2.5%
- test.runavg                    |     51 |     0.44384s |   2.7%
-----------------------------------------------------------------

[Iteration 7230] [Rank 0] a = 1.0854532718658447, b = 0.9996715757231402, delta = 0.0008172282832674682, c = 0.000343151422663863, d = 0.00034363502644051835, m = 0.0003509614034330679
[Iteration 7240] [Rank 0] a = 0.9905000329017639, b = 1.0001343327100927, delta = 0.0006733604241162539, c = 0.0012686654218014592, d = 0.001261549537659245, m = 0.000351937813568071
[Iteration 7250] [Rank 0] a = 0.9438119530677795, b = 0.999912064961064, delta = 0.0007244143635034561, c = 0.000824129921674496, d = 0.0008247862410856712, m = 0.0003524786385973874
[Iteration 7260] [Rank 0] a = 0.9957649111747742, b = 0.9998708722827219, delta = 0.0007257795659825206, c = 0.0007417445640085696, d = 0.0007432644615923435, m = 0.0003529834260715236
[Iteration 7270] [Rank 0] a = 0.9456489086151123, b = 1.0008132949624438, delta = 0.0006523925112560391, c = 0.0026265902835227316, d = 0.002510352661490932, m = 0.00035453779885499966
[Iteration 7280] [Rank 0] a = 1.0602729320526123, b = 0.9997587625683171, delta = 0.0006984813953749835, c = 0.0005175251272750147, d = 0.000518768679843557, m = 0.00035699739531670646
[Iteration 7290] [Rank 0] a = 0.8738054037094116, b = 1.0002296199224296, delta = 0.0006637655897065997, c = 0.0014592398529305647, d = 0.0014551637639558983, m = 0.0003576980777736134
[Iteration 7300] [Rank 0] a = 1.0538002252578735, b = 0.9997450489477807, delta = 0.000718435796443373, c = 0.0004900978845132764, d = 0.0004912032645742029, m = 0.0003583959560648075
[Iteration 7310] [Rank 0] a = 0.9063475728034973, b = 1.0000975615520018, delta = 0.0006712935864925385, c = 0.0011951231046229446, d = 0.0011939140951813063, m = 0.0003594329482535154
[Iteration 7320] [Rank 0] a = 0.9658384323120117, b = 1.0000050205153357, delta = 0.0006951572722755373, c = 0.0010100410306715679, d = 0.0010100410306715679, m = 0.0003598461191993971
[Iteration 7330] [Rank 0] a = 0.9862527847290039, b = 0.9998395589388426, delta = 0.0007075282628647983, c = 0.0006791178749317039, d = 0.0006810177469114213, m = 0.0003605787482418887
[Iteration 7340] [Rank 0] a = 0.9856284260749817, b = 0.9999934831109499, delta = 0.0006367349997162819, c = 0.0009869662218997277, d = 0.0009870007650266315, m = 0.00036207465201219954
[Iteration 7350] [Rank 0] a = 0.9987455010414124, b = 0.9997971227088477, delta = 0.0007077460177242756, c = 0.0005942454121286929, d = 0.0005952817059358115, m = 0.0003625140271186435
[Iteration 7360] [Rank 0] a = 0.954322338104248, b = 0.9999216334071501, delta = 0.0006958701997064054, c = 0.0008432668139792856, d = 0.0008441303921518844, m = 0.00036330955921620386
cross_entropy                  - bits:15748994432.000, epoch: 53.000, ratio_transmit_grad:  0.180, value:  5.536 (split:train)
last_cross_entropy             - bits:15748994432.000, epoch: 53.000, ratio_transmit_grad:  0.180, value:  5.536 (split:train)
perplexity                     - bits:15748994432.000, epoch: 53.000, ratio_transmit_grad:  0.180, value:254.354 (split:train)
last_perplexity                - bits:15748994432.000, epoch: 53.000, ratio_transmit_grad:  0.180, value:254.354 (split:train)
last_cross_entropy             - bits:15748994432.000, epoch: 53.000, ratio_transmit_grad:  0.180, value:  5.274 (split:test)
last_perplexity                - bits:15748994432.000, epoch: 53.000, ratio_transmit_grad:  0.180, value:195.835 (split:test)
runavg_cross_entropy           - bits:15748994432.000, epoch: 53.000, ratio_transmit_grad:  0.180, value:  5.460 (split:test)
runavg_perplexity              - bits:15748994432.000, epoch: 53.000, ratio_transmit_grad:  0.180, value:235.753 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7366 |     0.11009s |  92.8%
- batch.accumulate               |   7366 |     0.00083s |   0.7%
- batch.backward                 |   7366 |     0.05168s |  43.6%
- batch.evaluate                 |   7366 |     0.00275s |   2.3%
- batch.forward                  |   7366 |     0.02544s |  21.5%
- batch.mom                      |   7366 |     0.00126s |   1.1%
- batch.reduce                   |   7366 |     0.02530s |  21.3%
- batch.reporting.compr_err      |   7366 |     0.00001s |   0.0%
- batch.reporting.lr             |   7366 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7366 |     0.00001s |   0.0%
- batch.step                     |   7366 |     0.00048s |   0.4%
- batch.update_runavg            |   7366 |     0.00130s |   1.1%
- batch.wd                       |   7366 |     0.00001s |   0.0%
- epoch_metrics.collect          |     52 |     0.00946s |   0.1%
- reduce.combine                 |   7366 |     0.00623s |   5.3%
- reduce.flatpack                |   7366 |     0.00002s |   0.0%
- reduce.flatput                 |   7366 |     0.00017s |   0.1%
- reduce.gather.context          |   7366 |     0.00124s |   1.0%
- reduce.gather.tensors          |   7366 |     0.00341s |   2.9%
- reduce.heur_params             |   7366 |     0.01098s |   9.3%
- reduce.heur_params.alpha       |   7365 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   7365 |     0.00219s |   1.8%
- reduce.memory                  |   7366 |     0.00045s |   0.4%
- reduce.pad                     |   7366 |     0.00029s |   0.2%
- reduce.threshold               |   7366 |     0.00230s |   1.9%
- test.last                      |     52 |     0.41301s |   2.5%
- test.runavg                    |     52 |     0.44383s |   2.7%
-----------------------------------------------------------------

[Iteration 7370] [Rank 0] a = 1.0402846336364746, b = 0.9998465539218683, delta = 0.0007026223465800285, c = 0.0006931078413278046, d = 0.000693556901977556, m = 0.0003639948747811224
[Iteration 7380] [Rank 0] a = 1.0038018226623535, b = 0.999824619036878, delta = 0.000740269897505641, c = 0.0006492380701597851, d = 0.0006498598464440563, m = 0.000364401679478259
[Iteration 7390] [Rank 0] a = 1.0506300926208496, b = 0.9998248262956332, delta = 0.0006661221268586814, c = 0.0006496525876826325, d = 0.0006506543383628471, m = 0.0003656515097044933
[Iteration 7400] [Rank 0] a = 0.9717113971710205, b = 0.9998419596861013, delta = 0.000716661277692765, c = 0.0006839193695713533, d = 0.0006853010946475114, m = 0.00036606121227683147
[Iteration 7410] [Rank 0] a = 1.0053154230117798, b = 0.9998010778967186, delta = 0.0007131007732823491, c = 0.000602155788189698, d = 0.0006029502801084889, m = 0.0003667745354072796
[Iteration 7420] [Rank 0] a = 0.9854615330696106, b = 0.9999631715171083, delta = 0.0006924131885170937, c = 0.0009263430341832911, d = 0.0009269648104675623, m = 0.00036736587999147853
[Iteration 7430] [Rank 0] a = 0.9955768585205078, b = 0.9997399883800245, delta = 0.0007467845571227372, c = 0.0004799767483304184, d = 0.000480978499010633, m = 0.00036798913022509014
[Iteration 7440] [Rank 0] a = 0.9673275947570801, b = 0.999983724677601, delta = 0.0006877694395370781, c = 0.0009674493551989945, d = 0.0009675184414528024, m = 0.0003687140793358991
[Iteration 7450] [Rank 0] a = 1.0498836040496826, b = 0.9996831994841334, delta = 0.0007750116055831313, c = 0.00036639894707022296, d = 0.00036736615462353364, m = 0.00036937266013726324
[Iteration 7460] [Rank 0] a = 1.016298532485962, b = 0.999831303131736, delta = 0.0007200723048299551, c = 0.0006626062602716146, d = 0.0006637461834594451, m = 0.00036984346305018773
[Iteration 7470] [Rank 0] a = 0.9499433636665344, b = 0.999899577620799, delta = 0.0007183774141594768, c = 0.0007991552409229385, d = 0.0007998806465879214, m = 0.0003704738662669346
[Iteration 7480] [Rank 0] a = 1.0815321207046509, b = 0.999674701875791, delta = 0.0007732340600341558, c = 0.0003494037286334784, d = 0.0003500945911715574, m = 0.0003709497927915832
[Iteration 7490] [Rank 0] a = 0.9826968312263489, b = 0.9998628755489855, delta = 0.0007238468388095498, c = 0.0007257510962520396, d = 0.0007267873900591583, m = 0.0003717575954630494
[Iteration 7500] [Rank 0] a = 1.0732507705688477, b = 0.9997450489477807, delta = 0.0007394336862489581, c = 0.0004900978845132764, d = 0.0004909269195589713, m = 0.00037230473495864804

[Iteration 7230] [Rank 1] a = 1.0557067394256592, b = 0.9997362404510126, delta = 0.0007455464801751077, c = 0.00047248088979226076, d = 0.00047355172672628327, m = 0.0005896846063157517
[Iteration 7240] [Rank 1] a = 0.9977267384529114, b = 0.9998369336612665, delta = 0.0007161515532061458, c = 0.0006738673196423032, d = 0.0006752145015915573, m = 0.0005901875607419499
[Iteration 7250] [Rank 1] a = 1.1156752109527588, b = 0.9997052552685985, delta = 0.000727091683074832, c = 0.0004105105201265702, d = 0.0004112704689184571, m = 0.0005908481615778722
[Iteration 7260] [Rank 1] a = 1.073340892791748, b = 0.9997256357118209, delta = 0.0007414816645905375, c = 0.000451271409873234, d = 0.00045210044491892883, m = 0.0005911362452662664
[Iteration 7270] [Rank 1] a = 0.9804890155792236, b = 0.9998429268936309, delta = 0.0007106512202881277, c = 0.0006858537846779747, d = 0.0006865791903429576, m = 0.0005915928458413111

[Iteration 7230] [Rank 3] a = 1.0305484533309937, b = 0.9997823382511868, delta = 0.0006929046357981861, c = 0.0005646764954989097, d = 0.0005656782461791243, m = 0.0004645755392283531
[Iteration 7240] [Rank 3] a = 0.9994521737098694, b = 0.999901356591817, delta = 0.0006723263650201261, c = 0.0008027131829940455, d = 0.0008037840199280681, m = 0.00046505300121296733
[Iteration 7250] [Rank 3] a = 1.0123964548110962, b = 0.9999456236086781, delta = 0.0006293309852480888, c = 0.0008912472172488755, d = 0.0008916962778986269, m = 0.0004660627568050766
[Iteration 7260] [Rank 3] a = 1.0189778804779053, b = 0.999834170211189, delta = 0.0006883890018798411, c = 0.0006683404193376707, d = 0.000668927652495038, m = 0.0004665120648646452
[Iteration 7270] [Rank 3] a = 1.0068193674087524, b = 0.9997835127174463, delta = 0.0006824026349931955, c = 0.0005670254281283784, d = 0.0005679235494278811, m = 0.0004672169087187007
[Iteration 7280] [Rank 1] a = 1.019472599029541, b = 0.999893757103978, delta = 0.0006779934628866613, c = 0.0007875142071563065, d = 0.0007884814147096172, m = 0.0005920027277243325
[Iteration 7290] [Rank 1] a = 1.0221385955810547, b = 0.9997978653860458, delta = 0.0007300418801605701, c = 0.0005957307665855629, d = 0.0005968016035195854, m = 0.0005921762925666975
[Iteration 7300] [Rank 1] a = 0.9538955688476562, b = 1.0000207203665108, delta = 0.0007039345218800008, c = 0.0010414407330272604, d = 0.001041129844885125, m = 0.0005926134682045082
[Iteration 7310] [Rank 1] a = 1.0521513223648071, b = 0.9997529075086561, delta = 0.0007404375937767327, c = 0.0005058150072545748, d = 0.0005070585598231171, m = 0.0005928941621132012
[Iteration 7320] [Rank 1] a = 1.0129507780075073, b = 0.9998271924997544, delta = 0.0007173675112426281, c = 0.0006543849960684741, d = 0.0006555940055101123, m = 0.0005932482335410845
[Iteration 7280] [Rank 3] a = 0.9053964018821716, b = 1.0000340194703585, delta = 0.0006508947117254138, c = 0.0010680389407433039, d = 0.0010677971388549762, m = 0.00046790211078911564
[Iteration 7290] [Rank 3] a = 1.0665158033370972, b = 0.9997746696773903, delta = 0.0006778519600629807, c = 0.0005493393471535549, d = 0.0005500992959454417, m = 0.00046843285792876337
[Iteration 7300] [Rank 3] a = 1.007047414779663, b = 0.9998275033878872, delta = 0.0006909998483024538, c = 0.0006550067723527452, d = 0.0006561121524136717, m = 0.00046881088718688267
[Iteration 7310] [Rank 3] a = 1.0029953718185425, b = 0.9998050503561586, delta = 0.0007074599852785468, c = 0.000610100707377607, d = 0.000610860656169494, m = 0.00046952868325643947
[Iteration 7320] [Rank 3] a = 0.9540925025939941, b = 1.0001438147982444, delta = 0.0006496822461485863, c = 0.0012876295984717292, d = 0.0012843825445427576, m = 0.00047018619001358303
[Iteration 7330] [Rank 1] a = 0.9846614003181458, b = 0.9998046358386514, delta = 0.0007165540009737015, c = 0.0006092716723319122, d = 0.0006106188542811664, m = 0.0005942231953992766
[Iteration 7340] [Rank 1] a = 0.9976563453674316, b = 0.999831804007062, delta = 0.0007220394909381866, c = 0.0006636080109518293, d = 0.0006650242791548913, m = 0.0005943949249081844
[Iteration 7350] [Rank 1] a = 1.0549592971801758, b = 0.9998001279607664, delta = 0.0006884922622703016, c = 0.0006002559162099807, d = 0.0006009813218749636, m = 0.0005952255234265932
[Iteration 7360] [Rank 1] a = 0.9813183546066284, b = 1.000020029503973, delta = 0.0006831850623711944, c = 0.0010400590079511023, d = 0.001039679033555159, m = 0.0005958291401175948
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7366 |     0.11012s |  92.9%
- batch.accumulate               |   7366 |     0.00083s |   0.7%
[Iteration 7330] [Rank 3] a = 0.9253654479980469, b = 0.9999107523222518, delta = 0.0006876051775179803, c = 0.0008215046440297957, d = 0.0008220573340602589, m = 0.00047056629304490356
[Iteration 7340] [Rank 3] a = 0.9911369681358337, b = 0.9999076088977294, delta = 0.0006896949489600956, c = 0.0008152177949332763, d = 0.0008164268043749146, m = 0.00047113159507036355
[Iteration 7350] [Rank 3] a = 1.066840648651123, b = 0.999748382359313, delta = 0.0007128698634915054, c = 0.0004967647080057392, d = 0.00049773191555905, m = 0.00047161265480579254
[Iteration 7360] [Rank 3] a = 1.0124011039733887, b = 0.9998755356047789, delta = 0.0006752852350473404, c = 0.0007510712082726367, d = 0.0007520729589528514, m = 0.0004721408363826751
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7366 |     0.11021s |  92.9%
- batch.accumulate               |   7366 |     0.00082s |   0.7%
- batch.backward                 |   7366 |     0.05176s |  43.7%
- batch.evaluate                 |   7366 |     0.00276s |   2.3%
- batch.forward                  |   7366 |     0.02541s |  21.4%
- batch.mom                      |   7366 |     0.00126s |   1.1%
- batch.reduce                   |   7366 |     0.02533s |  21.4%
- batch.reporting.compr_err      |   7366 |     0.00001s |   0.0%
- batch.reporting.lr             |   7366 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7366 |     0.00001s |   0.0%
- batch.step                     |   7366 |     0.00048s |   0.4%
- batch.update_runavg            |   7366 |     0.00130s |   1.1%
- batch.wd                       |   7366 |     0.00001s |   0.0%
- epoch_metrics.collect          |     52 |     0.00997s |   0.1%
- reduce.combine                 |   7366 |     0.00601s |   5.1%
- reduce.flatpack                |   7366 |     0.00002s |   0.0%
- reduce.flatput                 |   7366 |     0.00022s |   0.2%
- batch.backward                 |   7366 |     0.05174s |  43.6%
- batch.evaluate                 |   7366 |     0.00277s |   2.3%
- batch.forward                  |   7366 |     0.02538s |  21.4%
- batch.mom                      |   7366 |     0.00126s |   1.1%
- batch.reduce                   |   7366 |     0.02546s |  21.5%
- batch.reporting.compr_err      |   7366 |     0.00001s |   0.0%
- batch.reporting.lr             |   7366 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   7366 |     0.00001s |   0.0%
- batch.step                     |   7366 |     0.00047s |   0.4%
- batch.update_runavg            |   7366 |     0.00129s |   1.1%
- batch.wd                       |   7366 |     0.00001s |   0.0%
- epoch_metrics.collect          |     52 |     0.00969s |   0.1%
- reduce.combine                 |   7366 |     0.00595s |   5.0%
- reduce.flatpack                |   7366 |     0.00002s |   0.0%
- reduce.flatput                 |   7366 |     0.00018s |   0.2%
- reduce.gather.context          |   7366 |     0.00141s |   1.2%
- reduce.gather.tensors          |   7366 |     0.00335s |   2.8%
- reduce.heur_params             |   7366 |     0.01085s |   9.1%
- reduce.gather.context          |   7366 |     0.00255s |   2.2%
- reduce.gather.tensors          |   7366 |     0.00304s |   2.6%
- reduce.heur_params             |   7366 |     0.01043s |   8.8%
- reduce.heur_params.alpha       |   7365 |     0.00830s |   7.0%
- reduce.heur_params.beta        |   7365 |     0.00247s |   2.1%
- reduce.memory                  |   7366 |     0.00046s |   0.4%
- reduce.pad                     |   7366 |     0.00019s |   0.2%
- reduce.threshold               |   7366 |     0.00262s |   2.2%
- test.last                      |     52 |     0.41302s |   2.5%
- test.runavg                    |     52 |     0.44382s |   2.7%
-----------------------------------------------------------------

[Iteration 7370] [Rank 1] a = 0.9806655645370483, b = 0.9998712177139852, delta = 0.0007029817206785083, c = 0.0007424354265466486, d = 0.0007429881165771119, m = 0.0005964067874355528
[Iteration 7380] [Rank 1] a = 0.9434480667114258, b = 0.9999620315939219, delta = 0.0007078510243445635, c = 0.0009240631878076303, d = 0.0009245122484573817, m = 0.0005966523721569534
- reduce.heur_params.alpha       |   7365 |     0.00811s |   6.8%
- reduce.heur_params.beta        |   7365 |     0.00225s |   1.9%
- reduce.memory                  |   7366 |     0.00044s |   0.4%
- reduce.pad                     |   7366 |     0.00027s |   0.2%
- reduce.threshold               |   7366 |     0.00237s |   2.0%
- test.last                      |     52 |     0.41302s |   2.5%
- test.runavg                    |     52 |     0.44382s |   2.7%
-----------------------------------------------------------------

[Iteration 7370] [Rank 3] a = 1.0986062288284302, b = 0.9997097976893979, delta = 0.000728562765289098, c = 0.0004195953625023096, d = 0.00042052802692871635, m = 0.0004726673270758895
[Iteration 7380] [Rank 3] a = 1.0063610076904297, b = 0.9997620096220596, delta = 0.0007141510723158717, c = 0.0005240192351329577, d = 0.0005247446407979407, m = 0.000473977186103989
[Iteration 7390] [Rank 1] a = 0.9532343149185181, b = 0.9998351546902788, delta = 0.0007411882397718728, c = 0.0006703093775711961, d = 0.0006712765851245067, m = 0.0005970484903655739
[Iteration 7400] [Rank 1] a = 1.0485103130340576, b = 0.9997822691649363, delta = 0.0007034026202745736, c = 0.0005645383229912938, d = 0.0005658855049405479, m = 0.0005975492958256933
[Iteration 7410] [Rank 1] a = 0.9269455671310425, b = 1.0001802577961671, delta = 0.0006938536535017192, c = 0.0013605155962390686, d = 0.0013568540247872497, m = 0.0005978061694809563
[Iteration 7420] [Rank 1] a = 0.9911774396896362, b = 0.9998358973674871, delta = 0.0007219043909572065, c = 0.0006717947320280661, d = 0.000673245543358032, m = 0.0005985160523137188
[Iteration 7430] [Rank 1] a = 1.0497057437896729, b = 0.999749004135558, delta = 0.0007315317634493113, c = 0.0004980082605742815, d = 0.0004991827268890159, m = 0.0005992025576983991

[Iteration 7230] [Rank 2] a = 1.102227807044983, b = 0.9997483996308754, delta = 0.0007211913471110165, c = 0.0004967992511326432, d = 0.0004975937430514341, m = 0.00041243160237920305
[Iteration 7240] [Rank 2] a = 0.9859917759895325, b = 0.9998783163264525, delta = 0.0006951482500880957, c = 0.0007566326517041731, d = 0.0007576689455112916, m = 0.0004132044880743071
[Iteration 7250] [Rank 2] a = 0.9847899079322815, b = 0.9998634455105687, delta = 0.0006795520894229412, c = 0.0007268910194398701, d = 0.0007278582269931807, m = 0.00041417200106405827
[Iteration 7260] [Rank 2] a = 1.006199836730957, b = 0.9999158647049952, delta = 0.0006828808691352606, c = 0.0008317294095933655, d = 0.0008323166427507328, m = 0.00041469059528328653
[Iteration 7270] [Rank 2] a = 1.099589467048645, b = 0.9996905053547572, delta = 0.0007398806628771126, c = 0.00038101068975059484, d = 0.00038159792290796203, m = 0.0004152874625890993
[Iteration 7390] [Rank 3] a = 1.0162264108657837, b = 0.9998626510186647, delta = 0.0006994752329774201, c = 0.0007253020356022883, d = 0.0007258201825058475, m = 0.0004744572604732597
[Iteration 7400] [Rank 3] a = 1.0014547109603882, b = 0.9998994739914194, delta = 0.0006812101346440613, c = 0.0007989479821615147, d = 0.0007999497328417294, m = 0.00047499537365957456
[Iteration 7410] [Rank 3] a = 1.052590012550354, b = 0.9997682619276844, delta = 0.0006946570356376469, c = 0.0005365238470721884, d = 0.0005377328565138268, m = 0.0004757085024336452
[Iteration 7420] [Rank 3] a = 0.9760363101959229, b = 0.9999537412434798, delta = 0.0006822653231211007, c = 0.0009074824868937332, d = 0.000908346065066332, m = 0.00047628867721259
[Iteration 7430] [Rank 3] a = 0.9393673539161682, b = 0.9999635169483768, delta = 0.0006773503264412284, c = 0.0009270338967213702, d = 0.0009273793279904098, m = 0.00047680157441373647
[Iteration 7440] [Rank 1] a = 0.9796050786972046, b = 0.9998227364365203, delta = 0.0007380666793324053, c = 0.0006454728693272543, d = 0.0006465782493881808, m = 0.0005995831910186045
[Iteration 7450] [Rank 1] a = 1.1591745615005493, b = 0.9996701421835289, delta = 0.0007703976589255035, c = 0.00034028434313083494, d = 0.0003408370331612982, m = 0.0006000363070405486
[Iteration 7460] [Rank 1] a = 0.982148289680481, b = 0.9999914968811531, delta = 0.0007022020872682333, c = 0.0009829937623057731, d = 0.0009832010210671968, m = 0.0006002915936440946
[Iteration 7470] [Rank 1] a = 0.9596773386001587, b = 1.0005339966384226, delta = 0.0006688142893835902, c = 0.0020679933783589177, d = 0.0020397371005514845, m = 0.0006008531410280682
[Iteration 7480] [Rank 1] a = 1.0901358127593994, b = 0.9997403510828328, delta = 0.0007139122462831438, c = 0.0004807021539954014, d = 0.00048170390467561604, m = 0.0006017782287189479
[Iteration 7280] [Rank 2] a = 1.0090458393096924, b = 0.9997902313553237, delta = 0.0007406477234326303, c = 0.0005804627044940159, d = 0.000581119023905191, m = 0.0004157714321864737
[Iteration 7290] [Rank 2] a = 0.9561334252357483, b = 1.0003948224103678, delta = 0.0006533117848448455, c = 0.0017896448617668692, d = 0.0017767602754316949, m = 0.00041693022594571183
[Iteration 7300] [Rank 2] a = 1.04435396194458, b = 0.9997198497385092, delta = 0.0007252863142639399, c = 0.00043969946236040993, d = 0.0004410121011827601, m = 0.000418671668596189
[Iteration 7310] [Rank 2] a = 0.9514025449752808, b = 1.0010970146745226, delta = 0.0006230911239981651, c = 0.0031940302291739576, d = 0.003124736716604629, m = 0.00041961440823402196
[Iteration 7320] [Rank 2] a = 0.894380509853363, b = 1.0000069203873154, delta = 0.0006710322923026979, c = 0.0010138407746310026, d = 0.0010137371452502908, m = 0.00042011159375096883
[Iteration 7440] [Rank 3] a = 1.035028100013733, b = 0.9998263116500449, delta = 0.0006706183776259422, c = 0.0006526232965963724, d = 0.000653694133530395, m = 0.0004779602207619412
[Iteration 7450] [Rank 3] a = 1.0235224962234497, b = 0.9997866388702866, delta = 0.0007041232893243432, c = 0.0005732777340979938, d = 0.0005740722260167847, m = 0.0004783843848203758
[Iteration 7460] [Rank 3] a = 1.0511635541915894, b = 0.9997479160271293, delta = 0.0007142723188735545, c = 0.0004958320435793325, d = 0.0004968337942595471, m = 0.00047895786729642583
[Iteration 7470] [Rank 3] a = 1.043308138847351, b = 0.9997976408557301, delta = 0.0006891280063427985, c = 0.0005952817059358115, d = 0.0005961452841084103, m = 0.00048012390454778953
[Iteration 7480] [Rank 3] a = 1.0048587322235107, b = 0.9998722367362123, delta = 0.0006664238171651959, c = 0.0007444734710339818, d = 0.0007454061354603886, m = 0.0004807325506541925
[Iteration 7490] [Rank 1] a = 0.9452946186065674, b = 1.0003050448345983, delta = 0.0006402247818186879, c = 0.0016100896881201248, d = 0.0016034919508814698, m = 0.0006035235502985268
[Iteration 7500] [Rank 1] a = 1.2237811088562012, b = 0.9996512643668498, delta = 0.0007653242792002857, c = 0.000302528705424815, d = 0.0003030468523283743, m = 0.0006039610384351808
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7505 |     0.11016s |  92.9%
- batch.accumulate               |   7505 |     0.00083s |   0.7%
- batch.backward                 |   7505 |     0.05177s |  43.6%
- batch.evaluate                 |   7505 |     0.00276s |   2.3%
- batch.forward                  |   7505 |     0.02541s |  21.4%
- batch.mom                      |   7505 |     0.00126s |   1.1%
- batch.reduce                   |   7505 |     0.02537s |  21.4%
[Iteration 7330] [Rank 2] a = 0.9225967526435852, b = 1.0000479403504772, delta = 0.0006701441016048193, c = 0.0010958807010278894, d = 0.0010953280109974263, m = 0.0004207062319566126
[Iteration 7340] [Rank 2] a = 0.9845712184906006, b = 0.9999635342199404, delta = 0.0006678274367004633, c = 0.0009270684398482742, d = 0.0009275175004980255, m = 0.00042168589692025355
[Iteration 7350] [Rank 2] a = 1.0207297801971436, b = 0.9998162768719999, delta = 0.0006769099272787571, c = 0.0006325537398651761, d = 0.0006333136886570631, m = 0.00042242458133972275
[Iteration 7360] [Rank 2] a = 1.0189058780670166, b = 0.9999072980095901, delta = 0.000657280208542943, c = 0.0008145960186490052, d = 0.0008153214243139882, m = 0.0004235556257116937
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7366 |     0.11010s |  92.8%
- batch.accumulate               |   7366 |     0.00083s |   0.7%
[Iteration 7490] [Rank 3] a = 0.9635691046714783, b = 1.0001855601659695, delta = 0.0006609988631680608, c = 0.001371120336198582, d = 0.0013658697809091813, m = 0.00048114637279716966
[Iteration 7500] [Rank 3] a = 1.079286813735962, b = 0.9997619750789347, delta = 0.0006987795932218432, c = 0.0005239501488791498, d = 0.0005247100976710368, m = 0.0004824758498473979
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7505 |     0.11026s |  92.9%
- batch.accumulate               |   7505 |     0.00082s |   0.7%
- batch.backward                 |   7505 |     0.05174s |  43.6%
- batch.evaluate                 |   7505 |     0.00277s |   2.3%
- batch.forward                  |   7505 |     0.02538s |  21.4%
- batch.mom                      |   7505 |     0.00126s |   1.1%
- batch.reduce                   |   7505 |     0.02551s |  21.5%
- batch.reporting.compr_err      |   7505 |     0.00001s |   0.0%
- batch.reporting.lr             |   7505 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7505 |     0.00001s |   0.0%
- batch.step                     |   7505 |     0.00048s |   0.4%
- batch.update_runavg            |   7505 |     0.00130s |   1.1%
- batch.backward                 |   7366 |     0.05190s |  43.8%
- batch.evaluate                 |   7366 |     0.00275s |   2.3%
- batch.forward                  |   7366 |     0.02557s |  21.6%
- batch.mom                      |   7366 |     0.00126s |   1.1%
- batch.reduce                   |   7366 |     0.02502s |  21.1%
- batch.reporting.compr_err      |   7366 |     0.00001s |   0.0%
- batch.reporting.lr             |   7366 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7366 |     0.00001s |   0.0%
- batch.step                     |   7366 |     0.00048s |   0.4%
- batch.update_runavg            |   7366 |     0.00130s |   1.1%
- batch.wd                       |   7366 |     0.00001s |   0.0%
- epoch_metrics.collect          |     52 |     0.01425s |   0.1%
- reduce.combine                 |   7366 |     0.00603s |   5.1%
- reduce.flatpack                |   7366 |     0.00002s |   0.0%
- reduce.flatput                 |   7366 |     0.00017s |   0.1%
- batch.reporting.compr_err      |   7505 |     0.00001s |   0.0%
- batch.reporting.lr             |   7505 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   7505 |     0.00001s |   0.0%
- batch.step                     |   7505 |     0.00047s |   0.4%
- batch.update_runavg            |   7505 |     0.00129s |   1.1%
- batch.wd                       |   7505 |     0.00001s |   0.0%
- epoch_metrics.collect          |     53 |     0.00980s |   0.1%
- reduce.combine                 |   7505 |     0.00602s |   5.1%
- reduce.flatpack                |   7505 |     0.00002s |   0.0%
- reduce.flatput                 |   7505 |     0.00022s |   0.2%
- reduce.gather.context          |   7505 |     0.00140s |   1.2%
- reduce.gather.tensors          |   7505 |     0.00338s |   2.9%
- reduce.heur_params             |   7505 |     0.01085s |   9.1%
- reduce.heur_params.alpha       |   7504 |     0.00830s |   7.0%
- reduce.heur_params.beta        |   7504 |     0.00247s |   2.1%
- reduce.memory                  |   7505 |     0.00046s |   0.4%
- reduce.pad                     |   7505 |     0.00019s |   0.2%
- reduce.threshold               |   7505 |     0.00262s |   2.2%
- test.last                      |     53 |     0.41288s |   2.5%
- test.runavg                    |     53 |     0.44373s |   2.7%
- reduce.gather.context          |   7366 |     0.00166s |   1.4%
- reduce.gather.tensors          |   7366 |     0.00333s |   2.8%
- reduce.heur_params             |   7366 |     0.01054s |   8.9%
- batch.wd                       |   7505 |     0.00001s |   0.0%
- epoch_metrics.collect          |     53 |     0.00954s |   0.1%
- reduce.combine                 |   7505 |     0.00596s |   5.0%
- reduce.flatpack                |   7505 |     0.00002s |   0.0%
- reduce.flatput                 |   7505 |     0.00018s |   0.2%
- reduce.gather.context          |   7505 |     0.00255s |   2.1%
- reduce.gather.tensors          |   7505 |     0.00307s |   2.6%
- reduce.heur_params             |   7505 |     0.01044s |   8.8%
- reduce.heur_params.alpha       |   7504 |     0.00811s |   6.8%
- reduce.heur_params.beta        |   7504 |     0.00226s |   1.9%
- reduce.memory                  |   7505 |     0.00045s |   0.4%
- reduce.pad                     |   7505 |     0.00027s |   0.2%
- reduce.threshold               |   7505 |     0.00238s |   2.0%
- test.last                      |     53 |     0.41287s |   2.5%
- test.runavg                    |     53 |     0.44373s |   2.7%
-----------------------------------------------------------------
- reduce.heur_params.alpha       |   7365 |     0.00825s |   7.0%
- reduce.heur_params.beta        |   7365 |     0.00221s |   1.9%
- reduce.memory                  |   7366 |     0.00045s |   0.4%
- reduce.pad                     |   7366 |     0.00028s |   0.2%
- reduce.threshold               |   7366 |     0.00232s |   2.0%
- test.last                      |     52 |     0.41302s |   2.5%
- test.runavg                    |     52 |     0.44383s |   2.7%
-----------------------------------------------------------------

[Iteration 7370] [Rank 2] a = 0.9977861046791077, b = 0.9998479529184751, delta = 0.0007055795867927372, c = 0.0006959058346070248, d = 0.0006968730421603354, m = 0.0004240370153295429
[Iteration 7380] [Rank 2] a = 0.9132372736930847, b = 1.00010144765374, delta = 0.0006784445140510798, c = 0.001202895308176334, d = 0.0012015826693539838, m = 0.00042482941608930385
-----------------------------------------------------------------
[Iteration 7390] [Rank 2] a = 0.9856968522071838, b = 0.9998300941223293, delta = 0.0007063107914291322, c = 0.0006601882413883381, d = 0.0006608100176726092, m = 0.00042544629332126735
[Iteration 7400] [Rank 2] a = 0.9894635081291199, b = 0.9999376959610806, delta = 0.0006693834438920021, c = 0.0008753919219999614, d = 0.0008761864139187523, m = 0.00042639252200595923
[Iteration 7410] [Rank 2] a = 0.9493799209594727, b = 1.000431921722319, delta = 0.0006593014113605022, c = 0.001863843498356559, d = 0.0018516152314325598, m = 0.0004268801588528457
[Iteration 7420] [Rank 2] a = 0.9937043786048889, b = 0.9999651232037757, delta = 0.0006795102381147444, c = 0.0009302464075234378, d = 0.0009308681838077089, m = 0.00042738936439329383
[Iteration 7430] [Rank 2] a = 0.9816898107528687, b = 1.000181639521198, delta = 0.0006141819176264107, c = 0.0013632790463913849, d = 0.0013589956986552949, m = 0.0004290853416943845
[Iteration 7440] [Rank 2] a = 1.0210626125335693, b = 0.9997744278755143, delta = 0.0007135496707633138, c = 0.0005488557433768994, d = 0.0005500992959454417, m = 0.00042930727799175166
[Iteration 7450] [Rank 2] a = 1.0083080530166626, b = 0.9998385744597513, delta = 0.0007136124768294394, c = 0.0006771489166981787, d = 0.0006782197536322011, m = 0.0004297853577730628
[Iteration 7460] [Rank 2] a = 0.9621450304985046, b = 0.9998720294774542, delta = 0.0006895594415254891, c = 0.0007440589535111344, d = 0.0007451643335720609, m = 0.00043041994971836187
[Iteration 7470] [Rank 2] a = 1.0446076393127441, b = 0.9998329957449068, delta = 0.0006587731186300516, c = 0.0006659914867082021, d = 0.0006668896080077048, m = 0.0004313648591571628
[Iteration 7480] [Rank 2] a = 0.9033678770065308, b = 1.003662654943897, delta = 0.0006041122833266854, c = 0.008325342644502277, d = 0.0075815945791332775, m = 0.0004326928778247918
[Iteration 7490] [Rank 2] a = 1.037911057472229, b = 0.999844239532421, delta = 0.0006928819348104298, c = 0.000688479062322675, d = 0.0006892735542414659, m = 0.00043307843813859343
[Iteration 7500] [Rank 2] a = 1.078897476196289, b = 0.9997350487132177, delta = 0.0007015469600446522, c = 0.00047009741403588804, d = 0.0004708919059546789, m = 0.00043427237377855024
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7505 |     0.11016s |  92.8%
- batch.accumulate               |   7505 |     0.00083s |   0.7%
- batch.backward                 |   7505 |     0.05189s |  43.7%
- batch.evaluate                 |   7505 |     0.00275s |   2.3%
- batch.forward                  |   7505 |     0.02557s |  21.6%
- batch.mom                      |   7505 |     0.00126s |   1.1%
- batch.reduce                   |   7505 |     0.02509s |  21.1%
- batch.reporting.compr_err      |   7505 |     0.00001s |   0.0%
- batch.reporting.lr             |   7505 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7505 |     0.00001s |   0.0%
- batch.step                     |   7505 |     0.00048s |   0.4%
- batch.update_runavg            |   7505 |     0.00130s |   1.1%
- batch.wd                       |   7505 |     0.00001s |   0.0%
- epoch_metrics.collect          |     53 |     0.01406s |   0.1%
- reduce.combine                 |   7505 |     0.00604s |   5.1%
- reduce.flatpack                |   7505 |     0.00002s |   0.0%
- reduce.flatput                 |   7505 |     0.00017s |   0.1%
- reduce.gather.context          |   7505 |     0.00169s |   1.4%
- reduce.gather.tensors          |   7505 |     0.00337s |   2.8%
- reduce.heur_params             |   7505 |     0.01054s |   8.9%
- reduce.heur_params.alpha       |   7504 |     0.00825s |   7.0%
- reduce.heur_params.beta        |   7504 |     0.00221s |   1.9%
- reduce.memory                  |   7505 |     0.00045s |   0.4%
- reduce.pad                     |   7505 |     0.00028s |   0.2%
- reduce.threshold               |   7505 |     0.00233s |   2.0%
- test.last                      |     53 |     0.41288s |   2.5%
- test.runavg                    |     53 |     0.44374s |   2.7%
-----------------------------------------------------------------
cross_entropy                  - bits:16225948288.000, epoch: 54.000, ratio_transmit_grad:  0.185, value:  5.516 (split:train)
last_cross_entropy             - bits:16225948288.000, epoch: 54.000, ratio_transmit_grad:  0.185, value:  5.516 (split:train)
perplexity                     - bits:16225948288.000, epoch: 54.000, ratio_transmit_grad:  0.185, value:249.378 (split:train)
last_perplexity                - bits:16225948288.000, epoch: 54.000, ratio_transmit_grad:  0.185, value:249.378 (split:train)
last_cross_entropy             - bits:16225948288.000, epoch: 54.000, ratio_transmit_grad:  0.185, value:  5.287 (split:test)
last_perplexity                - bits:16225948288.000, epoch: 54.000, ratio_transmit_grad:  0.185, value:198.429 (split:test)
runavg_cross_entropy           - bits:16225948288.000, epoch: 54.000, ratio_transmit_grad:  0.185, value:  5.471 (split:test)
runavg_perplexity              - bits:16225948288.000, epoch: 54.000, ratio_transmit_grad:  0.185, value:238.358 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7505 |     0.11014s |  92.8%
- batch.accumulate               |   7505 |     0.00083s |   0.7%
- batch.backward                 |   7505 |     0.05168s |  43.6%
- batch.evaluate                 |   7505 |     0.00275s |   2.3%
- batch.forward                  |   7505 |     0.02544s |  21.4%
- batch.mom                      |   7505 |     0.00126s |   1.1%
- batch.reduce                   |   7505 |     0.02536s |  21.4%
- batch.reporting.compr_err      |   7505 |     0.00001s |   0.0%
- batch.reporting.lr             |   7505 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7505 |     0.00001s |   0.0%
- batch.step                     |   7505 |     0.00048s |   0.4%
- batch.update_runavg            |   7505 |     0.00130s |   1.1%
- batch.wd                       |   7505 |     0.00001s |   0.0%
- epoch_metrics.collect          |     53 |     0.00930s |   0.1%
- reduce.combine                 |   7505 |     0.00624s |   5.3%
- reduce.flatpack                |   7505 |     0.00002s |   0.0%
- reduce.flatput                 |   7505 |     0.00017s |   0.1%
- reduce.gather.context          |   7505 |     0.00124s |   1.0%
- reduce.gather.tensors          |   7505 |     0.00345s |   2.9%
- reduce.heur_params             |   7505 |     0.01099s |   9.3%
- reduce.heur_params.alpha       |   7504 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   7504 |     0.00220s |   1.9%
- reduce.memory                  |   7505 |     0.00045s |   0.4%
- reduce.pad                     |   7505 |     0.00029s |   0.2%
- reduce.threshold               |   7505 |     0.00230s |   1.9%
- test.last                      |     53 |     0.41286s |   2.5%
- test.runavg                    |     53 |     0.44374s |   2.7%
-----------------------------------------------------------------

[Iteration 7510] [Rank 0] a = 1.0782092809677124, b = 0.9996829058675842, delta = 0.0007808440132066607, c = 0.00036581171391285576, d = 0.00036684800771997437, m = 0.0003731554097700471
[Iteration 7520] [Rank 0] a = 1.0602701902389526, b = 0.9997214732653472, delta = 0.0007459003245458007, c = 0.00044294651628938147, d = 0.0004442246119848277, m = 0.0003736683669376438
[Iteration 7530] [Rank 0] a = 1.0082805156707764, b = 0.9998574522781676, delta = 0.0007203053100965917, c = 0.0007149045544041986, d = 0.0007161135638458369, m = 0.0003742014051004501
[Iteration 7540] [Rank 0] a = 1.0011146068572998, b = 0.9998493346435198, delta = 0.0007201915723271668, c = 0.000698669284759341, d = 0.0007000164667085951, m = 0.00037476020690318005
[Iteration 7550] [Rank 0] a = 1.047195315361023, b = 0.9997258429705668, delta = 0.0007474601734429598, c = 0.0004516859273960814, d = 0.00045286039371081576, m = 0.00037569932373600167
[Iteration 7560] [Rank 0] a = 1.0436277389526367, b = 0.9997724071026942, delta = 0.0007192171178758144, c = 0.0005448141975291371, d = 0.0005462304657321991, m = 0.00037639472107846945
[Iteration 7570] [Rank 0] a = 1.1608095169067383, b = 0.9996082581797561, delta = 0.000842974754050374, c = 0.00021651631943397356, d = 0.00021689629382991703, m = 0.00037734893579645514
timer                          - epoch: -1.000, value:  0.000 (event:reduce.pad)
[Iteration 7580] [Rank 0] a = 0.9431092739105225, b = 0.9998250853690769, delta = 0.0007461722707375884, c = 0.0006501707345861918, d = 0.0006511033990125986, m = 0.0003777939003578193
[Iteration 7590] [Rank 0] a = 1.0001676082611084, b = 0.9999970755961479, delta = 0.0006826553144492209, c = 0.0009941511922957496, d = 0.0009941857354226536, m = 0.0003786469314713503
[Iteration 7600] [Rank 0] a = 1.0906734466552734, b = 0.9997283300755186, delta = 0.0007449834374710917, c = 0.00045666013767025053, d = 0.0004574546295890415, m = 0.0003791802766778114
[Iteration 7610] [Rank 0] a = 1.1058603525161743, b = 0.9996384661399461, delta = 0.0007732193334959447, c = 0.00027693224838898627, d = 0.00027731222278492976, m = 0.0003807735852918232
[Iteration 7620] [Rank 0] a = 1.0110080242156982, b = 0.9997838063340112, delta = 0.0007308796048164368, c = 0.0005676126612857456, d = 0.0005685107825852484, m = 0.0003812520202460354
[Iteration 7630] [Rank 0] a = 1.0269711017608643, b = 0.9998469338962553, delta = 0.0006915302947163582, c = 0.0006938677901196916, d = 0.0006949386270537142, m = 0.00038206215700305304
[Iteration 7640] [Rank 0] a = 1.0234159231185913, b = 0.9997488314199343, delta = 0.0007392411935143173, c = 0.000497662829305242, d = 0.0004987336662392645, m = 0.00038263390478264356
cross_entropy                  - bits:16681051776.000, epoch: 55.000, ratio_transmit_grad:  0.177, value:  5.500 (split:train)
last_cross_entropy             - bits:16681051776.000, epoch: 55.000, ratio_transmit_grad:  0.177, value:  5.500 (split:train)
perplexity                     - bits:16681051776.000, epoch: 55.000, ratio_transmit_grad:  0.177, value:245.270 (split:train)
last_perplexity                - bits:16681051776.000, epoch: 55.000, ratio_transmit_grad:  0.177, value:245.270 (split:train)
last_cross_entropy             - bits:16681051776.000, epoch: 55.000, ratio_transmit_grad:  0.177, value:  5.255 (split:test)
last_perplexity                - bits:16681051776.000, epoch: 55.000, ratio_transmit_grad:  0.177, value:192.135 (split:test)
runavg_cross_entropy           - bits:16681051776.000, epoch: 55.000, ratio_transmit_grad:  0.177, value:  5.444 (split:test)
runavg_perplexity              - bits:16681051776.000, epoch: 55.000, ratio_transmit_grad:  0.177, value:231.948 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7644 |     0.11018s |  92.8%
- batch.accumulate               |   7644 |     0.00083s |   0.7%
- batch.backward                 |   7644 |     0.05168s |  43.5%
- batch.evaluate                 |   7644 |     0.00275s |   2.3%
- batch.forward                  |   7644 |     0.02544s |  21.4%
- batch.mom                      |   7644 |     0.00126s |   1.1%
- batch.reduce                   |   7644 |     0.02541s |  21.4%
- batch.reporting.compr_err      |   7644 |     0.00001s |   0.0%
- batch.reporting.lr             |   7644 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7644 |     0.00001s |   0.0%
- batch.step                     |   7644 |     0.00048s |   0.4%
- batch.update_runavg            |   7644 |     0.00130s |   1.1%
- batch.wd                       |   7644 |     0.00001s |   0.0%
- epoch_metrics.collect          |     54 |     0.00916s |   0.1%
- reduce.combine                 |   7644 |     0.00625s |   5.3%
- reduce.flatpack                |   7644 |     0.00002s |   0.0%
- reduce.flatput                 |   7644 |     0.00018s |   0.1%
- reduce.gather.context          |   7644 |     0.00123s |   1.0%
- reduce.gather.tensors          |   7644 |     0.00347s |   2.9%
- reduce.heur_params             |   7644 |     0.01099s |   9.3%
- reduce.heur_params.alpha       |   7643 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   7643 |     0.00220s |   1.9%
- reduce.memory                  |   7644 |     0.00045s |   0.4%
- reduce.pad                     |   7644 |     0.00029s |   0.2%
- reduce.threshold               |   7644 |     0.00231s |   1.9%
- test.last                      |     54 |     0.41267s |   2.5%
- test.runavg                    |     54 |     0.44358s |   2.7%
-----------------------------------------------------------------

[Iteration 7510] [Rank 3] a = 1.0285916328430176, b = 0.9998524607964351, delta = 0.0006603156216442585, c = 0.0007049215907289564, d = 0.0007056469963939393, m = 0.0004831389552152887
[Iteration 7520] [Rank 3] a = 1.0755164623260498, b = 0.9997698509114372, delta = 0.0006827879697084427, c = 0.0005397018147473521, d = 0.000540461763539239, m = 0.00048372302645548513
[Iteration 7530] [Rank 3] a = 0.9779017567634583, b = 0.9999375750601369, delta = 0.0006893398240208626, c = 0.0008751501201116337, d = 0.0008758064395228088, m = 0.00048397878814285787
[Iteration 7540] [Rank 3] a = 0.9478642344474792, b = 1.0000695125331536, delta = 0.0006522095063701272, c = 0.001139025066530926, d = 0.001138299660865943, m = 0.0004849937607498995
[Iteration 7550] [Rank 3] a = 0.9315299987792969, b = 1.0007812562326084, delta = 0.0006290975725278258, c = 0.0025625127831158997, d = 0.0025270024486586367, m = 0.0004856056768908243

[Iteration 7510] [Rank 1] a = 0.9384434223175049, b = 0.9999588881693786, delta = 0.000692090776283294, c = 0.000917776338711111, d = 0.0009182253993608624, m = 0.0006043274383726362
[Iteration 7520] [Rank 1] a = 1.002172827720642, b = 0.9998916672448241, delta = 0.0006805210141465068, c = 0.0007833344888009282, d = 0.0007843707826080469, m = 0.0006047186714215559
[Iteration 7530] [Rank 1] a = 0.937201976776123, b = 0.9999139648330292, delta = 0.0007139575900509953, c = 0.0008279296656339308, d = 0.0008286896144258178, m = 0.0006052110821257775
[Iteration 7540] [Rank 1] a = 1.0008231401443481, b = 0.9997248930346486, delta = 0.0007338495342992246, c = 0.000449786055416364, d = 0.0004508914354772905, m = 0.0006056962594365101
[Iteration 7550] [Rank 1] a = 1.0694677829742432, b = 0.9997317843879572, delta = 0.0007235558587126434, c = 0.000463568763051041, d = 0.00046457051373125565, m = 0.0006059384184108538
[Iteration 7560] [Rank 3] a = 0.946388840675354, b = 1.0000494257049306, delta = 0.0006391221540980041, c = 0.0010988514099416293, d = 0.0010981260042766464, m = 0.0004863116270385166
[Iteration 7570] [Rank 3] a = 0.9898425340652466, b = 0.9998811143196915, delta = 0.0006928173243068159, c = 0.0007622286382626133, d = 0.0007630922164352121, m = 0.00048661420719935095
[Iteration 7580] [Rank 3] a = 0.9809278845787048, b = 0.999862547389286, delta = 0.0006829063058830798, c = 0.0007250947768408646, d = 0.0007259583550134634, m = 0.000487463908434431
[Iteration 7590] [Rank 3] a = 1.0234466791152954, b = 0.9997461370562075, delta = 0.000709760410245508, c = 0.0004922741015082254, d = 0.000493344938442248, m = 0.00048799262859340945
[Iteration 7600] [Rank 3] a = 0.9828113913536072, b = 1.0001595664637497, delta = 0.0006585047231055796, c = 0.0013191329302081338, d = 0.0013143659786953883, m = 0.0004884339792192901
[Iteration 7560] [Rank 1] a = 1.0578947067260742, b = 0.9997125611393195, delta = 0.0007416527369059622, c = 0.000425122262806942, d = 0.00042612401348715665, m = 0.0006062800027163825
[Iteration 7570] [Rank 1] a = 1.0022741556167603, b = 0.9999614270892023, delta = 0.0006554921856150031, c = 0.000922854178365992, d = 0.0009231650665081276, m = 0.0006073634189330798
[Iteration 7580] [Rank 1] a = 0.9492902159690857, b = 1.0000647628532258, delta = 0.0006727922591380775, c = 0.0011295257066323392, d = 0.00112883484409426, m = 0.0006076558276932361
[Iteration 7590] [Rank 1] a = 0.8954406380653381, b = 1.0000444687662307, delta = 0.0006830142810940742, c = 0.001088937532520195, d = 0.0010884539287435396, m = 0.0006081556804185374
[Iteration 7600] [Rank 1] a = 1.074432134628296, b = 0.9997449625899689, delta = 0.0007225016015581787, c = 0.0004899251688787567, d = 0.0004907542039244516, m = 0.0006084321757314049
[Iteration 7610] [Rank 3] a = 0.9887887239456177, b = 0.9999698901552835, delta = 0.0006813032669015229, c = 0.0009397803105489287, d = 0.0009401257418179682, m = 0.000488822534658296
[Iteration 7620] [Rank 3] a = 0.9767858982086182, b = 1.0000352630229257, delta = 0.0006667958223260939, c = 0.0010705260458803885, d = 0.0010697315539615975, m = 0.0004894527244221966
[Iteration 7630] [Rank 3] a = 1.1142168045043945, b = 0.9996687777301654, delta = 0.0007518205093219876, c = 0.00033755543610542273, d = 0.00033831538489730966, m = 0.0004898204621472134
[Iteration 7640] [Rank 3] a = 1.0605558156967163, b = 0.9997292454683143, delta = 0.00072885537520051, c = 0.00045849092339616003, d = 0.0004589399840459114, m = 0.0004903072183035257
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7644 |     0.11029s |  92.9%
- batch.accumulate               |   7644 |     0.00082s |   0.7%
[Iteration 7610] [Rank 1] a = 1.0473511219024658, b = 0.999925951297988, delta = 0.0006344723515212536, c = 0.0008519025957052737, d = 0.000852455285735737, m = 0.000610378976750454
[Iteration 7620] [Rank 1] a = 0.9258349537849426, b = 1.0001641434279447, delta = 0.0006604945519939065, c = 0.001328286858837681, d = 0.0013251088911625174, m = 0.000610585444310243
[Iteration 7630] [Rank 1] a = 0.9845108985900879, b = 0.9999165382959652, delta = 0.0006789960316382349, c = 0.0008330765915426197, d = 0.0008336638246999869, m = 0.0006109443047662784
[Iteration 7640] [Rank 1] a = 1.1377053260803223, b = 0.999713252001801, delta = 0.0007005788502283394, c = 0.0004265039878831001, d = 0.00042729847980189104, m = 0.0006117952012320471
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7644 |     0.11020s |  92.9%
- batch.accumulate               |   7644 |     0.00083s |   0.7%
- batch.backward                 |   7644 |     0.05174s |  43.6%
- batch.evaluate                 |   7644 |     0.00277s |   2.3%
- batch.forward                  |   7644 |     0.02537s |  21.4%
- batch.mom                      |   7644 |     0.00126s |   1.1%
- batch.reduce                   |   7644 |     0.02554s |  21.5%
- batch.reporting.compr_err      |   7644 |     0.00001s |   0.0%
- batch.reporting.lr             |   7644 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   7644 |     0.00001s |   0.0%
- batch.step                     |   7644 |     0.00047s |   0.4%
- batch.update_runavg            |   7644 |     0.00129s |   1.1%
- batch.wd                       |   7644 |     0.00001s |   0.0%
- epoch_metrics.collect          |     54 |     0.00939s |   0.1%
- reduce.combine                 |   7644 |     0.00597s |   5.0%
- reduce.flatpack                |   7644 |     0.00002s |   0.0%
- reduce.flatput                 |   7644 |     0.00018s |   0.2%
- batch.backward                 |   7644 |     0.05177s |  43.6%
- batch.evaluate                 |   7644 |     0.00276s |   2.3%
- batch.forward                  |   7644 |     0.02541s |  21.4%
- batch.mom                      |   7644 |     0.00126s |   1.1%
- batch.reduce                   |   7644 |     0.02541s |  21.4%
- batch.reporting.compr_err      |   7644 |     0.00001s |   0.0%
- batch.reporting.lr             |   7644 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7644 |     0.00001s |   0.0%
- batch.step                     |   7644 |     0.00048s |   0.4%
- batch.update_runavg            |   7644 |     0.00130s |   1.1%
- batch.wd                       |   7644 |     0.00001s |   0.0%
- epoch_metrics.collect          |     54 |     0.00963s |   0.1%
- reduce.combine                 |   7644 |     0.00604s |   5.1%
- reduce.flatpack                |   7644 |     0.00002s |   0.0%
- reduce.flatput                 |   7644 |     0.00022s |   0.2%
- reduce.gather.context          |   7644 |     0.00254s |   2.1%
- reduce.gather.tensors          |   7644 |     0.00309s |   2.6%
- reduce.heur_params             |   7644 |     0.01044s |   8.8%
- reduce.gather.context          |   7644 |     0.00139s |   1.2%
- reduce.gather.tensors          |   7644 |     0.00340s |   2.9%
- reduce.heur_params             |   7644 |     0.01086s |   9.1%
- reduce.heur_params.alpha       |   7643 |     0.00831s |   7.0%

[Iteration 7510] [Rank 2] a = 1.0264402627944946, b = 0.9997687800745603, delta = 0.0006786217563785613, c = 0.000537560140879307, d = 0.000538354632798098, m = 0.00043536733297779224
[Iteration 7520] [Rank 2] a = 1.1188427209854126, b = 0.9996713857359628, delta = 0.0007456864695996046, c = 0.00034277144826791954, d = 0.00034342776767909465, m = 0.0004358261770437109
[Iteration 7530] [Rank 2] a = 1.0455617904663086, b = 0.9997757405142702, delta = 0.0007023007492534816, c = 0.0005514810210215999, d = 0.0005525173148287184, m = 0.0004363171347760607
[Iteration 7540] [Rank 2] a = 0.9015069603919983, b = 1.0012378986253483, delta = 0.0006317842053249478, c = 0.003475798515329497, d = 0.003407644925947999, m = 0.0004370881787818405
[Iteration 7550] [Rank 2] a = 0.9386777877807617, b = 1.001427194624087, delta = 0.0006158804171718657, c = 0.0038543911861968153, d = 0.003734042932063445, m = 0.0004379998728120241
- reduce.heur_params.alpha       |   7643 |     0.00811s |   6.8%
- reduce.heur_params.beta        |   7643 |     0.00226s |   1.9%
- reduce.memory                  |   7644 |     0.00045s |   0.4%
- reduce.pad                     |   7644 |     0.00027s |   0.2%
- reduce.threshold               |   7644 |     0.00239s |   2.0%
- test.last                      |     54 |     0.41268s |   2.5%
- test.runavg                    |     54 |     0.44357s |   2.7%
-----------------------------------------------------------------

[Iteration 7650] [Rank 3] a = 0.9343785643577576, b = 1.0000229829413219, delta = 0.0006805674056522548, c = 0.0010459658826516784, d = 0.0010457586238902545, m = 0.0004909264680738473
[Iteration 7660] [Rank 3] a = 0.9597376585006714, b = 1.0000557643686998, delta = 0.0006528974045068026, c = 0.0011115287375153798, d = 0.0011103888143275495, m = 0.0004919120502201596
- reduce.heur_params.beta        |   7643 |     0.00247s |   2.1%
- reduce.memory                  |   7644 |     0.00046s |   0.4%
- reduce.pad                     |   7644 |     0.00019s |   0.2%
- reduce.threshold               |   7644 |     0.00262s |   2.2%
- test.last                      |     54 |     0.41268s |   2.5%
- test.runavg                    |     54 |     0.44357s |   2.7%
-----------------------------------------------------------------

[Iteration 7650] [Rank 1] a = 1.0397485494613647, b = 0.9998550688024604, delta = 0.0006999453180469573, c = 0.0007101376028914531, d = 0.0007108284654295322, m = 0.0006121009309560301
[Iteration 7660] [Rank 1] a = 1.024702787399292, b = 0.9998622019580234, delta = 0.000688750937115401, c = 0.0007244039143027855, d = 0.000725474751236808, m = 0.0006123786149013472
[Iteration 7670] [Rank 1] a = 1.0501478910446167, b = 0.9997209551184839, delta = 0.0007401269976980984, c = 0.00044191022248226287, d = 0.0004426356281472459, m = 0.0006127873079661455
[Iteration 7670] [Rank 3] a = 1.0292795896530151, b = 0.9998209920086669, delta = 0.0006852485821582377, c = 0.0006419840135099552, d = 0.000642847591682554, m = 0.0004923407470926581
[Iteration 7680] [Rank 3] a = 0.94493567943573, b = 1.0000571979084618, delta = 0.0006785872392356396, c = 0.001114395817048408, d = 0.001113635868256521, m = 0.0004936282811277656
[Iteration 7690] [Rank 3] a = 0.9126805067062378, b = 1.0006688184137607, delta = 0.0006465291953645647, c = 0.0023376370269711697, d = 0.00231273143247342, m = 0.0004941481301447884
[Iteration 7700] [Rank 3] a = 0.9819263219833374, b = 0.9998399561847916, delta = 0.0006778053939342499, c = 0.0006799123668504948, d = 0.0006811213762921331, m = 0.0004954127534442243
[Iteration 7710] [Rank 3] a = 1.0368849039077759, b = 0.99976589572362, delta = 0.0007145467679947615, c = 0.000531791438686347, d = 0.0005326550168589458, m = 0.0004957558793666991
[Iteration 7680] [Rank 1] a = 1.0364634990692139, b = 0.9998165014023171, delta = 0.000698937801644206, c = 0.0006330028005149275, d = 0.0006336936630530065, m = 0.0006133248794644115
[Iteration 7690] [Rank 1] a = 1.0041781663894653, b = 0.9998082110521521, delta = 0.0007386862416751683, c = 0.0006164220996010304, d = 0.000617389307154341, m = 0.0006134184914018179
[Iteration 7700] [Rank 1] a = 1.017473578453064, b = 0.9999360033478691, delta = 0.0006693777977488935, c = 0.0008720066955633741, d = 0.0008725939287207412, m = 0.0006140077409166311
[Iteration 7710] [Rank 1] a = 1.107819676399231, b = 0.9996850648128, delta = 0.0007265871972776949, c = 0.0003701296047758498, d = 0.00037133861421748815, m = 0.0006147955174669757
[Iteration 7720] [Rank 1] a = 0.9965828657150269, b = 0.9999786295663845, delta = 0.0006673245225101709, c = 0.0009572591327623285, d = 0.0009576045640313681, m = 0.0006151210929675099
[Iteration 7560] [Rank 2] a = 1.0387006998062134, b = 0.9998243254203083, delta = 0.0006841780268587172, c = 0.000648650837002418, d = 0.0006497216739364404, m = 0.0004384950032367716
[Iteration 7570] [Rank 2] a = 0.9258240461349487, b = 0.9999448291167615, delta = 0.0006749158492311835, c = 0.0008896582334112938, d = 0.0008900382078072372, m = 0.0004391335089737311
[Iteration 7580] [Rank 2] a = 1.0876716375350952, b = 0.9996949959608308, delta = 0.0007257506949827075, c = 0.00038999190274562246, d = 0.0003909591102989331, m = 0.0004400019391303963
[Iteration 7590] [Rank 2] a = 0.9917531609535217, b = 0.999901840195589, delta = 0.0006391937495209277, c = 0.0008036803905473563, d = 0.0008047512274813787, m = 0.00044088662012303477
[Iteration 7600] [Rank 2] a = 0.8957653641700745, b = 1.0012676229393975, delta = 0.0005876155919395387, c = 0.003535247236731199, d = 0.003350165162779822, m = 0.0004429272473960686
[Iteration 7720] [Rank 3] a = 0.921019434928894, b = 0.9998705268514586, delta = 0.0006650048308074474, c = 0.0007410537014704905, d = 0.0007420209090238012, m = 0.0004971204650793246
[Iteration 7730] [Rank 3] a = 1.0269447565078735, b = 0.9998186603476769, delta = 0.0006842092261649668, c = 0.0006373206913779215, d = 0.0006383569851850401, m = 0.0004974833042378681
[Iteration 7740] [Rank 3] a = 1.0910077095031738, b = 0.999748675975873, delta = 0.0006810910999774933, c = 0.0004973519411631065, d = 0.0004983191487164171, m = 0.0004981259017646412
[Iteration 7750] [Rank 3] a = 1.1097118854522705, b = 0.9996851684421706, delta = 0.0007453545113094151, c = 0.00037033686353727356, d = 0.00037095863982154466, m = 0.0004984451190460614
[Iteration 7760] [Rank 3] a = 1.031569242477417, b = 0.9998387126322553, delta = 0.0006753380876034498, c = 0.0006774252617134102, d = 0.0006782542967591051, m = 0.0004989012900895849
[Iteration 7730] [Rank 1] a = 0.982230544090271, b = 1.0002575653104349, delta = 0.0006407400360330939, c = 0.0015151306322611596, d = 0.0015000698289310364, m = 0.0006157568215856076
[Iteration 7740] [Rank 1] a = 0.9147430658340454, b = 0.9998953115446713, delta = 0.0007119245710782707, c = 0.0007906230885776622, d = 0.0007914521236233571, m = 0.0006158928369593089
[Iteration 7750] [Rank 1] a = 0.9992834329605103, b = 0.999886157616151, delta = 0.0006908344803377986, c = 0.0007723152313185675, d = 0.0007732824388718781, m = 0.000616302364058452
[Iteration 7760] [Rank 1] a = 0.9058296084403992, b = 1.000023414730408, delta = 0.0007057323819026351, c = 0.0010468294608242772, d = 0.0010465876589359495, m = 0.0006164954319755793
[Iteration 7770] [Rank 1] a = 1.0378341674804688, b = 0.9997684001001846, delta = 0.0007021242054179311, c = 0.0005368001920874201, d = 0.0005374219683716913, m = 0.0006174458892496138
[Iteration 7610] [Rank 2] a = 1.0152103900909424, b = 0.9998593866932355, delta = 0.0006622685468755662, c = 0.0007187733846174412, d = 0.0007195333334093282, m = 0.00044341054517360026
[Iteration 7620] [Rank 2] a = 1.0859392881393433, b = 0.9997209205753594, delta = 0.0006939253653399646, c = 0.000441841136228455, d = 0.0004429119731624775, m = 0.0004438986936617695
[Iteration 7630] [Rank 2] a = 1.0163744688034058, b = 0.9998770727739026, delta = 0.0006690914160571992, c = 0.0007541455465670885, d = 0.0007549745816127834, m = 0.0004443085683961355
[Iteration 7640] [Rank 2] a = 0.8988193869590759, b = 1.0005929617373086, delta = 0.0006385123706422746, c = 0.002185923613609011, d = 0.0021599471821772387, m = 0.00044501368351241915
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7644 |     0.11020s |  92.9%
- batch.accumulate               |   7644 |     0.00083s |   0.7%
[Iteration 7770] [Rank 3] a = 1.0450410842895508, b = 0.9998429787083197, delta = 0.0006646927213296294, c = 0.0006859574140586865, d = 0.0006869246216119971, m = 0.0004998961884821955
[Iteration 7780] [Rank 3] a = 0.937005877494812, b = 1.000107544515572, delta = 0.0006088541122153401, c = 0.0012150890319734293, d = 0.001213845479404887, m = 0.0005015716631319711
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7783 |     0.11035s |  92.9%
- batch.accumulate               |   7783 |     0.00082s |   0.7%
- batch.backward                 |   7783 |     0.05174s |  43.6%
- batch.evaluate                 |   7783 |     0.00277s |   2.3%
- batch.forward                  |   7783 |     0.02538s |  21.4%
- batch.mom                      |   7783 |     0.00126s |   1.1%
- batch.reduce                   |   7783 |     0.02560s |  21.6%
[Iteration 7780] [Rank 1] a = 0.8701227903366089, b = 1.0007761956675858, delta = 0.0006580485496670008, c = 0.0025523916469330416, d = 0.002522615471541835, m = 0.0006178001000038216
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7783 |     0.11026s |  92.9%
- batch.accumulate               |   7783 |     0.00083s |   0.7%
- batch.backward                 |   7783 |     0.05177s |  43.6%
- batch.evaluate                 |   7783 |     0.00276s |   2.3%
- batch.forward                  |   7783 |     0.02541s |  21.4%
- batch.mom                      |   7783 |     0.00126s |   1.1%
- batch.reduce                   |   7783 |     0.02546s |  21.4%
- batch.reporting.compr_err      |   7783 |     0.00001s |   0.0%
- batch.reporting.lr             |   7783 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7783 |     0.00001s |   0.0%
- batch.backward                 |   7644 |     0.05188s |  43.7%
- batch.evaluate                 |   7644 |     0.00275s |   2.3%
- batch.forward                  |   7644 |     0.02556s |  21.5%
- batch.mom                      |   7644 |     0.00126s |   1.1%
- batch.reduce                   |   7644 |     0.02514s |  21.2%
- batch.reporting.compr_err      |   7644 |     0.00001s |   0.0%
- batch.reporting.lr             |   7644 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7644 |     0.00001s |   0.0%
- batch.step                     |   7644 |     0.00048s |   0.4%
- batch.update_runavg            |   7644 |     0.00130s |   1.1%
- batch.wd                       |   7644 |     0.00001s |   0.0%
- epoch_metrics.collect          |     54 |     0.01388s |   0.1%
- reduce.combine                 |   7644 |     0.00604s |   5.1%
- reduce.flatpack                |   7644 |     0.00002s |   0.0%
- reduce.flatput                 |   7644 |     0.00017s |   0.1%
- batch.reporting.compr_err      |   7783 |     0.00001s |   0.0%
- batch.reporting.lr             |   7783 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   7783 |     0.00001s |   0.0%
- batch.step                     |   7783 |     0.00047s |   0.4%
- batch.update_runavg            |   7783 |     0.00129s |   1.1%
- batch.wd                       |   7783 |     0.00001s |   0.0%
- batch.step                     |   7783 |     0.00048s |   0.4%
- batch.update_runavg            |   7783 |     0.00130s |   1.1%
- batch.wd                       |   7783 |     0.00001s |   0.0%
- epoch_metrics.collect          |     55 |     0.00948s |   0.1%
- reduce.gather.context          |   7644 |     0.00171s |   1.4%
- reduce.gather.tensors          |   7644 |     0.00339s |   2.9%
- reduce.heur_params             |   7644 |     0.01054s |   8.9%
- epoch_metrics.collect          |     55 |     0.00925s |   0.1%
- reduce.combine                 |   7783 |     0.00598s |   5.0%
- reduce.flatpack                |   7783 |     0.00002s |   0.0%
- reduce.flatput                 |   7783 |     0.00018s |   0.2%
- reduce.gather.context          |   7783 |     0.00254s |   2.1%
- reduce.gather.tensors          |   7783 |     0.00312s |   2.6%
- reduce.heur_params             |   7783 |     0.01045s |   8.8%
- reduce.heur_params.alpha       |   7782 |     0.00811s |   6.8%
- reduce.heur_params.beta        |   7782 |     0.00227s |   1.9%
- reduce.memory                  |   7783 |     0.00045s |   0.4%
- reduce.pad                     |   7783 |     0.00027s |   0.2%
- reduce.threshold               |   7783 |     0.00239s |   2.0%
- test.last                      |     55 |     0.41260s |   2.5%
- test.runavg                    |     55 |     0.44341s |   2.7%
-----------------------------------------------------------------
- reduce.combine                 |   7783 |     0.00605s |   5.1%
- reduce.flatpack                |   7783 |     0.00002s |   0.0%
- reduce.flatput                 |   7783 |     0.00022s |   0.2%
- reduce.gather.context          |   7783 |     0.00138s |   1.2%
- reduce.gather.tensors          |   7783 |     0.00344s |   2.9%
- reduce.heur_params             |   7783 |     0.01086s |   9.1%
- reduce.heur_params.alpha       |   7782 |     0.00831s |   7.0%
- reduce.heur_params.beta        |   7782 |     0.00247s |   2.1%
- reduce.memory                  |   7783 |     0.00046s |   0.4%
- reduce.pad                     |   7783 |     0.00019s |   0.2%
- reduce.threshold               |   7783 |     0.00263s |   2.2%
- test.last                      |     55 |     0.41260s |   2.5%
- test.runavg                    |     55 |     0.44341s |   2.7%
-----------------------------------------------------------------
- reduce.heur_params.alpha       |   7643 |     0.00825s |   6.9%
- reduce.heur_params.beta        |   7643 |     0.00222s |   1.9%
- reduce.memory                  |   7644 |     0.00045s |   0.4%
- reduce.pad                     |   7644 |     0.00028s |   0.2%
- reduce.threshold               |   7644 |     0.00233s |   2.0%
- test.last                      |     54 |     0.41268s |   2.5%
- test.runavg                    |     54 |     0.44357s |   2.7%
-----------------------------------------------------------------

[Iteration 7650] [Rank 2] a = 1.2034776210784912, b = 0.9996327665247637, delta = 0.0007825226057320833, c = 0.000265533016510682, d = 0.0002661202496680492, m = 0.00044629265765870895
[Iteration 7660] [Rank 2] a = 1.023719310760498, b = 0.9999093360540602, delta = 0.0006287893047556281, c = 0.0008186721076236716, d = 0.0008196393151769822, m = 0.00044728666336884865
[Iteration 7670] [Rank 2] a = 0.8885492086410522, b = 1.0040434354455863, delta = 0.0005813682801090181, c = 0.009086914963353714, d = 0.008099257878915907, m = 0.00044872172993606403
[Iteration 7680] [Rank 2] a = 1.0268298387527466, b = 0.9998162077857483, delta = 0.0006717469659633934, c = 0.0006324155673575603, d = 0.0006334173180377749, m = 0.0004490849347253796
[Iteration 7690] [Rank 2] a = 0.9775039553642273, b = 1.0000562997871651, delta = 0.0006471805972978473, c = 0.0011125995744494025, d = 0.0011115632806422838, m = 0.0004496857092271447
[Iteration 7700] [Rank 2] a = 1.006990909576416, b = 0.9996859802055726, delta = 0.0007490864372812212, c = 0.0003719603905017593, d = 0.0003728239686743581, m = 0.0004502364123865514
[Iteration 7710] [Rank 2] a = 1.0605748891830444, b = 0.9997899031956327, delta = 0.0006812087376601994, c = 0.0005798063850828408, d = 0.0005808426788899594, m = 0.0004507836533954196
[Iteration 7720] [Rank 2] a = 1.1168341636657715, b = 0.9997231486068728, delta = 0.0006987688830122352, c = 0.00044629719959906483, d = 0.00044702260526404786, m = 0.00045151872362949946
[Iteration 7730] [Rank 2] a = 0.9633336067199707, b = 0.9998547751858881, delta = 0.0006947456276975572, c = 0.000709550369734086, d = 0.0007101721460183571, m = 0.0004520501114142631
[Iteration 7740] [Rank 2] a = 1.015304446220398, b = 0.9998078483493329, delta = 0.000684800383169204, c = 0.0006156966939360473, d = 0.0006170438758853015, m = 0.00045260429442181663
[Iteration 7750] [Rank 2] a = 1.0482254028320312, b = 0.9997719234989427, delta = 0.0007111257873475552, c = 0.0005438469899758264, d = 0.000544848740656041, m = 0.0004530843959282813
[Iteration 7760] [Rank 2] a = 1.0001226663589478, b = 0.999762095979872, delta = 0.0007221869891509414, c = 0.0005241919507674775, d = 0.0005250900720669802, m = 0.00045375783402869057
[Iteration 7770] [Rank 2] a = 1.0134077072143555, b = 0.9998789035596014, delta = 0.0006730714230798185, c = 0.0007578071180189075, d = 0.0007587743255722181, m = 0.0004543780820635937
[Iteration 7780] [Rank 2] a = 0.9632536172866821, b = 0.9998737566337714, delta = 0.0006899379659444094, c = 0.0007475132662015297, d = 0.0007485150168817442, m = 0.0004547974014387086
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7783 |     0.11026s |  92.9%
- batch.accumulate               |   7783 |     0.00083s |   0.7%
- batch.backward                 |   7783 |     0.05188s |  43.7%
- batch.evaluate                 |   7783 |     0.00275s |   2.3%
- batch.forward                  |   7783 |     0.02555s |  21.5%
- batch.mom                      |   7783 |     0.00126s |   1.1%
- batch.reduce                   |   7783 |     0.02522s |  21.2%
- batch.reporting.compr_err      |   7783 |     0.00001s |   0.0%
- batch.reporting.lr             |   7783 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7783 |     0.00001s |   0.0%
- batch.step                     |   7783 |     0.00048s |   0.4%
- batch.update_runavg            |   7783 |     0.00130s |   1.1%
- batch.wd                       |   7783 |     0.00001s |   0.0%
- epoch_metrics.collect          |     55 |     0.01371s |   0.1%
- reduce.combine                 |   7783 |     0.00605s |   5.1%
- reduce.flatpack                |   7783 |     0.00002s |   0.0%
- reduce.flatput                 |   7783 |     0.00018s |   0.1%
- reduce.gather.context          |   7783 |     0.00172s |   1.5%
- reduce.gather.tensors          |   7783 |     0.00343s |   2.9%
- reduce.heur_params             |   7783 |     0.01054s |   8.9%
- reduce.heur_params.alpha       |   7782 |     0.00824s |   6.9%
- reduce.heur_params.beta        |   7782 |     0.00223s |   1.9%
- reduce.memory                  |   7783 |     0.00045s |   0.4%
- reduce.pad                     |   7783 |     0.00028s |   0.2%
- reduce.threshold               |   7783 |     0.00234s |   2.0%
- test.last                      |     55 |     0.41260s |   2.5%
- test.runavg                    |     55 |     0.44342s |   2.7%
-----------------------------------------------------------------

[Iteration 7650] [Rank 0] a = 0.9701147675514221, b = 0.9998477456597185, delta = 0.0007460765191353858, c = 0.0006954913170841774, d = 0.0006963548952567762, m = 0.0003830528382377137
[Iteration 7660] [Rank 0] a = 1.0486397743225098, b = 0.9997600233923761, delta = 0.000729450024664402, c = 0.0005200467755390032, d = 0.0005206685518232743, m = 0.0003840872329254878
[Iteration 7670] [Rank 0] a = 0.983924925327301, b = 0.9998675734141591, delta = 0.0007084624958224595, c = 0.0007351468267699147, d = 0.0007363212930846491, m = 0.0003846235513857385
[Iteration 7680] [Rank 0] a = 0.9017239212989807, b = 1.0000984251301663, delta = 0.000688414613250643, c = 0.0011968502609681422, d = 0.0011950885614960408, m = 0.00038548298357882747
[Iteration 7690] [Rank 0] a = 0.960917055606842, b = 0.9998662953184863, delta = 0.0006960596656426787, c = 0.0007325906353790223, d = 0.0007331433254094855, m = 0.0003866586459516577
[Iteration 7700] [Rank 0] a = 0.9680746793746948, b = 0.9998625992039755, delta = 0.000717536429874599, c = 0.0007251984062215764, d = 0.0007262692431555989, m = 0.0003872545808512234
[Iteration 7710] [Rank 0] a = 1.1185119152069092, b = 0.9997293318261251, delta = 0.0007032956928014755, c = 0.00045866363903067977, d = 0.00045956176033018254, m = 0.0003885604258905264
[Iteration 7720] [Rank 0] a = 0.9588017463684082, b = 0.9998958296915692, delta = 0.0007132751052267849, c = 0.0007916593823847807, d = 0.0007924193311766677, m = 0.0003889195312574588
[Iteration 7730] [Rank 0] a = 0.938529372215271, b = 0.9998915290723183, delta = 0.00072723557241261, c = 0.0007830581437856967, d = 0.0007837144631968717, m = 0.0003893561367407031
[Iteration 7740] [Rank 0] a = 0.9155243039131165, b = 1.000454115676998, delta = 0.0006263777031563222, c = 0.0019082314164281377, d = 0.0018963485807731782, m = 0.00039170399862662993
[Iteration 7750] [Rank 0] a = 1.071994423866272, b = 0.9996937178652546, delta = 0.0007145701092667878, c = 0.00038743571135472994, d = 0.00038798840138519323, m = 0.0003936611796633711
[Iteration 7760] [Rank 0] a = 1.0050381422042847, b = 0.9998861921592775, delta = 0.0006565078510902822, c = 0.0007723843175723754, d = 0.0007729715507297425, m = 0.00039449737956744887
[Iteration 7770] [Rank 0] a = 1.058208703994751, b = 0.9997430627181136, delta = 0.0007119547808542848, c = 0.00048612542491932196, d = 0.00048712717559953655, m = 0.00039508783409095567
[Iteration 7780] [Rank 0] a = 0.9496856927871704, b = 0.9999417202353502, delta = 0.0006719717639498413, c = 0.0008834404705685822, d = 0.0008840277037259495, m = 0.00039567191420612107
cross_entropy                  - bits:17207440448.000, epoch: 56.000, ratio_transmit_grad:  0.204, value:  5.482 (split:train)
last_cross_entropy             - bits:17207440448.000, epoch: 56.000, ratio_transmit_grad:  0.204, value:  5.482 (split:train)
perplexity                     - bits:17207440448.000, epoch: 56.000, ratio_transmit_grad:  0.204, value:240.965 (split:train)
last_perplexity                - bits:17207440448.000, epoch: 56.000, ratio_transmit_grad:  0.204, value:240.965 (split:train)
last_cross_entropy             - bits:17207440448.000, epoch: 56.000, ratio_transmit_grad:  0.204, value:  5.248 (split:test)
last_perplexity                - bits:17207440448.000, epoch: 56.000, ratio_transmit_grad:  0.204, value:190.784 (split:test)
runavg_cross_entropy           - bits:17207440448.000, epoch: 56.000, ratio_transmit_grad:  0.204, value:  5.438 (split:test)
runavg_perplexity              - bits:17207440448.000, epoch: 56.000, ratio_transmit_grad:  0.204, value:230.730 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7783 |     0.11023s |  92.8%
- batch.accumulate               |   7783 |     0.00083s |   0.7%
- batch.backward                 |   7783 |     0.05167s |  43.5%
- batch.evaluate                 |   7783 |     0.00275s |   2.3%
- batch.forward                  |   7783 |     0.02544s |  21.4%
- batch.mom                      |   7783 |     0.00126s |   1.1%
- batch.reduce                   |   7783 |     0.02547s |  21.5%
- batch.reporting.compr_err      |   7783 |     0.00001s |   0.0%
- batch.reporting.lr             |   7783 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7783 |     0.00001s |   0.0%
- batch.step                     |   7783 |     0.00048s |   0.4%
- batch.update_runavg            |   7783 |     0.00130s |   1.1%
- batch.wd                       |   7783 |     0.00001s |   0.0%
- epoch_metrics.collect          |     55 |     0.00901s |   0.1%
- reduce.combine                 |   7783 |     0.00626s |   5.3%
- reduce.flatpack                |   7783 |     0.00002s |   0.0%
- reduce.flatput                 |   7783 |     0.00018s |   0.2%
- reduce.gather.context          |   7783 |     0.00122s |   1.0%
- reduce.gather.tensors          |   7783 |     0.00351s |   3.0%
- reduce.heur_params             |   7783 |     0.01100s |   9.3%
- reduce.heur_params.alpha       |   7782 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   7782 |     0.00221s |   1.9%
- reduce.memory                  |   7783 |     0.00045s |   0.4%
- reduce.pad                     |   7783 |     0.00029s |   0.2%
- reduce.threshold               |   7783 |     0.00232s |   2.0%
- test.last                      |     55 |     0.41259s |   2.5%
- test.runavg                    |     55 |     0.44342s |   2.7%
-----------------------------------------------------------------

[Iteration 7790] [Rank 0] a = 0.9439866542816162, b = 1.0000163679325222, delta = 0.0006740485550835729, c = 0.0010327358650474646, d = 0.0010325976925398487, m = 0.00039634864059960443
[Iteration 7800] [Rank 0] a = 1.067380666732788, b = 0.9997621996092468, delta = 0.0006731810281053185, c = 0.0005243992095289012, d = 0.0005254355033360198, m = 0.0003977807424389659
[Iteration 7810] [Rank 0] a = 0.9501966238021851, b = 0.99984240874674, delta = 0.000698041811119765, c = 0.0006848174908708561, d = 0.0006858537846779747, m = 0.0003984668650106122
[Iteration 7820] [Rank 0] a = 0.9177181124687195, b = 1.000572287682875, delta = 0.0006331767071969807, c = 0.00214457549070498, d = 0.0021283056779332183, m = 0.0003991795706599702
[Iteration 7830] [Rank 0] a = 0.9478585720062256, b = 1.0002335232955606, delta = 0.0006460231961682439, c = 0.0014670465996108578, d = 0.0014624178206057283, m = 0.0003997859841971355
[Iteration 7840] [Rank 0] a = 0.8947415947914124, b = 1.0005830996779879, delta = 0.0006154378061182797, c = 0.0021661994881468543, d = 0.00215034419289794, m = 0.00040112804560523356
[Iteration 7850] [Rank 0] a = 1.0108078718185425, b = 0.9997681064836216, delta = 0.0007040653144940734, c = 0.0005362129589300529, d = 0.0005369729077219399, m = 0.00040161132450877105
[Iteration 7860] [Rank 0] a = 1.041191816329956, b = 0.9997495740971162, delta = 0.000719395640771836, c = 0.000499148183762112, d = 0.0005000463050616147, m = 0.00040217707974436837
[Iteration 7870] [Rank 0] a = 1.080979824066162, b = 0.9996940287533679, delta = 0.0007448695250786841, c = 0.0003880574876390011, d = 0.00038847200516184855, m = 0.00040267376819171747
[Iteration 7880] [Rank 0] a = 1.061815619468689, b = 0.9998174340667121, delta = 0.000666944426484406, c = 0.0006348681293677409, d = 0.0006358353369210516, m = 0.00040350064099947794
[Iteration 7890] [Rank 0] a = 1.163845181465149, b = 0.99968466756688, delta = 0.000718871655408293, c = 0.0003693351128570589, d = 0.00037016414790275377, m = 0.00040428858111568464
[Iteration 7900] [Rank 0] a = 0.8880950212478638, b = 1.0003006751294459, delta = 0.0006381247076205909, c = 0.0016013502770134247, d = 0.0015969632998966228, m = 0.0004053613076648668
[Iteration 7910] [Rank 0] a = 1.0140026807785034, b = 0.9999230324037812, delta = 0.0006552262930199504, c = 0.0008460648072585058, d = 0.0008466520404158729, m = 0.00040591777321387064
[Iteration 7920] [Rank 0] a = 1.0050454139709473, b = 0.9998588858179052, delta = 0.0006747613660991192, c = 0.0007177716339372267, d = 0.0007187388414905373, m = 0.0004065189726312831

[Iteration 7790] [Rank 3] a = 0.9520979523658752, b = 1.0002455788461582, delta = 0.000638021039776504, c = 0.0014911577021898166, d = 0.0014859416900273197, m = 0.0005020437898614999
[Iteration 7800] [Rank 3] a = 1.045483946800232, b = 0.9997749460223916, delta = 0.000686932762619108, c = 0.0005498920371840181, d = 0.0005508937878642326, m = 0.0005025672758357421
[Iteration 7810] [Rank 3] a = 0.9949644207954407, b = 1.0000474049320116, delta = 0.0006342341657727957, c = 0.001094809864093867, d = 0.0010934972252715169, m = 0.0005031055940332084
[Iteration 7820] [Rank 3] a = 0.987666130065918, b = 0.9998006633792123, delta = 0.0007142583490349352, c = 0.0006013267531440031, d = 0.0006024321332049296, m = 0.0005033929514939191
[Iteration 7830] [Rank 3] a = 0.9859501123428345, b = 0.9999364869516437, delta = 0.0006601304630748928, c = 0.0008729739031166847, d = 0.0008736993087816677, m = 0.0005041124955843895
cross_entropy                  - bits:17685828928.000, epoch: 57.000, ratio_transmit_grad:  0.186, value:  5.467 (split:train)
last_cross_entropy             - bits:17685828928.000, epoch: 57.000, ratio_transmit_grad:  0.186, value:  5.467 (split:train)
perplexity                     - bits:17685828928.000, epoch: 57.000, ratio_transmit_grad:  0.186, value:237.399 (split:train)
last_perplexity                - bits:17685828928.000, epoch: 57.000, ratio_transmit_grad:  0.186, value:237.399 (split:train)
last_cross_entropy             - bits:17685828928.000, epoch: 57.000, ratio_transmit_grad:  0.186, value:  5.226 (split:test)
last_perplexity                - bits:17685828928.000, epoch: 57.000, ratio_transmit_grad:  0.186, value:186.579 (split:test)
runavg_cross_entropy           - bits:17685828928.000, epoch: 57.000, ratio_transmit_grad:  0.186, value:  5.422 (split:test)
runavg_perplexity              - bits:17685828928.000, epoch: 57.000, ratio_transmit_grad:  0.186, value:227.073 (split:test)
[Iteration 7840] [Rank 3] a = 1.1430284976959229, b = 0.9996823531776095, delta = 0.0007320644799619913, c = 0.0003647063338519293, d = 0.00036539719639000837, m = 0.0005046775555237273
[Iteration 7850] [Rank 3] a = 0.9355142116546631, b = 0.9999661594975817, delta = 0.0006669358699582517, c = 0.0009323189951376749, d = 0.0009326989695336184, m = 0.0005051356106939157
[Iteration 7860] [Rank 3] a = 0.9660205841064453, b = 1.0000996686827226, delta = 0.0006626809481531382, c = 0.0011993373661052268, d = 0.0011979556410290687, m = 0.0005059648025290996
[Iteration 7870] [Rank 3] a = 0.9807060956954956, b = 0.9999730681229562, delta = 0.000689120905008167, c = 0.0009461362458992559, d = 0.0009462053321530638, m = 0.000506328418796183
[Iteration 7880] [Rank 3] a = 0.8768083453178406, b = 1.0002351468224358, delta = 0.0006422014557756484, c = 0.0014702936535398294, d = 0.001467012056483954, m = 0.0005071236618487379

[Iteration 7790] [Rank 1] a = 0.9809350371360779, b = 0.9998738429915873, delta = 0.0007191979675553739, c = 0.0007476859818360494, d = 0.0007487913618969759, m = 0.0006179616341388616
[Iteration 7800] [Rank 1] a = 1.0008232593536377, b = 0.9998618910698872, delta = 0.0006860896246507764, c = 0.0007237821380185143, d = 0.0007245766299373052, m = 0.0006189002025362186
[Iteration 7810] [Rank 1] a = 1.0971332788467407, b = 0.9997692464067485, delta = 0.0006754269124940038, c = 0.0005384928053057137, d = 0.0005391491247168889, m = 0.0006201797028030378
[Iteration 7820] [Rank 1] a = 0.9822558760643005, b = 0.9998826687603803, delta = 0.0006867673946544528, c = 0.0007653375196839691, d = 0.0007658556665875284, m = 0.0006204448655772174
[Iteration 7830] [Rank 1] a = 1.0066622495651245, b = 0.9998725648959124, delta = 0.0007002411875873804, c = 0.0007451297904451569, d = 0.0007461315411253715, m = 0.0006205895992791616
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7922 |     0.11027s |  92.9%
- batch.accumulate               |   7922 |     0.00083s |   0.7%
- batch.backward                 |   7922 |     0.05167s |  43.5%
- batch.evaluate                 |   7922 |     0.00275s |   2.3%
- batch.forward                  |   7922 |     0.02543s |  21.4%
- batch.mom                      |   7922 |     0.00126s |   1.1%
- batch.reduce                   |   7922 |     0.02551s |  21.5%
- batch.reporting.compr_err      |   7922 |     0.00001s |   0.0%
- batch.reporting.lr             |   7922 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7922 |     0.00001s |   0.0%
- batch.step                     |   7922 |     0.00048s |   0.4%
- batch.update_runavg            |   7922 |     0.00130s |   1.1%
- batch.wd                       |   7922 |     0.00001s |   0.0%
[Iteration 7890] [Rank 3] a = 1.0444135665893555, b = 0.9997624241395592, delta = 0.0007166910218074918, c = 0.0005248482701786525, d = 0.0005260227364933869, m = 0.0005073282203427499
[Iteration 7900] [Rank 3] a = 0.9699904918670654, b = 0.9999209425446163, delta = 0.0007086869445629418, c = 0.0008418850889031276, d = 0.0008425068651873987, m = 0.0005075913878835117
[Iteration 7910] [Rank 3] a = 1.0636123418807983, b = 0.9997131483724285, delta = 0.000746325880754739, c = 0.0004262967291216764, d = 0.0004269530485328515, m = 0.000508085387128009
[Iteration 7920] [Rank 3] a = 0.9761108756065369, b = 1.0003911435679207, delta = 0.0006543715135194361, c = 0.0017822871757363274, d = 0.0017649810691574472, m = 0.0005086893085295757
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7922 |     0.11039s |  92.9%
- batch.accumulate               |   7922 |     0.00082s |   0.7%
[Iteration 7840] [Rank 1] a = 1.0721629858016968, b = 0.9999037400675508, delta = 0.0006512356922030449, c = 0.000807480134506791, d = 0.000808240083298678, m = 0.0006221924274047327
[Iteration 7850] [Rank 1] a = 1.0363829135894775, b = 0.9997808356252381, delta = 0.0007109455182217062, c = 0.0005616712434582658, d = 0.0005624311922501527, m = 0.000622384531054048
[Iteration 7860] [Rank 1] a = 1.0447793006896973, b = 0.999873324844692, delta = 0.0006636568577960134, c = 0.0007466496880289309, d = 0.000747236921186298, m = 0.0006229547010083542
[Iteration 7870] [Rank 1] a = 1.0472711324691772, b = 0.9997215250800335, delta = 0.0007434381986968219, c = 0.0004430501456700933, d = 0.0004439137238426921, m = 0.0006230908936009235
[Iteration 7880] [Rank 1] a = 0.9515219926834106, b = 1.0000063849688485, delta = 0.0006933597032912076, c = 0.0010127699376969801, d = 0.001012700851443172, m = 0.0006234136179669764
- epoch_metrics.collect          |     56 |     0.00886s |   0.1%
- reduce.combine                 |   7922 |     0.00627s |   5.3%
- reduce.flatpack                |   7922 |     0.00002s |   0.0%
- reduce.flatput                 |   7922 |     0.00018s |   0.2%
- reduce.gather.context          |   7922 |     0.00121s |   1.0%
- reduce.gather.tensors          |   7922 |     0.00354s |   3.0%
- reduce.heur_params             |   7922 |     0.01101s |   9.3%
- reduce.heur_params.alpha       |   7921 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   7921 |     0.00222s |   1.9%
- reduce.memory                  |   7922 |     0.00045s |   0.4%
- reduce.pad                     |   7922 |     0.00029s |   0.2%
- reduce.threshold               |   7922 |     0.00233s |   2.0%
- test.last                      |     56 |     0.41250s |   2.5%
- test.runavg                    |     56 |     0.44330s |   2.7%
-----------------------------------------------------------------

- batch.backward                 |   7922 |     0.05174s |  43.6%
- batch.evaluate                 |   7922 |     0.00277s |   2.3%
- batch.forward                  |   7922 |     0.02538s |  21.4%
- batch.mom                      |   7922 |     0.00126s |   1.1%
- batch.reduce                   |   7922 |     0.02564s |  21.6%
- batch.reporting.compr_err      |   7922 |     0.00001s |   0.0%
- batch.reporting.lr             |   7922 |     0.00002s |   0.0%
- batch.reporting.memory_norm    |   7922 |     0.00001s |   0.0%
- batch.step                     |   7922 |     0.00047s |   0.4%
- batch.update_runavg            |   7922 |     0.00130s |   1.1%
- batch.wd                       |   7922 |     0.00001s |   0.0%
- epoch_metrics.collect          |     56 |     0.00916s |   0.1%
- reduce.combine                 |   7922 |     0.00599s |   5.0%
- reduce.flatpack                |   7922 |     0.00002s |   0.0%
- reduce.flatput                 |   7922 |     0.00018s |   0.2%
[Iteration 7890] [Rank 1] a = 1.0626240968704224, b = 0.9997511285377298, delta = 0.0007343285251408815, c = 0.0005022570651834677, d = 0.0005031206433560665, m = 0.0006237544615929035
[Iteration 7900] [Rank 1] a = 1.0344260931015015, b = 0.9997724761889445, delta = 0.0007280712598003447, c = 0.0005449523700367529, d = 0.0005460922932245833, m = 0.0006241279800010051
[Iteration 7910] [Rank 1] a = 1.04217529296875, b = 0.9998610793064207, delta = 0.0006957015139050782, c = 0.0007221586110540286, d = 0.0007231258186073393, m = 0.0006247224536357493
[Iteration 7920] [Rank 1] a = 1.0624823570251465, b = 0.999747605139007, delta = 0.0007321707089431584, c = 0.0004952102672950615, d = 0.0004963156473559879, m = 0.0006249073324282716
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7922 |     0.11029s |  92.9%
- batch.accumulate               |   7922 |     0.00083s |   0.7%
[Iteration 7930] [Rank 0] a = 1.0218439102172852, b = 0.9997152209598736, delta = 0.0007719846325926483, c = 0.0004304419043501507, d = 0.00043134002564965346, m = 0.0004068058644973044
[Iteration 7940] [Rank 0] a = 1.013309121131897, b = 0.9997976235841671, delta = 0.0006957183941267431, c = 0.0005952471628089076, d = 0.0005957998528393708, m = 0.0004075287535842461
[Iteration 7950] [Rank 0] a = 1.0500390529632568, b = 0.999715998180166, delta = 0.0007520694634877145, c = 0.00043199634506082857, d = 0.00043292900948723524, m = 0.0004080110852958432
[Iteration 7960] [Rank 0] a = 1.0663670301437378, b = 0.999741715536254, delta = 0.0007430768455378711, c = 0.00048343106102081366, d = 0.00048432918232031643, m = 0.0004085942292054884
[Iteration 7970] [Rank 0] a = 0.9004823565483093, b = 1.000303922183078, delta = 0.0006779093528166413, c = 0.0016078443848713678, d = 0.0015984141112265887, m = 0.0004091341600474149
- reduce.gather.context          |   7922 |     0.00253s |   2.1%
- reduce.gather.tensors          |   7922 |     0.00315s |   2.6%
- reduce.heur_params             |   7922 |     0.01045s |   8.8%
- batch.backward                 |   7922 |     0.05176s |  43.6%
- batch.evaluate                 |   7922 |     0.00276s |   2.3%
- batch.forward                  |   7922 |     0.02541s |  21.4%
- batch.mom                      |   7922 |     0.00126s |   1.1%
- batch.reduce                   |   7922 |     0.02550s |  21.5%
- batch.reporting.compr_err      |   7922 |     0.00001s |   0.0%
- batch.reporting.lr             |   7922 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7922 |     0.00001s |   0.0%
- batch.step                     |   7922 |     0.00048s |   0.4%
- batch.update_runavg            |   7922 |     0.00130s |   1.1%
- batch.wd                       |   7922 |     0.00001s |   0.0%
- epoch_metrics.collect          |     56 |     0.00938s |   0.1%
- reduce.combine                 |   7922 |     0.00606s |   5.1%
- reduce.flatpack                |   7922 |     0.00002s |   0.0%
- reduce.flatput                 |   7922 |     0.00022s |   0.2%
[Iteration 7980] [Rank 0] a = 0.9962205290794373, b = 0.9998970041578712, delta = 0.0006768712191842496, c = 0.0007940083150142495, d = 0.0007950100656944642, m = 0.00041053827668249506
[Iteration 7990] [Rank 0] a = 0.9926371574401855, b = 0.9999525322340408, delta = 0.0006511471583507955, c = 0.0009050644680104565, d = 0.0009056862442947276, m = 0.0004112847988478388
[Iteration 8000] [Rank 0] a = 1.1172717809677124, b = 0.9996695722219971, delta = 0.0007464975933544338, c = 0.0003391444199430045, d = 0.0003397316531003717, m = 0.00041249036671980725
[Iteration 8010] [Rank 0] a = 1.0179866552352905, b = 0.9997866043271614, delta = 0.000715701375156641, c = 0.0005732086478441859, d = 0.0005740031397629768, m = 0.0004129862934277414
[Iteration 8020] [Rank 0] a = 0.9405849575996399, b = 1.0000938999805837, delta = 0.0006612606812268496, c = 0.0011877999617193069, d = 0.001186314607262437, m = 0.00041362909997976605

[Iteration 7790] [Rank 2] a = 0.955041766166687, b = 0.9999936558265846, delta = 0.000685554405208677, c = 0.0009873116531687672, d = 0.000987346196295671, m = 0.00045533806388781177
[Iteration 7800] [Rank 2] a = 1.1019076108932495, b = 0.999694961417707, delta = 0.0007205917499959469, c = 0.00038992281649181455, d = 0.00039071730841060544, m = 0.0004565457038760475
[Iteration 7810] [Rank 2] a = 0.9527954459190369, b = 1.0002895349719896, delta = 0.0006370902410708368, c = 0.0015790699601603755, d = 0.0015722304210333928, m = 0.0004572317642862218
[Iteration 7820] [Rank 2] a = 1.026983380317688, b = 0.9998290405569892, delta = 0.0006912780227139592, c = 0.000658081110647197, d = 0.0006593246632157392, m = 0.0004576944439556831
[Iteration 7830] [Rank 2] a = 0.9225261807441711, b = 1.0000194249992522, delta = 0.0006711401510983706, c = 0.001038849998509464, d = 0.0010386427397480404, m = 0.00045849465957653135
- reduce.heur_params.alpha       |   7921 |     0.00811s |   6.8%
- reduce.heur_params.beta        |   7921 |     0.00227s |   1.9%
- reduce.memory                  |   7922 |     0.00045s |   0.4%
- reduce.pad                     |   7922 |     0.00027s |   0.2%
- reduce.threshold               |   7922 |     0.00240s |   2.0%
- test.last                      |     56 |     0.41251s |   2.5%
- test.runavg                    |     56 |     0.44329s |   2.7%
-----------------------------------------------------------------

[Iteration 7930] [Rank 3] a = 1.1096391677856445, b = 0.9997328206816903, delta = 0.0007012460846453905, c = 0.00046564135066527816, d = 0.0004664358425840691, m = 0.0005095894721434588
[Iteration 7940] [Rank 3] a = 1.0662516355514526, b = 0.9996949786892688, delta = 0.000743851822335273, c = 0.0003899573596187185, d = 0.00039061367902989356, m = 0.0005101184257610398
- reduce.gather.context          |   7922 |     0.00138s |   1.2%
- reduce.gather.tensors          |   7922 |     0.00347s |   2.9%
- reduce.heur_params             |   7922 |     0.01086s |   9.1%
[Iteration 8030] [Rank 0] a = 0.9773950576782227, b = 1.0001197900539012, delta = 0.0006602936191484332, c = 0.0012395801089483314, d = 0.0012374384350802862, m = 0.0004142077831320003
[Iteration 8040] [Rank 0] a = 1.0461230278015137, b = 0.999842356932051, delta = 0.0006663470412604511, c = 0.0006847138614901442, d = 0.0006855083534089351, m = 0.00041548511273357074
[Iteration 8050] [Rank 0] a = 1.049359679222107, b = 0.9998135997797565, delta = 0.0006886586779728532, c = 0.0006271995551950635, d = 0.0006279595039869505, m = 0.00041597710832899345
[Iteration 8060] [Rank 0] a = 1.0260887145996094, b = 0.9998532034736473, delta = 0.0006877573905512691, c = 0.0007064069451858263, d = 0.0007072359802315211, m = 0.0004164650764265833
cross_entropy                  - bits:18143933696.000, epoch: 58.000, ratio_transmit_grad:  0.178, value:  5.451 (split:train)
last_cross_entropy             - bits:18143933696.000, epoch: 58.000, ratio_transmit_grad:  0.178, value:  5.451 (split:train)
[Iteration 7840] [Rank 2] a = 0.9716058373451233, b = 1.0000140708145837, delta = 0.0006854247185401618, c = 0.0010281416291692388, d = 0.0010278652841540072, m = 0.0004591148847832171
[Iteration 7850] [Rank 2] a = 1.068182110786438, b = 0.9998186776192395, delta = 0.0006581083871424198, c = 0.0006373552345048255, d = 0.0006381497264236164, m = 0.00046133842805062543
[Iteration 7860] [Rank 2] a = 1.0575653314590454, b = 0.9998254826150242, delta = 0.0006430506473407149, c = 0.0006509652265049827, d = 0.0006520706065659092, m = 0.0004619856543134046
[Iteration 7870] [Rank 2] a = 1.0170998573303223, b = 0.9998446540499338, delta = 0.0006904612528160214, c = 0.0006893080973683699, d = 0.000689964416779545, m = 0.0004622781114051347
[Iteration 7880] [Rank 2] a = 1.0394186973571777, b = 0.9997001947009543, delta = 0.00075882876990363, c = 0.00040038938394371213, d = 0.00040114933273559906, m = 0.00046270045114198046
[Iteration 7950] [Rank 3] a = 0.9979641437530518, b = 0.9998203184177141, delta = 0.0007169234449975193, c = 0.0006406368315607009, d = 0.0006414313234794918, m = 0.0005109380601306484
[Iteration 7960] [Rank 3] a = 0.9874162673950195, b = 1.0000855060008136, delta = 0.0006635547615587711, c = 0.001171012002043986, d = 0.0011683521812723815, m = 0.0005114227222481406
[Iteration 7970] [Rank 3] a = 0.9266759753227234, b = 0.9999031528343987, delta = 0.0007312377565540373, c = 0.0008063056681920566, d = 0.0008071001601108475, m = 0.0005116024479346438
[Iteration 7980] [Rank 3] a = 1.105538010597229, b = 0.9997123884236994, delta = 0.0007497855112887919, c = 0.00042477683153790247, d = 0.0004257785822181171, m = 0.0005122118265012493
[Iteration 7990] [Rank 3] a = 1.0377812385559082, b = 0.9997696781958118, delta = 0.0007261015707626939, c = 0.0005393563834783125, d = 0.000540461763539239, m = 0.0005125663794917665
- reduce.heur_params.alpha       |   7921 |     0.00831s |   7.0%
- reduce.heur_params.beta        |   7921 |     0.00247s |   2.1%
- reduce.memory                  |   7922 |     0.00046s |   0.4%
- reduce.pad                     |   7922 |     0.00019s |   0.2%
- reduce.threshold               |   7922 |     0.00263s |   2.2%
- test.last                      |     56 |     0.41251s |   2.5%
- test.runavg                    |     56 |     0.44329s |   2.7%
-----------------------------------------------------------------

[Iteration 7930] [Rank 1] a = 1.0643552541732788, b = 0.9997911812912719, delta = 0.0007137210923247039, c = 0.0005823625764737333, d = 0.0005833988702808519, m = 0.0006254706610226523
[Iteration 7940] [Rank 1] a = 0.9733867645263672, b = 0.9998651381237559, delta = 0.000718478171620518, c = 0.0007302762458764574, d = 0.0007311052809221523, m = 0.000625829096546142
perplexity                     - bits:18143933696.000, epoch: 58.000, ratio_transmit_grad:  0.178, value:233.637 (split:train)
last_perplexity                - bits:18143933696.000, epoch: 58.000, ratio_transmit_grad:  0.178, value:233.637 (split:train)
last_cross_entropy             - bits:18143933696.000, epoch: 58.000, ratio_transmit_grad:  0.178, value:  5.231 (split:test)
last_perplexity                - bits:18143933696.000, epoch: 58.000, ratio_transmit_grad:  0.178, value:187.627 (split:test)
runavg_cross_entropy           - bits:18143933696.000, epoch: 58.000, ratio_transmit_grad:  0.178, value:  5.421 (split:test)
runavg_perplexity              - bits:18143933696.000, epoch: 58.000, ratio_transmit_grad:  0.178, value:226.850 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8061 |     0.11032s |  92.9%
- batch.accumulate               |   8061 |     0.00083s |   0.7%
[Iteration 7890] [Rank 2] a = 1.0177680253982544, b = 0.9998405606894971, delta = 0.0006707411957904696, c = 0.0006811213762921331, d = 0.0006820540407185398, m = 0.0004635256749762577
[Iteration 7900] [Rank 2] a = 1.0781147480010986, b = 0.9997444098999745, delta = 0.0007025757804512978, c = 0.0004888197888178302, d = 0.0004897524532442369, m = 0.00046416564957180574
[Iteration 7910] [Rank 2] a = 0.9835692048072815, b = 1.0002362349308729, delta = 0.0006398535915650427, c = 0.0014724698705347783, d = 0.0014646285807275812, m = 0.00046481123273556463
[Iteration 7920] [Rank 2] a = 1.0886543989181519, b = 0.9996909544153638, delta = 0.000762841256801039, c = 0.0003819088110500976, d = 0.00038256513046127267, m = 0.0004650692413008795
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   7922 |     0.11030s |  92.9%
- batch.accumulate               |   7922 |     0.00083s |   0.7%
[Iteration 8000] [Rank 3] a = 0.9956454634666443, b = 0.9998430477945719, delta = 0.0007166860159486532, c = 0.0006860955865663023, d = 0.000687062794119613, m = 0.0005129616352546438
[Iteration 8010] [Rank 3] a = 1.0486258268356323, b = 0.9997420955106245, delta = 0.0007412132690660655, c = 0.0004841910098127006, d = 0.0004852618467467231, m = 0.0005133582111345648
[Iteration 8020] [Rank 3] a = 0.967256486415863, b = 1.0010114341727836, delta = 0.0006484843324869871, c = 0.0030228690353648734, d = 0.0029300861965008574, m = 0.0005142449600057175
[Iteration 8030] [Rank 3] a = 1.0690644979476929, b = 0.9997523893617843, delta = 0.0007143385009840131, c = 0.0005047787134474563, d = 0.0005056422916200551, m = 0.0005146034308044428
[Iteration 8040] [Rank 3] a = 1.0016433000564575, b = 0.9998907518519723, delta = 0.0006968961097300053, c = 0.0007815037030750188, d = 0.0007825399968821373, m = 0.0005148903385641591
[Iteration 7950] [Rank 1] a = 1.0179740190505981, b = 0.9997107130821841, delta = 0.0007625941070728004, c = 0.0004214261482282191, d = 0.0004223933557815298, m = 0.0006260843087725227
[Iteration 7960] [Rank 1] a = 0.9245818257331848, b = 1.0015393904533045, delta = 0.00065071095013991, c = 0.0040787833385648896, d = 0.003936707457608934, m = 0.0006267544040236872
[Iteration 7970] [Rank 1] a = 1.0477477312088013, b = 0.9997582271498815, delta = 0.0007201902917586267, c = 0.0005164542903409921, d = 0.0005175251272750147, m = 0.0006273236044997466
[Iteration 7980] [Rank 1] a = 0.9785766005516052, b = 1.0001555767326915, delta = 0.000654808129183948, c = 0.0013111534678933207, d = 0.0013081827589795808, m = 0.0006281050257276807
[Iteration 7990] [Rank 1] a = 1.0176738500595093, b = 0.99984684753844, delta = 0.0007357110735028982, c = 0.0006936950744851719, d = 0.0006945586526577707, m = 0.0006281616143484068
- batch.backward                 |   8061 |     0.05167s |  43.5%
- batch.evaluate                 |   8061 |     0.00275s |   2.3%
- batch.forward                  |   8061 |     0.02543s |  21.4%
- batch.mom                      |   8061 |     0.00126s |   1.1%
- batch.reduce                   |   8061 |     0.02556s |  21.5%
- batch.reporting.compr_err      |   8061 |     0.00001s |   0.0%
- batch.reporting.lr             |   8061 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8061 |     0.00001s |   0.0%
- batch.step                     |   8061 |     0.00048s |   0.4%
- batch.update_runavg            |   8061 |     0.00130s |   1.1%
- batch.wd                       |   8061 |     0.00001s |   0.0%
- epoch_metrics.collect          |     57 |     0.00873s |   0.1%
- reduce.combine                 |   8061 |     0.00628s |   5.3%
- reduce.flatpack                |   8061 |     0.00002s |   0.0%
- reduce.flatput                 |   8061 |     0.00018s |   0.2%
- batch.backward                 |   7922 |     0.05187s |  43.7%
- batch.evaluate                 |   7922 |     0.00275s |   2.3%
- batch.forward                  |   7922 |     0.02555s |  21.5%
- batch.mom                      |   7922 |     0.00126s |   1.1%
- batch.reduce                   |   7922 |     0.02528s |  21.3%
- batch.reporting.compr_err      |   7922 |     0.00001s |   0.0%
- batch.reporting.lr             |   7922 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   7922 |     0.00001s |   0.0%
- batch.step                     |   7922 |     0.00048s |   0.4%
- batch.update_runavg            |   7922 |     0.00130s |   1.1%
- batch.wd                       |   7922 |     0.00001s |   0.0%
- epoch_metrics.collect          |     56 |     0.01357s |   0.1%
- reduce.combine                 |   7922 |     0.00605s |   5.1%
- reduce.flatpack                |   7922 |     0.00002s |   0.0%
- reduce.flatput                 |   7922 |     0.00018s |   0.1%
[Iteration 8050] [Rank 3] a = 0.950982391834259, b = 0.9998974877616428, delta = 0.0007102350937202573, c = 0.0007949755225675603, d = 0.0007955282125980235, m = 0.0005154590484079548
[Iteration 8060] [Rank 3] a = 1.0557183027267456, b = 0.9997349623554065, delta = 0.0007472677389159799, c = 0.00046992469840136824, d = 0.00047068464719325523, m = 0.0005157065844114767
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8061 |     0.11042s |  92.9%
- batch.accumulate               |   8061 |     0.00082s |   0.7%
- batch.backward                 |   8061 |     0.05174s |  43.6%
- batch.evaluate                 |   8061 |     0.00277s |   2.3%
- batch.forward                  |   8061 |     0.02538s |  21.4%
- batch.mom                      |   8061 |     0.00126s |   1.1%
- batch.reduce                   |   8061 |     0.02568s |  21.6%
[Iteration 8000] [Rank 1] a = 0.9589995741844177, b = 0.9999065035176781, delta = 0.0007436848245561123, c = 0.0008130070348114234, d = 0.0008138360698571182, m = 0.000628263803851164
[Iteration 8010] [Rank 1] a = 0.9771251082420349, b = 0.9998227709796461, delta = 0.0007313181995414197, c = 0.0006455419555810622, d = 0.0006469927669110282, m = 0.0006286640009486061
[Iteration 8020] [Rank 1] a = 1.023327112197876, b = 0.9997202642559998, delta = 0.0007591614266857505, c = 0.0004405284974061048, d = 0.0004412884461979917, m = 0.0006289905049997836
[Iteration 8030] [Rank 1] a = 0.994053304195404, b = 0.9997900068250086, delta = 0.0007395882275886834, c = 0.0005800136438442646, d = 0.0005815335414280384, m = 0.0006293717247385849
[Iteration 8040] [Rank 1] a = 1.039993166923523, b = 0.9998281597072789, delta = 0.0006863464368507266, c = 0.0006563194111750953, d = 0.00065732116185531, m = 0.0006308766777125949
- reduce.gather.context          |   8061 |     0.00121s |   1.0%
- reduce.gather.tensors          |   8061 |     0.00357s |   3.0%
- reduce.gather.context          |   7922 |     0.00174s |   1.5%
- reduce.gather.tensors          |   7922 |     0.00346s |   2.9%
- reduce.heur_params             |   7922 |     0.01055s |   8.9%
- batch.reporting.compr_err      |   8061 |     0.00001s |   0.0%
- batch.reporting.lr             |   8061 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8061 |     0.00001s |   0.0%
- batch.step                     |   8061 |     0.00047s |   0.4%
- batch.update_runavg            |   8061 |     0.00130s |   1.1%
[Iteration 8050] [Rank 1] a = 1.0762884616851807, b = 0.9997761032170844, delta = 0.0007025824161246419, c = 0.0005522064266865828, d = 0.000552828202970854, m = 0.0006311796347857119
[Iteration 8060] [Rank 1] a = 1.0367088317871094, b = 0.9997430109034269, delta = 0.000747912039514631, c = 0.0004860217955386101, d = 0.0004870926324726326, m = 0.0006313522724038568
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8061 |     0.11033s |  92.9%
- batch.accumulate               |   8061 |     0.00083s |   0.7%
- batch.backward                 |   8061 |     0.05177s |  43.6%
- batch.evaluate                 |   8061 |     0.00276s |   2.3%
- batch.forward                  |   8061 |     0.02541s |  21.4%
- batch.mom                      |   8061 |     0.00126s |   1.1%
- batch.reduce                   |   8061 |     0.02554s |  21.5%
- reduce.heur_params             |   8061 |     0.01101s |   9.3%
- reduce.heur_params.alpha       |   8060 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   8060 |     0.00222s |   1.9%
- reduce.memory                  |   8061 |     0.00045s |   0.4%
- reduce.pad                     |   8061 |     0.00029s |   0.2%
- reduce.threshold               |   8061 |     0.00234s |   2.0%
- test.last                      |     57 |     0.41233s |   2.5%
- test.runavg                    |     57 |     0.44319s |   2.7%
-----------------------------------------------------------------
- reduce.heur_params.alpha       |   7921 |     0.00824s |   6.9%
- reduce.heur_params.beta        |   7921 |     0.00223s |   1.9%
- reduce.memory                  |   7922 |     0.00045s |   0.4%
- reduce.pad                     |   7922 |     0.00028s |   0.2%
- reduce.threshold               |   7922 |     0.00234s |   2.0%
- test.last                      |     56 |     0.41251s |   2.5%
- test.runavg                    |     56 |     0.44330s |   2.7%
-----------------------------------------------------------------

[Iteration 7930] [Rank 2] a = 0.8541513681411743, b = 1.0004793666972627, delta = 0.0006576393498107791, c = 0.001958733467961716, d = 0.0019417382495249716, m = 0.0004657921670636269
[Iteration 7940] [Rank 2] a = 0.9321832656860352, b = 0.99991282490985, delta = 0.0006883608875796199, c = 0.00082564981925827, d = 0.0008263752249232529, m = 0.0004663393558572266
- batch.wd                       |   8061 |     0.00001s |   0.0%
- epoch_metrics.collect          |     57 |     0.00901s |   0.1%
- reduce.combine                 |   8061 |     0.00600s |   5.1%
- reduce.flatpack                |   8061 |     0.00002s |   0.0%
- reduce.flatput                 |   8061 |     0.00018s |   0.2%
- reduce.gather.context          |   8061 |     0.00253s |   2.1%
- reduce.gather.tensors          |   8061 |     0.00317s |   2.7%
- reduce.heur_params             |   8061 |     0.01046s |   8.8%
- reduce.heur_params.alpha       |   8060 |     0.00811s |   6.8%
- reduce.heur_params.beta        |   8060 |     0.00228s |   1.9%
- reduce.memory                  |   8061 |     0.00045s |   0.4%
- reduce.pad                     |   8061 |     0.00027s |   0.2%
- reduce.threshold               |   8061 |     0.00240s |   2.0%
- test.last                      |     57 |     0.41234s |   2.5%
- test.runavg                    |     57 |     0.44318s |   2.7%
- batch.reporting.compr_err      |   8061 |     0.00001s |   0.0%
- batch.reporting.lr             |   8061 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8061 |     0.00001s |   0.0%
- batch.step                     |   8061 |     0.00048s |   0.4%
- batch.update_runavg            |   8061 |     0.00130s |   1.1%
- batch.wd                       |   8061 |     0.00001s |   0.0%
[Iteration 7950] [Rank 2] a = 0.9814924001693726, b = 0.9999784223076231, delta = 0.0006607096875086427, c = 0.0009568446152394811, d = 0.0009572245896354246, m = 0.00046694213334458714
[Iteration 7960] [Rank 2] a = 0.9456292986869812, b = 0.9998576595369247, delta = 0.0006974970456212759, c = 0.000715319071927046, d = 0.0007161135638458369, m = 0.0004674432166649204
[Iteration 7970] [Rank 2] a = 1.0768452882766724, b = 0.9997026472627458, delta = 0.0007384732598438859, c = 0.00040529450796407336, d = 0.00040608899988286426, m = 0.00046785811715695794
[Iteration 7980] [Rank 2] a = 1.009742259979248, b = 0.9998821333419209, delta = 0.0006597382598556578, c = 0.0007642666827499465, d = 0.0007651302609225453, m = 0.0004692214096864516
[Iteration 7990] [Rank 2] a = 0.9688831567764282, b = 1.0000221539062766, delta = 0.0006699577788822353, c = 0.0010443078125602885, d = 0.0010440660106719609, m = 0.00046965725393654286
-----------------------------------------------------------------
- epoch_metrics.collect          |     57 |     0.00923s |   0.1%
- reduce.combine                 |   8061 |     0.00607s |   5.1%
- reduce.flatpack                |   8061 |     0.00002s |   0.0%
- reduce.flatput                 |   8061 |     0.00022s |   0.2%
- reduce.gather.context          |   8061 |     0.00137s |   1.2%
- reduce.gather.tensors          |   8061 |     0.00349s |   2.9%
- reduce.heur_params             |   8061 |     0.01087s |   9.1%
- reduce.heur_params.alpha       |   8060 |     0.00831s |   7.0%
- reduce.heur_params.beta        |   8060 |     0.00248s |   2.1%
- reduce.memory                  |   8061 |     0.00046s |   0.4%
- reduce.pad                     |   8061 |     0.00019s |   0.2%
- reduce.threshold               |   8061 |     0.00263s |   2.2%
- test.last                      |     57 |     0.41234s |   2.5%
- test.runavg                    |     57 |     0.44318s |   2.7%
-----------------------------------------------------------------
[Iteration 8000] [Rank 2] a = 0.9803688526153564, b = 1.000025210973006, delta = 0.0006670965231023729, c = 0.001050421946022288, d = 0.0010502146872608644, m = 0.00047014663615685203
[Iteration 8010] [Rank 2] a = 1.1263740062713623, b = 0.9996544768772647, delta = 0.0007637804956175387, c = 0.00030895372702895017, d = 0.0003100936502167806, m = 0.000470615073687751
[Iteration 8020] [Rank 2] a = 1.031446099281311, b = 0.9998383153863062, delta = 0.0006766782025806606, c = 0.0006766307697946193, d = 0.0006775634342210261, m = 0.0004711415156835598
[Iteration 8030] [Rank 2] a = 1.1169642210006714, b = 0.999710626724374, delta = 0.0007031331188045442, c = 0.0004212534325936994, d = 0.0004220824676393942, m = 0.00047204694364231517
[Iteration 8040] [Rank 2] a = 0.9971500635147095, b = 0.9998251199122027, delta = 0.0007154860650189221, c = 0.0006502398208399998, d = 0.0006511379421395025, m = 0.00047244052145952635
[Iteration 8050] [Rank 2] a = 1.0859112739562988, b = 0.9996981566566515, delta = 0.0007669437327422202, c = 0.00039631329496904574, d = 0.00039710778688783663, m = 0.0004727436638336509
[Iteration 8060] [Rank 2] a = 1.0249273777008057, b = 0.9999362278781929, delta = 0.0006462086457759142, c = 0.0008724557562131254, d = 0.0008730084462435886, m = 0.000473947517854816
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8061 |     0.11034s |  92.9%
- batch.accumulate               |   8061 |     0.00083s |   0.7%
- batch.backward                 |   8061 |     0.05186s |  43.7%
- batch.evaluate                 |   8061 |     0.00275s |   2.3%
- batch.forward                  |   8061 |     0.02554s |  21.5%
- batch.mom                      |   8061 |     0.00126s |   1.1%
- batch.reduce                   |   8061 |     0.02534s |  21.3%
- batch.reporting.compr_err      |   8061 |     0.00001s |   0.0%
- batch.reporting.lr             |   8061 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8061 |     0.00001s |   0.0%
- batch.step                     |   8061 |     0.00048s |   0.4%
- batch.update_runavg            |   8061 |     0.00130s |   1.1%
- batch.wd                       |   8061 |     0.00001s |   0.0%
- epoch_metrics.collect          |     57 |     0.01335s |   0.1%
- reduce.combine                 |   8061 |     0.00606s |   5.1%
- reduce.flatpack                |   8061 |     0.00002s |   0.0%
- reduce.flatput                 |   8061 |     0.00018s |   0.1%
- reduce.gather.context          |   8061 |     0.00176s |   1.5%
- reduce.gather.tensors          |   8061 |     0.00348s |   2.9%
- reduce.heur_params             |   8061 |     0.01055s |   8.9%
- reduce.heur_params.alpha       |   8060 |     0.00824s |   6.9%
- reduce.heur_params.beta        |   8060 |     0.00224s |   1.9%
- reduce.memory                  |   8061 |     0.00045s |   0.4%
- reduce.pad                     |   8061 |     0.00028s |   0.2%
- reduce.threshold               |   8061 |     0.00235s |   2.0%
- test.last                      |     57 |     0.41234s |   2.5%
- test.runavg                    |     57 |     0.44319s |   2.7%
-----------------------------------------------------------------

[Iteration 8070] [Rank 0] a = 1.0052170753479004, b = 0.9998348783452711, delta = 0.0007281829603016376, c = 0.0006697566875407329, d = 0.0006705166363326198, m = 0.0004170754476005315
[Iteration 8080] [Rank 0] a = 1.0843286514282227, b = 0.999710626724374, delta = 0.0007445957744494081, c = 0.0004212534325936994, d = 0.0004225315282891456, m = 0.0004175495980685362
[Iteration 8090] [Rank 0] a = 1.0374243259429932, b = 0.999774116987388, delta = 0.0007071176078170538, c = 0.0005482339670926283, d = 0.000549201174645939, m = 0.0004182964111431727
[Iteration 8100] [Rank 0] a = 0.8826767206192017, b = 1.0006372114661244, delta = 0.0006713644834235311, c = 0.002274423104736937, d = 0.002252591848533639, m = 0.00041876114236313113
[Iteration 8110] [Rank 0] a = 1.0636039972305298, b = 0.9998166050316941, delta = 0.0006785719306208193, c = 0.0006332100592763512, d = 0.0006342118099565658, m = 0.00041995627025059624
[Iteration 8120] [Rank 0] a = 0.8889204263687134, b = 1.0002424872364843, delta = 0.0006604251102544367, c = 0.0014849744824740091, d = 0.0014816928854181337, m = 0.0004205005914936067
[Iteration 8130] [Rank 0] a = 0.9815603494644165, b = 1.0000338467547243, delta = 0.0006661636289209127, c = 0.0010676935094742644, d = 0.001067313535078321, m = 0.00042116256942825633
[Iteration 8140] [Rank 0] a = 0.8768048286437988, b = 1.000614309381956, delta = 0.0006627453840337694, c = 0.002228618918462296, d = 0.0022107601218529526, m = 0.0004216916096762594
[Iteration 8150] [Rank 0] a = 0.9846594333648682, b = 0.99976423765362, delta = 0.0007478097686544061, c = 0.0005284752985035676, d = 0.0005294079629299742, m = 0.0004220444748614909
[Iteration 8160] [Rank 0] a = 1.001830816268921, b = 0.9998210265517927, delta = 0.0007126900018192828, c = 0.000642053099763763, d = 0.0006430893935708816, m = 0.00042261555600086
[Iteration 8170] [Rank 0] a = 1.0085121393203735, b = 0.9997957237122662, delta = 0.0007328581996262074, c = 0.0005914474188494727, d = 0.0005933127477022862, m = 0.0004230755645708917
[Iteration 8180] [Rank 0] a = 0.9269318580627441, b = 1.0006097842340267, delta = 0.0006746994331479073, c = 0.0022195686192134608, d = 0.0021949048266040384, m = 0.00042368268295449335
[Iteration 8190] [Rank 0] a = 0.9121450185775757, b = 1.0037393914491581, delta = 0.0006127500673756003, c = 0.008478817757336537, d = 0.007819838525389837, m = 0.00042556392647896354
[Iteration 8200] [Rank 0] a = 0.9460729360580444, b = 1.0000831743397642, delta = 0.0007130917510949075, c = 0.0011663486799119523, d = 0.001165726903627681, m = 0.000425989248538335
cross_entropy                  - bits:18591839360.000, epoch: 59.000, ratio_transmit_grad:  0.174, value:  5.439 (split:train)
last_cross_entropy             - bits:18591839360.000, epoch: 59.000, ratio_transmit_grad:  0.174, value:  5.439 (split:train)
perplexity                     - bits:18591839360.000, epoch: 59.000, ratio_transmit_grad:  0.174, value:230.710 (split:train)
last_perplexity                - bits:18591839360.000, epoch: 59.000, ratio_transmit_grad:  0.174, value:230.710 (split:train)
last_cross_entropy             - bits:18591839360.000, epoch: 59.000, ratio_transmit_grad:  0.174, value:  5.204 (split:test)
last_perplexity                - bits:18591839360.000, epoch: 59.000, ratio_transmit_grad:  0.174, value:182.510 (split:test)
runavg_cross_entropy           - bits:18591839360.000, epoch: 59.000, ratio_transmit_grad:  0.174, value:  5.399 (split:test)
runavg_perplexity              - bits:18591839360.000, epoch: 59.000, ratio_transmit_grad:  0.174, value:221.757 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8200 |     0.11035s |  92.9%
- batch.accumulate               |   8200 |     0.00083s |   0.7%
- batch.backward                 |   8200 |     0.05167s |  43.5%
- batch.evaluate                 |   8200 |     0.00275s |   2.3%
- batch.forward                  |   8200 |     0.02543s |  21.4%
- batch.mom                      |   8200 |     0.00126s |   1.1%
- batch.reduce                   |   8200 |     0.02560s |  21.5%
- batch.reporting.compr_err      |   8200 |     0.00001s |   0.0%
- batch.reporting.lr             |   8200 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8200 |     0.00001s |   0.0%
- batch.step                     |   8200 |     0.00048s |   0.4%
- batch.update_runavg            |   8200 |     0.00130s |   1.1%
- batch.wd                       |   8200 |     0.00001s |   0.0%
- epoch_metrics.collect          |     58 |     0.00902s |   0.1%
- reduce.combine                 |   8200 |     0.00628s |   5.3%
- reduce.flatpack                |   8200 |     0.00002s |   0.0%
- reduce.flatput                 |   8200 |     0.00018s |   0.2%
- reduce.gather.context          |   8200 |     0.00120s |   1.0%
- reduce.gather.tensors          |   8200 |     0.00359s |   3.0%
- reduce.heur_params             |   8200 |     0.01102s |   9.3%
- reduce.heur_params.alpha       |   8199 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   8199 |     0.00223s |   1.9%
- reduce.memory                  |   8200 |     0.00045s |   0.4%
- reduce.pad                     |   8200 |     0.00029s |   0.2%
- reduce.threshold               |   8200 |     0.00234s |   2.0%
- test.last                      |     58 |     0.41231s |   2.5%
- test.runavg                    |     58 |     0.44305s |   2.7%
-----------------------------------------------------------------

[Iteration 8210] [Rank 0] a = 0.9704216718673706, b = 0.9998916499732611, delta = 0.0007445634109899402, c = 0.0007832999456740243, d = 0.0007841635238466231, m = 0.00042627730150506004
[Iteration 8220] [Rank 0] a = 0.9748870134353638, b = 0.9998394725810276, delta = 0.0007427497766911983, c = 0.0006789451592971842, d = 0.0006798432805966869, m = 0.0004271058139464086
timer                          - epoch: -1.000, value:  0.007 (event:reduce.combine)
[Iteration 8230] [Rank 0] a = 1.0805772542953491, b = 0.9997124056952614, delta = 0.0007408800884149969, c = 0.00042481137466480643, d = 0.00042574403909121316, m = 0.00042775360469880335
[Iteration 8240] [Rank 0] a = 1.1169137954711914, b = 0.9997051516392268, delta = 0.0007273990195244551, c = 0.0004103032613651464, d = 0.0004111322964108413, m = 0.00042840700776820644
[Iteration 8250] [Rank 0] a = 1.0363056659698486, b = 0.9998401461719848, delta = 0.0006962285842746496, c = 0.0006802923412464383, d = 0.0006815013506880766, m = 0.000428851224964588
[Iteration 8260] [Rank 0] a = 1.1280570030212402, b = 0.9996559449599836, delta = 0.0007957405759952962, c = 0.0003118898928157861, d = 0.00031247712597315327, m = 0.00042919505678294065
[Iteration 8270] [Rank 0] a = 0.8754749894142151, b = 0.9999733099248443, delta = 0.0006880243890918791, c = 0.0009466198496759112, d = 0.0009468961946911428, m = 0.0004302288737834585
[Iteration 8280] [Rank 0] a = 0.901245653629303, b = 1.0005835487384847, delta = 0.000655711570288986, c = 0.002167097609446357, d = 0.002146717164573025, m = 0.0004308859468400591
[Iteration 8290] [Rank 0] a = 0.9343740344047546, b = 0.9998207156636606, delta = 0.0007457169704139233, c = 0.0006414313234794918, d = 0.0006422258153982828, m = 0.0004312615317995913
[Iteration 8300] [Rank 0] a = 1.0738762617111206, b = 0.9997587798398795, delta = 0.0007006936939433217, c = 0.0005175596704019186, d = 0.0005184232485745174, m = 0.000431999357857345
[Iteration 8310] [Rank 0] a = 0.9626988172531128, b = 0.9999143793505492, delta = 0.0006993947317823768, c = 0.0008287587006796256, d = 0.0008293804769638968, m = 0.00043246286638632623
[Iteration 8320] [Rank 0] a = 1.0586580038070679, b = 0.999763356803933, delta = 0.0007233981741592288, c = 0.000526713599031466, d = 0.000527473547823353, m = 0.000433142225391684
[Iteration 8330] [Rank 0] a = 1.0780998468399048, b = 0.9997066024504312, delta = 0.0007895632297731936, c = 0.0004132048840250784, d = 0.00041424117783219703, m = 0.00043346401124745863
cross_entropy                  - bits:19044921472.000, epoch: 60.000, ratio_transmit_grad:  0.176, value:  5.422 (split:train)

[Iteration 8070] [Rank 3] a = 1.088836908340454, b = 0.9997129411136843, delta = 0.0007351732929237187, c = 0.000425882211598829, d = 0.00042660761726381197, m = 0.0005164930106568281
[Iteration 8080] [Rank 3] a = 1.050419569015503, b = 0.9997731152367592, delta = 0.000725132820662111, c = 0.0005462304657321991, d = 0.0005471631301586058, m = 0.0005168723728889418
[Iteration 8090] [Rank 3] a = 0.9458644390106201, b = 0.999970028327791, delta = 0.0006939903250895441, c = 0.0009400566555641602, d = 0.00094022937119868, m = 0.0005175173912540114
[Iteration 8100] [Rank 3] a = 1.1036006212234497, b = 0.9996899526647798, delta = 0.0007705815369263291, c = 0.0003799053096896683, d = 0.00038128703476582646, m = 0.0005177886332141948
[Iteration 8110] [Rank 3] a = 0.9770984053611755, b = 0.9998325812273955, delta = 0.0007290749344974756, c = 0.0006651624516625072, d = 0.0006661987454696257, m = 0.0005182552389140136

[Iteration 8070] [Rank 1] a = 1.0092997550964355, b = 0.9999732062954637, delta = 0.0006860411958768964, c = 0.0009464125909144875, d = 0.0009467580221835271, m = 0.0006317947711719214
[Iteration 8080] [Rank 1] a = 1.103934645652771, b = 0.9996988302475647, delta = 0.0007562483078800142, c = 0.00039766047691829987, d = 0.00039855859821780263, m = 0.0006319932999659992
[Iteration 8090] [Rank 1] a = 0.9540552496910095, b = 0.9999485943175836, delta = 0.0007311753579415381, c = 0.0008971886350763554, d = 0.0008979485838682422, m = 0.0006321161807830779
[Iteration 8100] [Rank 1] a = 0.9744613766670227, b = 1.0000172315106945, delta = 0.0007001407793723047, c = 0.0010344630213926622, d = 0.0010339794176160069, m = 0.0006324355103528119
[Iteration 8110] [Rank 1] a = 1.0350531339645386, b = 0.9997573635717596, delta = 0.0007610801258124411, c = 0.0005147271339957945, d = 0.0005158325140567209, m = 0.0006327679745410212
[Iteration 8120] [Rank 3] a = 0.930799663066864, b = 0.9999823947672156, delta = 0.0007085832767188549, c = 0.0009647895344273901, d = 0.00096496225006191, m = 0.0005186368111056844
[Iteration 8130] [Rank 3] a = 0.9789581298828125, b = 0.9999643114402946, delta = 0.0007210021722130477, c = 0.000928622880558952, d = 0.0009291064843356074, m = 0.0005188774539452987
[Iteration 8140] [Rank 3] a = 1.0544180870056152, b = 0.9997175180776279, delta = 0.0007673663203604519, c = 0.00043503614022837636, d = 0.0004359342615278791, m = 0.0005191910131678746
[Iteration 8150] [Rank 3] a = 1.1211413145065308, b = 0.9996646152838359, delta = 0.0007890416891314089, c = 0.0003292305425215702, d = 0.00033012866382107293, m = 0.0005195251238917393
[Iteration 8160] [Rank 3] a = 1.064146637916565, b = 0.9997259293283774, delta = 0.0007558902725577354, c = 0.0004518586430306012, d = 0.0004529294799646237, m = 0.0005199400181873601
[Iteration 8120] [Rank 1] a = 1.0093820095062256, b = 0.9998669861810122, delta = 0.0007263684528879821, c = 0.0007339723604551803, d = 0.0007352159130237226, m = 0.0006331379232230129
[Iteration 8130] [Rank 1] a = 0.9655798673629761, b = 0.9999552438694971, delta = 0.0006955285207368433, c = 0.000910487738934377, d = 0.0009110404289648402, m = 0.0006342033175557937
[Iteration 8140] [Rank 1] a = 0.9856436848640442, b = 0.9998979195507247, delta = 0.0007103219395503402, c = 0.0007958391007401591, d = 0.0007964263338975262, m = 0.0006344230190497856
[Iteration 8150] [Rank 1] a = 1.05767822265625, b = 0.9996831822125717, delta = 0.0007862697239033878, c = 0.000366364403943319, d = 0.00036715889586210994, m = 0.0006345358822071302
[Iteration 8160] [Rank 1] a = 1.0012637376785278, b = 0.999862564660849, delta = 0.0007446515955962241, c = 0.0007251293199677685, d = 0.0007265455881708305, m = 0.0006346439313104144
[Iteration 8170] [Rank 3] a = 1.0562686920166016, b = 0.999725963871502, delta = 0.0007786053465679288, c = 0.0004519277292844091, d = 0.0004524804193148723, m = 0.0005202533156207595
[Iteration 8180] [Rank 3] a = 0.9374805688858032, b = 1.0017296362158856, delta = 0.0006736782379448414, c = 0.004459275881411926, d = 0.004272224849227024, m = 0.0005211326145179958
[Iteration 8190] [Rank 3] a = 1.037588357925415, b = 0.9998507336401279, delta = 0.0007048000115901232, c = 0.0007014672780385611, d = 0.0007023653993380639, m = 0.000521605209942904
[Iteration 8200] [Rank 3] a = 1.0046254396438599, b = 0.9999136194017628, delta = 0.0007545081316493452, c = 0.0008272388030958518, d = 0.0008276187774917952, m = 0.0005219559224809756
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8200 |     0.11046s |  92.9%
- batch.accumulate               |   8200 |     0.00082s |   0.7%
[Iteration 8170] [Rank 1] a = 1.0464377403259277, b = 0.9997372422016234, delta = 0.0007658688118681312, c = 0.00047448439115269, d = 0.00047538251245219276, m = 0.0006348893515556082
[Iteration 8180] [Rank 1] a = 0.9592429399490356, b = 0.9999959011298332, delta = 0.0007042447105050087, c = 0.0009918022596662808, d = 0.0009919058890469929, m = 0.0006362293717756917
[Iteration 8190] [Rank 1] a = 1.0225656032562256, b = 0.9997558782173906, delta = 0.000718817813321948, c = 0.0005117564250820546, d = 0.0005126890895084613, m = 0.0006377456211801406
[Iteration 8200] [Rank 1] a = 0.991547703742981, b = 1.0000370247223953, delta = 0.0007280330173671246, c = 0.0010740494448245915, d = 0.0010736003841748402, m = 0.000638032807984817
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8200 |     0.11036s |  92.9%
- batch.accumulate               |   8200 |     0.00083s |   0.7%
- batch.backward                 |   8200 |     0.05174s |  43.5%
- batch.evaluate                 |   8200 |     0.00277s |   2.3%
- batch.forward                  |   8200 |     0.02538s |  21.4%
- batch.mom                      |   8200 |     0.00126s |   1.1%
- batch.reduce                   |   8200 |     0.02571s |  21.6%
- batch.reporting.compr_err      |   8200 |     0.00001s |   0.0%
- batch.reporting.lr             |   8200 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8200 |     0.00001s |   0.0%
- batch.step                     |   8200 |     0.00047s |   0.4%
- batch.update_runavg            |   8200 |     0.00130s |   1.1%
- batch.wd                       |   8200 |     0.00001s |   0.0%
- epoch_metrics.collect          |     58 |     0.00888s |   0.1%
- reduce.combine                 |   8200 |     0.00601s |   5.1%
- reduce.flatpack                |   8200 |     0.00002s |   0.0%
- reduce.flatput                 |   8200 |     0.00019s |   0.2%
- batch.backward                 |   8200 |     0.05177s |  43.6%
- batch.evaluate                 |   8200 |     0.00276s |   2.3%
- batch.forward                  |   8200 |     0.02541s |  21.4%
- batch.mom                      |   8200 |     0.00126s |   1.1%
- batch.reduce                   |   8200 |     0.02557s |  21.5%
- batch.reporting.compr_err      |   8200 |     0.00001s |   0.0%
- batch.reporting.lr             |   8200 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8200 |     0.00001s |   0.0%
- batch.step                     |   8200 |     0.00048s |   0.4%
- batch.update_runavg            |   8200 |     0.00130s |   1.1%
- batch.wd                       |   8200 |     0.00001s |   0.0%
- epoch_metrics.collect          |     58 |     0.00908s |   0.1%
- reduce.combine                 |   8200 |     0.00608s |   5.1%
- reduce.flatpack                |   8200 |     0.00002s |   0.0%
- reduce.flatput                 |   8200 |     0.00023s |   0.2%
- reduce.gather.context          |   8200 |     0.00253s |   2.1%
- reduce.gather.tensors          |   8200 |     0.00319s |   2.7%
- reduce.heur_params             |   8200 |     0.01046s |   8.8%
- reduce.heur_params.alpha       |   8199 |     0.00810s |   6.8%
- reduce.gather.context          |   8200 |     0.00136s |   1.1%
- reduce.gather.tensors          |   8200 |     0.00351s |   3.0%
- reduce.heur_params             |   8200 |     0.01087s |   9.1%
- reduce.heur_params.beta        |   8199 |     0.00228s |   1.9%
- reduce.memory                  |   8200 |     0.00045s |   0.4%
- reduce.pad                     |   8200 |     0.00027s |   0.2%
- reduce.threshold               |   8200 |     0.00241s |   2.0%
- test.last                      |     58 |     0.41232s |   2.5%
- test.runavg                    |     58 |     0.44304s |   2.7%
-----------------------------------------------------------------

[Iteration 8210] [Rank 3] a = 0.9751455783843994, b = 0.999952204074336, delta = 0.0007066773832775652, c = 0.0009044081485992814, d = 0.0009050299248835526, m = 0.0005224336967735083
[Iteration 8220] [Rank 3] a = 0.811251699924469, b = 1.0051844568700805, delta = 0.0006475829286500812, c = 0.011369006642263329, d = 0.0104327151875317, m = 0.0005237924127176166
[Iteration 8230] [Rank 3] a = 0.9292318820953369, b = 1.0003295359091064, delta = 0.000670545850880444, c = 0.0016590718420699292, d = 0.0016514723541510596, m = 0.0005241899951002284
- reduce.heur_params.alpha       |   8199 |     0.00832s |   7.0%
- reduce.heur_params.beta        |   8199 |     0.00248s |   2.1%
- reduce.memory                  |   8200 |     0.00046s |   0.4%
- reduce.pad                     |   8200 |     0.00019s |   0.2%
- reduce.threshold               |   8200 |     0.00263s |   2.2%
- test.last                      |     58 |     0.41232s |   2.5%
- test.runavg                    |     58 |     0.44304s |   2.7%
-----------------------------------------------------------------

[Iteration 8210] [Rank 1] a = 1.1068878173828125, b = 0.9996866192533576, delta = 0.0007986108539626002, c = 0.00037323848619720556, d = 0.00037417115062361224, m = 0.000638187605648394
[Iteration 8220] [Rank 1] a = 0.9479710459709167, b = 1.0001768898414014, delta = 0.0007061678334139287, c = 0.001353779686492798, d = 0.0013505671756907304, m = 0.0006384817959187173

[Iteration 8070] [Rank 2] a = 0.9869663119316101, b = 0.9998307158985955, delta = 0.0007283563609234989, c = 0.0006614317939568803, d = 0.000662399001510191, m = 0.00047429794557750507
[Iteration 8080] [Rank 2] a = 1.0077755451202393, b = 0.9999642423540409, delta = 0.0006774780340492725, c = 0.0009284847080513362, d = 0.0009287955961934718, m = 0.00047478963253444435
[Iteration 8090] [Rank 2] a = 0.9055135250091553, b = 1.0003312457937015, delta = 0.0006390492198988795, c = 0.0016624916116334204, d = 0.0016539249161612402, m = 0.0004756443033307768
[Iteration 8100] [Rank 2] a = 0.9720286130905151, b = 1.000066749083014, delta = 0.0006716635543853045, c = 0.0011334981662262935, d = 0.0011321855274039434, m = 0.00047604269509913806
[Iteration 8110] [Rank 2] a = 1.0532702207565308, b = 0.999756137290827, delta = 0.0007451105630025268, c = 0.0005122745719856139, d = 0.0005132072364120206, m = 0.0004762695523540622
[Iteration 8240] [Rank 3] a = 0.9339010715484619, b = 0.9999773341991263, delta = 0.0007121734670363367, c = 0.0009546683982445321, d = 0.000954772027625244, m = 0.0005244729442874716
[Iteration 8250] [Rank 3] a = 1.0268040895462036, b = 0.9997840308643254, delta = 0.0007360677700489759, c = 0.000568061721935497, d = 0.0005689598432349998, m = 0.000524890776101264
[Iteration 8260] [Rank 3] a = 1.0529776811599731, b = 0.9997318362026439, delta = 0.0007494196761399508, c = 0.0004636723924317529, d = 0.00046463959998506357, m = 0.0005251757713026547
[Iteration 8270] [Rank 3] a = 0.9892383217811584, b = 0.9999520831733922, delta = 0.0007183743291534483, c = 0.0009041663467109538, d = 0.0009047535798683209, m = 0.000525501996036231
[Iteration 8280] [Rank 3] a = 1.0300301313400269, b = 0.9998116826362804, delta = 0.0007211313350126147, c = 0.0006233652681087247, d = 0.0006242633894082276, m = 0.000526125072748953
[Iteration 8230] [Rank 1] a = 1.016861081123352, b = 0.9998347919874562, delta = 0.0007105337572284043, c = 0.000669583971906213, d = 0.0006705166363326198, m = 0.0006388819937108195
[Iteration 8240] [Rank 1] a = 1.052659034729004, b = 0.9997614223889358, delta = 0.0007317306590266526, c = 0.0005228447688182233, d = 0.0005237774332446301, m = 0.0006390925722910201
[Iteration 8250] [Rank 1] a = 1.0212175846099854, b = 0.9998509408988846, delta = 0.0007081725634634495, c = 0.0007018817955614085, d = 0.000702987175622335, m = 0.0006394385773357664
[Iteration 8260] [Rank 1] a = 0.9881346225738525, b = 1.0000668527123941, delta = 0.000693473091814667, c = 0.0011337054249877174, d = 0.001132496415546079, m = 0.0006397200190885492
[Iteration 8270] [Rank 1] a = 0.9569848775863647, b = 1.0002103103154252, delta = 0.0006976125878281891, c = 0.0014206206370519457, d = 0.0014146792192244661, m = 0.0006399950753079737
[Iteration 8290] [Rank 3] a = 0.9691023230552673, b = 0.9998738602631505, delta = 0.0007218209211714566, c = 0.0007477205249629533, d = 0.000748722275643168, m = 0.0005267897722300178
[Iteration 8300] [Rank 3] a = 0.9322657585144043, b = 0.9999760906465581, delta = 0.0006923660985194147, c = 0.0009521812931074476, d = 0.0009522503793612555, m = 0.0005287737442954519
[Iteration 8310] [Rank 3] a = 0.9344074130058289, b = 1.0002640766894133, delta = 0.0006699988734908402, c = 0.0015281533911039496, d = 0.001521348395103871, m = 0.0005291395440058285
[Iteration 8320] [Rank 3] a = 1.0548028945922852, b = 0.9998557423934211, delta = 0.000652708753477782, c = 0.0007114847848407073, d = 0.0007126247080285377, m = 0.0005301747738524682
[Iteration 8330] [Rank 3] a = 0.9962181448936462, b = 0.9999146729671257, delta = 0.000663662445731461, c = 0.0008293459338369929, d = 0.0008301749688826877, m = 0.0005307779082649817
--- Timer summary -----------------------------------------------
[Iteration 8280] [Rank 1] a = 1.06499183177948, b = 0.9997353423297759, delta = 0.0007451468845829368, c = 0.00047068464719325523, d = 0.0004717900272541817, m = 0.0006401960886256041
[Iteration 8290] [Rank 1] a = 0.9320700168609619, b = 1.0001773043589113, delta = 0.0007176153012551367, c = 0.0013546087215384928, d = 0.0013503599169293068, m = 0.0006403374883473628
[Iteration 8300] [Rank 1] a = 1.0540605783462524, b = 0.99974161190688, delta = 0.0007697346736676991, c = 0.00048322380225938996, d = 0.0004839837510512769, m = 0.0006406607633186619
[Iteration 8310] [Rank 1] a = 0.9933090209960938, b = 0.9998663816763022, delta = 0.0007511763251386583, c = 0.000732763351013542, d = 0.0007336269291861408, m = 0.0006407726058750531
[Iteration 8320] [Rank 1] a = 0.975476086139679, b = 1.0001615181503696, delta = 0.00070113007677719, c = 0.0013230363035482804, d = 0.0013186838695583823, m = 0.0006412659971931152
[Iteration 8120] [Rank 2] a = 0.9001769423484802, b = 1.0005369846180432, delta = 0.0006850559148006141, c = 0.002073969339313301, d = 0.0020542797569780484, m = 0.00047671071928888457
[Iteration 8130] [Rank 2] a = 0.8731356859207153, b = 1.0005832033073332, delta = 0.0006761336699128151, c = 0.002166406746908278, d = 0.0021400157979536583, m = 0.0004772247644060587
[Iteration 8140] [Rank 2] a = 1.0387578010559082, b = 0.9997540819748993, delta = 0.0007255977834574878, c = 0.0005081639398840436, d = 0.0005092693199449701, m = 0.00047781676121636945
[Iteration 8150] [Rank 2] a = 1.1995097398757935, b = 0.9996401932960668, delta = 0.0007621414260938764, c = 0.0002803865610793815, d = 0.0002811465098712685, m = 0.00047887041474188136
[Iteration 8160] [Rank 2] a = 1.173625111579895, b = 0.99962223087252, delta = 0.0008150105713866651, c = 0.000244461709099271, d = 0.00024497985600283035, m = 0.00047916795832528004
  Event                          |  Count | Average time |  Frac.
- batch                          |   8339 |     0.11049s |  92.9%
- batch.accumulate               |   8339 |     0.00082s |   0.7%
- batch.backward                 |   8339 |     0.05174s |  43.5%
- batch.evaluate                 |   8339 |     0.00277s |   2.3%
- batch.forward                  |   8339 |     0.02538s |  21.4%
- batch.mom                      |   8339 |     0.00126s |   1.1%
- batch.reduce                   |   8339 |     0.02574s |  21.7%
- batch.reporting.compr_err      |   8339 |     0.00001s |   0.0%
- batch.reporting.lr             |   8339 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8339 |     0.00001s |   0.0%
- batch.step                     |   8339 |     0.00047s |   0.4%
- batch.update_runavg            |   8339 |     0.00130s |   1.1%
- batch.wd                       |   8339 |     0.00001s |   0.0%
- epoch_metrics.collect          |     59 |     0.00875s |   0.1%
[Iteration 8330] [Rank 1] a = 1.055371642112732, b = 0.9997681755698716, delta = 0.0007328648352995515, c = 0.0005363511314376687, d = 0.000537594684006211, m = 0.0006417420706461977
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8339 |     0.11039s |  92.9%
- batch.accumulate               |   8339 |     0.00083s |   0.7%
- batch.backward                 |   8339 |     0.05176s |  43.6%
- batch.evaluate                 |   8339 |     0.00276s |   2.3%
- batch.forward                  |   8339 |     0.02542s |  21.4%
- batch.mom                      |   8339 |     0.00126s |   1.1%
- batch.reduce                   |   8339 |     0.02560s |  21.5%
- batch.reporting.compr_err      |   8339 |     0.00001s |   0.0%
- batch.reporting.lr             |   8339 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8339 |     0.00001s |   0.0%
[Iteration 8170] [Rank 2] a = 1.0046932697296143, b = 0.9998885583634405, delta = 0.0007046130485832691, c = 0.0007771167259582168, d = 0.0007775657866079682, m = 0.00047952000203573843
[Iteration 8180] [Rank 2] a = 1.0941976308822632, b = 0.9997479160271293, delta = 0.0007105031399987638, c = 0.0004958320435793325, d = 0.0004967301648788353, m = 0.000480335116910402
[Iteration 8190] [Rank 2] a = 1.0439155101776123, b = 0.9997982453604262, delta = 0.0007244938751682639, c = 0.0005964907153774499, d = 0.0005975960954383763, m = 0.00048071911981148414
[Iteration 8200] [Rank 2] a = 0.9688165187835693, b = 0.9999153811012219, delta = 0.0007535735494457185, c = 0.0008307622020400549, d = 0.0008311767195629023, m = 0.00048115662714583206
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8200 |     0.11038s |  92.9%
- batch.accumulate               |   8200 |     0.00083s |   0.7%
- reduce.combine                 |   8339 |     0.00602s |   5.1%
- reduce.flatpack                |   8339 |     0.00002s |   0.0%
- batch.step                     |   8339 |     0.00048s |   0.4%
- batch.update_runavg            |   8339 |     0.00130s |   1.1%
- batch.wd                       |   8339 |     0.00001s |   0.0%
- epoch_metrics.collect          |     59 |     0.00894s |   0.1%
- reduce.combine                 |   8339 |     0.00609s |   5.1%
- batch.backward                 |   8200 |     0.05185s |  43.6%
- batch.evaluate                 |   8200 |     0.00275s |   2.3%
- batch.forward                  |   8200 |     0.02554s |  21.5%
- batch.mom                      |   8200 |     0.00126s |   1.1%
- batch.reduce                   |   8200 |     0.02539s |  21.4%
- batch.reporting.compr_err      |   8200 |     0.00001s |   0.0%
- batch.reporting.lr             |   8200 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8200 |     0.00001s |   0.0%
- batch.step                     |   8200 |     0.00048s |   0.4%
- batch.update_runavg            |   8200 |     0.00130s |   1.1%
- batch.wd                       |   8200 |     0.00001s |   0.0%
- epoch_metrics.collect          |     58 |     0.01362s |   0.1%
- reduce.combine                 |   8200 |     0.00606s |   5.1%
- reduce.flatpack                |   8200 |     0.00002s |   0.0%
- reduce.flatput                 |   8200 |     0.00018s |   0.2%
- reduce.flatput                 |   8339 |     0.00019s |   0.2%
- reduce.gather.context          |   8339 |     0.00252s |   2.1%
- reduce.gather.tensors          |   8339 |     0.00320s |   2.7%
- reduce.heur_params             |   8339 |     0.01046s |   8.8%
- reduce.heur_params.alpha       |   8338 |     0.00810s |   6.8%
- reduce.heur_params.beta        |   8338 |     0.00228s |   1.9%
- reduce.memory                  |   8339 |     0.00045s |   0.4%
- reduce.pad                     |   8339 |     0.00027s |   0.2%
- reduce.threshold               |   8339 |     0.00241s |   2.0%
- test.last                      |     59 |     0.41220s |   2.5%
- test.runavg                    |     59 |     0.44291s |   2.7%
-----------------------------------------------------------------
- reduce.flatpack                |   8339 |     0.00002s |   0.0%
- reduce.flatput                 |   8339 |     0.00023s |   0.2%
- reduce.gather.context          |   8339 |     0.00135s |   1.1%
- reduce.gather.tensors          |   8339 |     0.00353s |   3.0%
- reduce.heur_params             |   8339 |     0.01087s |   9.1%
- reduce.heur_params.alpha       |   8338 |     0.00832s |   7.0%
- reduce.heur_params.beta        |   8338 |     0.00248s |   2.1%
- reduce.memory                  |   8339 |     0.00046s |   0.4%
- reduce.pad                     |   8339 |     0.00020s |   0.2%
- reduce.threshold               |   8339 |     0.00263s |   2.2%
- test.last                      |     59 |     0.41221s |   2.5%
- test.runavg                    |     59 |     0.44291s |   2.7%
-----------------------------------------------------------------
- reduce.gather.context          |   8200 |     0.00178s |   1.5%
- reduce.gather.tensors          |   8200 |     0.00350s |   2.9%
- reduce.heur_params             |   8200 |     0.01055s |   8.9%
- reduce.heur_params.alpha       |   8199 |     0.00823s |   6.9%
- reduce.heur_params.beta        |   8199 |     0.00224s |   1.9%
- reduce.memory                  |   8200 |     0.00045s |   0.4%
- reduce.pad                     |   8200 |     0.00028s |   0.2%
- reduce.threshold               |   8200 |     0.00236s |   2.0%
- test.last                      |     58 |     0.41232s |   2.5%
- test.runavg                    |     58 |     0.44304s |   2.7%
-----------------------------------------------------------------

[Iteration 8210] [Rank 2] a = 1.0255192518234253, b = 0.9997200397256923, delta = 0.0007695051608607173, c = 0.0004400794367563534, d = 0.0004410121011827601, m = 0.0004814767302933466
[Iteration 8220] [Rank 2] a = 1.0499626398086548, b = 0.9997298327014288, delta = 0.0007589078741148114, c = 0.0004596653897108944, d = 0.00046070168351801296, m = 0.0004819115752149787
[Iteration 8230] [Rank 2] a = 1.0848186016082764, b = 0.9997241503574765, delta = 0.0007361065363511443, c = 0.00044830070095949406, d = 0.0004490261066244771, m = 0.00048265858085036565
[Iteration 8240] [Rank 2] a = 1.0106571912765503, b = 0.9998372790925263, delta = 0.0007104917312972248, c = 0.0006745581821803822, d = 0.0006758017347489245, m = 0.0004834245430542639
[Iteration 8250] [Rank 2] a = 1.0771065950393677, b = 0.9997302644904835, delta = 0.0007417615852318704, c = 0.0004605289678834932, d = 0.00046115074416776437, m = 0.0004838182320759678
[Iteration 8260] [Rank 2] a = 1.0515516996383667, b = 0.9996808332801799, delta = 0.000799552071839571, c = 0.00036166653868438146, d = 0.00036242648747626845, m = 0.00048428480019358124
[Iteration 8270] [Rank 2] a = 0.9857324361801147, b = 0.9998420115007904, delta = 0.0007120351656340063, c = 0.0006840229989520651, d = 0.0006851629221398956, m = 0.00048482749125352214
[Iteration 8280] [Rank 2] a = 0.9498283863067627, b = 0.9999896660954274, delta = 0.0007224635919556022, c = 0.000979332190853954, d = 0.0009794703633615699, m = 0.00048511159394741364
[Iteration 8290] [Rank 2] a = 1.0316987037658691, b = 0.9997189343457183, delta = 0.0007756627164781094, c = 0.00043786867663450044, d = 0.0004386286254263874, m = 0.00048569027151328104
[Iteration 8300] [Rank 2] a = 1.04035222530365, b = 0.9997350314416554, delta = 0.0007516489131376147, c = 0.0004700628709089841, d = 0.00047116825096991054, m = 0.0004863648132413797
[Iteration 8310] [Rank 2] a = 1.042117714881897, b = 0.9997861552665321, delta = 0.0007404149509966373, c = 0.0005723105265446831, d = 0.0005733813634787057, m = 0.0004867356341813123
[Iteration 8320] [Rank 2] a = 0.9397972822189331, b = 1.000353957896974, delta = 0.0006861535948701203, c = 0.0017079158235121178, d = 0.0016999018180704009, m = 0.0004874153933876253
[Iteration 8330] [Rank 2] a = 0.9480270743370056, b = 1.0000641756200708, delta = 0.0007164429407566786, c = 0.0011283512403176047, d = 0.0011275222052719099, m = 0.0004877776901400279
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8339 |     0.11041s |  92.9%
- batch.accumulate               |   8339 |     0.00083s |   0.7%
- batch.backward                 |   8339 |     0.05184s |  43.6%
- batch.evaluate                 |   8339 |     0.00275s |   2.3%
- batch.forward                  |   8339 |     0.02553s |  21.5%
- batch.mom                      |   8339 |     0.00126s |   1.1%
- batch.reduce                   |   8339 |     0.02544s |  21.4%
- batch.reporting.compr_err      |   8339 |     0.00001s |   0.0%
- batch.reporting.lr             |   8339 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8339 |     0.00001s |   0.0%
- batch.step                     |   8339 |     0.00048s |   0.4%
- batch.update_runavg            |   8339 |     0.00130s |   1.1%
- batch.wd                       |   8339 |     0.00001s |   0.0%
- epoch_metrics.collect          |     59 |     0.01345s |   0.1%
- reduce.combine                 |   8339 |     0.00607s |   5.1%
- reduce.flatpack                |   8339 |     0.00002s |   0.0%
- reduce.flatput                 |   8339 |     0.00018s |   0.2%
- reduce.gather.context          |   8339 |     0.00180s |   1.5%
- reduce.gather.tensors          |   8339 |     0.00352s |   3.0%
- reduce.heur_params             |   8339 |     0.01055s |   8.9%
- reduce.heur_params.alpha       |   8338 |     0.00823s |   6.9%
- reduce.heur_params.beta        |   8338 |     0.00224s |   1.9%
- reduce.memory                  |   8339 |     0.00045s |   0.4%
- reduce.pad                     |   8339 |     0.00028s |   0.2%
- reduce.threshold               |   8339 |     0.00236s |   2.0%
- test.last                      |     59 |     0.41220s |   2.5%
- test.runavg                    |     59 |     0.44292s |   2.7%
-----------------------------------------------------------------
last_cross_entropy             - bits:19044921472.000, epoch: 60.000, ratio_transmit_grad:  0.176, value:  5.422 (split:train)
perplexity                     - bits:19044921472.000, epoch: 60.000, ratio_transmit_grad:  0.176, value:226.871 (split:train)
last_perplexity                - bits:19044921472.000, epoch: 60.000, ratio_transmit_grad:  0.176, value:226.871 (split:train)
last_cross_entropy             - bits:19044921472.000, epoch: 60.000, ratio_transmit_grad:  0.176, value:  5.217 (split:test)
last_perplexity                - bits:19044921472.000, epoch: 60.000, ratio_transmit_grad:  0.176, value:184.999 (split:test)
runavg_cross_entropy           - bits:19044921472.000, epoch: 60.000, ratio_transmit_grad:  0.176, value:  5.411 (split:test)
runavg_perplexity              - bits:19044921472.000, epoch: 60.000, ratio_transmit_grad:  0.176, value:224.511 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8339 |     0.11038s |  92.9%
- batch.accumulate               |   8339 |     0.00083s |   0.7%
- batch.backward                 |   8339 |     0.05167s |  43.5%
- batch.evaluate                 |   8339 |     0.00275s |   2.3%
- batch.forward                  |   8339 |     0.02543s |  21.4%
- batch.mom                      |   8339 |     0.00126s |   1.1%
- batch.reduce                   |   8339 |     0.02564s |  21.6%
- batch.reporting.compr_err      |   8339 |     0.00001s |   0.0%
- batch.reporting.lr             |   8339 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8339 |     0.00001s |   0.0%
- batch.step                     |   8339 |     0.00048s |   0.4%
- batch.update_runavg            |   8339 |     0.00130s |   1.1%
- batch.wd                       |   8339 |     0.00001s |   0.0%
- epoch_metrics.collect          |     59 |     0.00889s |   0.1%
- reduce.combine                 |   8339 |     0.00629s |   5.3%
- reduce.flatpack                |   8339 |     0.00002s |   0.0%
- reduce.flatput                 |   8339 |     0.00018s |   0.2%
- reduce.gather.context          |   8339 |     0.00120s |   1.0%
- reduce.gather.tensors          |   8339 |     0.00361s |   3.0%
- reduce.heur_params             |   8339 |     0.01103s |   9.3%
- reduce.heur_params.alpha       |   8338 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   8338 |     0.00224s |   1.9%
- reduce.memory                  |   8339 |     0.00045s |   0.4%
- reduce.pad                     |   8339 |     0.00029s |   0.2%
- reduce.threshold               |   8339 |     0.00235s |   2.0%
- test.last                      |     59 |     0.41219s |   2.5%
- test.runavg                    |     59 |     0.44292s |   2.7%
-----------------------------------------------------------------

[Iteration 8340] [Rank 0] a = 1.0068823099136353, b = 0.9998266916244293, delta = 0.0007699633133597672, c = 0.0006533832453882594, d = 0.0006545922548298977, m = 0.00043387587879618406
[Iteration 8350] [Rank 0] a = 0.987111508846283, b = 0.9998220973886927, delta = 0.000737967377062887, c = 0.0006441947736318081, d = 0.0006451965243120226, m = 0.0004345109697073486
[Iteration 8360] [Rank 0] a = 0.9757291674613953, b = 0.9998444467911775, delta = 0.0007513418677262962, c = 0.0006888935798455224, d = 0.000689929873652641, m = 0.0004350013202937343
[Iteration 8370] [Rank 0] a = 0.9479813575744629, b = 0.999949768783895, delta = 0.0007193387136794627, c = 0.0008995375677058241, d = 0.0009000211714824795, m = 0.000435844975942308
[Iteration 8380] [Rank 0] a = 1.0323631763458252, b = 0.9996995383816023, delta = 0.0007791370153427124, c = 0.0003990767451213619, d = 0.00040014758205538447, m = 0.0004370788957041424
[Iteration 8390] [Rank 0] a = 0.9570135474205017, b = 1.0000687698559285, delta = 0.0006773676723241806, c = 0.001137539712074056, d = 0.0011363997888862256, m = 0.0004378352079630998
[Iteration 8400] [Rank 0] a = 1.0680816173553467, b = 0.9997043744189393, delta = 0.000762870186008513, c = 0.0004087488206544686, d = 0.0004095433125732595, m = 0.00043818935083091967
[Iteration 8410] [Rank 0] a = 1.0140877962112427, b = 0.9997220777700213, delta = 0.0007879116456024349, c = 0.0004441555257310198, d = 0.000445433621426466, m = 0.0004387064963370082
[Iteration 8420] [Rank 0] a = 1.0251096487045288, b = 0.999841545168589, delta = 0.0007141679525375366, c = 0.0006830903345256585, d = 0.0006842302577134889, m = 0.00043928295535691384
[Iteration 8430] [Rank 0] a = 1.0445746183395386, b = 0.99976423765362, delta = 0.0007330980733968318, c = 0.0005284752985035676, d = 0.0005294079629299742, m = 0.0004397139540031409
[Iteration 8440] [Rank 0] a = 0.9543355703353882, b = 1.000008163939884, delta = 0.0006936590652912855, c = 0.0010163278797680872, d = 0.0010162587935142792, m = 0.00044045647287897473
[Iteration 8450] [Rank 0] a = 1.1142939329147339, b = 0.9996930960890288, delta = 0.0007610550965182483, c = 0.0003861921587861877, d = 0.0003871248232125944, m = 0.0004409025572470104
[Iteration 8460] [Rank 0] a = 0.8681228756904602, b = 1.0009521409526234, delta = 0.0006796349189244211, c = 0.0029042824807036047, d = 0.002857614716256365, m = 0.00044149309207663397
[Iteration 8470] [Rank 0] a = 1.1553013324737549, b = 0.9996639589644987, delta = 0.000759496761020273, c = 0.00032791790369922, d = 0.00032885056812562673, m = 0.00044257254850728925
cross_entropy                  - bits:19482854080.000, epoch: 61.000, ratio_transmit_grad:  0.170, value:  5.384 (split:train)
last_cross_entropy             - bits:19482854080.000, epoch: 61.000, ratio_transmit_grad:  0.170, value:  5.384 (split:train)
perplexity                     - bits:19482854080.000, epoch: 61.000, ratio_transmit_grad:  0.170, value:218.348 (split:train)
last_perplexity                - bits:19482854080.000, epoch: 61.000, ratio_transmit_grad:  0.170, value:218.348 (split:train)
last_cross_entropy             - bits:19482854080.000, epoch: 61.000, ratio_transmit_grad:  0.170, value:  5.166 (split:test)
last_perplexity                - bits:19482854080.000, epoch: 61.000, ratio_transmit_grad:  0.170, value:175.824 (split:test)
timer                          - epoch: 60.000, value:  0.399 (event:test.last)
runavg_cross_entropy           - bits:19482854080.000, epoch: 61.000, ratio_transmit_grad:  0.170, value:  5.364 (split:test)
runavg_perplexity              - bits:19482854080.000, epoch: 61.000, ratio_transmit_grad:  0.170, value:214.203 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8478 |     0.11042s |  92.9%
- batch.accumulate               |   8478 |     0.00083s |   0.7%
- batch.backward                 |   8478 |     0.05166s |  43.5%
- batch.evaluate                 |   8478 |     0.00275s |   2.3%
- batch.forward                  |   8478 |     0.02543s |  21.4%
- batch.mom                      |   8478 |     0.00126s |   1.1%
- batch.reduce                   |   8478 |     0.02567s |  21.6%
- batch.reporting.compr_err      |   8478 |     0.00001s |   0.0%
- batch.reporting.lr             |   8478 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8478 |     0.00001s |   0.0%
- batch.step                     |   8478 |     0.00048s |   0.4%
- batch.update_runavg            |   8478 |     0.00130s |   1.1%
- batch.wd                       |   8478 |     0.00001s |   0.0%
- epoch_metrics.collect          |     60 |     0.00877s |   0.1%
- reduce.combine                 |   8478 |     0.00630s |   5.3%
- reduce.flatpack                |   8478 |     0.00002s |   0.0%
- reduce.flatput                 |   8478 |     0.00019s |   0.2%
- reduce.gather.context          |   8478 |     0.00119s |   1.0%
- reduce.gather.tensors          |   8478 |     0.00363s |   3.1%
- reduce.heur_params             |   8478 |     0.01103s |   9.3%
- reduce.heur_params.alpha       |   8477 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   8477 |     0.00224s |   1.9%
- reduce.memory                  |   8478 |     0.00045s |   0.4%
- reduce.pad                     |   8478 |     0.00028s |   0.2%
- reduce.threshold               |   8478 |     0.00236s |   2.0%
- test.last                      |     60 |     0.41198s |   2.5%
- test.runavg                    |     60 |     0.44289s |   2.7%
-----------------------------------------------------------------

[Iteration 8340] [Rank 3] a = 0.9650291800498962, b = 0.9999355370156577, delta = 0.0006810039049014449, c = 0.0008710740311369674, d = 0.0008715576349136227, m = 0.0005315324584152848
[Iteration 8350] [Rank 3] a = 1.00361967086792, b = 0.999891995404526, delta = 0.0006996611482463777, c = 0.0007839908082121034, d = 0.0007846471276232785, m = 0.0005318750478617892
[Iteration 8360] [Rank 3] a = 0.9998681545257568, b = 0.9999204071261527, delta = 0.000708540843334049, c = 0.000840814251969105, d = 0.0008416778301417038, m = 0.0005320987944312222
[Iteration 8370] [Rank 3] a = 0.8687801361083984, b = 1.002501723422568, delta = 0.0006248275167308748, c = 0.006003457283399309, d = 0.005740929518929271, m = 0.0005332288016767394
[Iteration 8380] [Rank 3] a = 1.0323492288589478, b = 0.9997751878242677, delta = 0.0007211623596958816, c = 0.0005503756409606734, d = 0.0005511701328794643, m = 0.0005340368408534972

[Iteration 8340] [Rank 1] a = 1.0528618097305298, b = 0.9998241872478051, delta = 0.0007391431136056781, c = 0.0006483744919871863, d = 0.0006490653545252654, m = 0.0006433647695066641
[Iteration 8350] [Rank 1] a = 0.9870545268058777, b = 1.0001874254947574, delta = 0.0006650324212387204, c = 0.0013748509939042089, d = 0.001367562394127475, m = 0.0006438664753566193
[Iteration 8360] [Rank 1] a = 1.0465812683105469, b = 0.999795792798517, delta = 0.0007161303656175733, c = 0.0005915855913570886, d = 0.0005925527989103992, m = 0.0006441334958351058
[Iteration 8370] [Rank 1] a = 0.9906601905822754, b = 0.9998867103061744, delta = 0.0007359028677456081, c = 0.0007734206113794939, d = 0.000774836879582556, m = 0.0006442221242285266
[Iteration 8380] [Rank 1] a = 0.8783095479011536, b = 1.000660182635848, delta = 0.0006756140501238406, c = 0.0023203654635191935, d = 0.0022875149498335348, m = 0.0006447554224712515

[Iteration 8340] [Rank 2] a = 0.9581608772277832, b = 1.0001414831372257, delta = 0.0007121367962099612, c = 0.0012829662763396957, d = 0.0012813082062483059, m = 0.0004883133122813272
[Iteration 8350] [Rank 2] a = 1.087010145187378, b = 0.9997314044135887, delta = 0.000743258569855243, c = 0.00046280881425915407, d = 0.0004636723924317529, m = 0.0004889986263333006
[Iteration 8360] [Rank 2] a = 1.1084046363830566, b = 0.9997256011686966, delta = 0.0007483102381229401, c = 0.00045120232361942606, d = 0.0004520313586651209, m = 0.0004895515486664251
[Iteration 8370] [Rank 2] a = 0.8667473793029785, b = 1.001630394092479, delta = 0.0006679645157419145, c = 0.004260791074221815, d = 0.0040919788130422, m = 0.0004902158040443252
[Iteration 8380] [Rank 2] a = 1.0249501466751099, b = 0.999857175933158, delta = 0.0007068722043186426, c = 0.0007143518643737354, d = 0.000715319071927046, m = 0.0004905894017613145
[Iteration 8390] [Rank 3] a = 0.8916876912117004, b = 1.0015893051495195, delta = 0.0006214797031134367, c = 0.004178612975317312, d = 0.0040648624584225974, m = 0.0005347517364967701
[Iteration 8400] [Rank 3] a = 1.0787042379379272, b = 0.9997458261680855, delta = 0.0007132365135475993, c = 0.0004916523252239543, d = 0.000492584989650361, m = 0.0005350039618237781
[Iteration 8410] [Rank 3] a = 1.0322219133377075, b = 0.9997258775136911, delta = 0.0007560524973087013, c = 0.0004517550136498893, d = 0.000452687678076296, m = 0.0005352441045102721
[Iteration 8420] [Rank 3] a = 1.0337550640106201, b = 0.9997696609242495, delta = 0.0007349943625740707, c = 0.0005393218403514086, d = 0.0005402545047778154, m = 0.0005356003014405942
[Iteration 8430] [Rank 3] a = 0.9876276850700378, b = 0.9997913021922108, delta = 0.000729109684471041, c = 0.000582604378362061, d = 0.0005836061290422755, m = 0.0005361302865051139
[Iteration 8390] [Rank 1] a = 0.9175183176994324, b = 1.0004853771999453, delta = 0.0007033671136014163, c = 0.0019707544761242914, d = 0.0019574553722662698, m = 0.0006448914530496779
[Iteration 8400] [Rank 1] a = 0.9860449433326721, b = 0.9999194917332956, delta = 0.000734395463950932, c = 0.0008389834662431956, d = 0.0008398815875426983, m = 0.0006451478201889219
[Iteration 8410] [Rank 1] a = 0.9928260445594788, b = 0.999899957595191, delta = 0.0007260908023454249, c = 0.0007999151897148254, d = 0.0008011932854102717, m = 0.0006455086116686467
[Iteration 8420] [Rank 1] a = 1.023814082145691, b = 0.9998162768719999, delta = 0.0007300064899027348, c = 0.0006325537398651761, d = 0.0006335209474184868, m = 0.0006457599534359713
[Iteration 8430] [Rank 1] a = 0.8808330297470093, b = 1.0003356673134536, delta = 0.0007111407467164099, c = 0.0016713346521208322, d = 0.0016604535671460874, m = 0.0006460215113670431
[Iteration 8390] [Rank 2] a = 1.06870698928833, b = 0.99976993726925, delta = 0.0007283559534698725, c = 0.0005398745303818719, d = 0.0005405653929199509, m = 0.0004911195023285694
[Iteration 8400] [Rank 2] a = 0.9990476965904236, b = 0.9999216334071501, delta = 0.000711445405613631, c = 0.0008432668139792856, d = 0.0008441649352787884, m = 0.0004915751634194694
[Iteration 8410] [Rank 2] a = 0.9354345798492432, b = 1.0005754138348304, delta = 0.0006779195973649621, c = 0.0021508277966745953, d = 0.002124920451496631, m = 0.0004922663600037417
[Iteration 8420] [Rank 2] a = 0.9695809483528137, b = 0.9999484216019493, delta = 0.0007309858337976038, c = 0.0008968432038073158, d = 0.0008976722388530107, m = 0.0004924914922638843
[Iteration 8430] [Rank 2] a = 1.0006343126296997, b = 0.9998047394680281, delta = 0.0007441563648171723, c = 0.0006094789310933359, d = 0.00061082611304259, m = 0.0004936468661030009
[Iteration 8440] [Rank 3] a = 0.9694252610206604, b = 0.9998328057577139, delta = 0.0007195277139544487, c = 0.0006656115123122586, d = 0.0006665441767386653, m = 0.0005366308526026103
[Iteration 8450] [Rank 3] a = 0.9546846747398376, b = 1.0001565093970952, delta = 0.0006875500548630953, c = 0.0013130187967461341, d = 0.0013103935191014337, m = 0.0005369863554662921
[Iteration 8460] [Rank 3] a = 0.9094217419624329, b = 0.999931443655138, delta = 0.0007028065738268197, c = 0.0008628873100607306, d = 0.0008634745432180978, m = 0.0005373800438509288
[Iteration 8470] [Rank 3] a = 0.9762692451477051, b = 0.9999309082366734, delta = 0.0006871323566883802, c = 0.0008618164731267081, d = 0.0008623691631571713, m = 0.0005379537677824964
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8478 |     0.11052s |  93.0%
- batch.accumulate               |   8478 |     0.00082s |   0.7%
[Iteration 8440] [Rank 1] a = 1.0548903942108154, b = 0.9997855334902762, delta = 0.0007322176825255156, c = 0.0005710669739761409, d = 0.0005722068971639713, m = 0.0006464195908133603
[Iteration 8450] [Rank 1] a = 0.9392081499099731, b = 0.9998995430776726, delta = 0.0007503879605792463, c = 0.0007990861546691305, d = 0.0008000879053493452, m = 0.0006465157357705189
[Iteration 8460] [Rank 1] a = 1.0663537979125977, b = 0.9998111299462697, delta = 0.0007048888364806771, c = 0.0006222598880477983, d = 0.0006231580093473011, m = 0.0006475641390533838
[Iteration 8470] [Rank 1] a = 0.999131977558136, b = 0.999775377811456, delta = 0.0007685981690883636, c = 0.0005507556153566169, d = 0.0005524136854480066, m = 0.0006476311928927563
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8478 |     0.11042s |  92.9%
- batch.accumulate               |   8478 |     0.00083s |   0.7%
[Iteration 8440] [Rank 2] a = 0.938075840473175, b = 1.0003428350114612, delta = 0.0007068426930345595, c = 0.0016856700497859724, d = 0.0016755143704762106, m = 0.0004940082884294241
[Iteration 8450] [Rank 2] a = 1.0692081451416016, b = 0.9998090746302931, delta = 0.0007073142332956195, c = 0.000618149255946228, d = 0.0006189437478650189, m = 0.0004947567840132776
[Iteration 8460] [Rank 2] a = 1.0436345338821411, b = 0.9998557251218578, delta = 0.0006815005908720195, c = 0.0007114502417138034, d = 0.0007126247080285377, m = 0.0004956646557761109
[Iteration 8470] [Rank 2] a = 1.030156135559082, b = 0.9996952895773822, delta = 0.0007704973686486483, c = 0.00039057913590298966, d = 0.00039151180032939633, m = 0.0004960523309431012
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8478 |     0.11045s |  92.9%
- batch.accumulate               |   8478 |     0.00083s |   0.7%
- batch.backward                 |   8478 |     0.05174s |  43.5%
- batch.evaluate                 |   8478 |     0.00277s |   2.3%
- batch.forward                  |   8478 |     0.02538s |  21.3%
- batch.mom                      |   8478 |     0.00126s |   1.1%
- batch.reduce                   |   8478 |     0.02577s |  21.7%
- batch.reporting.compr_err      |   8478 |     0.00001s |   0.0%
- batch.reporting.lr             |   8478 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8478 |     0.00001s |   0.0%
- batch.step                     |   8478 |     0.00047s |   0.4%
- batch.update_runavg            |   8478 |     0.00130s |   1.1%
- batch.wd                       |   8478 |     0.00001s |   0.0%
- epoch_metrics.collect          |     60 |     0.00863s |   0.1%
- reduce.combine                 |   8478 |     0.00603s |   5.1%
- reduce.flatpack                |   8478 |     0.00002s |   0.0%
- reduce.flatput                 |   8478 |     0.00019s |   0.2%
- batch.backward                 |   8478 |     0.05177s |  43.5%
- batch.evaluate                 |   8478 |     0.00276s |   2.3%
- batch.forward                  |   8478 |     0.02542s |  21.4%
- batch.mom                      |   8478 |     0.00126s |   1.1%
- batch.reduce                   |   8478 |     0.02562s |  21.6%
- batch.reporting.compr_err      |   8478 |     0.00001s |   0.0%
- batch.reporting.lr             |   8478 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8478 |     0.00001s |   0.0%
- batch.step                     |   8478 |     0.00048s |   0.4%
- batch.update_runavg            |   8478 |     0.00130s |   1.1%
- batch.wd                       |   8478 |     0.00001s |   0.0%
- epoch_metrics.collect          |     60 |     0.00880s |   0.1%
- reduce.combine                 |   8478 |     0.00610s |   5.1%
- reduce.flatpack                |   8478 |     0.00002s |   0.0%
- reduce.flatput                 |   8478 |     0.00023s |   0.2%
- batch.backward                 |   8478 |     0.05184s |  43.6%
- batch.evaluate                 |   8478 |     0.00275s |   2.3%
- batch.forward                  |   8478 |     0.02553s |  21.5%
- batch.mom                      |   8478 |     0.00126s |   1.1%
- batch.reduce                   |   8478 |     0.02548s |  21.4%
- batch.reporting.compr_err      |   8478 |     0.00001s |   0.0%
- batch.reporting.lr             |   8478 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8478 |     0.00001s |   0.0%
- batch.step                     |   8478 |     0.00048s |   0.4%
- batch.update_runavg            |   8478 |     0.00130s |   1.1%
- batch.wd                       |   8478 |     0.00001s |   0.0%
- epoch_metrics.collect          |     60 |     0.01330s |   0.1%
- reduce.combine                 |   8478 |     0.00607s |   5.1%
- reduce.flatpack                |   8478 |     0.00002s |   0.0%
- reduce.flatput                 |   8478 |     0.00018s |   0.2%
- reduce.gather.context          |   8478 |     0.00252s |   2.1%
- reduce.gather.tensors          |   8478 |     0.00322s |   2.7%
- reduce.heur_params             |   8478 |     0.01047s |   8.8%
- reduce.heur_params.alpha       |   8477 |     0.00810s |   6.8%
- reduce.gather.context          |   8478 |     0.00134s |   1.1%
- reduce.gather.tensors          |   8478 |     0.00355s |   3.0%
- reduce.heur_params             |   8478 |     0.01088s |   9.2%
- reduce.gather.context          |   8478 |     0.00182s |   1.5%
- reduce.gather.tensors          |   8478 |     0.00354s |   3.0%
- reduce.heur_params             |   8478 |     0.01055s |   8.9%
- reduce.heur_params.alpha       |   8477 |     0.00823s |   6.9%
- reduce.heur_params.beta        |   8477 |     0.00229s |   1.9%
- reduce.memory                  |   8478 |     0.00045s |   0.4%
- reduce.pad                     |   8478 |     0.00027s |   0.2%
- reduce.threshold               |   8478 |     0.00242s |   2.0%
- test.last                      |     60 |     0.41199s |   2.5%
- test.runavg                    |     60 |     0.44288s |   2.7%
-----------------------------------------------------------------

[Iteration 8480] [Rank 3] a = 1.018709659576416, b = 0.9997198842816335, delta = 0.000779487076215446, c = 0.00043976854861421785, d = 0.0004405284974061048, m = 0.0005382486899524555
[Iteration 8490] [Rank 3] a = 0.9871135354042053, b = 0.9999513404961655, delta = 0.0006720187375321984, c = 0.0009026809922540838, d = 0.0009030955097769312, m = 0.0005399102980384195
[Iteration 8500] [Rank 3] a = 1.0101317167282104, b = 0.9997643240114323, delta = 0.0007308976491913199, c = 0.0005286480141380873, d = 0.0005293388766761664, m = 0.0005401916518091123
- reduce.heur_params.alpha       |   8477 |     0.00832s |   7.0%
- reduce.heur_params.beta        |   8477 |     0.00248s |   2.1%
- reduce.memory                  |   8478 |     0.00046s |   0.4%
- reduce.pad                     |   8478 |     0.00020s |   0.2%
- reduce.threshold               |   8478 |     0.00264s |   2.2%
- test.last                      |     60 |     0.41199s |   2.5%
- test.runavg                    |     60 |     0.44288s |   2.7%
-----------------------------------------------------------------

[Iteration 8480] [Rank 1] a = 1.0391685962677002, b = 0.9998216310564945, delta = 0.0007413634448312223, c = 0.0006432621092054014, d = 0.0006444020323932317, m = 0.000648011212824964
[Iteration 8490] [Rank 1] a = 0.9921541810035706, b = 0.999940390324969, delta = 0.0007132995524443686, c = 0.000880780649796978, d = 0.0008812987967005372, m = 0.0006488399841161011
- reduce.heur_params.beta        |   8477 |     0.00225s |   1.9%
- reduce.memory                  |   8478 |     0.00045s |   0.4%
- reduce.pad                     |   8478 |     0.00028s |   0.2%
- reduce.threshold               |   8478 |     0.00237s |   2.0%
- test.last                      |     60 |     0.41199s |   2.5%
- test.runavg                    |     60 |     0.44288s |   2.7%
-----------------------------------------------------------------

[Iteration 8480] [Rank 2] a = 1.0096654891967773, b = 0.9998261907491043, delta = 0.0007479392806999385, c = 0.0006523814947080448, d = 0.0006535214178958752, m = 0.0004963569231546026
[Iteration 8490] [Rank 2] a = 0.951614499092102, b = 1.000510731848802, delta = 0.0006847396143712103, c = 0.0020214637864192937, d = 0.002004468567982549, m = 0.0004969871208300206
[Iteration 8500] [Rank 2] a = 1.0061025619506836, b = 0.9998015096857878, delta = 0.000747270358260721, c = 0.0006030193663622968, d = 0.0006040556601694154, m = 0.0004973338833280336
[Iteration 8510] [Rank 3] a = 0.9227991700172424, b = 1.000227737322112, delta = 0.0006933281547389925, c = 0.0014554746520980338, d = 0.0014515712787578872, m = 0.0005405922976771182
[Iteration 8520] [Rank 3] a = 1.0330324172973633, b = 0.9997779167311569, delta = 0.0007402069168165326, c = 0.0005558334550114978, d = 0.0005566279469302887, m = 0.0005409793793842816
[Iteration 8530] [Rank 3] a = 0.9708695411682129, b = 1.000108373550608, delta = 0.0006752837216481566, c = 0.0012167471020648188, d = 0.0012146399713236777, m = 0.0005415557291030682
[Iteration 8540] [Rank 3] a = 0.9977263808250427, b = 0.9999482488863153, delta = 0.0006877408595755696, c = 0.0008964977725382763, d = 0.000897499523218491, m = 0.0005418260492098
[Iteration 8550] [Rank 3] a = 1.017277479171753, b = 0.9997876233493588, delta = 0.0007560304366052151, c = 0.0005752466923315191, d = 0.0005764211586462535, m = 0.0005421075005507046
[Iteration 8500] [Rank 1] a = 1.0043773651123047, b = 0.9998786790292797, delta = 0.0007316653500311077, c = 0.000757358057369156, d = 0.000758118006161043, m = 0.000648993123184972
[Iteration 8510] [Rank 1] a = 1.006423830986023, b = 0.9998601466420124, delta = 0.0007337633869610727, c = 0.0007202932822012152, d = 0.0007210186878661982, m = 0.0006495233969562234
[Iteration 8520] [Rank 1] a = 0.991700291633606, b = 0.9999321345176727, delta = 0.0007191995391622186, c = 0.0008642690351368887, d = 0.0008649598976749678, m = 0.0006497469134045915
[Iteration 8530] [Rank 1] a = 1.0844155550003052, b = 0.9997240121849793, delta = 0.0007417788729071617, c = 0.00044802435594426245, d = 0.0004489224772437652, m = 0.0006503070930836279
[Iteration 8540] [Rank 1] a = 0.9621298909187317, b = 0.9999510814227143, delta = 0.0007272879010997713, c = 0.0009021628453505245, d = 0.0009027846216347956, m = 0.0006505438213875787
[Iteration 8510] [Rank 2] a = 1.0588831901550293, b = 0.9997630459158083, delta = 0.0007467637769877911, c = 0.0005260918227471948, d = 0.0005272317459350253, m = 0.0004977319886146592
[Iteration 8520] [Rank 2] a = 0.8306408524513245, b = 1.0033668139903604, delta = 0.0006396237877197564, c = 0.007733653423764476, d = 0.007076919495066533, m = 0.0004992938883821317
[Iteration 8530] [Rank 2] a = 1.0952595472335815, b = 0.9996946159864701, delta = 0.0007600964163430035, c = 0.0003892319539537355, d = 0.0003897846439841987, m = 0.0004996779395210036
[Iteration 8540] [Rank 2] a = 1.1407127380371094, b = 0.9997172590041967, delta = 0.0007042698562145233, c = 0.0004345179933248171, d = 0.0004350706833552803, m = 0.0005013283602139448
[Iteration 8550] [Rank 2] a = 1.034080982208252, b = 0.999887953858727, delta = 0.0006773927016183734, c = 0.0007759077165165785, d = 0.0007764604065470418, m = 0.000501737419566299
[Iteration 8560] [Rank 3] a = 1.0577338933944702, b = 0.9997530284095929, delta = 0.0007271745125763118, c = 0.0005060568091429025, d = 0.0005068858441885973, m = 0.0005427380228526629
[Iteration 8570] [Rank 3] a = 0.9704408645629883, b = 0.9998365536868806, delta = 0.0007150056189857423, c = 0.0006731073708504162, d = 0.0006741436646575347, m = 0.0005434300381922576
[Iteration 8580] [Rank 3] a = 0.954971432685852, b = 0.9999599762778745, delta = 0.0007052034488879144, c = 0.00091995255570606, d = 0.0009204361594827153, m = 0.0005437194006031175
[Iteration 8590] [Rank 3] a = 1.065312385559082, b = 0.9997949810350688, delta = 0.0007121203234419227, c = 0.0005899620643926028, d = 0.0005907220131844898, m = 0.0005442667024375594
[Iteration 8600] [Rank 3] a = 0.9992871880531311, b = 0.9998370200190816, delta = 0.0006930824602022767, c = 0.0006740400352768229, d = 0.0006750072428301335, m = 0.0005454163628276314
[Iteration 8550] [Rank 1] a = 0.9627681970596313, b = 1.0002383766046203, delta = 0.000708507839590311, c = 0.0014767532182708685, d = 0.0014703627397936374, m = 0.000650763651544233
[Iteration 8560] [Rank 1] a = 1.0775387287139893, b = 0.9997008164771828, delta = 0.0007794041302986443, c = 0.0004016329365122544, d = 0.0004022892559234295, m = 0.0006513013532008847
[Iteration 8570] [Rank 1] a = 0.9684969186782837, b = 1.000041187169181, delta = 0.0007085620891302824, c = 0.0010823743384084442, d = 0.0010816489327434612, m = 0.0006516279459261372
[Iteration 8580] [Rank 1] a = 1.008034348487854, b = 0.9999890097760161, delta = 0.0006977586890570819, c = 0.000978019552031604, d = 0.0009781922676661238, m = 0.0006518784918720093
[Iteration 8590] [Rank 1] a = 1.0210015773773193, b = 0.99989116636949, delta = 0.0007029420230537653, c = 0.0007823327381207137, d = 0.0007832308594202164, m = 0.0006522510020249425
[Iteration 8560] [Rank 2] a = 0.9952426552772522, b = 0.9998253444425208, delta = 0.0007443869253620505, c = 0.000650688881489751, d = 0.0006518978909313895, m = 0.000501926869850323
[Iteration 8570] [Rank 2] a = 1.066900610923767, b = 0.9996998665412783, delta = 0.0007226223824545741, c = 0.000399733064532537, d = 0.0004003202976899042, m = 0.0005028617089473255
[Iteration 8580] [Rank 2] a = 0.9786665439605713, b = 0.9998511481576416, delta = 0.0006946440553292632, c = 0.0007022963130842559, d = 0.0007030908050030468, m = 0.0005042961563102368
[Iteration 8590] [Rank 2] a = 0.918251633644104, b = 1.0005923054181278, delta = 0.0006492417887784541, c = 0.0021846109747866607, d = 0.0021652668237204476, m = 0.0005047594214066134
[Iteration 8600] [Rank 2] a = 1.0497589111328125, b = 0.9997806110949239, delta = 0.000705516489688307, c = 0.0005612221828085144, d = 0.0005620857609811132, m = 0.0005053104711703481
[Iteration 8610] [Rank 3] a = 0.9668735861778259, b = 0.9999322726901796, delta = 0.0007117809145711362, c = 0.0008645453801521204, d = 0.0008652707858171034, m = 0.0005456202345784858
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8617 |     0.11056s |  93.0%
- batch.accumulate               |   8617 |     0.00082s |   0.7%
- batch.backward                 |   8617 |     0.05174s |  43.5%
- batch.evaluate                 |   8617 |     0.00277s |   2.3%
- batch.forward                  |   8617 |     0.02538s |  21.3%
- batch.mom                      |   8617 |     0.00126s |   1.1%
- batch.reduce                   |   8617 |     0.02581s |  21.7%
- batch.reporting.compr_err      |   8617 |     0.00001s |   0.0%
- batch.reporting.lr             |   8617 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8617 |     0.00001s |   0.0%
[Iteration 8600] [Rank 1] a = 0.9727151393890381, b = 0.9999125658364003, delta = 0.0007372085237875581, c = 0.0008251316723547106, d = 0.0008259607074004055, m = 0.0006523456744372801
[Iteration 8610] [Rank 1] a = 1.089578628540039, b = 0.9997195215788297, delta = 0.000774738728068769, c = 0.0004390431429492348, d = 0.0004399412642487376, m = 0.0006525681182534906
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8617 |     0.11046s |  92.9%
- batch.accumulate               |   8617 |     0.00083s |   0.7%
- batch.backward                 |   8617 |     0.05177s |  43.5%
- batch.evaluate                 |   8617 |     0.00276s |   2.3%
- batch.forward                  |   8617 |     0.02542s |  21.4%
- batch.mom                      |   8617 |     0.00126s |   1.1%
- batch.reduce                   |   8617 |     0.02566s |  21.6%
[Iteration 8610] [Rank 2] a = 0.9361982345581055, b = 1.0003292422925596, delta = 0.0006657367339357734, c = 0.001658484608912562, d = 0.0016491234215215908, m = 0.0005057676072328008
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8617 |     0.11049s |  92.9%
- batch.accumulate               |   8617 |     0.00083s |   0.7%
- batch.backward                 |   8617 |     0.05183s |  43.6%
- batch.evaluate                 |   8617 |     0.00275s |   2.3%
- batch.forward                  |   8617 |     0.02552s |  21.5%
- batch.mom                      |   8617 |     0.00126s |   1.1%
- batch.reduce                   |   8617 |     0.02554s |  21.5%
- batch.reporting.compr_err      |   8617 |     0.00001s |   0.0%
- batch.reporting.lr             |   8617 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8617 |     0.00001s |   0.0%
- batch.step                     |   8617 |     0.00047s |   0.4%
- batch.update_runavg            |   8617 |     0.00130s |   1.1%
- batch.wd                       |   8617 |     0.00001s |   0.0%
- batch.reporting.compr_err      |   8617 |     0.00001s |   0.0%
- batch.reporting.lr             |   8617 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8617 |     0.00001s |   0.0%
- batch.step                     |   8617 |     0.00048s |   0.4%
- batch.update_runavg            |   8617 |     0.00130s |   1.1%
- batch.wd                       |   8617 |     0.00001s |   0.0%
- batch.step                     |   8617 |     0.00048s |   0.4%
- batch.update_runavg            |   8617 |     0.00130s |   1.1%
- batch.wd                       |   8617 |     0.00001s |   0.0%
- epoch_metrics.collect          |     61 |     0.01315s |   0.1%
- epoch_metrics.collect          |     61 |     0.00850s |   0.1%
- reduce.combine                 |   8617 |     0.00603s |   5.1%
- reduce.flatpack                |   8617 |     0.00002s |   0.0%
- reduce.flatput                 |   8617 |     0.00019s |   0.2%
- reduce.gather.context          |   8617 |     0.00251s |   2.1%
- reduce.gather.tensors          |   8617 |     0.00324s |   2.7%
- reduce.heur_params             |   8617 |     0.01047s |   8.8%
- reduce.heur_params.alpha       |   8616 |     0.00810s |   6.8%
- reduce.heur_params.beta        |   8616 |     0.00229s |   1.9%
- reduce.memory                  |   8617 |     0.00045s |   0.4%
- reduce.pad                     |   8617 |     0.00027s |   0.2%
- reduce.threshold               |   8617 |     0.00242s |   2.0%
- test.last                      |     61 |     0.41188s |   2.5%
- test.runavg                    |     61 |     0.44277s |   2.7%
-----------------------------------------------------------------
- epoch_metrics.collect          |     61 |     0.00867s |   0.1%
- reduce.combine                 |   8617 |     0.00611s |   5.1%
- reduce.flatpack                |   8617 |     0.00002s |   0.0%
- reduce.flatput                 |   8617 |     0.00023s |   0.2%
- reduce.gather.context          |   8617 |     0.00134s |   1.1%
- reduce.gather.tensors          |   8617 |     0.00357s |   3.0%
- reduce.heur_params             |   8617 |     0.01088s |   9.2%
- reduce.heur_params.alpha       |   8616 |     0.00832s |   7.0%
- reduce.heur_params.beta        |   8616 |     0.00248s |   2.1%
- reduce.memory                  |   8617 |     0.00046s |   0.4%
- reduce.pad                     |   8617 |     0.00020s |   0.2%
- reduce.threshold               |   8617 |     0.00264s |   2.2%
- test.last                      |     61 |     0.41188s |   2.5%
- test.runavg                    |     61 |     0.44277s |   2.7%
-----------------------------------------------------------------
- reduce.combine                 |   8617 |     0.00608s |   5.1%
- reduce.flatpack                |   8617 |     0.00002s |   0.0%
- reduce.flatput                 |   8617 |     0.00018s |   0.2%
- reduce.gather.context          |   8617 |     0.00183s |   1.5%
- reduce.gather.tensors          |   8617 |     0.00357s |   3.0%
- reduce.heur_params             |   8617 |     0.01055s |   8.9%
- reduce.heur_params.alpha       |   8616 |     0.00822s |   6.9%
- reduce.heur_params.beta        |   8616 |     0.00225s |   1.9%
- reduce.memory                  |   8617 |     0.00045s |   0.4%
- reduce.pad                     |   8617 |     0.00028s |   0.2%
- reduce.threshold               |   8617 |     0.00237s |   2.0%
- test.last                      |     61 |     0.41188s |   2.5%
- test.runavg                    |     61 |     0.44278s |   2.7%
-----------------------------------------------------------------

[Iteration 8480] [Rank 0] a = 1.0340218544006348, b = 0.9997300572317371, delta = 0.0007960363873280585, c = 0.00046011445036064577, d = 0.00046166889107132365, m = 0.00044275440094805363
[Iteration 8490] [Rank 0] a = 0.895148515701294, b = 1.000387585626389, delta = 0.0007115304470062256, c = 0.001775171291594113, d = 0.0017660173629645657, m = 0.0004433041725138269
[Iteration 8500] [Rank 0] a = 0.9478750228881836, b = 1.0000407899232222, delta = 0.0007230623159557581, c = 0.0010815798464896532, d = 0.0010808544408246702, m = 0.0004437043521032675
[Iteration 8510] [Rank 0] a = 0.9660027027130127, b = 0.999854757914325, delta = 0.0007232143543660641, c = 0.000709515826607182, d = 0.0007101721460183571, m = 0.0004447556126168454
[Iteration 8520] [Rank 0] a = 0.9208706021308899, b = 1.0009295497676267, delta = 0.0006749500171281397, c = 0.002859100070713235, d = 0.002819237302266074, m = 0.000445279646887555
[Iteration 8530] [Rank 0] a = 0.919783890247345, b = 1.0003393288844882, delta = 0.0006849312921985984, c = 0.0016786577950244702, d = 0.0016658422949431039, m = 0.0004457670308289281
[Iteration 8540] [Rank 0] a = 1.1253626346588135, b = 0.9997019909433927, delta = 0.0007831106777302921, c = 0.00040398186914172314, d = 0.000404810904187418, m = 0.0004461342916079999
[Iteration 8550] [Rank 0] a = 0.984264612197876, b = 1.0001166811725233, delta = 0.0006973698036745191, c = 0.0012333623461056199, d = 0.0012299080334152246, m = 0.00044672405828115634
[Iteration 8560] [Rank 0] a = 1.0954171419143677, b = 0.9997137528770997, delta = 0.0007565584382973611, c = 0.00042750573856331473, d = 0.00042843840298972146, m = 0.00044721671011895334
[Iteration 8570] [Rank 0] a = 1.0302398204803467, b = 0.9996758936135436, delta = 0.0008266257937066257, c = 0.0003517872043898511, d = 0.0003528234981969697, m = 0.0004475542937504331
[Iteration 8580] [Rank 0] a = 0.891899824142456, b = 1.0001836948371803, delta = 0.0007334424881264567, c = 0.0013673896784929553, d = 0.0013640389951832719, m = 0.0004479973445957575
[Iteration 8590] [Rank 0] a = 1.0509185791015625, b = 0.9997148755286325, delta = 0.0007917399052530527, c = 0.0004297510418120716, d = 0.0004306491631115744, m = 0.0004483138330573258
memory_norm                    - epoch: 61.827, value:  1.217 (weight:encoder.weight)
memory_inf_norm                - epoch: 61.827, value:  0.001 (weight:encoder.weight)
memory_norm                    - epoch: 61.827, value:  0.379 (weight:rnn.weight_ih_l0)
memory_inf_norm                - epoch: 61.827, value:  0.001 (weight:rnn.weight_ih_l0)
memory_norm                    - epoch: 61.827, value:  0.347 (weight:rnn.weight_hh_l0)
memory_inf_norm                - epoch: 61.827, value:  0.001 (weight:rnn.weight_hh_l0)
memory_norm                    - epoch: 61.827, value:  0.016 (weight:rnn.bias_ih_l0)
memory_inf_norm                - epoch: 61.827, value:  0.001 (weight:rnn.bias_ih_l0)
memory_norm                    - epoch: 61.827, value:  0.016 (weight:rnn.bias_hh_l0)
memory_inf_norm                - epoch: 61.827, value:  0.001 (weight:rnn.bias_hh_l0)
memory_norm                    - epoch: 61.827, value:  0.292 (weight:rnn.weight_ih_l1)
memory_inf_norm                - epoch: 61.827, value:  0.001 (weight:rnn.weight_ih_l1)
memory_norm                    - epoch: 61.827, value:  0.222 (weight:rnn.weight_hh_l1)
memory_inf_norm                - epoch: 61.827, value:  0.001 (weight:rnn.weight_hh_l1)
memory_norm                    - epoch: 61.827, value:  0.015 (weight:rnn.bias_ih_l1)
memory_inf_norm                - epoch: 61.827, value:  0.001 (weight:rnn.bias_ih_l1)
memory_norm                    - epoch: 61.827, value:  0.015 (weight:rnn.bias_hh_l1)
memory_inf_norm                - epoch: 61.827, value:  0.001 (weight:rnn.bias_hh_l1)
memory_norm                    - epoch: 61.827, value:  0.257 (weight:rnn.weight_ih_l2)
memory_inf_norm                - epoch: 61.827, value:  0.001 (weight:rnn.weight_ih_l2)
memory_norm                    - epoch: 61.827, value:  0.200 (weight:rnn.weight_hh_l2)
memory_inf_norm                - epoch: 61.827, value:  0.001 (weight:rnn.weight_hh_l2)
memory_norm                    - epoch: 61.827, value:  0.017 (weight:rnn.bias_ih_l2)
memory_inf_norm                - epoch: 61.827, value:  0.001 (weight:rnn.bias_ih_l2)
memory_norm                    - epoch: 61.827, value:  0.017 (weight:rnn.bias_hh_l2)
memory_inf_norm                - epoch: 61.827, value:  0.001 (weight:rnn.bias_hh_l2)
memory_norm                    - epoch: 61.827, value:  0.062 (weight:decoder.bias)
memory_inf_norm                - epoch: 61.827, value:  0.001 (weight:decoder.bias)
memory_norm                    - epoch: 61.827, value:  1.411 (weight:entire_model)
memory_inf_norm                - epoch: 61.827, value:  0.001 (weight:entire_model)
[Iteration 8600] [Rank 0] a = 0.9882798194885254, b = 0.9997961209582089, delta = 0.0007862880593165755, c = 0.0005922419107682636, d = 0.0005935200064637099, m = 0.00044869965981781144
[Iteration 8610] [Rank 0] a = 0.9154549241065979, b = 1.0005073293516835, delta = 0.0007029756088741124, c = 0.0020146587904192152, d = 0.002001705117830233, m = 0.0004495602795171182
cross_entropy                  - bits:19960368704.000, epoch: 62.000, ratio_transmit_grad:  0.185, value:  5.378 (split:train)
last_cross_entropy             - bits:19960368704.000, epoch: 62.000, ratio_transmit_grad:  0.185, value:  5.378 (split:train)
perplexity                     - bits:19960368704.000, epoch: 62.000, ratio_transmit_grad:  0.185, value:217.139 (split:train)
last_perplexity                - bits:19960368704.000, epoch: 62.000, ratio_transmit_grad:  0.185, value:217.139 (split:train)
last_cross_entropy             - bits:19960368704.000, epoch: 62.000, ratio_transmit_grad:  0.185, value:  5.164 (split:test)
last_perplexity                - bits:19960368704.000, epoch: 62.000, ratio_transmit_grad:  0.185, value:175.453 (split:test)
runavg_cross_entropy           - bits:19960368704.000, epoch: 62.000, ratio_transmit_grad:  0.185, value:  5.361 (split:test)
runavg_perplexity              - bits:19960368704.000, epoch: 62.000, ratio_transmit_grad:  0.185, value:213.568 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8617 |     0.11046s |  92.9%
- batch.accumulate               |   8617 |     0.00083s |   0.7%
- batch.backward                 |   8617 |     0.05166s |  43.4%
- batch.evaluate                 |   8617 |     0.00275s |   2.3%
- batch.forward                  |   8617 |     0.02542s |  21.4%
- batch.mom                      |   8617 |     0.00126s |   1.1%
- batch.reduce                   |   8617 |     0.02572s |  21.6%
- batch.reporting.compr_err      |   8617 |     0.00001s |   0.0%
- batch.reporting.lr             |   8617 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8617 |     0.00001s |   0.0%
- batch.step                     |   8617 |     0.00048s |   0.4%
- batch.update_runavg            |   8617 |     0.00130s |   1.1%
- batch.wd                       |   8617 |     0.00001s |   0.0%
- epoch_metrics.collect          |     61 |     0.00864s |   0.1%
- reduce.combine                 |   8617 |     0.00631s |   5.3%
- reduce.flatpack                |   8617 |     0.00002s |   0.0%
- reduce.flatput                 |   8617 |     0.00019s |   0.2%
- reduce.gather.context          |   8617 |     0.00119s |   1.0%
- reduce.gather.tensors          |   8617 |     0.00365s |   3.1%
- reduce.heur_params             |   8617 |     0.01104s |   9.3%
- reduce.heur_params.alpha       |   8616 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   8616 |     0.00225s |   1.9%
- reduce.memory                  |   8617 |     0.00045s |   0.4%
- reduce.pad                     |   8617 |     0.00028s |   0.2%
- reduce.threshold               |   8617 |     0.00236s |   2.0%
- test.last                      |     61 |     0.41187s |   2.5%
- test.runavg                    |     61 |     0.44278s |   2.7%
-----------------------------------------------------------------

learning_rate                  - epoch: 62.007, value:  1.000 (weight:encoder.weight)
effective_lr                   - epoch: 62.007, value:  0.000 (weight:encoder.weight)
grad_norm                      - epoch: 62.007, value:  0.087 (weight:encoder.weight)
learning_rate                  - epoch: 62.007, value:  1.000 (weight:rnn.weight_ih_l0)
effective_lr                   - epoch: 62.007, value:  0.000 (weight:rnn.weight_ih_l0)
grad_norm                      - epoch: 62.007, value:  0.051 (weight:rnn.weight_ih_l0)
learning_rate                  - epoch: 62.007, value:  1.000 (weight:rnn.weight_hh_l0)
effective_lr                   - epoch: 62.007, value:  0.000 (weight:rnn.weight_hh_l0)
grad_norm                      - epoch: 62.007, value:  0.044 (weight:rnn.weight_hh_l0)
learning_rate                  - epoch: 62.007, value:  1.000 (weight:rnn.bias_ih_l0)
effective_lr                   - epoch: 62.007, value:  0.001 (weight:rnn.bias_ih_l0)
grad_norm                      - epoch: 62.007, value:  0.006 (weight:rnn.bias_ih_l0)
learning_rate                  - epoch: 62.007, value:  1.000 (weight:rnn.bias_hh_l0)
effective_lr                   - epoch: 62.007, value:  0.001 (weight:rnn.bias_hh_l0)
grad_norm                      - epoch: 62.007, value:  0.006 (weight:rnn.bias_hh_l0)
learning_rate                  - epoch: 62.007, value:  1.000 (weight:rnn.weight_ih_l1)
effective_lr                   - epoch: 62.007, value:  0.000 (weight:rnn.weight_ih_l1)
grad_norm                      - epoch: 62.007, value:  0.038 (weight:rnn.weight_ih_l1)
learning_rate                  - epoch: 62.007, value:  1.000 (weight:rnn.weight_hh_l1)
effective_lr                   - epoch: 62.007, value:  0.000 (weight:rnn.weight_hh_l1)
grad_norm                      - epoch: 62.007, value:  0.018 (weight:rnn.weight_hh_l1)
learning_rate                  - epoch: 62.007, value:  1.000 (weight:rnn.bias_ih_l1)
effective_lr                   - epoch: 62.007, value:  0.000 (weight:rnn.bias_ih_l1)
grad_norm                      - epoch: 62.007, value:  0.005 (weight:rnn.bias_ih_l1)
learning_rate                  - epoch: 62.007, value:  1.000 (weight:rnn.bias_hh_l1)
effective_lr                   - epoch: 62.007, value:  0.000 (weight:rnn.bias_hh_l1)
grad_norm                      - epoch: 62.007, value:  0.005 (weight:rnn.bias_hh_l1)
learning_rate                  - epoch: 62.007, value:  1.000 (weight:rnn.weight_ih_l2)
effective_lr                   - epoch: 62.007, value:  0.000 (weight:rnn.weight_ih_l2)
grad_norm                      - epoch: 62.007, value:  0.043 (weight:rnn.weight_ih_l2)
learning_rate                  - epoch: 62.007, value:  1.000 (weight:rnn.weight_hh_l2)
effective_lr                   - epoch: 62.007, value:  0.000 (weight:rnn.weight_hh_l2)
grad_norm                      - epoch: 62.007, value:  0.028 (weight:rnn.weight_hh_l2)
learning_rate                  - epoch: 62.007, value:  1.000 (weight:rnn.bias_ih_l2)
effective_lr                   - epoch: 62.007, value:  0.000 (weight:rnn.bias_ih_l2)
grad_norm                      - epoch: 62.007, value:  0.010 (weight:rnn.bias_ih_l2)
learning_rate                  - epoch: 62.007, value:  1.000 (weight:rnn.bias_hh_l2)
effective_lr                   - epoch: 62.007, value:  0.000 (weight:rnn.bias_hh_l2)
grad_norm                      - epoch: 62.007, value:  0.010 (weight:rnn.bias_hh_l2)
learning_rate                  - epoch: 62.007, value:  1.000 (weight:decoder.bias)
effective_lr                   - epoch: 62.007, value:  0.000 (weight:decoder.bias)
grad_norm                      - epoch: 62.007, value:  0.017 (weight:decoder.bias)
grad_norm                      - epoch: 62.007, value:  0.131 (weight:entire_model)
[Iteration 8620] [Rank 0] a = 0.9489129185676575, b = 1.0000116355241375, delta = 0.0007638626848347485, c = 0.0010232710482757815, d = 0.0010231328757681658, m = 0.00044989149990396486
[Iteration 8630] [Rank 0] a = 1.0241161584854126, b = 0.9997287791361354, delta = 0.0008156881667673588, c = 0.0004575582589697533, d = 0.00045845638026925607, m = 0.00045014054770258735
[Iteration 8640] [Rank 0] a = 0.9566155076026917, b = 0.9999799594767697, delta = 0.0007509432616643608, c = 0.0009599189535339328, d = 0.0009601262122953566, m = 0.0004507074586474826
timer                          - epoch: 62.201, value:  0.001 (event:batch.mom)
[Iteration 8650] [Rank 0] a = 1.033828616142273, b = 0.9997281746314591, delta = 0.0007952440646477044, c = 0.00045634924952811496, d = 0.0004577309746042731, m = 0.00045107556300138314
memory_norm                    - epoch: 62.259, value:  1.238 (weight:encoder.weight)
memory_inf_norm                - epoch: 62.259, value:  0.001 (weight:encoder.weight)
memory_norm                    - epoch: 62.259, value:  0.384 (weight:rnn.weight_ih_l0)
memory_inf_norm                - epoch: 62.259, value:  0.001 (weight:rnn.weight_ih_l0)
memory_norm                    - epoch: 62.259, value:  0.353 (weight:rnn.weight_hh_l0)
memory_inf_norm                - epoch: 62.259, value:  0.001 (weight:rnn.weight_hh_l0)
memory_norm                    - epoch: 62.259, value:  0.017 (weight:rnn.bias_ih_l0)
memory_inf_norm                - epoch: 62.259, value:  0.001 (weight:rnn.bias_ih_l0)
memory_norm                    - epoch: 62.259, value:  0.017 (weight:rnn.bias_hh_l0)
memory_inf_norm                - epoch: 62.259, value:  0.001 (weight:rnn.bias_hh_l0)
memory_norm                    - epoch: 62.259, value:  0.295 (weight:rnn.weight_ih_l1)
memory_inf_norm                - epoch: 62.259, value:  0.001 (weight:rnn.weight_ih_l1)
memory_norm                    - epoch: 62.259, value:  0.224 (weight:rnn.weight_hh_l1)
memory_inf_norm                - epoch: 62.259, value:  0.001 (weight:rnn.weight_hh_l1)
memory_norm                    - epoch: 62.259, value:  0.015 (weight:rnn.bias_ih_l1)
memory_inf_norm                - epoch: 62.259, value:  0.001 (weight:rnn.bias_ih_l1)
memory_norm                    - epoch: 62.259, value:  0.015 (weight:rnn.bias_hh_l1)
memory_inf_norm                - epoch: 62.259, value:  0.001 (weight:rnn.bias_hh_l1)
memory_norm                    - epoch: 62.259, value:  0.259 (weight:rnn.weight_ih_l2)
memory_inf_norm                - epoch: 62.259, value:  0.001 (weight:rnn.weight_ih_l2)
memory_norm                    - epoch: 62.259, value:  0.203 (weight:rnn.weight_hh_l2)
memory_inf_norm                - epoch: 62.259, value:  0.001 (weight:rnn.weight_hh_l2)
memory_norm                    - epoch: 62.259, value:  0.017 (weight:rnn.bias_ih_l2)
memory_inf_norm                - epoch: 62.259, value:  0.001 (weight:rnn.bias_ih_l2)
memory_norm                    - epoch: 62.259, value:  0.017 (weight:rnn.bias_hh_l2)
memory_inf_norm                - epoch: 62.259, value:  0.001 (weight:rnn.bias_hh_l2)
memory_norm                    - epoch: 62.259, value:  0.063 (weight:decoder.bias)
memory_inf_norm                - epoch: 62.259, value:  0.001 (weight:decoder.bias)
memory_norm                    - epoch: 62.259, value:  1.434 (weight:entire_model)
memory_inf_norm                - epoch: 62.259, value:  0.001 (weight:entire_model)
[Iteration 8660] [Rank 0] a = 0.9528211355209351, b = 1.000572374040664, delta = 0.0007187717710621655, c = 0.0021447482063395, d = 0.0021145575134254454, m = 0.00045166191352157675
[Iteration 8670] [Rank 0] a = 0.9828780889511108, b = 0.9998303877388994, delta = 0.0007558837532997131, c = 0.0006607754745457052, d = 0.0006621571996218633, m = 0.00045203957714866463
[Iteration 8680] [Rank 0] a = 1.0724129676818848, b = 0.9996802805902057, delta = 0.0008086233283393085, c = 0.000360561158623455, d = 0.0003614938230498617, m = 0.0004526687452116717
[Iteration 8690] [Rank 0] a = 1.019963264465332, b = 0.9998638082133946, delta = 0.0007274758536368608, c = 0.0007276164251048531, d = 0.0007287563482926835, m = 0.00045349434415199784
[Iteration 8700] [Rank 0] a = 1.0599703788757324, b = 0.9997322507201369, delta = 0.0007890890701673925, c = 0.00046450142747744773, d = 0.00046553772128456633, m = 0.00045376520052068655
timer                          - epoch: -1.000, value:  0.007 (event:reduce.combine)
[Iteration 8710] [Rank 0] a = 1.0166550874710083, b = 0.9998482119919211, delta = 0.0007345498306676745, c = 0.000696423981510584, d = 0.0006975984478253184, m = 0.0004546045261926546
[Iteration 8720] [Rank 0] a = 1.0152137279510498, b = 0.9998208365646009, delta = 0.0007344085606746376, c = 0.0006416731253678196, d = 0.0006430893935708816, m = 0.0004551354592638453
[Iteration 8730] [Rank 0] a = 1.015838861465454, b = 0.999753978345525, delta = 0.0007882355130277574, c = 0.0005079566811226198, d = 0.0005087857161683147, m = 0.00045547607318510464
[Iteration 8740] [Rank 0] a = 1.0064564943313599, b = 0.9998734284740711, delta = 0.0007426979718729854, c = 0.0007468569467903545, d = 0.0007481695856127047, m = 0.00045587917293638105
[Iteration 8750] [Rank 0] a = 1.0156134366989136, b = 0.9998186948908024, delta = 0.0007633704226464033, c = 0.0006373897776317294, d = 0.000638426071438848, m = 0.0004562494648515067

[Iteration 8620] [Rank 2] a = 0.9773045778274536, b = 0.9998890765103375, delta = 0.0007198599050752819, c = 0.0007781530197653354, d = 0.0007786711666688947, m = 0.0005060963568360407
[Iteration 8630] [Rank 2] a = 0.8977736234664917, b = 1.00052116387035, delta = 0.0006516373250633478, c = 0.002042327835069281, d = 0.002013277065343057, m = 0.0005068257909364606
[Iteration 8640] [Rank 2] a = 1.021616816520691, b = 0.9997790221111634, delta = 0.0007470819400623441, c = 0.0005580442151333509, d = 0.0005589077933059497, m = 0.0005070591634583634
[Iteration 8650] [Rank 2] a = 1.076387882232666, b = 0.999760990599874, delta = 0.0007134820334613323, c = 0.0005219811906456245, d = 0.000523052027579647, m = 0.0005076154863878129
[Iteration 8660] [Rank 2] a = 0.8933008313179016, b = 0.9999930167787369, delta = 0.0007105228723958135, c = 0.0009860335574733209, d = 0.0009862408162347445, m = 0.0005079357422684177

[Iteration 8620] [Rank 3] a = 0.9743126630783081, b = 0.9999906333029804, delta = 0.0007088961428962648, c = 0.0009812666059605755, d = 0.0009813702353412873, m = 0.0005460606630837903
[Iteration 8630] [Rank 3] a = 1.0298582315444946, b = 0.9998146015304019, delta = 0.0007328618667088449, c = 0.0006292030565554928, d = 0.0006303775228702271, m = 0.0005464230723805894
[Iteration 8640] [Rank 3] a = 0.9567996859550476, b = 1.0001347644991712, delta = 0.0006911919335834682, c = 0.001269528999974058, d = 0.0012666273773141261, m = 0.0005468427997220895
[Iteration 8650] [Rank 3] a = 1.0443761348724365, b = 0.9997520266589738, delta = 0.0007201081607490778, c = 0.0005040533077824732, d = 0.0005049859722088799, m = 0.0005475168588057184
[Iteration 8660] [Rank 3] a = 1.1041277647018433, b = 0.9996552886406503, delta = 0.0007790641393512487, c = 0.0003105772539934359, d = 0.000311233573404611, m = 0.0005477765947148475

[Iteration 8620] [Rank 1] a = 1.0586130619049072, b = 0.9997634431617454, delta = 0.0007483471999876201, c = 0.0005268863146659857, d = 0.0005278880653462004, m = 0.0006531832230132408
[Iteration 8630] [Rank 1] a = 1.0294703245162964, b = 0.9998225809924541, delta = 0.0007428535609506071, c = 0.0006451619811851187, d = 0.0006462673612460452, m = 0.0006533294395954095
[Iteration 8640] [Rank 1] a = 1.0092403888702393, b = 0.9999200444233224, delta = 0.0007261249120347202, c = 0.0008400888463041221, d = 0.0008410560538574327, m = 0.0006535183757341389
[Iteration 8650] [Rank 1] a = 1.0018672943115234, b = 1.0000647628532258, delta = 0.0006900757434777915, c = 0.0011295257066323392, d = 0.0011278330934140453, m = 0.0006540752818575972
[Iteration 8660] [Rank 1] a = 1.1200470924377441, b = 0.9996857729468315, delta = 0.0007721741567365825, c = 0.00037154587297891185, d = 0.00037230582177079884, m = 0.0006543992663961581
cross_entropy                  - bits:20368396224.000, epoch: 63.000, ratio_transmit_grad:  0.158, value:  5.376 (split:train)
last_cross_entropy             - bits:20368396224.000, epoch: 63.000, ratio_transmit_grad:  0.158, value:  5.376 (split:train)
perplexity                     - bits:20368396224.000, epoch: 63.000, ratio_transmit_grad:  0.158, value:216.674 (split:train)
last_perplexity                - bits:20368396224.000, epoch: 63.000, ratio_transmit_grad:  0.158, value:216.674 (split:train)
last_cross_entropy             - bits:20368396224.000, epoch: 63.000, ratio_transmit_grad:  0.158, value:  5.164 (split:test)
last_perplexity                - bits:20368396224.000, epoch: 63.000, ratio_transmit_grad:  0.158, value:175.398 (split:test)
runavg_cross_entropy           - bits:20368396224.000, epoch: 63.000, ratio_transmit_grad:  0.158, value:  5.360 (split:test)
runavg_perplexity              - bits:20368396224.000, epoch: 63.000, ratio_transmit_grad:  0.158, value:213.444 (split:test)
[Iteration 8670] [Rank 2] a = 0.9672120213508606, b = 0.9999755897712184, delta = 0.0007115115877240896, c = 0.0009511795424272329, d = 0.0009514904305693685, m = 0.0005082949854565851
[Iteration 8680] [Rank 2] a = 0.9876527786254883, b = 0.9998866412199215, delta = 0.0007211554911918938, c = 0.0007732824388718781, d = 0.0007743532758059007, m = 0.00050873898486059
[Iteration 8690] [Rank 2] a = 1.0376123189926147, b = 0.9998036859026981, delta = 0.000730894214939326, c = 0.0006073718003521948, d = 0.0006082699216516976, m = 0.0005091432381279587
[Iteration 8700] [Rank 2] a = 0.9994851350784302, b = 0.9999734135542251, delta = 0.0007046759710647166, c = 0.0009468271084373349, d = 0.0009473452553408942, m = 0.0005095133331333423
[Iteration 8710] [Rank 2] a = 1.033778429031372, b = 0.9998071574868205, delta = 0.0007242657011374831, c = 0.0006143149688598893, d = 0.0006155239783015276, m = 0.000509824456664597
[Iteration 8670] [Rank 3] a = 0.9692021608352661, b = 0.9999477825541033, delta = 0.0006884850445203483, c = 0.0008955651081118696, d = 0.0008958069100001972, m = 0.0005484689288761367
[Iteration 8680] [Rank 3] a = 1.009116768836975, b = 0.9998288332982339, delta = 0.0007163551053963602, c = 0.0006576665931243494, d = 0.000658771973185276, m = 0.0005489067602447767
[Iteration 8690] [Rank 3] a = 0.9844474792480469, b = 0.9998300595792033, delta = 0.0007510666619054973, c = 0.0006601191551345301, d = 0.0006611554489416487, m = 0.0005490913965806899
[Iteration 8700] [Rank 3] a = 0.9259033203125, b = 0.9999755206849648, delta = 0.0007354281260631979, c = 0.0009510413699196171, d = 0.0009511795424272329, m = 0.0005493285685545963
[Iteration 8710] [Rank 3] a = 0.9764650464057922, b = 1.0006125131400327, delta = 0.0006752607296220958, c = 0.002225026433264285, d = 0.0021860272429897226, m = 0.0005499276985707995
[Iteration 8670] [Rank 1] a = 1.0060620307922363, b = 0.9997550837255192, delta = 0.0007911041611805558, c = 0.0005101674412444728, d = 0.0005113764506861112, m = 0.0006544141770631206
[Iteration 8680] [Rank 1] a = 0.9346845746040344, b = 1.0007522400230697, delta = 0.0006856798427179456, c = 0.00250448032991726, d = 0.002458710686769523, m = 0.0006551928181882945
[Iteration 8690] [Rank 1] a = 1.0315073728561401, b = 0.9997796266158548, delta = 0.0007745326147414744, c = 0.0005592532245749891, d = 0.0005602895183821077, m = 0.0006552973026654028
[Iteration 8700] [Rank 1] a = 1.030933141708374, b = 0.999775878686771, delta = 0.0007686096359975636, c = 0.0005517573660368314, d = 0.0005524827717018145, m = 0.0006555025839348526
[Iteration 8710] [Rank 1] a = 1.0689946413040161, b = 0.9997658784520573, delta = 0.0007585474522784352, c = 0.000531756895559443, d = 0.0005325859306051379, m = 0.0006558234074032822
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8756 |     0.11048s |  92.9%
- batch.accumulate               |   8756 |     0.00083s |   0.7%
- batch.backward                 |   8756 |     0.05166s |  43.4%
- batch.evaluate                 |   8756 |     0.00275s |   2.3%
- batch.forward                  |   8756 |     0.02542s |  21.4%
- batch.mom                      |   8756 |     0.00126s |   1.1%
- batch.reduce                   |   8756 |     0.02574s |  21.6%
- batch.reporting.compr_err      |   8756 |     0.00001s |   0.0%
- batch.reporting.lr             |   8756 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8756 |     0.00001s |   0.0%
- batch.step                     |   8756 |     0.00048s |   0.4%
- batch.update_runavg            |   8756 |     0.00130s |   1.1%
- batch.wd                       |   8756 |     0.00001s |   0.0%
[Iteration 8720] [Rank 2] a = 0.957627534866333, b = 1.0000260918227413, delta = 0.0007018442847765982, c = 0.0010521836454943896, d = 0.0010518727573522542, m = 0.0005103185580175086
[Iteration 8730] [Rank 2] a = 0.9827984571456909, b = 1.0014606668442663, delta = 0.0006317537627182901, c = 0.003921335766136675, d = 0.0036792229896668725, m = 0.0005119444993717851
[Iteration 8740] [Rank 2] a = 1.0414233207702637, b = 0.9997767077217752, delta = 0.0007169783348217607, c = 0.0005534154361282212, d = 0.0005541062986663002, m = 0.0005124237227344541
[Iteration 8750] [Rank 2] a = 1.0414727926254272, b = 0.9998022869061126, delta = 0.0007278065313585103, c = 0.0006045738070729747, d = 0.0006054028421186695, m = 0.0005126660489151883
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8756 |     0.11051s |  92.9%
- batch.accumulate               |   8756 |     0.00083s |   0.7%
[Iteration 8720] [Rank 3] a = 0.9486103653907776, b = 0.9999043791153926, delta = 0.0007292248192243278, c = 0.0008087582302022372, d = 0.0008094836358672203, m = 0.0005501743909050768
[Iteration 8730] [Rank 3] a = 1.032099723815918, b = 0.9998192648523777, delta = 0.0007334582041949034, c = 0.0006385297008195598, d = 0.0006395659946266785, m = 0.0005504446203923051
[Iteration 8740] [Rank 3] a = 0.9739741086959839, b = 0.9998596630382451, delta = 0.0007523208623751998, c = 0.0007193260746479045, d = 0.0007199478509321756, m = 0.0005508169085608596
[Iteration 8750] [Rank 3] a = 1.0517865419387817, b = 0.9997376912622422, delta = 0.000762107374612242, c = 0.00047538251245219276, d = 0.00047610791811717574, m = 0.0005510899427728425
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8756 |     0.11058s |  93.0%
- batch.accumulate               |   8756 |     0.00082s |   0.7%
[Iteration 8720] [Rank 1] a = 1.075696587562561, b = 0.9997373112878725, delta = 0.0007550159352831542, c = 0.0004746225636603058, d = 0.00047569340059432834, m = 0.0006563838037463702
[Iteration 8730] [Rank 1] a = 0.8738494515419006, b = 1.0003563931871136, delta = 0.0006916931597515941, c = 0.0017127864044055752, d = 0.001693407710212458, m = 0.0006568045895897667
[Iteration 8740] [Rank 1] a = 0.9632211923599243, b = 0.9999303037319555, delta = 0.0007406612858176231, c = 0.0008606074636850697, d = 0.000861194696842437, m = 0.0006569241312717786
[Iteration 8750] [Rank 1] a = 0.9023890495300293, b = 1.0022749145460292, delta = 0.0006821741699241102, c = 0.005549836940896606, d = 0.005214768609928268, m = 0.0006575028418871799
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8756 |     0.11048s |  92.9%
- batch.accumulate               |   8756 |     0.00083s |   0.7%
- epoch_metrics.collect          |     62 |     0.00859s |   0.1%
- reduce.combine                 |   8756 |     0.00632s |   5.3%
- reduce.flatpack                |   8756 |     0.00002s |   0.0%
- reduce.flatput                 |   8756 |     0.00019s |   0.2%
- reduce.gather.context          |   8756 |     0.00119s |   1.0%
- reduce.gather.tensors          |   8756 |     0.00366s |   3.1%
- reduce.heur_params             |   8756 |     0.01104s |   9.3%
- reduce.heur_params.alpha       |   8755 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   8755 |     0.00225s |   1.9%
- reduce.memory                  |   8756 |     0.00046s |   0.4%
- reduce.pad                     |   8756 |     0.00028s |   0.2%
- reduce.threshold               |   8756 |     0.00237s |   2.0%
- test.last                      |     62 |     0.41177s |   2.5%
- test.runavg                    |     62 |     0.44276s |   2.7%
-----------------------------------------------------------------

- batch.backward                 |   8756 |     0.05182s |  43.6%
- batch.evaluate                 |   8756 |     0.00275s |   2.3%
- batch.forward                  |   8756 |     0.02552s |  21.5%
- batch.mom                      |   8756 |     0.00126s |   1.1%
- batch.reduce                   |   8756 |     0.02557s |  21.5%
- batch.reporting.compr_err      |   8756 |     0.00001s |   0.0%
- batch.reporting.lr             |   8756 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8756 |     0.00001s |   0.0%
- batch.step                     |   8756 |     0.00048s |   0.4%
- batch.update_runavg            |   8756 |     0.00130s |   1.1%
- batch.wd                       |   8756 |     0.00001s |   0.0%
- epoch_metrics.collect          |     62 |     0.01306s |   0.1%
- reduce.combine                 |   8756 |     0.00608s |   5.1%
- reduce.flatpack                |   8756 |     0.00002s |   0.0%
- reduce.flatput                 |   8756 |     0.00018s |   0.2%
- batch.backward                 |   8756 |     0.05174s |  43.5%
- batch.evaluate                 |   8756 |     0.00277s |   2.3%
- batch.forward                  |   8756 |     0.02538s |  21.3%
- batch.mom                      |   8756 |     0.00126s |   1.1%
- batch.reduce                   |   8756 |     0.02583s |  21.7%
- batch.reporting.compr_err      |   8756 |     0.00001s |   0.0%
- batch.reporting.lr             |   8756 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8756 |     0.00001s |   0.0%
- batch.step                     |   8756 |     0.00047s |   0.4%
- batch.update_runavg            |   8756 |     0.00130s |   1.1%
- batch.wd                       |   8756 |     0.00001s |   0.0%
- epoch_metrics.collect          |     62 |     0.00838s |   0.1%
- reduce.combine                 |   8756 |     0.00604s |   5.1%
- reduce.flatpack                |   8756 |     0.00002s |   0.0%
- reduce.flatput                 |   8756 |     0.00019s |   0.2%
- batch.backward                 |   8756 |     0.05177s |  43.5%
- batch.evaluate                 |   8756 |     0.00276s |   2.3%
- batch.forward                  |   8756 |     0.02542s |  21.4%
- batch.mom                      |   8756 |     0.00126s |   1.1%
- batch.reduce                   |   8756 |     0.02568s |  21.6%
- batch.reporting.compr_err      |   8756 |     0.00001s |   0.0%
- batch.reporting.lr             |   8756 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8756 |     0.00001s |   0.0%
- batch.step                     |   8756 |     0.00048s |   0.4%
- batch.update_runavg            |   8756 |     0.00130s |   1.1%
- batch.wd                       |   8756 |     0.00001s |   0.0%
- epoch_metrics.collect          |     62 |     0.00861s |   0.1%
- reduce.combine                 |   8756 |     0.00613s |   5.2%
- reduce.flatpack                |   8756 |     0.00002s |   0.0%
- reduce.flatput                 |   8756 |     0.00023s |   0.2%
[Iteration 8760] [Rank 0] a = 1.1084091663360596, b = 0.9996764808466392, delta = 0.0008133971714414656, c = 0.0003529616707045855, d = 0.0003535489038619527, m = 0.0004568262806084408
[Iteration 8770] [Rank 0] a = 1.0448282957077026, b = 0.9997092795425381, delta = 0.0008192730019800365, c = 0.00041855906869519107, d = 0.0004192153881063662, m = 0.0004570649196316226
[Iteration 8780] [Rank 0] a = 1.0026898384094238, b = 0.9999402003377716, delta = 0.0007313615642488003, c = 0.0008804006754010345, d = 0.0008812642535736333, m = 0.0004576530293228166
[Iteration 8790] [Rank 0] a = 1.0520296096801758, b = 0.9997969499932204, delta = 0.0007472278666682541, c = 0.0005938999808596534, d = 0.00059483264528606, m = 0.0004585045111714803
[Iteration 8800] [Rank 0] a = 0.9572619199752808, b = 0.9999509950648973, delta = 0.0007398700108751655, c = 0.0009019901297160047, d = 0.000902542819746468, m = 0.0004592913576276585
- reduce.gather.context          |   8756 |     0.00185s |   1.6%
- reduce.gather.tensors          |   8756 |     0.00358s |   3.0%
- reduce.heur_params             |   8756 |     0.01055s |   8.9%
- reduce.heur_params.alpha       |   8755 |     0.00822s |   6.9%
- reduce.gather.context          |   8756 |     0.00251s |   2.1%
- reduce.gather.tensors          |   8756 |     0.00325s |   2.7%
- reduce.heur_params             |   8756 |     0.01047s |   8.8%
- reduce.gather.context          |   8756 |     0.00133s |   1.1%
- reduce.gather.tensors          |   8756 |     0.00358s |   3.0%
- reduce.heur_params             |   8756 |     0.01089s |   9.2%
[Iteration 8810] [Rank 0] a = 0.9738821983337402, b = 0.9999753652408938, delta = 0.0007497755577787757, c = 0.0009507304817774815, d = 0.0009508686542850974, m = 0.0004595351796469
[Iteration 8820] [Rank 0] a = 1.0194214582443237, b = 0.999850768183254, delta = 0.0007376977009698749, c = 0.0007015363642923691, d = 0.0007025726580994876, m = 0.0004602922724726045
[Iteration 8830] [Rank 0] a = 0.9472296833992004, b = 1.0004027500567316, delta = 0.0007145287236198783, c = 0.0018055001570157834, d = 0.0017922010531577616, m = 0.00046071727897118624
[Iteration 8840] [Rank 0] a = 0.9027206301689148, b = 1.0000479576220407, delta = 0.0007601252291351557, c = 0.0010959152441547934, d = 0.0010953280109974263, m = 0.00046098190052043693
[Iteration 8850] [Rank 0] a = 0.9718873500823975, b = 1.0007742267105355, delta = 0.0007016941090114415, c = 0.002548453730465991, d = 0.0024858615845160296, m = 0.0004616941730028668
- reduce.heur_params.beta        |   8755 |     0.00226s |   1.9%
- reduce.memory                  |   8756 |     0.00045s |   0.4%
- reduce.pad                     |   8756 |     0.00028s |   0.2%
- reduce.threshold               |   8756 |     0.00238s |   2.0%
- test.last                      |     62 |     0.41178s |   2.5%
- test.runavg                    |     62 |     0.44275s |   2.7%
-----------------------------------------------------------------

[Iteration 8760] [Rank 2] a = 0.9870812296867371, b = 0.9997401265525231, delta = 0.0008088235626928508, c = 0.00048025309334565004, d = 0.0004815657321680002, m = 0.0005128545542800236
[Iteration 8770] [Rank 2] a = 1.0678002834320068, b = 0.9998314758473658, delta = 0.0006855487008579075, c = 0.0006629516915406542, d = 0.0006641261578553886, m = 0.000514003784141124
[Iteration 8780] [Rank 2] a = 0.8736911416053772, b = 1.0006220643109822, delta = 0.0006458071293309331, c = 0.0022441287824421707, d = 0.002227306279639946, m = 0.0005147101004301997
- reduce.heur_params.alpha       |   8755 |     0.00810s |   6.8%
- reduce.heur_params.beta        |   8755 |     0.00230s |   1.9%
- reduce.memory                  |   8756 |     0.00045s |   0.4%
- reduce.pad                     |   8756 |     0.00027s |   0.2%
- reduce.threshold               |   8756 |     0.00243s |   2.0%
- test.last                      |     62 |     0.41179s |   2.5%
- test.runavg                    |     62 |     0.44274s |   2.7%
-----------------------------------------------------------------

[Iteration 8760] [Rank 3] a = 0.9784857034683228, b = 1.0002311052768078, delta = 0.0007134777260944247, c = 0.0014622105618443046, d = 0.0014550255914482825, m = 0.0005514660067278842
[Iteration 8770] [Rank 3] a = 1.0216150283813477, b = 0.9998722021930859, delta = 0.0007048947154544294, c = 0.0007444043847801739, d = 0.0007452679629527727, m = 0.0005521613091330761
- reduce.heur_params.alpha       |   8755 |     0.00832s |   7.0%
- reduce.heur_params.beta        |   8755 |     0.00248s |   2.1%
- reduce.memory                  |   8756 |     0.00046s |   0.4%
- reduce.pad                     |   8756 |     0.00020s |   0.2%
- reduce.threshold               |   8756 |     0.00264s |   2.2%
- test.last                      |     62 |     0.41179s |   2.5%
- test.runavg                    |     62 |     0.44274s |   2.7%
-----------------------------------------------------------------

[Iteration 8760] [Rank 1] a = 1.0173661708831787, b = 0.9997974854116654, delta = 0.000751190003938973, c = 0.0005949708177936759, d = 0.0005959725684738905, m = 0.0006576656862736275
[Iteration 8770] [Rank 1] a = 1.0406743288040161, b = 0.9997192797769602, delta = 0.0007949137943796813, c = 0.0004385595391725795, d = 0.00043949220359898623, m = 0.0006577587698299932
[Iteration 8860] [Rank 0] a = 0.9949551224708557, b = 0.9998392653222715, delta = 0.0007519701612181962, c = 0.0006785306417743367, d = 0.0006796705649621672, m = 0.00046244825356053467
timer                          - epoch: 63.748, value:  0.000 (event:batch.step)
[Iteration 8870] [Rank 0] a = 1.0141488313674927, b = 0.9998456558005898, delta = 0.0007420871988870203, c = 0.0006913115987287991, d = 0.0006926933238049572, m = 0.00046281945249866587
[Iteration 8880] [Rank 0] a = 1.0416817665100098, b = 0.9997782276192837, delta = 0.000750398903619498, c = 0.000556455231295769, d = 0.0005574224388490797, m = 0.0004632789679589232
[Iteration 8890] [Rank 0] a = 1.0049052238464355, b = 0.9997567763386367, delta = 0.0007751637022010982, c = 0.0005135526676810601, d = 0.0005145544183612747, m = 0.00046371600745173154
cross_entropy                  - bits:20835685440.000, epoch: 64.000, ratio_transmit_grad:  0.181, value:  5.374 (split:train)
[Iteration 8790] [Rank 2] a = 1.1118608713150024, b = 0.9997024572755646, delta = 0.0007388804224319756, c = 0.00040491453356812987, d = 0.000405570852979305, m = 0.0005150330475504365
[Iteration 8800] [Rank 2] a = 1.0483325719833374, b = 0.9997730461505089, delta = 0.0007441064808517694, c = 0.0005460922932245833, d = 0.0005469904145240861, m = 0.0005152701530496996
[Iteration 8810] [Rank 2] a = 0.9049702286720276, b = 1.0010844755343746, delta = 0.0006707906723022461, c = 0.003168951919041688, d = 0.003115859132990313, m = 0.0005158092971236234
[Iteration 8820] [Rank 2] a = 0.9226416945457458, b = 1.0000147962202486, delta = 0.0007205780711956322, c = 0.0010295924404992048, d = 0.0010294197248646852, m = 0.0005160316980048952
[Iteration 8830] [Rank 2] a = 0.9989895224571228, b = 0.9998860885298981, delta = 0.0007005103398114443, c = 0.0007721770588109516, d = 0.0007732824388718781, m = 0.0005166470058631648
[Iteration 8780] [Rank 3] a = 0.8625328540802002, b = 1.0012464480360654, delta = 0.0006801493582315743, c = 0.0034928973631469535, d = 0.0034146226375825974, m = 0.000552561137905101
[Iteration 8790] [Rank 3] a = 0.9390153884887695, b = 1.000176768940461, delta = 0.0007056434405967593, c = 0.0013535378846044703, d = 0.0013505671756907304, m = 0.0005528712256868679
[Iteration 8800] [Rank 3] a = 0.9606670141220093, b = 0.9999005966430325, delta = 0.0007504438981413841, c = 0.0008011932854102717, d = 0.0008022295792173902, m = 0.0005530043332764808
[Iteration 8810] [Rank 3] a = 0.9663605093955994, b = 0.9998894046700392, delta = 0.0007489416166208684, c = 0.0007788093391765105, d = 0.000779880176110533, m = 0.0005532330840158983
[Iteration 8820] [Rank 3] a = 1.0858174562454224, b = 0.999829437802937, delta = 0.000680958095472306, c = 0.0006588756025659878, d = 0.0006596010082309708, m = 0.0005555413088946847
[Iteration 8780] [Rank 1] a = 0.9956114292144775, b = 0.9999267457899025, delta = 0.0007510481518693268, c = 0.0008534915795428556, d = 0.0008551496496342453, m = 0.0006578758463471504
[Iteration 8790] [Rank 1] a = 1.024182915687561, b = 0.9998098863937458, delta = 0.0007523265667259693, c = 0.0006197727829107137, d = 0.0006209817923523521, m = 0.0006583503670717195
[Iteration 8800] [Rank 1] a = 1.0826480388641357, b = 0.9997246512327785, delta = 0.00077883864287287, c = 0.0004493024516397087, d = 0.0004500969435584996, m = 0.0006585293431410836
[Iteration 8810] [Rank 1] a = 0.959475576877594, b = 0.9999024792434307, delta = 0.0007433667196892202, c = 0.0008049584862428025, d = 0.0008057875212884974, m = 0.000659682490962736
[Iteration 8820] [Rank 1] a = 1.0785454511642456, b = 0.9997228204471923, delta = 0.0007785206544212997, c = 0.0004456408801878897, d = 0.00044664263086810436, m = 0.0006600267686194063
last_cross_entropy             - bits:20835685440.000, epoch: 64.000, ratio_transmit_grad:  0.181, value:  5.374 (split:train)
perplexity                     - bits:20835685440.000, epoch: 64.000, ratio_transmit_grad:  0.181, value:216.238 (split:train)
last_perplexity                - bits:20835685440.000, epoch: 64.000, ratio_transmit_grad:  0.181, value:216.238 (split:train)
last_cross_entropy             - bits:20835685440.000, epoch: 64.000, ratio_transmit_grad:  0.181, value:  5.161 (split:test)
last_perplexity                - bits:20835685440.000, epoch: 64.000, ratio_transmit_grad:  0.181, value:174.924 (split:test)
runavg_cross_entropy           - bits:20835685440.000, epoch: 64.000, ratio_transmit_grad:  0.181, value:  5.360 (split:test)
runavg_perplexity              - bits:20835685440.000, epoch: 64.000, ratio_transmit_grad:  0.181, value:213.336 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
[Iteration 8840] [Rank 2] a = 1.0052533149719238, b = 0.9998559669237412, delta = 0.0007236441597342491, c = 0.0007119338454904587, d = 0.0007134191999473286, m = 0.0005168977911140801
[Iteration 8850] [Rank 2] a = 0.8655385375022888, b = 1.000390849951387, delta = 0.0006934587145224214, c = 0.00178169994257896, d = 0.001773098703979876, m = 0.0005174002162683843
[Iteration 8860] [Rank 2] a = 0.9824358224868774, b = 0.9998479356469121, delta = 0.0007411386468447745, c = 0.0006958712914801208, d = 0.0006968730421603354, m = 0.0005177057721184415
[Iteration 8870] [Rank 2] a = 1.0223499536514282, b = 0.999791526722526, delta = 0.0007427302189171314, c = 0.0005830534390118123, d = 0.0005841933621996428, m = 0.000518118563476138
[Iteration 8880] [Rank 2] a = 1.040632724761963, b = 0.9997876233493588, delta = 0.000753384898416698, c = 0.0005752466923315191, d = 0.0005762138998848297, m = 0.0005184049054390062
[Iteration 8830] [Rank 3] a = 1.0027012825012207, b = 0.9998888347084522, delta = 0.0007075683679431677, c = 0.0007776694159886801, d = 0.0007787402529227026, m = 0.000555753146446391
[Iteration 8840] [Rank 3] a = 1.1443179845809937, b = 0.9996886572976459, delta = 0.0007430305704474449, c = 0.0003773145751718719, d = 0.0003780745239637589, m = 0.0005563135657946628
[Iteration 8850] [Rank 3] a = 0.952151358127594, b = 0.9999408048424904, delta = 0.0007206967566162348, c = 0.0008816096848426728, d = 0.0008820587454924242, m = 0.000556564956751978
[Iteration 8860] [Rank 3] a = 0.9870651364326477, b = 0.9999343452777848, delta = 0.00073531229281798, c = 0.0008686905553805946, d = 0.0008693814179186736, m = 0.0005567137258451286
[Iteration 8870] [Rank 3] a = 1.0427742004394531, b = 0.9998062420939917, delta = 0.0007141896057873964, c = 0.0006124841831339797, d = 0.0006133132181796746, m = 0.0005572378583844759
[Iteration 8830] [Rank 1] a = 1.0635948181152344, b = 0.9996976039666714, delta = 0.0007756072445772588, c = 0.0003952079149081193, d = 0.00039610603620762204, m = 0.000661001238972783
[Iteration 8840] [Rank 1] a = 1.0267280340194702, b = 0.999841545168589, delta = 0.0007235807133838534, c = 0.0006830903345256585, d = 0.000684126628332777, m = 0.0006613971375225821
[Iteration 8850] [Rank 1] a = 0.952652096748352, b = 1.0001258696441446, delta = 0.0007104831747710705, c = 0.0012517392896185227, d = 0.0012495976157504776, m = 0.0006615762264549561
[Iteration 8860] [Rank 1] a = 0.959679126739502, b = 1.0003979312913007, delta = 0.0006945867789909244, c = 0.0017958626246095807, d = 0.0017823908051170392, m = 0.000661886877530802
[Iteration 8870] [Rank 1] a = 0.9639937281608582, b = 1.0001856637953466, delta = 0.0007171279285103083, c = 0.0013713275949600058, d = 0.0013672169628584354, m = 0.0006620198837806803
- batch                          |   8895 |     0.11051s |  92.9%
- batch.accumulate               |   8895 |     0.00083s |   0.7%
- batch.backward                 |   8895 |     0.05166s |  43.4%
- batch.evaluate                 |   8895 |     0.00275s |   2.3%
[Iteration 8890] [Rank 2] a = 0.8901817202568054, b = 1.000072897759573, delta = 0.0007240654085762799, c = 0.0011457955194041007, d = 0.001144759225596982, m = 0.0005187689712319859
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8895 |     0.11054s |  92.9%
- batch.accumulate               |   8895 |     0.00083s |   0.7%
- batch.backward                 |   8895 |     0.05182s |  43.6%
- batch.evaluate                 |   8895 |     0.00275s |   2.3%
- batch.forward                  |   8895 |     0.02551s |  21.4%
- batch.mom                      |   8895 |     0.00126s |   1.1%
- batch.reduce                   |   8895 |     0.02562s |  21.5%
- batch.reporting.compr_err      |   8895 |     0.00001s |   0.0%
- batch.reporting.lr             |   8895 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8895 |     0.00001s |   0.0%
[Iteration 8880] [Rank 3] a = 0.9931705594062805, b = 0.9998230300530897, delta = 0.0007389426464214921, c = 0.0006460601024846214, d = 0.0006475800000683954, m = 0.0005575313346855767
[Iteration 8890] [Rank 3] a = 1.0031853914260864, b = 0.9998125289428598, delta = 0.0007631111075170338, c = 0.0006250578813270185, d = 0.000626094175134137, m = 0.0005576581798580945
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8895 |     0.11060s |  93.0%
- batch.accumulate               |   8895 |     0.00082s |   0.7%
- batch.backward                 |   8895 |     0.05174s |  43.5%
- batch.evaluate                 |   8895 |     0.00277s |   2.3%
- batch.forward                  |   8895 |     0.02538s |  21.3%
- batch.mom                      |   8895 |     0.00126s |   1.1%
- batch.reduce                   |   8895 |     0.02585s |  21.7%
[Iteration 8880] [Rank 1] a = 1.062703251838684, b = 0.9997402129103342, delta = 0.0007511121220886707, c = 0.0004804258089801698, d = 0.0004811512146451528, m = 0.0006623687757879563
[Iteration 8890] [Rank 1] a = 1.061421275138855, b = 0.9997294181839362, delta = 0.0007858456228859723, c = 0.00045883635466519956, d = 0.00045956176033018254, m = 0.0006625069278989288
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   8895 |     0.11050s |  92.9%
- batch.accumulate               |   8895 |     0.00083s |   0.7%
- batch.backward                 |   8895 |     0.05177s |  43.5%
- batch.evaluate                 |   8895 |     0.00276s |   2.3%
- batch.forward                  |   8895 |     0.02542s |  21.4%
- batch.mom                      |   8895 |     0.00126s |   1.1%
- batch.reduce                   |   8895 |     0.02570s |  21.6%
- batch.forward                  |   8895 |     0.02542s |  21.4%
- batch.mom                      |   8895 |     0.00126s |   1.1%
- batch.reduce                   |   8895 |     0.02578s |  21.7%
- batch.reporting.compr_err      |   8895 |     0.00001s |   0.0%
- batch.reporting.lr             |   8895 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8895 |     0.00001s |   0.0%
- batch.step                     |   8895 |     0.00048s |   0.4%
- batch.update_runavg            |   8895 |     0.00130s |   1.1%
- batch.wd                       |   8895 |     0.00001s |   0.0%
- epoch_metrics.collect          |     63 |     0.00886s |   0.1%
- reduce.combine                 |   8895 |     0.00632s |   5.3%
- reduce.flatpack                |   8895 |     0.00002s |   0.0%
- reduce.flatput                 |   8895 |     0.00019s |   0.2%
- reduce.gather.context          |   8895 |     0.00118s |   1.0%
- reduce.gather.tensors          |   8895 |     0.00368s |   3.1%
- batch.step                     |   8895 |     0.00048s |   0.4%
- batch.update_runavg            |   8895 |     0.00130s |   1.1%
- batch.wd                       |   8895 |     0.00001s |   0.0%
- epoch_metrics.collect          |     63 |     0.01327s |   0.1%
- batch.reporting.compr_err      |   8895 |     0.00001s |   0.0%
- batch.reporting.lr             |   8895 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8895 |     0.00001s |   0.0%
- batch.step                     |   8895 |     0.00047s |   0.4%
- batch.update_runavg            |   8895 |     0.00130s |   1.1%
- batch.reporting.compr_err      |   8895 |     0.00001s |   0.0%
- batch.reporting.lr             |   8895 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   8895 |     0.00001s |   0.0%
- batch.step                     |   8895 |     0.00048s |   0.4%
- batch.update_runavg            |   8895 |     0.00130s |   1.1%
- reduce.heur_params             |   8895 |     0.01105s |   9.3%
- reduce.heur_params.alpha       |   8894 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   8894 |     0.00226s |   1.9%
- reduce.memory                  |   8895 |     0.00046s |   0.4%
- reduce.pad                     |   8895 |     0.00028s |   0.2%
- reduce.threshold               |   8895 |     0.00237s |   2.0%
- test.last                      |     63 |     0.41169s |   2.5%
- test.runavg                    |     63 |     0.44267s |   2.7%
-----------------------------------------------------------------
- reduce.combine                 |   8895 |     0.00608s |   5.1%
- reduce.flatpack                |   8895 |     0.00002s |   0.0%
- reduce.flatput                 |   8895 |     0.00018s |   0.2%
- reduce.gather.context          |   8895 |     0.00186s |   1.6%
- reduce.gather.tensors          |   8895 |     0.00359s |   3.0%
- reduce.heur_params             |   8895 |     0.01056s |   8.9%
- reduce.heur_params.alpha       |   8894 |     0.00822s |   6.9%
- reduce.heur_params.beta        |   8894 |     0.00226s |   1.9%
- reduce.memory                  |   8895 |     0.00045s |   0.4%
- reduce.pad                     |   8895 |     0.00027s |   0.2%
- reduce.threshold               |   8895 |     0.00238s |   2.0%
- test.last                      |     63 |     0.41170s |   2.5%
- test.runavg                    |     63 |     0.44266s |   2.7%
-----------------------------------------------------------------
- batch.wd                       |   8895 |     0.00001s |   0.0%
- epoch_metrics.collect          |     63 |     0.00827s |   0.1%
- reduce.combine                 |   8895 |     0.00605s |   5.1%
- reduce.flatpack                |   8895 |     0.00002s |   0.0%
- reduce.flatput                 |   8895 |     0.00019s |   0.2%
- reduce.gather.context          |   8895 |     0.00250s |   2.1%
- reduce.gather.tensors          |   8895 |     0.00326s |   2.7%
- reduce.heur_params             |   8895 |     0.01048s |   8.8%
- reduce.heur_params.alpha       |   8894 |     0.00810s |   6.8%
- reduce.heur_params.beta        |   8894 |     0.00230s |   1.9%
- reduce.memory                  |   8895 |     0.00045s |   0.4%
- reduce.pad                     |   8895 |     0.00027s |   0.2%
- reduce.threshold               |   8895 |     0.00243s |   2.0%
- test.last                      |     63 |     0.41170s |   2.5%
- test.runavg                    |     63 |     0.44266s |   2.7%
- batch.wd                       |   8895 |     0.00001s |   0.0%
- epoch_metrics.collect          |     63 |     0.00849s |   0.1%
- reduce.combine                 |   8895 |     0.00614s |   5.2%
- reduce.flatpack                |   8895 |     0.00002s |   0.0%
- reduce.flatput                 |   8895 |     0.00023s |   0.2%
- reduce.gather.context          |   8895 |     0.00132s |   1.1%
- reduce.gather.tensors          |   8895 |     0.00359s |   3.0%
- reduce.heur_params             |   8895 |     0.01089s |   9.2%
- reduce.heur_params.alpha       |   8894 |     0.00833s |   7.0%
- reduce.heur_params.beta        |   8894 |     0.00249s |   2.1%
- reduce.memory                  |   8895 |     0.00046s |   0.4%
- reduce.pad                     |   8895 |     0.00020s |   0.2%
- reduce.threshold               |   8895 |     0.00264s |   2.2%
- test.last                      |     63 |     0.41170s |   2.5%
- test.runavg                    |     63 |     0.44266s |   2.7%
-----------------------------------------------------------------
-----------------------------------------------------------------

[Iteration 8900] [Rank 0] a = 1.073523759841919, b = 0.9997467070177648, delta = 0.0007393072010017931, c = 0.0004934140246960559, d = 0.0004941394303610389, m = 0.00046489757710684173
[Iteration 8910] [Rank 0] a = 0.9560033679008484, b = 0.9999172809731884, delta = 0.0007501724758185446, c = 0.0008345619459994896, d = 0.000835011006649241, m = 0.0004651775672239239
[Iteration 8920] [Rank 0] a = 1.0238527059555054, b = 0.9997595916033147, delta = 0.0007566718268208206, c = 0.0005191831973664044, d = 0.0005203231205542348, m = 0.0004662957030426612
[Iteration 8930] [Rank 0] a = 1.0112626552581787, b = 0.9998463812062378, delta = 0.0007366600912064314, c = 0.0006927624100587651, d = 0.0006938332469927876, m = 0.0004666522060953237
[Iteration 8940] [Rank 0] a = 0.9942492842674255, b = 0.9999335507858693, delta = 0.0006963754422031343, c = 0.0008671015715430128, d = 0.0008678615203348998, m = 0.0004684526149031074
memory_norm                    - epoch: 64.338, value:  1.178 (weight:encoder.weight)
memory_inf_norm                - epoch: 64.338, value:  0.001 (weight:encoder.weight)
memory_norm                    - epoch: 64.338, value:  0.363 (weight:rnn.weight_ih_l0)
memory_inf_norm                - epoch: 64.338, value:  0.001 (weight:rnn.weight_ih_l0)
memory_norm                    - epoch: 64.338, value:  0.337 (weight:rnn.weight_hh_l0)
memory_inf_norm                - epoch: 64.338, value:  0.001 (weight:rnn.weight_hh_l0)
memory_norm                    - epoch: 64.338, value:  0.015 (weight:rnn.bias_ih_l0)
memory_inf_norm                - epoch: 64.338, value:  0.001 (weight:rnn.bias_ih_l0)
memory_norm                    - epoch: 64.338, value:  0.015 (weight:rnn.bias_hh_l0)
memory_inf_norm                - epoch: 64.338, value:  0.001 (weight:rnn.bias_hh_l0)
memory_norm                    - epoch: 64.338, value:  0.285 (weight:rnn.weight_ih_l1)
memory_inf_norm                - epoch: 64.338, value:  0.001 (weight:rnn.weight_ih_l1)
memory_norm                    - epoch: 64.338, value:  0.219 (weight:rnn.weight_hh_l1)
memory_inf_norm                - epoch: 64.338, value:  0.001 (weight:rnn.weight_hh_l1)
memory_norm                    - epoch: 64.338, value:  0.014 (weight:rnn.bias_ih_l1)
memory_inf_norm                - epoch: 64.338, value:  0.001 (weight:rnn.bias_ih_l1)
memory_norm                    - epoch: 64.338, value:  0.014 (weight:rnn.bias_hh_l1)
memory_inf_norm                - epoch: 64.338, value:  0.001 (weight:rnn.bias_hh_l1)
memory_norm                    - epoch: 64.338, value:  0.251 (weight:rnn.weight_ih_l2)
memory_inf_norm                - epoch: 64.338, value:  0.001 (weight:rnn.weight_ih_l2)
memory_norm                    - epoch: 64.338, value:  0.197 (weight:rnn.weight_hh_l2)
memory_inf_norm                - epoch: 64.338, value:  0.001 (weight:rnn.weight_hh_l2)
memory_norm                    - epoch: 64.338, value:  0.016 (weight:rnn.bias_ih_l2)
memory_inf_norm                - epoch: 64.338, value:  0.001 (weight:rnn.bias_ih_l2)
memory_norm                    - epoch: 64.338, value:  0.016 (weight:rnn.bias_hh_l2)
memory_inf_norm                - epoch: 64.338, value:  0.001 (weight:rnn.bias_hh_l2)
memory_norm                    - epoch: 64.338, value:  0.055 (weight:decoder.bias)
memory_inf_norm                - epoch: 64.338, value:  0.001 (weight:decoder.bias)
memory_norm                    - epoch: 64.338, value:  1.367 (weight:entire_model)
memory_inf_norm                - epoch: 64.338, value:  0.001 (weight:entire_model)
[Iteration 8950] [Rank 0] a = 0.992207944393158, b = 0.9998701296055058, delta = 0.0007076245965436101, c = 0.0007402592095516996, d = 0.0007409846152166827, m = 0.000468927833387411
[Iteration 8960] [Rank 0] a = 0.9793500304222107, b = 0.9999322554186162, delta = 0.0006968050147406757, c = 0.0008645108370252164, d = 0.000865512587705431, m = 0.00047052779418201636
[Iteration 8970] [Rank 0] a = 1.0640034675598145, b = 0.9997768286227133, delta = 0.0007152852485887706, c = 0.0005536572380165489, d = 0.0005545899024429555, m = 0.00047101712527102343
[Iteration 8980] [Rank 0] a = 1.0097107887268066, b = 0.9998525471542504, delta = 0.0007034941227175295, c = 0.0007050943063634761, d = 0.0007059578845360749, m = 0.000471618861656423
[Iteration 8990] [Rank 0] a = 0.9789358973503113, b = 0.9999276266396336, delta = 0.0007034054724499583, c = 0.0008552532790149571, d = 0.0008561859434413639, m = 0.0004719967635080702
[Iteration 9000] [Rank 0] a = 0.9354655146598816, b = 0.9999781459626081, delta = 0.000734722416382283, c = 0.0009562919252090179, d = 0.0009564991839704416, m = 0.00047224187791096217
[Iteration 9010] [Rank 0] a = 1.1088066101074219, b = 0.9996805223920692, delta = 0.0007516469340771437, c = 0.00036104476240011036, d = 0.00036163199555747756, m = 0.00047309603805895247
[Iteration 9020] [Rank 0] a = 1.100077509880066, b = 0.9997368276841292, delta = 0.0007543385145254433, c = 0.00047365535610699515, d = 0.0004743116755181702, m = 0.0004735431033894272
[Iteration 9030] [Rank 0] a = 0.967993974685669, b = 0.9999965747208079, delta = 0.0007314080139622092, c = 0.000993149441615535, d = 0.0009933221572500548, m = 0.00047379448485220747
cross_entropy                  - bits:21316004032.000, epoch: 65.000, ratio_transmit_grad:  0.187, value:  5.371 (split:train)
last_cross_entropy             - bits:21316004032.000, epoch: 65.000, ratio_transmit_grad:  0.187, value:  5.371 (split:train)
perplexity                     - bits:21316004032.000, epoch: 65.000, ratio_transmit_grad:  0.187, value:215.677 (split:train)
last_perplexity                - bits:21316004032.000, epoch: 65.000, ratio_transmit_grad:  0.187, value:215.677 (split:train)
last_cross_entropy             - bits:21316004032.000, epoch: 65.000, ratio_transmit_grad:  0.187, value:  5.159 (split:test)
last_perplexity                - bits:21316004032.000, epoch: 65.000, ratio_transmit_grad:  0.187, value:174.617 (split:test)
runavg_cross_entropy           - bits:21316004032.000, epoch: 65.000, ratio_transmit_grad:  0.187, value:  5.360 (split:test)
runavg_perplexity              - bits:21316004032.000, epoch: 65.000, ratio_transmit_grad:  0.187, value:213.454 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9034 |     0.11053s |  92.9%
- batch.accumulate               |   9034 |     0.00083s |   0.7%
- batch.backward                 |   9034 |     0.05166s |  43.4%
- batch.evaluate                 |   9034 |     0.00275s |   2.3%
- batch.forward                  |   9034 |     0.02542s |  21.4%
- batch.mom                      |   9034 |     0.00126s |   1.1%
- batch.reduce                   |   9034 |     0.02581s |  21.7%
- batch.reporting.compr_err      |   9034 |     0.00001s |   0.0%
- batch.reporting.lr             |   9034 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9034 |     0.00001s |   0.0%
- batch.step                     |   9034 |     0.00048s |   0.4%
- batch.update_runavg            |   9034 |     0.00130s |   1.1%
- batch.wd                       |   9034 |     0.00001s |   0.0%
- epoch_metrics.collect          |     64 |     0.00877s |   0.1%
- reduce.combine                 |   9034 |     0.00633s |   5.3%
- reduce.flatpack                |   9034 |     0.00002s |   0.0%
- reduce.flatput                 |   9034 |     0.00019s |   0.2%
- reduce.gather.context          |   9034 |     0.00118s |   1.0%
- reduce.gather.tensors          |   9034 |     0.00370s |   3.1%
- reduce.heur_params             |   9034 |     0.01105s |   9.3%
- reduce.heur_params.alpha       |   9033 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   9033 |     0.00226s |   1.9%
- reduce.memory                  |   9034 |     0.00046s |   0.4%
- reduce.pad                     |   9034 |     0.00028s |   0.2%
- reduce.threshold               |   9034 |     0.00238s |   2.0%
- test.last                      |     64 |     0.41169s |   2.5%
- test.runavg                    |     64 |     0.44256s |   2.7%
-----------------------------------------------------------------


[Iteration 8900] [Rank 3] a = 1.0474834442138672, b = 0.999739522047843, delta = 0.0007662093266844749, c = 0.0004790440839040117, d = 0.00047980403269589863, m = 0.0005583874343383149
[Iteration 8910] [Rank 3] a = 0.948881208896637, b = 0.9998391098782042, delta = 0.0007434985018335283, c = 0.0006782197536322011, d = 0.0006793251336931277, m = 0.0005587994230157775
[Iteration 8920] [Rank 3] a = 0.9487505555152893, b = 1.000559990333639, delta = 0.0006743610138073564, c = 0.002119980784349366, d = 0.00209082638524243, m = 0.0005592801164050924
[Iteration 8930] [Rank 3] a = 0.7956041097640991, b = 1.0025841773332413, delta = 0.0006536493310704827, c = 0.006168366171238777, d = 0.005826561930524169, m = 0.000559998355908678
[Iteration 8940] [Rank 3] a = 0.9843878746032715, b = 1.0000489421011551, delta = 0.0006990641704760492, c = 0.0010978842023883187, d = 0.0010968133654542963, m = 0.0005601812451317464

[Iteration 8900] [Rank 1] a = 0.9219408631324768, b = 1.0001715874715826, delta = 0.0007373475236818194, c = 0.0013431749465332846, d = 0.0013394097457007537, m = 0.0006627058070358229
[Iteration 8910] [Rank 1] a = 0.9682336449623108, b = 0.999892133577032, delta = 0.0007565098349004984, c = 0.000784267153227335, d = 0.0007849925588923179, m = 0.0006628540784244424
[Iteration 8920] [Rank 1] a = 1.0241243839263916, b = 0.9998626337471016, delta = 0.0007374116103164852, c = 0.0007252674924753843, d = 0.0007261656137748871, m = 0.0006631975088109575
[Iteration 8930] [Rank 1] a = 0.9388653635978699, b = 1.0000286998288206, delta = 0.0007523666718043387, c = 0.0010573996576568865, d = 0.0010571578557685589, m = 0.0006633290861285538
[Iteration 8940] [Rank 1] a = 0.9453963041305542, b = 1.000159618278439, delta = 0.0007237736717797816, c = 0.0013192365595888456, d = 0.0013142278061877724, m = 0.0006636053103986807
[Iteration 8950] [Rank 3] a = 1.0463082790374756, b = 0.9997600752070637, delta = 0.0007213728385977447, c = 0.000520150404919715, d = 0.0005208758105846981, m = 0.0005607079953785564
[Iteration 8960] [Rank 3] a = 1.0103950500488281, b = 0.9998185912614252, delta = 0.0007422709604725242, c = 0.0006371825188703057, d = 0.0006383224420581362, m = 0.0005608798739513478
[Iteration 8970] [Rank 3] a = 0.9784126281738281, b = 0.9998835668816675, delta = 0.0007347575738094747, c = 0.0007671337622829746, d = 0.0007678591679479576, m = 0.0005611209638611371
[Iteration 8980] [Rank 3] a = 0.9570750594139099, b = 0.9999729644935755, delta = 0.0007345337653532624, c = 0.0009459289871378322, d = 0.0009462398752799677, m = 0.00056131150031135
[Iteration 8990] [Rank 3] a = 1.080753207206726, b = 0.9997083641497528, delta = 0.0007759235450066626, c = 0.0004167282829692816, d = 0.0004173846023804567, m = 0.0005615661771818294
[Iteration 9000] [Rank 3] a = 1.1306928396224976, b = 0.9996424558705879, delta = 0.000817251275293529, c = 0.0002849117107037993, d = 0.00028529168509974274, m = 0.0005622820093846784
[Iteration 9010] [Rank 3] a = 0.9309865236282349, b = 0.9999658486094402, delta = 0.000710044929292053, c = 0.0009316972188534038, d = 0.0009320771932493472, m = 0.0005628410291428872
[Iteration 9020] [Rank 3] a = 0.9914646744728088, b = 0.9998142560991448, delta = 0.0007677300600335002, c = 0.0006285121940174137, d = 0.0006296175740783402, m = 0.0005629298102824997
[Iteration 9030] [Rank 3] a = 0.9250150322914124, b = 1.0000193731845621, delta = 0.0007439976325258613, c = 0.0010387463691287522, d = 0.0010385736534942324, m = 0.0005631627369604999
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9034 |     0.11063s |  93.0%
- batch.accumulate               |   9034 |     0.00082s |   0.7%
[Iteration 8950] [Rank 1] a = 0.9727253317832947, b = 0.9999325490351936, delta = 0.0007616172078996897, c = 0.0008650980701825836, d = 0.0008659961914820863, m = 0.0006636664305535581
[Iteration 8960] [Rank 1] a = 1.0405714511871338, b = 0.9998340147671222, delta = 0.0007442710921168327, c = 0.0006680295311955353, d = 0.0006692385406371735, m = 0.0006640417949123808
[Iteration 8970] [Rank 1] a = 1.0304228067398071, b = 0.9997913885500244, delta = 0.0007667116005904973, c = 0.0005827770939965807, d = 0.000583986103438219, m = 0.0006642082242541962
[Iteration 8980] [Rank 1] a = 0.9536198973655701, b = 1.0002115020532505, delta = 0.0007371627143584192, c = 0.0014230041128083185, d = 0.0014179953594072455, m = 0.0006645012898287985
[Iteration 8990] [Rank 1] a = 0.9465137124061584, b = 1.0000304269851643, delta = 0.000741827127058059, c = 0.0010608539703472817, d = 0.0010603703665706264, m = 0.000664896633637345
- batch.backward                 |   9034 |     0.05174s |  43.5%
- batch.evaluate                 |   9034 |     0.00277s |   2.3%
- batch.forward                  |   9034 |     0.02538s |  21.3%
- batch.mom                      |   9034 |     0.00126s |   1.1%
- batch.reduce                   |   9034 |     0.02588s |  21.7%
- batch.reporting.compr_err      |   9034 |     0.00001s |   0.0%
- batch.reporting.lr             |   9034 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9034 |     0.00001s |   0.0%
- batch.step                     |   9034 |     0.00047s |   0.4%
- batch.update_runavg            |   9034 |     0.00130s |   1.1%
- batch.wd                       |   9034 |     0.00001s |   0.0%
- epoch_metrics.collect          |     64 |     0.00820s |   0.1%
- reduce.combine                 |   9034 |     0.00606s |   5.1%
- reduce.flatpack                |   9034 |     0.00002s |   0.0%
- reduce.flatput                 |   9034 |     0.00019s |   0.2%
[Iteration 9000] [Rank 1] a = 1.083407998085022, b = 0.9997881069531137, delta = 0.0007169277523644269, c = 0.0005762138998848297, d = 0.0005773192799457562, m = 0.0006664638844043595
[Iteration 9010] [Rank 1] a = 1.016642451286316, b = 0.9998207329352234, delta = 0.0007449471740983427, c = 0.0006414658666063958, d = 0.0006426057897942262, m = 0.0006665121905161718
[Iteration 9020] [Rank 1] a = 1.0630466938018799, b = 0.9997666729439327, delta = 0.0007411297410726547, c = 0.0005333458793970249, d = 0.0005344858025848553, m = 0.000666897702916282
[Iteration 9030] [Rank 1] a = 1.0311027765274048, b = 0.9997657057364323, delta = 0.0007479203632101417, c = 0.0005314114642904035, d = 0.0005328277324934656, m = 0.0006674155272104412
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9034 |     0.11053s |  92.9%
- batch.accumulate               |   9034 |     0.00083s |   0.7%
- reduce.gather.context          |   9034 |     0.00250s |   2.1%
- reduce.gather.tensors          |   9034 |     0.00328s |   2.8%
- reduce.heur_params             |   9034 |     0.01048s |   8.8%
- reduce.heur_params.alpha       |   9033 |     0.00810s |   6.8%
- batch.backward                 |   9034 |     0.05177s |  43.5%
- batch.evaluate                 |   9034 |     0.00276s |   2.3%
- batch.forward                  |   9034 |     0.02542s |  21.4%
- batch.mom                      |   9034 |     0.00126s |   1.1%
- batch.reduce                   |   9034 |     0.02572s |  21.6%
- batch.reporting.compr_err      |   9034 |     0.00001s |   0.0%
- batch.reporting.lr             |   9034 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9034 |     0.00001s |   0.0%
- batch.step                     |   9034 |     0.00048s |   0.4%
- batch.update_runavg            |   9034 |     0.00130s |   1.1%
- batch.wd                       |   9034 |     0.00001s |   0.0%
- epoch_metrics.collect          |     64 |     0.00836s |   0.1%
- reduce.combine                 |   9034 |     0.00614s |   5.2%
- reduce.flatpack                |   9034 |     0.00002s |   0.0%
- reduce.flatput                 |   9034 |     0.00023s |   0.2%
- reduce.heur_params.beta        |   9033 |     0.00230s |   1.9%
- reduce.memory                  |   9034 |     0.00045s |   0.4%
- reduce.pad                     |   9034 |     0.00027s |   0.2%
- reduce.threshold               |   9034 |     0.00244s |   2.0%
- test.last                      |     64 |     0.41170s |   2.5%
- test.runavg                    |     64 |     0.44255s |   2.7%
-----------------------------------------------------------------

[Iteration 9040] [Rank 3] a = 0.8977784514427185, b = 1.0002326769889973, delta = 0.0007339403382502496, c = 0.0014653539863925642, d = 0.0014608979230219543, m = 0.0005634873003096911
[Iteration 9050] [Rank 3] a = 0.9851997494697571, b = 0.9998144633578993, delta = 0.0007704550516791642, c = 0.0006289267115402611, d = 0.0006302393503626113, m = 0.0005638055934659058
[Iteration 9060] [Rank 3] a = 0.9924192428588867, b = 0.9998998366942483, delta = 0.0007135760970413685, c = 0.0007996733878264978, d = 0.0008007096816336163, m = 0.0005645259063745492
- reduce.gather.context          |   9034 |     0.00131s |   1.1%
- reduce.gather.tensors          |   9034 |     0.00361s |   3.0%
- reduce.heur_params             |   9034 |     0.01089s |   9.2%
[Iteration 9070] [Rank 3] a = 0.9418136477470398, b = 1.0004633559615002, delta = 0.0007058606715872884, c = 0.0019267119893217523, d = 0.0019104767196768946, m = 0.0005647839177309498
[Iteration 9080] [Rank 3] a = 0.9918649196624756, b = 0.9999015293074498, delta = 0.0007218485698103905, c = 0.0008030586142630851, d = 0.0008039221924356839, m = 0.0005650458228061844
[Iteration 9090] [Rank 3] a = 1.015720248222351, b = 0.9999336371436863, delta = 0.0006941285100765526, c = 0.0008672742871775325, d = 0.0008677924340810919, m = 0.0005659435606479474
[Iteration 9100] [Rank 3] a = 1.0321483612060547, b = 0.9998703714073902, delta = 0.0007176657090894878, c = 0.0007407428133283549, d = 0.0007416754777547617, m = 0.0005662005036426705
[Iteration 9110] [Rank 3] a = 1.0317071676254272, b = 0.9998176585970296, delta = 0.0007230223855003715, c = 0.0006353171900174923, d = 0.0006364571132053227, m = 0.0005664862960193082
- reduce.heur_params.alpha       |   9033 |     0.00833s |   7.0%
- reduce.heur_params.beta        |   9033 |     0.00249s |   2.1%
- reduce.memory                  |   9034 |     0.00047s |   0.4%
- reduce.pad                     |   9034 |     0.00020s |   0.2%
- reduce.threshold               |   9034 |     0.00264s |   2.2%
- test.last                      |     64 |     0.41171s |   2.5%
- test.runavg                    |     64 |     0.44255s |   2.7%
-----------------------------------------------------------------

[Iteration 9040] [Rank 1] a = 0.8738055229187012, b = 1.001540271300952, delta = 0.0006747199222445488, c = 0.004080545038036992, d = 0.003971492386401214, m = 0.0006678732675800896
[Iteration 9050] [Rank 1] a = 0.9899173974990845, b = 0.9999087488209077, delta = 0.0007381241885013878, c = 0.0008174976413089372, d = 0.0008184648488622478, m = 0.000667981435682858

[Iteration 8900] [Rank 2] a = 1.0212209224700928, b = 0.9998508372695064, delta = 0.0007205341826193035, c = 0.0007016745367999848, d = 0.0007029180893685271, m = 0.0005194277623944199
[Iteration 8910] [Rank 2] a = 1.0661457777023315, b = 0.9997892123331252, delta = 0.0007280407007783651, c = 0.0005784246600066827, d = 0.0005792882381792815, m = 0.0005204222648717862
[Iteration 8920] [Rank 2] a = 1.0538694858551025, b = 0.9997707317611269, delta = 0.0007439664914272726, c = 0.0005414635142194536, d = 0.0005421889198844366, m = 0.0005208329424131984
[Iteration 8930] [Rank 2] a = 1.0038293600082397, b = 0.9997679855826841, delta = 0.0007736614206805825, c = 0.0005359711570417252, d = 0.0005369383645950358, m = 0.0005210701316281186
[Iteration 8940] [Rank 2] a = 0.9961333274841309, b = 0.9998077619915189, delta = 0.0007660984992980957, c = 0.0006155239783015276, d = 0.0006165602721086461, m = 0.0005216100017401839
[Iteration 9120] [Rank 3] a = 1.051294207572937, b = 0.9997373112878725, delta = 0.0007643192657269537, c = 0.0004746225636603058, d = 0.0004754170555790967, m = 0.0005666554443879305
[Iteration 9130] [Rank 3] a = 0.943389892578125, b = 0.9998763991829382, delta = 0.0007409274112433195, c = 0.0007527983646178343, d = 0.0007537310290442411, m = 0.000567300403675651
[Iteration 9140] [Rank 3] a = 1.041977047920227, b = 0.9999062444442286, delta = 0.0006887799827381968, c = 0.0008124888879078641, d = 0.0008130761210652312, m = 0.0005682684856581263
[Iteration 9150] [Rank 3] a = 0.95121830701828, b = 1.0012457571746, delta = 0.0006563794449903071, c = 0.0034915156380707956, d = 0.0032660181056417942, m = 0.000568901620834239
[Iteration 9160] [Rank 3] a = 1.0058857202529907, b = 0.9998796807799454, delta = 0.0007086849655024707, c = 0.0007593615587295853, d = 0.000760259680029088, m = 0.0005691293010088448
[Iteration 9060] [Rank 1] a = 1.0023771524429321, b = 0.9998579013388081, delta = 0.0007211508345790207, c = 0.0007158026757037014, d = 0.0007170462282722436, m = 0.0006684063413937821
[Iteration 9070] [Rank 1] a = 0.9211987853050232, b = 1.0001398941534196, delta = 0.0007305949693545699, c = 0.0012797883086645319, d = 0.0012777157210502948, m = 0.0006685830056912332
[Iteration 9080] [Rank 1] a = 0.9906575083732605, b = 1.0000067304001174, delta = 0.0007276783580891788, c = 0.001013460800235059, d = 0.0010133571708543473, m = 0.0006687427606079892
[Iteration 9090] [Rank 1] a = 1.0579971075057983, b = 0.9997553427989555, delta = 0.0007498455815948546, c = 0.0005106855881480321, d = 0.0005119982269703823, m = 0.0006691337637452613
[Iteration 9100] [Rank 1] a = 1.1158578395843506, b = 0.9997000392568973, delta = 0.0007678522379137576, c = 0.00040007849580157655, d = 0.0004007002720858477, m = 0.0006699215843815573
[Iteration 9170] [Rank 3] a = 0.9388900995254517, b = 1.0000225338806723, delta = 0.0007160805980674922, c = 0.0010450677613521755, d = 0.001044687786956232, m = 0.0005694294693054141
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9173 |     0.11065s |  93.0%
- batch.accumulate               |   9173 |     0.00082s |   0.7%
- batch.backward                 |   9173 |     0.05174s |  43.5%
- batch.evaluate                 |   9173 |     0.00277s |   2.3%
- batch.forward                  |   9173 |     0.02538s |  21.3%
- batch.mom                      |   9173 |     0.00126s |   1.1%
- batch.reduce                   |   9173 |     0.02591s |  21.8%
- batch.reporting.compr_err      |   9173 |     0.00001s |   0.0%
- batch.reporting.lr             |   9173 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9173 |     0.00001s |   0.0%
[Iteration 9110] [Rank 1] a = 1.0300912857055664, b = 0.9998237036440434, delta = 0.0007305736071430147, c = 0.0006474072844338757, d = 0.0006485126644948021, m = 0.000670247210558591
[Iteration 9120] [Rank 1] a = 0.9771661162376404, b = 0.9999028246746964, delta = 0.0007535411277785897, c = 0.0008056493487808815, d = 0.0008070656169839436, m = 0.0006702560650399573
[Iteration 9130] [Rank 1] a = 0.9187100529670715, b = 1.001138535461178, delta = 0.0006808633916079998, c = 0.003277071906251059, d = 0.003186258025620568, m = 0.000670841132143956
[Iteration 9140] [Rank 1] a = 1.0707812309265137, b = 0.9996715411800169, delta = 0.0008391361334361136, c = 0.0003430823364100551, d = 0.0003436004833136144, m = 0.0006707488095274396
[Iteration 9150] [Rank 1] a = 0.9693418145179749, b = 0.9999045000163357, delta = 0.0007424653740599751, c = 0.000809000032090565, d = 0.0008098636102631638, m = 0.0006710723763954877
- batch.step                     |   9173 |     0.00047s |   0.4%
- batch.update_runavg            |   9173 |     0.00130s |   1.1%
- batch.wd                       |   9173 |     0.00001s |   0.0%
- epoch_metrics.collect          |     65 |     0.00808s |   0.0%
[Iteration 9160] [Rank 1] a = 0.8568528890609741, b = 1.0008639869655118, delta = 0.0007100072107277811, c = 0.0027279743609858317, d = 0.0026898042057569645, m = 0.0006712822411326232
[Iteration 9170] [Rank 1] a = 0.9622599482536316, b = 1.0007688552574996, delta = 0.0007008144748397171, c = 0.002537710817998862, d = 0.00248254544433325, m = 0.0006715938839527169
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9173 |     0.11055s |  92.9%
- batch.accumulate               |   9173 |     0.00083s |   0.7%
- batch.backward                 |   9173 |     0.05177s |  43.5%
- batch.evaluate                 |   9173 |     0.00276s |   2.3%
- batch.forward                  |   9173 |     0.02542s |  21.4%
- batch.mom                      |   9173 |     0.00126s |   1.1%
- batch.reduce                   |   9173 |     0.02575s |  21.6%
[Iteration 8950] [Rank 2] a = 1.0179752111434937, b = 0.9998217174143088, delta = 0.0007378822774626315, c = 0.0006434348248399211, d = 0.0006446438342815594, m = 0.0005219540532008269
[Iteration 8960] [Rank 2] a = 0.9776073098182678, b = 1.000148771736849, delta = 0.0007175405626185238, c = 0.0012975434758931636, d = 0.0012933292144108814, m = 0.0005222564293247978
[Iteration 8970] [Rank 2] a = 1.0881848335266113, b = 0.9997188652594703, delta = 0.0007315640104934573, c = 0.00043773050412688466, d = 0.00043873225480709925, m = 0.0005233145992401877
[Iteration 8980] [Rank 2] a = 0.9350333213806152, b = 1.0000290798032163, delta = 0.0006984915235079825, c = 0.0010581596064487735, d = 0.0010576414595452142, m = 0.0005237024083884463
[Iteration 8990] [Rank 2] a = 1.0568559169769287, b = 0.9997171381032622, delta = 0.0007935775793157518, c = 0.0004342761914364894, d = 0.00043524339898980005, m = 0.0005237989021572252
- reduce.combine                 |   9173 |     0.00607s |   5.1%
- reduce.flatpack                |   9173 |     0.00002s |   0.0%
- reduce.flatput                 |   9173 |     0.00019s |   0.2%
- reduce.gather.context          |   9173 |     0.00250s |   2.1%
- reduce.gather.tensors          |   9173 |     0.00329s |   2.8%
- reduce.heur_params             |   9173 |     0.01048s |   8.8%
- reduce.heur_params.alpha       |   9172 |     0.00810s |   6.8%
- reduce.heur_params.beta        |   9172 |     0.00231s |   1.9%
- reduce.memory                  |   9173 |     0.00045s |   0.4%
- reduce.pad                     |   9173 |     0.00027s |   0.2%
- reduce.threshold               |   9173 |     0.00244s |   2.1%
- test.last                      |     65 |     0.41155s |   2.5%
- test.runavg                    |     65 |     0.44243s |   2.7%
-----------------------------------------------------------------
- batch.reporting.compr_err      |   9173 |     0.00001s |   0.0%
- batch.reporting.lr             |   9173 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9173 |     0.00001s |   0.0%
- batch.step                     |   9173 |     0.00048s |   0.4%
- batch.update_runavg            |   9173 |     0.00130s |   1.1%
- batch.wd                       |   9173 |     0.00001s |   0.0%
[Iteration 9000] [Rank 2] a = 1.0519723892211914, b = 0.9998121316969143, delta = 0.0007262816652655602, c = 0.0006242633894082276, d = 0.0006254723988498659, m = 0.0005243314357680832
[Iteration 9010] [Rank 2] a = 1.11058509349823, b = 0.9997109721556141, delta = 0.0007759020081721246, c = 0.0004219442951317784, d = 0.0004227042439236654, m = 0.0005246692485355039
[Iteration 9020] [Rank 2] a = 1.1029407978057861, b = 0.9997144955542676, delta = 0.000750254956074059, c = 0.0004289910930201847, d = 0.00042982012806587954, m = 0.000525231958889317
[Iteration 9030] [Rank 2] a = 0.8848658204078674, b = 1.0003444239951111, delta = 0.0006951436516828835, c = 0.0016888480174611362, d = 0.0016781741912478148, m = 0.0005256433281901003
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9034 |     0.11057s |  92.9%
- batch.accumulate               |   9034 |     0.00083s |   0.7%
- epoch_metrics.collect          |     65 |     0.00825s |   0.1%
- reduce.combine                 |   9173 |     0.00615s |   5.2%
- reduce.flatpack                |   9173 |     0.00002s |   0.0%
- reduce.flatput                 |   9173 |     0.00023s |   0.2%
- reduce.gather.context          |   9173 |     0.00131s |   1.1%
- reduce.gather.tensors          |   9173 |     0.00362s |   3.0%
- reduce.heur_params             |   9173 |     0.01090s |   9.2%
- reduce.heur_params.alpha       |   9172 |     0.00833s |   7.0%
- reduce.heur_params.beta        |   9172 |     0.00249s |   2.1%
- reduce.memory                  |   9173 |     0.00047s |   0.4%
- reduce.pad                     |   9173 |     0.00020s |   0.2%
- reduce.threshold               |   9173 |     0.00264s |   2.2%
- test.last                      |     65 |     0.41155s |   2.5%
- test.runavg                    |     65 |     0.44243s |   2.7%
-----------------------------------------------------------------
- batch.backward                 |   9034 |     0.05181s |  43.5%
- batch.evaluate                 |   9034 |     0.00274s |   2.3%
- batch.forward                  |   9034 |     0.02551s |  21.4%
- batch.mom                      |   9034 |     0.00126s |   1.1%
- batch.reduce                   |   9034 |     0.02566s |  21.6%
- batch.reporting.compr_err      |   9034 |     0.00001s |   0.0%
- batch.reporting.lr             |   9034 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9034 |     0.00001s |   0.0%
- batch.step                     |   9034 |     0.00048s |   0.4%
- batch.update_runavg            |   9034 |     0.00130s |   1.1%
- batch.wd                       |   9034 |     0.00001s |   0.0%
- epoch_metrics.collect          |     64 |     0.01315s |   0.1%
- reduce.combine                 |   9034 |     0.00609s |   5.1%
- reduce.flatpack                |   9034 |     0.00002s |   0.0%
- reduce.flatput                 |   9034 |     0.00018s |   0.2%
- reduce.gather.context          |   9034 |     0.00188s |   1.6%
- reduce.gather.tensors          |   9034 |     0.00361s |   3.0%
- reduce.heur_params             |   9034 |     0.01056s |   8.9%
- reduce.heur_params.alpha       |   9033 |     0.00822s |   6.9%
- reduce.heur_params.beta        |   9033 |     0.00227s |   1.9%
- reduce.memory                  |   9034 |     0.00045s |   0.4%
- reduce.pad                     |   9034 |     0.00027s |   0.2%
- reduce.threshold               |   9034 |     0.00239s |   2.0%
- test.last                      |     64 |     0.41170s |   2.5%
- test.runavg                    |     64 |     0.44256s |   2.7%
-----------------------------------------------------------------

[Iteration 9040] [Rank 2] a = 0.9215299487113953, b = 0.9999116159004178, delta = 0.0007397962617687881, c = 0.0008232318003749933, d = 0.000824129921674496, m = 0.000525958066991565
[Iteration 9050] [Rank 2] a = 1.0889874696731567, b = 0.999694633258032, delta = 0.0007867156527936459, c = 0.00038926649708063944, d = 0.00039006098899943033, m = 0.000526220202119949
[Iteration 9060] [Rank 2] a = 0.9276701807975769, b = 1.000211847484504, delta = 0.0007374672568403184, c = 0.0014236949753463977, d = 0.0014178571868996297, m = 0.0005264243456145465
[Iteration 9070] [Rank 2] a = 1.019216775894165, b = 0.9998303013810845, delta = 0.0007527474663220346, c = 0.0006606027589111855, d = 0.0006618463114797278, m = 0.0005267611124913251
[Iteration 9080] [Rank 2] a = 1.016197681427002, b = 0.9999614789038923, delta = 0.0007012392161414027, c = 0.0009229578077467038, d = 0.0009232341527619355, m = 0.0005277090238422786
[Iteration 9090] [Rank 2] a = 0.9483221769332886, b = 0.9999312018532505, delta = 0.000719554431270808, c = 0.0008624037062840753, d = 0.0008629909394414425, m = 0.0005283356327115088
[Iteration 9100] [Rank 2] a = 0.8772729635238647, b = 1.00120159385299, delta = 0.0006771034095436335, c = 0.003403188862577389, d = 0.0033127894994697455, m = 0.0005288149681566705
[Iteration 9110] [Rank 2] a = 0.9527899622917175, b = 0.9998575904506724, delta = 0.0007177346851676702, c = 0.0007151808994194303, d = 0.0007158717619575092, m = 0.000529591768307244
[Iteration 9120] [Rank 2] a = 0.9707912802696228, b = 1.0002147318354693, delta = 0.0007101193768903613, c = 0.0014294636775393577, d = 0.0014239713203616292, m = 0.000529856319158982
[Iteration 9130] [Rank 2] a = 1.1056790351867676, b = 0.9996694858641892, delta = 0.000812390586361289, c = 0.0003389717043084848, d = 0.0003397316531003717, m = 0.0005300303255886481
[Iteration 9140] [Rank 2] a = 0.9960569739341736, b = 0.9997707490326893, delta = 0.000760587106924504, c = 0.0005414980573463577, d = 0.000542672523661092, m = 0.0005307401501163408
[Iteration 9150] [Rank 2] a = 0.8977895379066467, b = 1.00033267933331, delta = 0.0007081934018060565, c = 0.0016653586911664485, d = 0.0016587954970546975, m = 0.0005311898650919664
[Iteration 9160] [Rank 2] a = 1.0906264781951904, b = 0.9996733374224231, delta = 0.0008098619873635471, c = 0.00034667482160806614, d = 0.00034733114101924125, m = 0.0005315166848947322
[Iteration 9170] [Rank 2] a = 1.0995651483535767, b = 0.9996815759573328, delta = 0.0008029938326217234, c = 0.0003631518931412514, d = 0.0003640500144407542, m = 0.0005317623081069692
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9173 |     0.11060s |  92.9%
- batch.accumulate               |   9173 |     0.00083s |   0.7%
- batch.backward                 |   9173 |     0.05181s |  43.5%
- batch.evaluate                 |   9173 |     0.00274s |   2.3%
- batch.forward                  |   9173 |     0.02550s |  21.4%
- batch.mom                      |   9173 |     0.00126s |   1.1%
- batch.reduce                   |   9173 |     0.02570s |  21.6%
- batch.reporting.compr_err      |   9173 |     0.00001s |   0.0%
- batch.reporting.lr             |   9173 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9173 |     0.00001s |   0.0%
- batch.step                     |   9173 |     0.00048s |   0.4%
- batch.update_runavg            |   9173 |     0.00130s |   1.1%
- batch.wd                       |   9173 |     0.00001s |   0.0%
- epoch_metrics.collect          |     65 |     0.01300s |   0.1%
- reduce.combine                 |   9173 |     0.00609s |   5.1%
- reduce.flatpack                |   9173 |     0.00002s |   0.0%
- reduce.flatput                 |   9173 |     0.00019s |   0.2%
- reduce.gather.context          |   9173 |     0.00189s |   1.6%
- reduce.gather.tensors          |   9173 |     0.00362s |   3.0%
- reduce.heur_params             |   9173 |     0.01056s |   8.9%
- reduce.heur_params.alpha       |   9172 |     0.00821s |   6.9%
- reduce.heur_params.beta        |   9172 |     0.00227s |   1.9%
- reduce.memory                  |   9173 |     0.00045s |   0.4%
- reduce.pad                     |   9173 |     0.00027s |   0.2%
- reduce.threshold               |   9173 |     0.00239s |   2.0%
- test.last                      |     65 |     0.41155s |   2.5%
- test.runavg                    |     65 |     0.44243s |   2.7%
-----------------------------------------------------------------
[Iteration 9040] [Rank 0] a = 0.9154185056686401, b = 1.0000652464570003, delta = 0.0007208023453131318, c = 0.0011304929141856498, d = 0.001129663879139955, m = 0.0004742685625169562
[Iteration 9050] [Rank 0] a = 0.9611072540283203, b = 0.999981099399957, delta = 0.0007391422404907644, c = 0.0009621987999095937, d = 0.0009622333430364977, m = 0.0004745459779871676
[Iteration 9060] [Rank 0] a = 1.0627994537353516, b = 0.999712802941188, delta = 0.0007761897868476808, c = 0.0004256058665835974, d = 0.0004266421603907159, m = 0.00047526073658830524
[Iteration 9070] [Rank 0] a = 0.986504077911377, b = 0.9998185049036109, delta = 0.0007563914405182004, c = 0.000637009803235786, d = 0.0006380460970429045, m = 0.0004755756432232289
[Iteration 9080] [Rank 0] a = 0.8921206593513489, b = 1.0004330443737335, delta = 0.0006618152256123722, c = 0.0018660888016053159, d = 0.0018575221061331356, m = 0.00047730328680855856
[Iteration 9090] [Rank 0] a = 1.0358964204788208, b = 0.9998798362240142, delta = 0.0006778229726478457, c = 0.0007596724468717209, d = 0.0007606051112981276, m = 0.0004778266619133736
timer                          - epoch: 66.000, value:  0.025 (event:batch.forward)
[Iteration 9100] [Rank 0] a = 0.921579897403717, b = 1.0001171820478565, delta = 0.0006894029793329537, c = 0.0012343640967858345, d = 0.0012329478285827726, m = 0.00047820563594163593
[Iteration 9110] [Rank 0] a = 1.020112156867981, b = 0.9998836186963573, delta = 0.000697427720297128, c = 0.0007672373916636864, d = 0.0007679627973286694, m = 0.00047866873118205616
[Iteration 9120] [Rank 0] a = 0.9262148141860962, b = 1.0001100143491164, delta = 0.0007197665981948376, c = 0.0012200286991206942, d = 0.0012184051721562087, m = 0.00047895758406644155
[Iteration 9130] [Rank 0] a = 0.9081085324287415, b = 1.0008025693285414, delta = 0.0006965877837501466, c = 0.002605139001715377, d = 0.0025734974974713568, m = 0.0004793516013390984
[Iteration 9140] [Rank 0] a = 0.9528888463973999, b = 1.0002994315769893, delta = 0.0007076893816702068, c = 0.0015988631718763403, d = 0.0015906764508001035, m = 0.00047969362392894264
[Iteration 9150] [Rank 0] a = 0.9982434511184692, b = 0.9998227537080833, delta = 0.0007592554320581257, c = 0.0006455074124541582, d = 0.0006468545944034124, m = 0.0004801130032434043
[Iteration 9160] [Rank 0] a = 0.9517234563827515, b = 0.9998660535166022, delta = 0.0007715108804404736, c = 0.0007321070316023668, d = 0.0007328669803942538, m = 0.0004804953590266443
[Iteration 9170] [Rank 0] a = 0.9030009508132935, b = 1.0007304951366363, delta = 0.0007083615055307746, c = 0.002460990533145184, d = 0.0024327342553377507, m = 0.00048093167689630163
cross_entropy                  - bits:21767731840.000, epoch: 66.000, ratio_transmit_grad:  0.175, value:  5.370 (split:train)
last_cross_entropy             - bits:21767731840.000, epoch: 66.000, ratio_transmit_grad:  0.175, value:  5.370 (split:train)
perplexity                     - bits:21767731840.000, epoch: 66.000, ratio_transmit_grad:  0.175, value:215.421 (split:train)
last_perplexity                - bits:21767731840.000, epoch: 66.000, ratio_transmit_grad:  0.175, value:215.421 (split:train)
timer                          - epoch: 66.000, value:  0.001 (event:epoch_metrics.collect)
last_cross_entropy             - bits:21767731840.000, epoch: 66.000, ratio_transmit_grad:  0.175, value:  5.158 (split:test)
last_perplexity                - bits:21767731840.000, epoch: 66.000, ratio_transmit_grad:  0.175, value:174.413 (split:test)
runavg_cross_entropy           - bits:21767731840.000, epoch: 66.000, ratio_transmit_grad:  0.175, value:  5.357 (split:test)
runavg_perplexity              - bits:21767731840.000, epoch: 66.000, ratio_transmit_grad:  0.175, value:212.833 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9173 |     0.11056s |  92.9%
- batch.accumulate               |   9173 |     0.00083s |   0.7%
- batch.backward                 |   9173 |     0.05166s |  43.4%
- batch.evaluate                 |   9173 |     0.00275s |   2.3%
- batch.forward                  |   9173 |     0.02542s |  21.4%
- batch.mom                      |   9173 |     0.00126s |   1.1%
- batch.reduce                   |   9173 |     0.02584s |  21.7%
- batch.reporting.compr_err      |   9173 |     0.00001s |   0.0%
- batch.reporting.lr             |   9173 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9173 |     0.00001s |   0.0%
- batch.step                     |   9173 |     0.00048s |   0.4%
- batch.update_runavg            |   9173 |     0.00130s |   1.1%
- batch.wd                       |   9173 |     0.00001s |   0.0%
- epoch_metrics.collect          |     65 |     0.00865s |   0.1%
- reduce.combine                 |   9173 |     0.00634s |   5.3%
- reduce.flatpack                |   9173 |     0.00002s |   0.0%
- reduce.flatput                 |   9173 |     0.00019s |   0.2%
- reduce.gather.context          |   9173 |     0.00117s |   1.0%
- reduce.gather.tensors          |   9173 |     0.00371s |   3.1%
- reduce.heur_params             |   9173 |     0.01106s |   9.3%
- reduce.heur_params.alpha       |   9172 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   9172 |     0.00227s |   1.9%
- reduce.memory                  |   9173 |     0.00046s |   0.4%
- reduce.pad                     |   9173 |     0.00028s |   0.2%
- reduce.threshold               |   9173 |     0.00239s |   2.0%
- test.last                      |     65 |     0.41154s |   2.5%
- test.runavg                    |     65 |     0.44244s |   2.7%
-----------------------------------------------------------------

[Iteration 9180] [Rank 0] a = 1.215842604637146, b = 0.9996389324720983, delta = 0.0007800423773005605, c = 0.000277864912815393, d = 0.00027838305971895227, m = 0.00048276146765781336
[Iteration 9190] [Rank 0] a = 0.9024236798286438, b = 1.000505429480191, delta = 0.0006777233211323619, c = 0.0020108590464597803, d = 0.0019974563132210466, m = 0.0004831484508121821
[Iteration 9200] [Rank 0] a = 0.9479448199272156, b = 0.9999991309121986, delta = 0.0007204283610917628, c = 0.00099826182439732, d = 0.00099826182439732, m = 0.0004834650747942904
[Iteration 9210] [Rank 0] a = 0.8876054286956787, b = 1.0010684648136081, delta = 0.0006746717845089734, c = 0.0031369304404017242, d = 0.0030835267662082137, m = 0.0004839500667210368
[Iteration 9220] [Rank 0] a = 0.9201767444610596, b = 1.0000937790796407, delta = 0.0006962677580304444, c = 0.0011875581598309792, d = 0.0011864873228969565, m = 0.0004844623125278778
[Iteration 9230] [Rank 0] a = 1.1018753051757812, b = 0.9996834931006827, delta = 0.0007932418957352638, c = 0.00036698618022759015, d = 0.0003675043271311494, m = 0.000484745750502199
[Iteration 9240] [Rank 0] a = 0.987419843673706, b = 0.9998752765313312, delta = 0.0007599183591082692, c = 0.0007505530613690774, d = 0.0007516238983031, m = 0.00048501339490462957
[Iteration 9250] [Rank 0] a = 0.9606195092201233, b = 0.9999105623350554, delta = 0.0007438667817041278, c = 0.0008211246696338522, d = 0.0008217809890450272, m = 0.0004854574666662327
[Iteration 9260] [Rank 0] a = 1.0172276496887207, b = 0.9997658784520573, delta = 0.0007620943360961974, c = 0.000531756895559443, d = 0.0005325859306051379, m = 0.00048597452953017515
[Iteration 9270] [Rank 0] a = 0.984371542930603, b = 0.9998653281109504, delta = 0.0007344855112023652, c = 0.0007306562202724009, d = 0.0007317270572064234, m = 0.0004862998284015926
[Iteration 9280] [Rank 0] a = 0.9813612103462219, b = 0.9998458630593466, delta = 0.0007559920195490122, c = 0.0006917261162516466, d = 0.000692796953185669, m = 0.0004866041306510474
memory_norm                    - epoch: 66.777, value:  1.215 (weight:encoder.weight)
memory_inf_norm                - epoch: 66.777, value:  0.001 (weight:encoder.weight)
memory_norm                    - epoch: 66.777, value:  0.380 (weight:rnn.weight_ih_l0)
memory_inf_norm                - epoch: 66.777, value:  0.001 (weight:rnn.weight_ih_l0)
memory_norm                    - epoch: 66.777, value:  0.352 (weight:rnn.weight_hh_l0)
memory_inf_norm                - epoch: 66.777, value:  0.001 (weight:rnn.weight_hh_l0)
memory_norm                    - epoch: 66.777, value:  0.016 (weight:rnn.bias_ih_l0)
memory_inf_norm                - epoch: 66.777, value:  0.001 (weight:rnn.bias_ih_l0)
memory_norm                    - epoch: 66.777, value:  0.016 (weight:rnn.bias_hh_l0)
memory_inf_norm                - epoch: 66.777, value:  0.001 (weight:rnn.bias_hh_l0)
memory_norm                    - epoch: 66.777, value:  0.296 (weight:rnn.weight_ih_l1)
memory_inf_norm                - epoch: 66.777, value:  0.001 (weight:rnn.weight_ih_l1)
memory_norm                    - epoch: 66.777, value:  0.227 (weight:rnn.weight_hh_l1)
memory_inf_norm                - epoch: 66.777, value:  0.001 (weight:rnn.weight_hh_l1)
memory_norm                    - epoch: 66.777, value:  0.015 (weight:rnn.bias_ih_l1)
memory_inf_norm                - epoch: 66.777, value:  0.001 (weight:rnn.bias_ih_l1)
memory_norm                    - epoch: 66.777, value:  0.015 (weight:rnn.bias_hh_l1)
memory_inf_norm                - epoch: 66.777, value:  0.001 (weight:rnn.bias_hh_l1)
memory_norm                    - epoch: 66.777, value:  0.264 (weight:rnn.weight_ih_l2)
memory_inf_norm                - epoch: 66.777, value:  0.001 (weight:rnn.weight_ih_l2)
memory_norm                    - epoch: 66.777, value:  0.206 (weight:rnn.weight_hh_l2)
memory_inf_norm                - epoch: 66.777, value:  0.001 (weight:rnn.weight_hh_l2)
memory_norm                    - epoch: 66.777, value:  0.017 (weight:rnn.bias_ih_l2)
memory_inf_norm                - epoch: 66.777, value:  0.001 (weight:rnn.bias_ih_l2)
memory_norm                    - epoch: 66.777, value:  0.017 (weight:rnn.bias_hh_l2)
memory_inf_norm                - epoch: 66.777, value:  0.001 (weight:rnn.bias_hh_l2)
memory_norm                    - epoch: 66.777, value:  0.061 (weight:decoder.bias)
memory_inf_norm                - epoch: 66.777, value:  0.001 (weight:decoder.bias)
memory_norm                    - epoch: 66.777, value:  1.414 (weight:entire_model)
memory_inf_norm                - epoch: 66.777, value:  0.001 (weight:entire_model)
[Iteration 9290] [Rank 0] a = 0.9923128485679626, b = 0.9998596284951191, delta = 0.0007484775851480663, c = 0.0007192569883940966, d = 0.0007205696272164468, m = 0.0004869080269532967
[Iteration 9300] [Rank 0] a = 0.9491519331932068, b = 1.0000260572796145, delta = 0.0007434994331561029, c = 0.0010521145592405818, d = 0.0010518382142253502, m = 0.0004872143894742919
memory_norm                    - epoch: 66.935, value:  1.232 (weight:encoder.weight)
memory_inf_norm                - epoch: 66.935, value:  0.001 (weight:encoder.weight)
memory_norm                    - epoch: 66.935, value:  0.387 (weight:rnn.weight_ih_l0)
memory_inf_norm                - epoch: 66.935, value:  0.001 (weight:rnn.weight_ih_l0)
memory_norm                    - epoch: 66.935, value:  0.358 (weight:rnn.weight_hh_l0)
memory_inf_norm                - epoch: 66.935, value:  0.001 (weight:rnn.weight_hh_l0)
memory_norm                    - epoch: 66.935, value:  0.017 (weight:rnn.bias_ih_l0)
memory_inf_norm                - epoch: 66.935, value:  0.001 (weight:rnn.bias_ih_l0)
memory_norm                    - epoch: 66.935, value:  0.017 (weight:rnn.bias_hh_l0)
memory_inf_norm                - epoch: 66.935, value:  0.001 (weight:rnn.bias_hh_l0)
memory_norm                    - epoch: 66.935, value:  0.300 (weight:rnn.weight_ih_l1)
memory_inf_norm                - epoch: 66.935, value:  0.001 (weight:rnn.weight_ih_l1)
memory_norm                    - epoch: 66.935, value:  0.228 (weight:rnn.weight_hh_l1)
memory_inf_norm                - epoch: 66.935, value:  0.001 (weight:rnn.weight_hh_l1)
memory_norm                    - epoch: 66.935, value:  0.016 (weight:rnn.bias_ih_l1)
memory_inf_norm                - epoch: 66.935, value:  0.001 (weight:rnn.bias_ih_l1)
memory_norm                    - epoch: 66.935, value:  0.016 (weight:rnn.bias_hh_l1)
memory_inf_norm                - epoch: 66.935, value:  0.001 (weight:rnn.bias_hh_l1)
memory_norm                    - epoch: 66.935, value:  0.266 (weight:rnn.weight_ih_l2)
memory_inf_norm                - epoch: 66.935, value:  0.001 (weight:rnn.weight_ih_l2)
memory_norm                    - epoch: 66.935, value:  0.208 (weight:rnn.weight_hh_l2)
memory_inf_norm                - epoch: 66.935, value:  0.001 (weight:rnn.weight_hh_l2)
memory_norm                    - epoch: 66.935, value:  0.017 (weight:rnn.bias_ih_l2)
memory_inf_norm                - epoch: 66.935, value:  0.001 (weight:rnn.bias_ih_l2)
memory_norm                    - epoch: 66.935, value:  0.017 (weight:rnn.bias_hh_l2)
memory_inf_norm                - epoch: 66.935, value:  0.001 (weight:rnn.bias_hh_l2)
memory_norm                    - epoch: 66.935, value:  0.064 (weight:decoder.bias)
memory_inf_norm                - epoch: 66.935, value:  0.001 (weight:decoder.bias)
memory_norm                    - epoch: 66.935, value:  1.434 (weight:entire_model)
memory_inf_norm                - epoch: 66.935, value:  0.001 (weight:entire_model)
[Iteration 9310] [Rank 0] a = 1.04033362865448, b = 0.9997378121631781, delta = 0.0007887819083407521, c = 0.0004756243143405204, d = 0.00047683332378215877, m = 0.0004875029874577964
cross_entropy                  - bits:22228985216.000, epoch: 67.000, ratio_transmit_grad:  0.179, value:  5.368 (split:train)
last_cross_entropy             - bits:22228985216.000, epoch: 67.000, ratio_transmit_grad:  0.179, value:  5.368 (split:train)
perplexity                     - bits:22228985216.000, epoch: 67.000, ratio_transmit_grad:  0.179, value:215.065 (split:train)
last_perplexity                - bits:22228985216.000, epoch: 67.000, ratio_transmit_grad:  0.179, value:215.065 (split:train)
last_cross_entropy             - bits:22228985216.000, epoch: 67.000, ratio_transmit_grad:  0.179, value:  5.157 (split:test)
last_perplexity                - bits:22228985216.000, epoch: 67.000, ratio_transmit_grad:  0.179, value:174.248 (split:test)
runavg_cross_entropy           - bits:22228985216.000, epoch: 67.000, ratio_transmit_grad:  0.179, value:  5.352 (split:test)
runavg_perplexity              - bits:22228985216.000, epoch: 67.000, ratio_transmit_grad:  0.179, value:211.624 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9312 |     0.11059s |  92.9%
- batch.accumulate               |   9312 |     0.00083s |   0.7%
- batch.backward                 |   9312 |     0.05165s |  43.4%
- batch.evaluate                 |   9312 |     0.00275s |   2.3%
- batch.forward                  |   9312 |     0.02542s |  21.3%
- batch.mom                      |   9312 |     0.00126s |   1.1%
- batch.reduce                   |   9312 |     0.02587s |  21.7%
- batch.reporting.compr_err      |   9312 |     0.00001s |   0.0%
- batch.reporting.lr             |   9312 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9312 |     0.00001s |   0.0%
- batch.step                     |   9312 |     0.00048s |   0.4%
- batch.update_runavg            |   9312 |     0.00130s |   1.1%
- batch.wd                       |   9312 |     0.00001s |   0.0%
- epoch_metrics.collect          |     66 |     0.00853s |   0.1%
- reduce.combine                 |   9312 |     0.00634s |   5.3%
- reduce.flatpack                |   9312 |     0.00002s |   0.0%
- reduce.flatput                 |   9312 |     0.00019s |   0.2%
- reduce.gather.context          |   9312 |     0.00117s |   1.0%
- reduce.gather.tensors          |   9312 |     0.00373s |   3.1%
- reduce.heur_params             |   9312 |     0.01106s |   9.3%
- reduce.heur_params.alpha       |   9311 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   9311 |     0.00227s |   1.9%
- reduce.memory                  |   9312 |     0.00046s |   0.4%
- reduce.pad                     |   9312 |     0.00028s |   0.2%
- reduce.threshold               |   9312 |     0.00239s |   2.0%
- test.last                      |     66 |     0.41141s |   2.5%
- test.runavg                    |     66 |     0.44241s |   2.7%
-----------------------------------------------------------------


[Iteration 9180] [Rank 3] a = 1.016618251800537, b = 0.9997551700833314, delta = 0.0007602052646689117, c = 0.0005103401568789925, d = 0.0005111346487977835, m = 0.0005699068125267253
[Iteration 9190] [Rank 3] a = 0.9872401356697083, b = 0.9998102490965652, delta = 0.0007604638230986893, c = 0.0006204981885756968, d = 0.000621776284271143, m = 0.0005701014652035247
[Iteration 9200] [Rank 3] a = 1.0228054523468018, b = 0.9997652048611197, delta = 0.0007537425262853503, c = 0.0005304097136101889, d = 0.0005316532661787312, m = 0.000570510345706343
[Iteration 9210] [Rank 3] a = 1.0939006805419922, b = 0.9997133729027351, delta = 0.0007623072015121579, c = 0.0004267457897714278, d = 0.00042778208357854635, m = 0.0005708250108290517
[Iteration 9220] [Rank 3] a = 1.008445382118225, b = 0.9997213178212881, delta = 0.0007790005183778703, c = 0.0004426356281472459, d = 0.00044318831817770913, m = 0.0005713290349719732

[Iteration 9180] [Rank 1] a = 0.9721843600273132, b = 0.9998949142987162, delta = 0.0007571328897029161, c = 0.0007898285966588713, d = 0.000790830347339086, m = 0.0006718207080381025
[Iteration 9190] [Rank 1] a = 1.0407508611679077, b = 0.999761439660498, delta = 0.0007613656925968826, c = 0.0005228793119451272, d = 0.0005241574076405736, m = 0.0006721742479035568
[Iteration 9200] [Rank 1] a = 0.9994733333587646, b = 0.9998178831273469, delta = 0.0007320108124986291, c = 0.0006357662506672436, d = 0.0006370788894895939, m = 0.0006730071128128152
[Iteration 9210] [Rank 1] a = 0.9551459550857544, b = 0.9999082997602617, delta = 0.0007408616947941482, c = 0.0008165995200094344, d = 0.000817601270689649, m = 0.0006731108435391053
[Iteration 9220] [Rank 1] a = 0.9114886522293091, b = 1.0002202069208246, delta = 0.0007088411366567016, c = 0.0014404138487679105, d = 0.0014360959579049165, m = 0.0006736233262639814
[Iteration 9320] [Rank 0] a = 0.9010394215583801, b = 1.0019624042822495, delta = 0.0006974688149057329, c = 0.004924813602696492, d = 0.0047542396420447745, m = 0.0004882562403642563
[Iteration 9330] [Rank 0] a = 0.930849015712738, b = 1.000013276322665, delta = 0.0007232452626340091, c = 0.001026552645331657, d = 0.0010264490159509452, m = 0.0004888548391152838
[Iteration 9340] [Rank 0] a = 1.017603874206543, b = 0.9997999379735762, delta = 0.0007635364891029894, c = 0.0005998759418140372, d = 0.0006015340119054269, m = 0.0004891299558476936
[Iteration 9350] [Rank 0] a = 1.0648382902145386, b = 0.9997263956605559, delta = 0.000788224337156862, c = 0.0004527913074570079, d = 0.00045403486002555015, m = 0.0004894103577086597
[Iteration 9360] [Rank 0] a = 0.9190910458564758, b = 1.0001094443875294, delta = 0.0007402616902254522, c = 0.001218888775932864, d = 0.001217334335222186, m = 0.0004899058068675555
learning_rate                  - epoch: 67.353, value:  1.000 (weight:encoder.weight)
[Iteration 9230] [Rank 3] a = 0.9655954837799072, b = 0.999948870662598, delta = 0.0007308272761292756, c = 0.0008977413251068186, d = 0.0008982940151372818, m = 0.0005715924927744031
[Iteration 9240] [Rank 3] a = 1.0275272130966187, b = 0.9997812501427411, delta = 0.0007547515560872853, c = 0.0005625002785039606, d = 0.0005630529685344239, m = 0.0005722357360584704
[Iteration 9250] [Rank 3] a = 0.9339370131492615, b = 1.00005764696911, delta = 0.000685770355630666, c = 0.0011152939383479107, d = 0.001114361273921504, m = 0.0005735932449177977
[Iteration 9260] [Rank 3] a = 1.0471415519714355, b = 0.9997650494170573, delta = 0.0007266292232088745, c = 0.0005300988254680533, d = 0.000531135119275172, m = 0.0005739175708315113
[Iteration 9270] [Rank 3] a = 0.9653620719909668, b = 1.0005008007023575, delta = 0.0006763904821127653, c = 0.002001601488449521, d = 0.0019821537080025957, m = 0.0005742890045375914
[Iteration 9230] [Rank 1] a = 0.8944487571716309, b = 1.0000610840102249, delta = 0.000723919365555048, c = 0.0011221680206017972, d = 0.0011214080718099102, m = 0.0006738015488700726
[Iteration 9240] [Rank 1] a = 0.9096902012825012, b = 1.0001829521599768, delta = 0.0007001273334026337, c = 0.0013659043240360853, d = 0.0013623118388380743, m = 0.0006742629713322881
[Iteration 9250] [Rank 1] a = 1.063307285308838, b = 0.999735204157278, delta = 0.0007682905998080969, c = 0.0004704083021780236, d = 0.00047123733722371846, m = 0.0006748151365937319
[Iteration 9260] [Rank 1] a = 1.0559078454971313, b = 0.9997411283031358, delta = 0.0007730477373115718, c = 0.0004822565947060793, d = 0.0004828092847365425, m = 0.0006750036881816144
[Iteration 9270] [Rank 1] a = 1.0466724634170532, b = 0.9997909913040824, delta = 0.0007400567992590368, c = 0.0005819826020777898, d = 0.0005832261546463321, m = 0.0006753225871884035
effective_lr                   - epoch: 67.353, value:  0.000 (weight:encoder.weight)
grad_norm                      - epoch: 67.353, value:  0.083 (weight:encoder.weight)
learning_rate                  - epoch: 67.353, value:  1.000 (weight:rnn.weight_ih_l0)
effective_lr                   - epoch: 67.353, value:  0.000 (weight:rnn.weight_ih_l0)
grad_norm                      - epoch: 67.353, value:  0.050 (weight:rnn.weight_ih_l0)
learning_rate                  - epoch: 67.353, value:  1.000 (weight:rnn.weight_hh_l0)
effective_lr                   - epoch: 67.353, value:  0.000 (weight:rnn.weight_hh_l0)
grad_norm                      - epoch: 67.353, value:  0.043 (weight:rnn.weight_hh_l0)
learning_rate                  - epoch: 67.353, value:  1.000 (weight:rnn.bias_ih_l0)
effective_lr                   - epoch: 67.353, value:  0.001 (weight:rnn.bias_ih_l0)
grad_norm                      - epoch: 67.353, value:  0.006 (weight:rnn.bias_ih_l0)
[Iteration 9280] [Rank 3] a = 0.940110981464386, b = 1.000040289047883, delta = 0.000703135970979929, c = 0.0010805780958094385, d = 0.0010797836038906477, m = 0.0005745582043775329
[Iteration 9290] [Rank 3] a = 1.0010544061660767, b = 0.9999979909890107, delta = 0.0006821849383413792, c = 0.0009959819780216593, d = 0.0009959819780216593, m = 0.0005749038003968545
[Iteration 9300] [Rank 3] a = 1.0226426124572754, b = 0.9998211129096072, delta = 0.0007068916456773877, c = 0.0006422258153982828, d = 0.0006430893935708816, m = 0.0005754884942198469
[Iteration 9310] [Rank 3] a = 1.163930892944336, b = 0.9996508498493774, delta = 0.0007726605399511755, c = 0.00030169967037912016, d = 0.0003021832741557755, m = 0.0005759314631700628
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9312 |     0.11069s |  93.0%
- batch.accumulate               |   9312 |     0.00082s |   0.7%
[Iteration 9280] [Rank 1] a = 1.0437936782836914, b = 0.9997814055868048, delta = 0.0007615950889885426, c = 0.0005628111666460962, d = 0.0005639165467070227, m = 0.00067540240637605
[Iteration 9290] [Rank 1] a = 1.067193627357483, b = 0.9997266547339883, delta = 0.0007530683069489896, c = 0.0004533094543605672, d = 0.0004545875500560134, m = 0.0006759762386994539
[Iteration 9300] [Rank 1] a = 1.0487620830535889, b = 0.9997882623971777, delta = 0.0007533574244007468, c = 0.0005765247880269653, d = 0.0005773192799457562, m = 0.0006760966679106091
[Iteration 9310] [Rank 1] a = 0.9960187673568726, b = 0.999818746705491, delta = 0.0007847151136957109, c = 0.0006374934070124413, d = 0.0006388060458347915, m = 0.0006760641601194202
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9312 |     0.11058s |  92.9%
- batch.accumulate               |   9312 |     0.00083s |   0.7%
learning_rate                  - epoch: 67.353, value:  1.000 (weight:rnn.bias_hh_l0)
effective_lr                   - epoch: 67.353, value:  0.001 (weight:rnn.bias_hh_l0)
grad_norm                      - epoch: 67.353, value:  0.006 (weight:rnn.bias_hh_l0)
learning_rate                  - epoch: 67.353, value:  1.000 (weight:rnn.weight_ih_l1)
effective_lr                   - epoch: 67.353, value:  0.000 (weight:rnn.weight_ih_l1)
grad_norm                      - epoch: 67.353, value:  0.037 (weight:rnn.weight_ih_l1)
learning_rate                  - epoch: 67.353, value:  1.000 (weight:rnn.weight_hh_l1)
effective_lr                   - epoch: 67.353, value:  0.000 (weight:rnn.weight_hh_l1)
grad_norm                      - epoch: 67.353, value:  0.017 (weight:rnn.weight_hh_l1)
learning_rate                  - epoch: 67.353, value:  1.000 (weight:rnn.bias_ih_l1)
effective_lr                   - epoch: 67.353, value:  0.000 (weight:rnn.bias_ih_l1)
- batch.backward                 |   9312 |     0.05174s |  43.5%
- batch.evaluate                 |   9312 |     0.00277s |   2.3%
- batch.forward                  |   9312 |     0.02538s |  21.3%
- batch.mom                      |   9312 |     0.00126s |   1.1%
- batch.reduce                   |   9312 |     0.02594s |  21.8%
- batch.reporting.compr_err      |   9312 |     0.00001s |   0.0%
- batch.reporting.lr             |   9312 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9312 |     0.00001s |   0.0%
- batch.step                     |   9312 |     0.00047s |   0.4%
- batch.update_runavg            |   9312 |     0.00130s |   1.1%
- batch.wd                       |   9312 |     0.00001s |   0.0%
- epoch_metrics.collect          |     66 |     0.00799s |   0.0%
- reduce.combine                 |   9312 |     0.00607s |   5.1%
- reduce.flatpack                |   9312 |     0.00002s |   0.0%
- reduce.flatput                 |   9312 |     0.00019s |   0.2%
- batch.backward                 |   9312 |     0.05177s |  43.5%
- batch.evaluate                 |   9312 |     0.00276s |   2.3%
- batch.forward                  |   9312 |     0.02542s |  21.3%
- batch.mom                      |   9312 |     0.00126s |   1.1%
- batch.reduce                   |   9312 |     0.02578s |  21.7%
- batch.reporting.compr_err      |   9312 |     0.00001s |   0.0%
- batch.reporting.lr             |   9312 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9312 |     0.00001s |   0.0%
- batch.step                     |   9312 |     0.00048s |   0.4%
- batch.update_runavg            |   9312 |     0.00130s |   1.1%
- batch.wd                       |   9312 |     0.00001s |   0.0%
- epoch_metrics.collect          |     66 |     0.00813s |   0.0%
- reduce.combine                 |   9312 |     0.00616s |   5.2%
- reduce.flatpack                |   9312 |     0.00002s |   0.0%
- reduce.flatput                 |   9312 |     0.00023s |   0.2%
grad_norm                      - epoch: 67.353, value:  0.004 (weight:rnn.bias_ih_l1)
learning_rate                  - epoch: 67.353, value:  1.000 (weight:rnn.bias_hh_l1)
effective_lr                   - epoch: 67.353, value:  0.000 (weight:rnn.bias_hh_l1)
grad_norm                      - epoch: 67.353, value:  0.004 (weight:rnn.bias_hh_l1)
learning_rate                  - epoch: 67.353, value:  1.000 (weight:rnn.weight_ih_l2)
effective_lr                   - epoch: 67.353, value:  0.000 (weight:rnn.weight_ih_l2)
grad_norm                      - epoch: 67.353, value:  0.038 (weight:rnn.weight_ih_l2)
learning_rate                  - epoch: 67.353, value:  1.000 (weight:rnn.weight_hh_l2)
effective_lr                   - epoch: 67.353, value:  0.000 (weight:rnn.weight_hh_l2)
grad_norm                      - epoch: 67.353, value:  0.027 (weight:rnn.weight_hh_l2)
learning_rate                  - epoch: 67.353, value:  1.000 (weight:rnn.bias_ih_l2)
- reduce.gather.context          |   9312 |     0.00249s |   2.1%
- reduce.gather.tensors          |   9312 |     0.00331s |   2.8%
- reduce.heur_params             |   9312 |     0.01049s |   8.8%
- reduce.gather.context          |   9312 |     0.00130s |   1.1%
- reduce.gather.tensors          |   9312 |     0.00365s |   3.1%
- reduce.heur_params             |   9312 |     0.01090s |   9.2%
effective_lr                   - epoch: 67.353, value:  0.000 (weight:rnn.bias_ih_l2)
grad_norm                      - epoch: 67.353, value:  0.008 (weight:rnn.bias_ih_l2)
- reduce.heur_params.alpha       |   9311 |     0.00810s |   6.8%
- reduce.heur_params.beta        |   9311 |     0.00231s |   1.9%
- reduce.memory                  |   9312 |     0.00045s |   0.4%
- reduce.pad                     |   9312 |     0.00027s |   0.2%
- reduce.threshold               |   9312 |     0.00245s |   2.1%
- test.last                      |     66 |     0.41142s |   2.5%
- test.runavg                    |     66 |     0.44240s |   2.7%
-----------------------------------------------------------------

[Iteration 9320] [Rank 3] a = 1.0214327573776245, b = 0.9998870730090023, delta = 0.000704163103364408, c = 0.0007741460170444769, d = 0.0007749750520901718, m = 0.0005762876889846889
[Iteration 9330] [Rank 3] a = 1.0569077730178833, b = 0.9998005770213982, delta = 0.0007341790478676558, c = 0.0006011540375094834, d = 0.0006022939606973139, m = 0.0005765361901093644
- reduce.heur_params.alpha       |   9311 |     0.00833s |   7.0%
- reduce.heur_params.beta        |   9311 |     0.00249s |   2.1%
- reduce.memory                  |   9312 |     0.00047s |   0.4%
- reduce.pad                     |   9312 |     0.00020s |   0.2%
- reduce.threshold               |   9312 |     0.00264s |   2.2%
- test.last                      |     66 |     0.41142s |   2.5%
- test.runavg                    |     66 |     0.44240s |   2.7%
-----------------------------------------------------------------

[Iteration 9320] [Rank 1] a = 1.0296225547790527, b = 0.9997491250364945, delta = 0.0007875178707763553, c = 0.0004982500624626092, d = 0.0004994936150311515, m = 0.0006765216444953162
[Iteration 9330] [Rank 1] a = 0.9977011680603027, b = 0.9998453276408921, delta = 0.0007849415997043252, c = 0.000690655279317624, d = 0.000692140633774494, m = 0.0006765861795080962
learning_rate                  - epoch: 67.353, value:  1.000 (weight:rnn.bias_hh_l2)
effective_lr                   - epoch: 67.353, value:  0.000 (weight:rnn.bias_hh_l2)
grad_norm                      - epoch: 67.353, value:  0.008 (weight:rnn.bias_hh_l2)
learning_rate                  - epoch: 67.353, value:  1.000 (weight:decoder.bias)
effective_lr                   - epoch: 67.353, value:  0.000 (weight:decoder.bias)
grad_norm                      - epoch: 67.353, value:  0.015 (weight:decoder.bias)
grad_norm                      - epoch: 67.353, value:  0.124 (weight:entire_model)
[Iteration 9370] [Rank 0] a = 0.9387627840042114, b = 1.0000702724819417, delta = 0.0007510663126595318, c = 0.0011405449641146998, d = 0.001138990523404022, m = 0.0004901330211140296
[Iteration 9380] [Rank 0] a = 1.025115966796875, b = 0.9999138784752127, delta = 0.0007069850689731538, c = 0.0008277569499994111, d = 0.0008282750969029703, m = 0.0004913567368038412
[Iteration 9340] [Rank 3] a = 1.0777506828308105, b = 0.9997378985209894, delta = 0.0007373570115305483, c = 0.00047579702997504016, d = 0.00047645334938621527, m = 0.0005769499299373083
[Iteration 9350] [Rank 3] a = 1.053394079208374, b = 0.9997616296476852, delta = 0.000755676650442183, c = 0.0005232592863410707, d = 0.0005241228645136695, m = 0.0005771918202034086
[Iteration 9360] [Rank 3] a = 0.9742158651351929, b = 0.9998380563128614, delta = 0.0007565030246041715, c = 0.0006761126228910601, d = 0.0006773216323326984, m = 0.0005773237597402293
[Iteration 9370] [Rank 3] a = 0.9983833432197571, b = 0.9999105623350554, delta = 0.0007368222577497363, c = 0.0008211246696338522, d = 0.0008221955065678747, m = 0.0005776995381770185
[Iteration 9380] [Rank 3] a = 0.9861440062522888, b = 0.9999328081086443, delta = 0.000724836194422096, c = 0.0008656162170861428, d = 0.0008667215971470693, m = 0.000578051077985572
[Iteration 9340] [Rank 1] a = 0.9897973537445068, b = 0.9998419424145384, delta = 0.0007696122047491372, c = 0.0006838848264444494, d = 0.0006857156121703588, m = 0.0006768914019583142
[Iteration 9350] [Rank 1] a = 1.007178783416748, b = 0.9998182976448562, delta = 0.0007585019338876009, c = 0.0006365952857129386, d = 0.0006380806401698085, m = 0.0006770253135513284
[Iteration 9360] [Rank 1] a = 0.8947234749794006, b = 1.0002286872580524, delta = 0.0007368092774413526, c = 0.0014573745240777512, d = 0.001453160262595469, m = 0.0006772200952447936
[Iteration 9370] [Rank 1] a = 1.092927098274231, b = 0.999708070533199, delta = 0.000793348765000701, c = 0.0004161410498119144, d = 0.0004166937398423776, m = 0.0006774136170929989
[Iteration 9380] [Rank 1] a = 1.0276048183441162, b = 0.9997659993529948, delta = 0.000805129820946604, c = 0.0005319986974477708, d = 0.0005330004481279853, m = 0.000677402015709772
[Iteration 9390] [Rank 0] a = 0.9771966934204102, b = 1.000006903115752, delta = 0.0007144247647374868, c = 0.0010138062315040986, d = 0.0010136680589964827, m = 0.0004916699627804989
[Iteration 9400] [Rank 0] a = 0.9264781475067139, b = 1.0003896236705687, delta = 0.0007093867170624435, c = 0.0017792473805687795, d = 0.0017672263724062042, m = 0.0004920883233467255
[Iteration 9410] [Rank 0] a = 1.0841084718704224, b = 0.9997293663692496, delta = 0.0007664398290216923, c = 0.0004587327252844877, d = 0.00045983810534541415, m = 0.0004924603502963845
[Iteration 9420] [Rank 0] a = 1.0335376262664795, b = 0.9997505240330465, delta = 0.0007414794526994228, c = 0.0005010480557418294, d = 0.0005023606945641796, m = 0.0004936101149653295
[Iteration 9430] [Rank 0] a = 1.0850598812103271, b = 0.9997105058234399, delta = 0.0007957598427310586, c = 0.00042101163070537166, d = 0.00042184066575106657, m = 0.0004938263995267991
[Iteration 9390] [Rank 3] a = 1.0308650732040405, b = 0.9997004537743829, delta = 0.0008120784186758101, c = 0.0004009075308472714, d = 0.00040180565214677417, m = 0.0005781450633543322
[Iteration 9400] [Rank 3] a = 0.9768197536468506, b = 0.9998792144477391, delta = 0.0007487780530937016, c = 0.0007584288943031786, d = 0.0007600869643945683, m = 0.0005790090859149323
[Iteration 9410] [Rank 3] a = 0.9472638964653015, b = 0.9999693029221266, delta = 0.0007454712758772075, c = 0.0009386058442341943, d = 0.0009389167323763299, m = 0.0005792536583473229
[Iteration 9420] [Rank 3] a = 1.0205750465393066, b = 0.9997855334902762, delta = 0.0007702115108259022, c = 0.0005710669739761409, d = 0.0005720687246563554, m = 0.0005793762844701579
[Iteration 9430] [Rank 3] a = 0.9703868627548218, b = 0.9999178336632152, delta = 0.0007445470546372235, c = 0.0008356673260604161, d = 0.0008363927317253992, m = 0.0005797204136827041
[Iteration 9390] [Rank 1] a = 0.971834659576416, b = 1.0002466151399023, delta = 0.0007618540548719466, c = 0.0014932302898040537, d = 0.001484352706189738, m = 0.0006775116765446709
[Iteration 9400] [Rank 1] a = 0.8872584700584412, b = 1.0005778663960252, delta = 0.0007599845412187278, c = 0.0021557329206949565, d = 0.002131518188735286, m = 0.0006775973747447177
[Iteration 9410] [Rank 1] a = 1.019140601158142, b = 0.9997697300104995, delta = 0.0008061221451498568, c = 0.0005394600128590245, d = 0.000540496306666143, m = 0.0006778330034831759
[Iteration 9420] [Rank 1] a = 1.004896879196167, b = 0.9997932366072342, delta = 0.0007927612168714404, c = 0.0005864732085753036, d = 0.0005875785886362301, m = 0.000677994906145616
[Iteration 9430] [Rank 1] a = 0.9937122464179993, b = 1.0000023779661278, delta = 0.0007587971049360931, c = 0.001004755932255263, d = 0.0010047213891283592, m = 0.0006781683839625145
[Iteration 9440] [Rank 0] a = 1.003692626953125, b = 0.999788348754991, delta = 0.0007777406717650592, c = 0.0005766975036614851, d = 0.0005776647112147958, m = 0.0004949674262956186
[Iteration 9450] [Rank 0] a = 1.023050308227539, b = 0.9998696460017376, delta = 0.000701022450812161, c = 0.000739292001998389, d = 0.0007402592095516996, m = 0.0004958120508902881
cross_entropy                  - bits:22674087040.000, epoch: 68.000, ratio_transmit_grad:  0.173, value:  5.366 (split:train)
last_cross_entropy             - bits:22674087040.000, epoch: 68.000, ratio_transmit_grad:  0.173, value:  5.366 (split:train)
perplexity                     - bits:22674087040.000, epoch: 68.000, ratio_transmit_grad:  0.173, value:214.598 (split:train)
last_perplexity                - bits:22674087040.000, epoch: 68.000, ratio_transmit_grad:  0.173, value:214.598 (split:train)
last_cross_entropy             - bits:22674087040.000, epoch: 68.000, ratio_transmit_grad:  0.173, value:  5.156 (split:test)

[Iteration 9180] [Rank 2] a = 1.0012028217315674, b = 0.9997063779201258, delta = 0.0008100731065496802, c = 0.00041275582337532707, d = 0.0004135848584210219, m = 0.0005322118181187597
[Iteration 9190] [Rank 2] a = 1.0837616920471191, b = 0.9997562754633262, delta = 0.0007395499851554632, c = 0.0005125509170008456, d = 0.0005135872108079641, m = 0.0005328043968091063
[Iteration 9200] [Rank 2] a = 0.9865353107452393, b = 0.9998178658557842, delta = 0.0007532706367783248, c = 0.0006357317075403397, d = 0.0006368025444743622, m = 0.0005331363192621862
[Iteration 9210] [Rank 2] a = 1.0462126731872559, b = 0.9998120971537885, delta = 0.0007309753564186394, c = 0.0006241943031544197, d = 0.0006250233382001144, m = 0.0005335386548714978
[Iteration 9220] [Rank 2] a = 1.078698992729187, b = 0.9997130965577424, delta = 0.0007757953135296702, c = 0.00042619309974096457, d = 0.00042681487602523567, m = 0.00053397294148024
[Iteration 9440] [Rank 3] a = 0.953410267829895, b = 1.001534468069348, delta = 0.0006845195312052965, c = 0.004068938547397263, d = 0.0039148071151518275, m = 0.0005803295665529313
[Iteration 9450] [Rank 3] a = 1.013674259185791, b = 0.999879818952451, delta = 0.0007312290836125612, c = 0.0007596379037448169, d = 0.0007607087406788395, m = 0.0005804804420662163
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9451 |     0.11071s |  93.0%
- batch.accumulate               |   9451 |     0.00082s |   0.7%
- batch.backward                 |   9451 |     0.05174s |  43.5%
- batch.evaluate                 |   9451 |     0.00277s |   2.3%
- batch.forward                  |   9451 |     0.02537s |  21.3%
- batch.mom                      |   9451 |     0.00126s |   1.1%
- batch.reduce                   |   9451 |     0.02596s |  21.8%
[Iteration 9440] [Rank 1] a = 0.9556403160095215, b = 0.9999609089422994, delta = 0.0007842383347451687, c = 0.0009218178845588734, d = 0.0009223360314624326, m = 0.000678131634082541
[Iteration 9450] [Rank 1] a = 1.0603206157684326, b = 0.9997541337895864, delta = 0.0007797043072059751, c = 0.0005082675692647554, d = 0.0005093729493256819, m = 0.0006785573632642116
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9451 |     0.11060s |  92.9%
- batch.accumulate               |   9451 |     0.00083s |   0.7%
- batch.backward                 |   9451 |     0.05177s |  43.5%
- batch.evaluate                 |   9451 |     0.00276s |   2.3%
- batch.forward                  |   9451 |     0.02542s |  21.3%
- batch.mom                      |   9451 |     0.00126s |   1.1%
- batch.reduce                   |   9451 |     0.02580s |  21.7%
last_perplexity                - bits:22674087040.000, epoch: 68.000, ratio_transmit_grad:  0.173, value:173.993 (split:test)
runavg_cross_entropy           - bits:22674087040.000, epoch: 68.000, ratio_transmit_grad:  0.173, value:  5.355 (split:test)
runavg_perplexity              - bits:22674087040.000, epoch: 68.000, ratio_transmit_grad:  0.173, value:212.228 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9451 |     0.11062s |  92.9%
- batch.accumulate               |   9451 |     0.00083s |   0.7%
- batch.backward                 |   9451 |     0.05165s |  43.4%
- batch.evaluate                 |   9451 |     0.00275s |   2.3%
- batch.forward                  |   9451 |     0.02542s |  21.3%
- batch.mom                      |   9451 |     0.00126s |   1.1%
- batch.reduce                   |   9451 |     0.02590s |  21.8%
[Iteration 9230] [Rank 2] a = 1.0315459966659546, b = 0.9997632359029955, delta = 0.0007825166685506701, c = 0.0005264717971431383, d = 0.000527473547823353, m = 0.0005343678709800047
[Iteration 9240] [Rank 2] a = 1.0903561115264893, b = 0.999715963637042, delta = 0.0007651746855117381, c = 0.00043192725880702065, d = 0.00043279083697961946, m = 0.000534764222206237
[Iteration 9250] [Rank 2] a = 1.0579859018325806, b = 0.9997160154517281, delta = 0.000794238003436476, c = 0.0004320308881877325, d = 0.0004328599232334274, m = 0.0005349362746822308
[Iteration 9260] [Rank 2] a = 1.009812593460083, b = 0.9997349450838442, delta = 0.0007896062452346087, c = 0.00046989015527446434, d = 0.00047075373344706314, m = 0.00053560108568022
[Iteration 9270] [Rank 2] a = 1.002415418624878, b = 0.9998027014236195, delta = 0.0007634899229742587, c = 0.0006054028421186695, d = 0.0006066118515603079, m = 0.0005359316248902367
- batch.reporting.compr_err      |   9451 |     0.00001s |   0.0%
- batch.reporting.lr             |   9451 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9451 |     0.00001s |   0.0%
- batch.step                     |   9451 |     0.00047s |   0.4%
- batch.update_runavg            |   9451 |     0.00130s |   1.1%
- batch.reporting.compr_err      |   9451 |     0.00001s |   0.0%
- batch.reporting.lr             |   9451 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9451 |     0.00001s |   0.0%
- batch.step                     |   9451 |     0.00048s |   0.4%
- batch.update_runavg            |   9451 |     0.00130s |   1.1%
- batch.wd                       |   9451 |     0.00001s |   0.0%
- batch.reporting.compr_err      |   9451 |     0.00001s |   0.0%
- batch.reporting.lr             |   9451 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9451 |     0.00001s |   0.0%
[Iteration 9280] [Rank 2] a = 0.9730953574180603, b = 0.9999590090703228, delta = 0.0007316206465475261, c = 0.0009180181405994386, d = 0.0009183290287415742, m = 0.0005366936298348194
[Iteration 9290] [Rank 2] a = 0.8850197792053223, b = 1.0002563044863861, delta = 0.0007016920135356486, c = 0.001512608983997171, d = 0.0015027987359564486, m = 0.000537071038309767
[Iteration 9300] [Rank 2] a = 0.8591787815093994, b = 1.004642073798272, delta = 0.0006581515772268176, c = 0.010284214284971609, d = 0.009303673084676016, m = 0.0005381355155048813
[Iteration 9310] [Rank 2] a = 0.9675332307815552, b = 1.0002544564292173, delta = 0.000687591964378953, c = 0.001508912869418448, d = 0.0015029023653371605, m = 0.0005384870994385479
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9312 |     0.11063s |  92.9%
- batch.accumulate               |   9312 |     0.00083s |   0.7%
- batch.wd                       |   9451 |     0.00001s |   0.0%
- epoch_metrics.collect          |     67 |     0.00793s |   0.0%
- reduce.combine                 |   9451 |     0.00608s |   5.1%
- reduce.flatpack                |   9451 |     0.00002s |   0.0%
- reduce.flatput                 |   9451 |     0.00019s |   0.2%
- reduce.gather.context          |   9451 |     0.00249s |   2.1%
- reduce.gather.tensors          |   9451 |     0.00332s |   2.8%
- reduce.heur_params             |   9451 |     0.01049s |   8.8%
- reduce.heur_params.alpha       |   9450 |     0.00810s |   6.8%
- reduce.heur_params.beta        |   9450 |     0.00231s |   1.9%
- reduce.memory                  |   9451 |     0.00045s |   0.4%
- reduce.pad                     |   9451 |     0.00027s |   0.2%
- reduce.threshold               |   9451 |     0.00245s |   2.1%
- test.last                      |     67 |     0.41135s |   2.5%
- test.runavg                    |     67 |     0.44226s |   2.7%
- epoch_metrics.collect          |     67 |     0.00806s |   0.0%
- reduce.combine                 |   9451 |     0.00617s |   5.2%
- reduce.flatpack                |   9451 |     0.00002s |   0.0%
- reduce.flatput                 |   9451 |     0.00023s |   0.2%
- reduce.gather.context          |   9451 |     0.00129s |   1.1%
- reduce.gather.tensors          |   9451 |     0.00366s |   3.1%
- reduce.heur_params             |   9451 |     0.01090s |   9.2%
- reduce.heur_params.alpha       |   9450 |     0.00834s |   7.0%
- reduce.heur_params.beta        |   9450 |     0.00249s |   2.1%
- reduce.memory                  |   9451 |     0.00047s |   0.4%
- reduce.pad                     |   9451 |     0.00020s |   0.2%
- reduce.threshold               |   9451 |     0.00265s |   2.2%
- test.last                      |     67 |     0.41135s |   2.5%
- test.runavg                    |     67 |     0.44227s |   2.7%
-----------------------------------------------------------------
- batch.step                     |   9451 |     0.00048s |   0.4%
- batch.update_runavg            |   9451 |     0.00130s |   1.1%
- batch.wd                       |   9451 |     0.00001s |   0.0%
- epoch_metrics.collect          |     67 |     0.00841s |   0.1%
- reduce.combine                 |   9451 |     0.00635s |   5.3%
- reduce.flatpack                |   9451 |     0.00002s |   0.0%
- reduce.flatput                 |   9451 |     0.00019s |   0.2%
- reduce.gather.context          |   9451 |     0.00117s |   1.0%
- reduce.gather.tensors          |   9451 |     0.00375s |   3.1%
- reduce.heur_params             |   9451 |     0.01107s |   9.3%
- reduce.heur_params.alpha       |   9450 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   9450 |     0.00228s |   1.9%
- reduce.memory                  |   9451 |     0.00046s |   0.4%
- reduce.pad                     |   9451 |     0.00028s |   0.2%
- reduce.threshold               |   9451 |     0.00240s |   2.0%
- batch.backward                 |   9312 |     0.05180s |  43.5%
- batch.evaluate                 |   9312 |     0.00274s |   2.3%
- batch.forward                  |   9312 |     0.02550s |  21.4%
- batch.mom                      |   9312 |     0.00126s |   1.1%
- batch.reduce                   |   9312 |     0.02574s |  21.6%
- batch.reporting.compr_err      |   9312 |     0.00001s |   0.0%
- batch.reporting.lr             |   9312 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9312 |     0.00001s |   0.0%
- batch.step                     |   9312 |     0.00048s |   0.4%
- batch.update_runavg            |   9312 |     0.00130s |   1.1%
- batch.wd                       |   9312 |     0.00001s |   0.0%
- epoch_metrics.collect          |     66 |     0.01287s |   0.1%
- reduce.combine                 |   9312 |     0.00610s |   5.1%
- reduce.flatpack                |   9312 |     0.00002s |   0.0%
- reduce.flatput                 |   9312 |     0.00019s |   0.2%
-----------------------------------------------------------------
- test.last                      |     67 |     0.41134s |   2.5%
- test.runavg                    |     67 |     0.44228s |   2.7%
-----------------------------------------------------------------
- reduce.gather.context          |   9312 |     0.00190s |   1.6%
- reduce.gather.tensors          |   9312 |     0.00365s |   3.1%
- reduce.heur_params             |   9312 |     0.01056s |   8.9%
- reduce.heur_params.alpha       |   9311 |     0.00821s |   6.9%
- reduce.heur_params.beta        |   9311 |     0.00227s |   1.9%
- reduce.memory                  |   9312 |     0.00045s |   0.4%
- reduce.pad                     |   9312 |     0.00027s |   0.2%
- reduce.threshold               |   9312 |     0.00239s |   2.0%
- test.last                      |     66 |     0.41142s |   2.5%
- test.runavg                    |     66 |     0.44240s |   2.7%
-----------------------------------------------------------------

[Iteration 9320] [Rank 2] a = 1.1425491571426392, b = 0.9996740455564495, delta = 0.0007823352934792638, c = 0.0003480910898111282, d = 0.00034857469358778355, m = 0.0005390287741057734
[Iteration 9330] [Rank 2] a = 1.0701485872268677, b = 0.999774116987388, delta = 0.0007481405627913773, c = 0.0005482339670926283, d = 0.0005492702608997469, m = 0.0005393716985480802
[Iteration 9340] [Rank 2] a = 1.1523797512054443, b = 0.9996536132991953, delta = 0.0008039658423513174, c = 0.00030722657068375255, d = 0.00030812469198325526, m = 0.0005396644796216459
[Iteration 9350] [Rank 2] a = 1.0101404190063477, b = 0.9997632013598706, delta = 0.0007695254753343761, c = 0.0005264027108893304, d = 0.000527404461569545, m = 0.0005399207762813174
[Iteration 9360] [Rank 2] a = 0.9669189453125, b = 0.9998960714934548, delta = 0.0007318914867937565, c = 0.0007921429861614362, d = 0.000792902934953323, m = 0.000540649737781787
[Iteration 9370] [Rank 2] a = 1.077287197113037, b = 0.999709331357224, delta = 0.0007675684755668044, c = 0.00041866269807590295, d = 0.0004198026212637334, m = 0.0005409565990849351
[Iteration 9380] [Rank 2] a = 1.0227752923965454, b = 0.9999060026423425, delta = 0.0006956233410164714, c = 0.0008120052841312088, d = 0.0008129379485576155, m = 0.0005415552020842775
[Iteration 9390] [Rank 2] a = 0.9452822804450989, b = 0.9999479034550472, delta = 0.0007149013108573854, c = 0.0008958069100001972, d = 0.0008961868843961407, m = 0.00054204723090048
[Iteration 9400] [Rank 2] a = 0.935417890548706, b = 1.000337498098972, delta = 0.0006952725234441459, c = 0.0016749962235726513, d = 0.0016668095024964145, m = 0.0005423938711164813
[Iteration 9410] [Rank 2] a = 0.866950511932373, b = 1.0013856393246245, delta = 0.000668270920868963, c = 0.0037712804228659056, d = 0.0035712757180920212, m = 0.0005430878743886797
[Iteration 9420] [Rank 2] a = 0.8863092660903931, b = 1.0001971148414959, delta = 0.0007008566171862185, c = 0.0013942296880973262, d = 0.0013889791328079255, m = 0.0005433338809935462
[Iteration 9430] [Rank 2] a = 0.9461908340454102, b = 0.9999393194880388, delta = 0.0007255254895426333, c = 0.0008786389759289329, d = 0.000879295295340108, m = 0.0005437607804987895
[Iteration 9440] [Rank 2] a = 1.0268925428390503, b = 0.9997619232642473, delta = 0.000763497781008482, c = 0.000523846519498438, d = 0.0005243301232750933, m = 0.0005441302136139351
[Iteration 9450] [Rank 2] a = 0.9620950222015381, b = 1.0000105992303305, delta = 0.0007185834692791104, c = 0.0010211984606615444, d = 0.0010210602881539285, m = 0.0005444520959393055
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9451 |     0.11066s |  92.9%
- batch.accumulate               |   9451 |     0.00083s |   0.7%
- batch.backward                 |   9451 |     0.05180s |  43.5%
- batch.evaluate                 |   9451 |     0.00274s |   2.3%
- batch.forward                  |   9451 |     0.02550s |  21.4%
- batch.mom                      |   9451 |     0.00126s |   1.1%
- batch.reduce                   |   9451 |     0.02578s |  21.6%
- batch.reporting.compr_err      |   9451 |     0.00001s |   0.0%
- batch.reporting.lr             |   9451 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9451 |     0.00001s |   0.0%
- batch.step                     |   9451 |     0.00048s |   0.4%
- batch.update_runavg            |   9451 |     0.00130s |   1.1%
- batch.wd                       |   9451 |     0.00001s |   0.0%
- epoch_metrics.collect          |     67 |     0.01277s |   0.1%
- reduce.combine                 |   9451 |     0.00610s |   5.1%
- reduce.flatpack                |   9451 |     0.00002s |   0.0%
- reduce.flatput                 |   9451 |     0.00019s |   0.2%
- reduce.gather.context          |   9451 |     0.00192s |   1.6%
- reduce.gather.tensors          |   9451 |     0.00366s |   3.1%
- reduce.heur_params             |   9451 |     0.01056s |   8.9%
- reduce.heur_params.alpha       |   9450 |     0.00821s |   6.9%
- reduce.heur_params.beta        |   9450 |     0.00228s |   1.9%
- reduce.memory                  |   9451 |     0.00045s |   0.4%
- reduce.pad                     |   9451 |     0.00027s |   0.2%
- reduce.threshold               |   9451 |     0.00240s |   2.0%
- test.last                      |     67 |     0.41135s |   2.5%
- test.runavg                    |     67 |     0.44227s |   2.7%
-----------------------------------------------------------------

[Iteration 9460] [Rank 0] a = 0.9499273896217346, b = 1.0004287610267926, delta = 0.0006883345195092261, c = 0.0018575221061331356, d = 0.0018437393984984587, m = 0.0004961889028144659
[Iteration 9470] [Rank 0] a = 1.0351051092147827, b = 0.9996885191251516, delta = 0.0007961027440614998, c = 0.0003770382301566403, d = 0.0003779018083292391, m = 0.0004964426957439697
[Iteration 9480] [Rank 0] a = 0.8646669387817383, b = 1.0000492529892964, delta = 0.0007385697099380195, c = 0.0010985059786725899, d = 0.0010979878317690305, m = 0.000496745438034408
[Iteration 9490] [Rank 0] a = 0.9593755602836609, b = 1.000008060310503, delta = 0.0007269653724506497, c = 0.0010161206210066633, d = 0.0010159824484990475, m = 0.0004971006982389357
[Iteration 9500] [Rank 0] a = 0.9726011157035828, b = 0.9998177276832811, delta = 0.000747981364838779, c = 0.0006354553625251081, d = 0.0006363534838246109, m = 0.0004977028951149969
[Iteration 9510] [Rank 0] a = 1.0095053911209106, b = 0.9997964836610262, delta = 0.0007512159063480794, c = 0.0005929673164332467, d = 0.0005937618083520376, m = 0.0004980480300243498
[Iteration 9520] [Rank 0] a = 0.8848162293434143, b = 1.0026513632546348, delta = 0.0006594214355573058, c = 0.006302738934895152, d = 0.005916132258586117, m = 0.0004990817097393062
[Iteration 9530] [Rank 0] a = 1.1040421724319458, b = 0.9996748055051606, delta = 0.0008179018041118979, c = 0.0003496109873949021, d = 0.00035044002244059695, m = 0.0004992127505238153
[Iteration 9540] [Rank 0] a = 0.9429395794868469, b = 0.9998470375256335, delta = 0.0007767613278701901, c = 0.0006940750488811154, d = 0.0006949040839268101, m = 0.000499554685512717
[Iteration 9550] [Rank 0] a = 0.9348788857460022, b = 0.9998780399814415, delta = 0.00074278365354985, c = 0.0007560799616737098, d = 0.0007570126261001166, m = 0.0005000266627495832
[Iteration 9560] [Rank 0] a = 0.9247159361839294, b = 1.000608091621436, delta = 0.0006909187068231404, c = 0.002216183392776873, d = 0.0021927976958628975, m = 0.0005005495053156603
[Iteration 9570] [Rank 0] a = 1.1322300434112549, b = 0.9996632508304771, delta = 0.0007924452074803412, c = 0.00032650163549615796, d = 0.0003273997567956607, m = 0.0005009252473645271
[Iteration 9580] [Rank 0] a = 1.0576540231704712, b = 0.9997370522144386, delta = 0.0007682419382035732, c = 0.0004741044167567465, d = 0.00047569340059432834, m = 0.0005012410516277673
[Iteration 9590] [Rank 0] a = 1.1082234382629395, b = 0.9997914749078379, delta = 0.000837442115880549, c = 0.0005829498096311005, d = 0.0005834334134077558, m = 0.0005015789415714508
cross_entropy                  - bits:23132000896.000, epoch: 69.000, ratio_transmit_grad:  0.178, value:  5.364 (split:train)
last_cross_entropy             - bits:23132000896.000, epoch: 69.000, ratio_transmit_grad:  0.178, value:  5.364 (split:train)
perplexity                     - bits:23132000896.000, epoch: 69.000, ratio_transmit_grad:  0.178, value:214.173 (split:train)
last_perplexity                - bits:23132000896.000, epoch: 69.000, ratio_transmit_grad:  0.178, value:214.173 (split:train)
last_cross_entropy             - bits:23132000896.000, epoch: 69.000, ratio_transmit_grad:  0.178, value:  5.154 (split:test)
last_perplexity                - bits:23132000896.000, epoch: 69.000, ratio_transmit_grad:  0.178, value:173.747 (split:test)
runavg_cross_entropy           - bits:23132000896.000, epoch: 69.000, ratio_transmit_grad:  0.178, value:  5.351 (split:test)
runavg_perplexity              - bits:23132000896.000, epoch: 69.000, ratio_transmit_grad:  0.178, value:211.614 (split:test)
timer                          - epoch: 68.000, value:  0.435 (event:test.runavg)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9590 |     0.11064s |  92.9%
- batch.accumulate               |   9590 |     0.00083s |   0.7%
- batch.backward                 |   9590 |     0.05165s |  43.4%
- batch.evaluate                 |   9590 |     0.00275s |   2.3%
- batch.forward                  |   9590 |     0.02541s |  21.3%
- batch.mom                      |   9590 |     0.00126s |   1.1%
- batch.reduce                   |   9590 |     0.02593s |  21.8%
- batch.reporting.compr_err      |   9590 |     0.00001s |   0.0%
- batch.reporting.lr             |   9590 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9590 |     0.00001s |   0.0%
- batch.step                     |   9590 |     0.00048s |   0.4%
- batch.update_runavg            |   9590 |     0.00130s |   1.1%
- batch.wd                       |   9590 |     0.00001s |   0.0%
- epoch_metrics.collect          |     68 |     0.00830s |   0.1%
- reduce.combine                 |   9590 |     0.00636s |   5.3%
- reduce.flatpack                |   9590 |     0.00002s |   0.0%
- reduce.flatput                 |   9590 |     0.00019s |   0.2%
- reduce.gather.context          |   9590 |     0.00116s |   1.0%
- reduce.gather.tensors          |   9590 |     0.00377s |   3.2%
- reduce.heur_params             |   9590 |     0.01107s |   9.3%
- reduce.heur_params.alpha       |   9589 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   9589 |     0.00228s |   1.9%
- reduce.memory                  |   9590 |     0.00046s |   0.4%
- reduce.pad                     |   9590 |     0.00028s |   0.2%
- reduce.threshold               |   9590 |     0.00240s |   2.0%
- test.last                      |     68 |     0.41126s |   2.5%
- test.runavg                    |     68 |     0.44217s |   2.7%
-----------------------------------------------------------------

[Iteration 9600] [Rank 0] a = 1.109176516532898, b = 0.9996382934243341, delta = 0.0008359249331988394, c = 0.00027658681711994674, d = 0.00027717405027731393, m = 0.0005019783059990715
[Iteration 9610] [Rank 0] a = 0.9856064915657043, b = 0.999776586820837, delta = 0.0007783422479405999, c = 0.0005531736342398935, d = 0.000554244471173916, m = 0.0005025032770620893
[Iteration 9620] [Rank 0] a = 0.9482009410858154, b = 1.000087716760919, delta = 0.0007235657540149987, c = 0.0011754335222876919, d = 0.001173948167830822, m = 0.0005029006243542299
[Iteration 9630] [Rank 0] a = 0.9553762078285217, b = 0.9998307158985955, delta = 0.0007498384220525622, c = 0.0006614317939568803, d = 0.0006625026308909028, m = 0.0005038188262681478
[Iteration 9640] [Rank 0] a = 0.975518524646759, b = 0.9998987140426353, delta = 0.0007490050047636032, c = 0.0007974280845777408, d = 0.0007985680077655713, m = 0.0005040421970847735
[Iteration 9650] [Rank 0] a = 0.9508107900619507, b = 0.9999168837272316, delta = 0.0007380250026471913, c = 0.0008337674540806987, d = 0.0008343892303649699, m = 0.0005045023684322254
[Iteration 9660] [Rank 0] a = 0.9502432346343994, b = 1.000463235060582, delta = 0.0006917085847817361, c = 0.0019264701874334247, d = 0.001899388375940726, m = 0.0005050527808545902
[Iteration 9670] [Rank 0] a = 0.935987114906311, b = 1.0006611498429792, delta = 0.0006968663074076176, c = 0.002322299878625815, d = 0.0022914528663005853, m = 0.0005054368759207227
[Iteration 9680] [Rank 0] a = 1.0194655656814575, b = 0.9997447207880964, delta = 0.000786022050306201, c = 0.0004894415651021014, d = 0.0004909614626858752, m = 0.0005056222743757697
[Iteration 9690] [Rank 0] a = 0.9059416055679321, b = 1.0005463112595707, delta = 0.0006979614845477045, c = 0.0020926226278414357, d = 0.00207352027866355, m = 0.0005063395559181098
[Iteration 9700] [Rank 0] a = 1.0160324573516846, b = 0.9998534798186566, delta = 0.0007334380643442273, c = 0.0007069596352162896, d = 0.0007079268427696002, m = 0.0005065813796936054
learning_rate                  - epoch: 69.849, value:  1.000 (weight:encoder.weight)
effective_lr                   - epoch: 69.849, value:  0.000 (weight:encoder.weight)
grad_norm                      - epoch: 69.849, value:  0.084 (weight:encoder.weight)
learning_rate                  - epoch: 69.849, value:  1.000 (weight:rnn.weight_ih_l0)
effective_lr                   - epoch: 69.849, value:  0.000 (weight:rnn.weight_ih_l0)

[Iteration 9460] [Rank 3] a = 1.1017017364501953, b = 0.9996376025618866, delta = 0.0008561783470213413, c = 0.00027520509204378865, d = 0.0002758268683280598, m = 0.0005807050248395914
[Iteration 9470] [Rank 3] a = 0.9292193055152893, b = 0.9999357960891087, delta = 0.0007643125136382878, c = 0.0008715921780405266, d = 0.0008722830405786056, m = 0.0005809859466090931
[Iteration 9480] [Rank 3] a = 1.0089527368545532, b = 0.9997654639345573, delta = 0.0007845733198337257, c = 0.0005309278605137482, d = 0.0005322059562091944, m = 0.0005811536872644744
[Iteration 9490] [Rank 3] a = 0.9099133610725403, b = 1.00039672228205, delta = 0.0007201542030088603, c = 0.001793444605726304, d = 0.0017777274829850057, m = 0.0005815440779734381
[Iteration 9500] [Rank 3] a = 0.9939724206924438, b = 0.9999259685695514, delta = 0.0007195061189122498, c = 0.0008519371388321777, d = 0.0008529388895123924, m = 0.0005819299566217781

[Iteration 9460] [Rank 1] a = 1.0365216732025146, b = 0.9998083664962175, delta = 0.0007583096157759428, c = 0.000616732987743166, d = 0.0006180110834386122, m = 0.0006789509426512721
[Iteration 9470] [Rank 1] a = 1.0765130519866943, b = 0.9997062570191919, delta = 0.0008127562468871474, c = 0.0004125140214869994, d = 0.00041348122904031004, m = 0.0006793376401213996
[Iteration 9480] [Rank 1] a = 1.0474436283111572, b = 0.9997703863298759, delta = 0.0007777691935189068, c = 0.0005407726516813746, d = 0.0005418434886153971, m = 0.0006795321301293613
[Iteration 9490] [Rank 1] a = 0.9570371508598328, b = 1.0000249173564273, delta = 0.0007257701945491135, c = 0.0010498347128649209, d = 0.0010494201953420736, m = 0.0006802429122920108
[Iteration 9500] [Rank 1] a = 0.8752886056900024, b = 1.001159330396123, delta = 0.0007045639213174582, c = 0.0033186618310434178, d = 0.0031676392802193376, m = 0.000680602738564227
[Iteration 9510] [Rank 3] a = 0.9439213275909424, b = 1.0002892758985593, delta = 0.0007197090308181942, c = 0.0015785518132568161, d = 0.001567083495124704, m = 0.0005821571481965868
[Iteration 9520] [Rank 3] a = 1.024347186088562, b = 0.9997555846008294, delta = 0.0007734618848189712, c = 0.0005111691919246874, d = 0.0005123782013663257, m = 0.0005824030479137727
[Iteration 9530] [Rank 3] a = 1.042583703994751, b = 0.9997352905150892, delta = 0.0007715749088674784, c = 0.00047058101781254335, d = 0.0004717209410003738, m = 0.0005829782711960544
[Iteration 9540] [Rank 3] a = 1.0346494913101196, b = 0.999822235561196, delta = 0.0007257320103235543, c = 0.0006444711186470397, d = 0.0006459219299770057, m = 0.0005837021807304385
[Iteration 9550] [Rank 3] a = 0.9433562755584717, b = 0.9999458308674388, delta = 0.0007524810498580337, c = 0.0008916617347717229, d = 0.0008921107954214743, m = 0.0005838896929959742
[Iteration 9510] [Rank 1] a = 0.8261501789093018, b = 1.0008107560442903, delta = 0.0007093832246027887, c = 0.0026215124438678508, d = 0.0025744992481515714, m = 0.0006808895984843718
[Iteration 9520] [Rank 1] a = 0.9718647003173828, b = 0.9999800976492773, delta = 0.0007585884304717183, c = 0.0009601952985491645, d = 0.0009604371004374922, m = 0.0006809427722535641
[Iteration 9530] [Rank 1] a = 1.0408365726470947, b = 0.9997868461290386, delta = 0.0007795009296387434, c = 0.0005736922516208412, d = 0.0005744867435396321, m = 0.0006811391244499822
[Iteration 9540] [Rank 1] a = 0.9104151129722595, b = 1.0003024368287576, delta = 0.0007330228690989316, c = 0.001604873675957628, d = 0.0015928526677950524, m = 0.0006813447715923494
[Iteration 9550] [Rank 1] a = 0.9897080659866333, b = 1.0001123805532801, delta = 0.0007390624959953129, c = 0.0012247611075065358, d = 0.001220961363547101, m = 0.0006814910611690698

[Iteration 9460] [Rank 2] a = 0.9823692440986633, b = 0.9999562974348655, delta = 0.0007231606286950409, c = 0.0009125948696755181, d = 0.0009131821028328853, m = 0.0005448323873460951
[Iteration 9470] [Rank 2] a = 1.0174787044525146, b = 0.9998161559710597, delta = 0.0007694851374253631, c = 0.0006323119379768484, d = 0.0006337282061799105, m = 0.0005450222368025617
[Iteration 9480] [Rank 2] a = 0.9820873737335205, b = 0.9997940138275564, delta = 0.0007641411502845585, c = 0.0005880276492859815, d = 0.0005890639430931001, m = 0.0005463226948973134
[Iteration 9490] [Rank 2] a = 1.0498247146606445, b = 0.9997983662613654, delta = 0.0007449382683262229, c = 0.0005967325172657775, d = 0.0005980451560881276, m = 0.0005466422281031065
[Iteration 9500] [Rank 2] a = 1.0188966989517212, b = 0.9998620119708291, delta = 0.0007269653724506497, c = 0.000724023939906842, d = 0.0007252329493484804, m = 0.0005469342787615986
[Iteration 9560] [Rank 3] a = 1.0218580961227417, b = 0.9997592461720657, delta = 0.0007663769065402448, c = 0.0005184923348283253, d = 0.0005196668011430597, m = 0.0005841262883422038
[Iteration 9570] [Rank 3] a = 1.0222868919372559, b = 0.99981076724345, delta = 0.0007338200812228024, c = 0.0006215344823828153, d = 0.0006227434918244536, m = 0.0005847349252360355
[Iteration 9580] [Rank 3] a = 0.9380488991737366, b = 1.0015278876191007, delta = 0.0006572709535248578, c = 0.004055777616046858, d = 0.003739742548002597, m = 0.0005860936848516137
[Iteration 9590] [Rank 3] a = 0.9606925249099731, b = 1.0000017734614068, delta = 0.0007389448001049459, c = 0.0010035469228136247, d = 0.0010035123796867209, m = 0.0005866723204747672
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9590 |     0.11074s |  93.0%
- batch.accumulate               |   9590 |     0.00082s |   0.7%
[Iteration 9560] [Rank 1] a = 0.9911834597587585, b = 0.9998054994167912, delta = 0.0007648757309652865, c = 0.0006109988286771099, d = 0.0006121387518649402, m = 0.000682320305687327
[Iteration 9570] [Rank 1] a = 0.9562037587165833, b = 1.0001465955199016, delta = 0.0007250467897392809, c = 0.0012931910419032655, d = 0.0012903239623702374, m = 0.0006828964332099224
[Iteration 9580] [Rank 1] a = 1.031636357307434, b = 0.9997999379735762, delta = 0.0007633891655132174, c = 0.0005998759418140372, d = 0.0006009813218749636, m = 0.0006829264845157145
[Iteration 9590] [Rank 1] a = 1.0065339803695679, b = 0.9999076261692927, delta = 0.000812009209766984, c = 0.0008152523380601803, d = 0.0008159086574713554, m = 0.0006829659454135867
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9590 |     0.11063s |  92.9%
- batch.accumulate               |   9590 |     0.00083s |   0.7%
[Iteration 9510] [Rank 2] a = 0.9924313426017761, b = 0.9999277993552674, delta = 0.0007400460308417678, c = 0.0008555987102839967, d = 0.0008564968315834994, m = 0.0005472284319588093
[Iteration 9520] [Rank 2] a = 0.981357216835022, b = 0.9997870015731026, delta = 0.000800657260697335, c = 0.0005740031397629768, d = 0.0005754194079660389, m = 0.0005473878328181656
[Iteration 9530] [Rank 2] a = 1.0068447589874268, b = 0.9997394529615939, delta = 0.000783975759986788, c = 0.00047890591139639586, d = 0.0004799076620766105, m = 0.0005477863307896268
[Iteration 9540] [Rank 2] a = 1.0275962352752686, b = 0.9997375703613065, delta = 0.0007778927101753652, c = 0.00047514071056386505, d = 0.00047600428873646386, m = 0.0005480865116401028
[Iteration 9550] [Rank 2] a = 1.0398576259613037, b = 0.999718640729163, delta = 0.0007930633146315813, c = 0.00043728144347713325, d = 0.0004383522804111558, m = 0.0005483100227324212
- batch.backward                 |   9590 |     0.05174s |  43.4%
- batch.evaluate                 |   9590 |     0.00277s |   2.3%
- batch.forward                  |   9590 |     0.02537s |  21.3%
- batch.mom                      |   9590 |     0.00126s |   1.1%
- batch.reduce                   |   9590 |     0.02599s |  21.8%
- batch.reporting.compr_err      |   9590 |     0.00001s |   0.0%
- batch.reporting.lr             |   9590 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9590 |     0.00001s |   0.0%
- batch.step                     |   9590 |     0.00047s |   0.4%
- batch.update_runavg            |   9590 |     0.00130s |   1.1%
- batch.wd                       |   9590 |     0.00001s |   0.0%
- epoch_metrics.collect          |     68 |     0.00783s |   0.0%
- reduce.combine                 |   9590 |     0.00608s |   5.1%
- reduce.flatpack                |   9590 |     0.00002s |   0.0%
- reduce.flatput                 |   9590 |     0.00019s |   0.2%
- batch.backward                 |   9590 |     0.05177s |  43.5%
- batch.evaluate                 |   9590 |     0.00276s |   2.3%
- batch.forward                  |   9590 |     0.02542s |  21.3%
- batch.mom                      |   9590 |     0.00126s |   1.1%
- batch.reduce                   |   9590 |     0.02582s |  21.7%
- batch.reporting.compr_err      |   9590 |     0.00001s |   0.0%
- batch.reporting.lr             |   9590 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9590 |     0.00001s |   0.0%
- batch.step                     |   9590 |     0.00048s |   0.4%
- batch.update_runavg            |   9590 |     0.00130s |   1.1%
- batch.wd                       |   9590 |     0.00001s |   0.0%
- epoch_metrics.collect          |     68 |     0.00796s |   0.0%
- reduce.combine                 |   9590 |     0.00618s |   5.2%
- reduce.flatpack                |   9590 |     0.00002s |   0.0%
- reduce.flatput                 |   9590 |     0.00023s |   0.2%
[Iteration 9560] [Rank 2] a = 0.9656774401664734, b = 1.000802241169047, delta = 0.0007015366572886705, c = 0.002604482682304202, d = 0.0025367781535724555, m = 0.0005489000775166584
[Iteration 9570] [Rank 2] a = 0.9903485774993896, b = 0.9998633936958793, delta = 0.0007418393506668508, c = 0.0007267873900591583, d = 0.0007280309426277005, m = 0.0005492368510443757
[Iteration 9580] [Rank 2] a = 1.0291259288787842, b = 0.9996996074678499, delta = 0.0008200117736123502, c = 0.00039921491762897774, d = 0.0003999403232939607, m = 0.0005494300656755411
[Iteration 9590] [Rank 2] a = 0.9928420186042786, b = 1.0000341749144295, delta = 0.0007628416060470045, c = 0.0010683498288854394, d = 0.001067900768235688, m = 0.0005496625636371968
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9590 |     0.11069s |  92.9%
- batch.accumulate               |   9590 |     0.00083s |   0.7%
- reduce.gather.context          |   9590 |     0.00249s |   2.1%
- reduce.gather.tensors          |   9590 |     0.00334s |   2.8%
- reduce.heur_params             |   9590 |     0.01049s |   8.8%
- reduce.gather.context          |   9590 |     0.00129s |   1.1%
- reduce.gather.tensors          |   9590 |     0.00367s |   3.1%
- reduce.heur_params             |   9590 |     0.01091s |   9.2%
- batch.backward                 |   9590 |     0.05179s |  43.5%
- batch.evaluate                 |   9590 |     0.00274s |   2.3%
- batch.forward                  |   9590 |     0.02549s |  21.4%
- batch.mom                      |   9590 |     0.00126s |   1.1%
- batch.reduce                   |   9590 |     0.02582s |  21.7%
- batch.reporting.compr_err      |   9590 |     0.00001s |   0.0%
- batch.reporting.lr             |   9590 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9590 |     0.00001s |   0.0%
- batch.step                     |   9590 |     0.00048s |   0.4%
- batch.update_runavg            |   9590 |     0.00130s |   1.1%
- batch.wd                       |   9590 |     0.00001s |   0.0%
- epoch_metrics.collect          |     68 |     0.01261s |   0.1%
- reduce.combine                 |   9590 |     0.00610s |   5.1%
- reduce.flatpack                |   9590 |     0.00002s |   0.0%
- reduce.flatput                 |   9590 |     0.00019s |   0.2%
- reduce.heur_params.alpha       |   9589 |     0.00810s |   6.8%
- reduce.heur_params.beta        |   9589 |     0.00232s |   1.9%
- reduce.memory                  |   9590 |     0.00045s |   0.4%
- reduce.pad                     |   9590 |     0.00027s |   0.2%
- reduce.threshold               |   9590 |     0.00245s |   2.1%
- test.last                      |     68 |     0.41128s |   2.5%
- test.runavg                    |     68 |     0.44216s |   2.7%
-----------------------------------------------------------------

[Iteration 9600] [Rank 3] a = 0.9385497570037842, b = 1.0000982524145334, delta = 0.0006787154707126319, c = 0.0011965048296991028, d = 0.0011955721652726961, m = 0.0005877640587114198
[Iteration 9610] [Rank 3] a = 1.0699138641357422, b = 0.9997355323169606, delta = 0.0007309322827495635, c = 0.0004710646215891987, d = 0.00047203182914250935, m = 0.000588311462891131
- reduce.heur_params.alpha       |   9589 |     0.00834s |   7.0%
- reduce.heur_params.beta        |   9589 |     0.00249s |   2.1%
- reduce.memory                  |   9590 |     0.00047s |   0.4%
- reduce.pad                     |   9590 |     0.00020s |   0.2%
- reduce.threshold               |   9590 |     0.00265s |   2.2%
- test.last                      |     68 |     0.41128s |   2.5%
- test.runavg                    |     68 |     0.44216s |   2.7%
-----------------------------------------------------------------

[Iteration 9600] [Rank 1] a = 0.9696750640869141, b = 1.0012688664899658, delta = 0.0006981897749938071, c = 0.0035377343418682835, d = 0.003400287239917457, m = 0.000683697737328836
[Iteration 9610] [Rank 1] a = 1.0281425714492798, b = 0.999789505949691, delta = 0.0007546214037574828, c = 0.0005790118931640499, d = 0.0005802209026056882, m = 0.0006849056295766168
- reduce.gather.context          |   9590 |     0.00193s |   1.6%
- reduce.gather.tensors          |   9590 |     0.00368s |   3.1%
- reduce.heur_params             |   9590 |     0.01056s |   8.9%
[Iteration 9620] [Rank 3] a = 1.062984585762024, b = 0.9997013518956019, delta = 0.0007741407607682049, c = 0.00040270377344627694, d = 0.000403360092857452, m = 0.0005885769966648334
[Iteration 9630] [Rank 3] a = 1.1018906831741333, b = 0.999705497070466, delta = 0.0007556727505289018, c = 0.0004109941239032255, d = 0.0004117540726951124, m = 0.0005889470896952666
[Iteration 9640] [Rank 3] a = 1.237615704536438, b = 0.9996101925945673, delta = 0.0008123904117383063, c = 0.00022038514964721622, d = 0.00022107601218529526, m = 0.0005894874860424249
[Iteration 9650] [Rank 3] a = 1.048607587814331, b = 0.9997932538787969, delta = 0.000715951609890908, c = 0.0005865077517022075, d = 0.000587613131763134, m = 0.0005897237200382702
[Iteration 9660] [Rank 3] a = 0.92267906665802, b = 1.0001340909082086, delta = 0.0007032820722088218, c = 0.0012681818180248039, d = 0.0012663855754257985, m = 0.0005900220902713381
[Iteration 9620] [Rank 1] a = 1.0162845849990845, b = 0.9998339629524333, delta = 0.0007335709524340928, c = 0.0006679259018148233, d = 0.0006688240231143261, m = 0.0006851845183261891
[Iteration 9630] [Rank 1] a = 1.1204140186309814, b = 0.9996750300354618, delta = 0.0008091802592389286, c = 0.0003500600480446535, d = 0.00035088908309034836, m = 0.0006853688681835907
[Iteration 9640] [Rank 1] a = 1.021230936050415, b = 0.9997949464919433, delta = 0.000754301086999476, c = 0.000589892978138795, d = 0.0005911710738342412, m = 0.0006855317643404975
[Iteration 9650] [Rank 1] a = 0.9944412708282471, b = 0.9999227387872043, delta = 0.0007324739126488566, c = 0.0008454775741011387, d = 0.0008463411522737375, m = 0.0006857284222264349
[Iteration 9660] [Rank 1] a = 0.9452091455459595, b = 0.999994743935082, delta = 0.0007521745865233243, c = 0.000989487870163716, d = 0.000989591499544428, m = 0.0006859572638867241
- reduce.heur_params.alpha       |   9589 |     0.00821s |   6.9%
- reduce.heur_params.beta        |   9589 |     0.00228s |   1.9%
- reduce.memory                  |   9590 |     0.00045s |   0.4%
- reduce.pad                     |   9590 |     0.00027s |   0.2%
- reduce.threshold               |   9590 |     0.00240s |   2.0%
- test.last                      |     68 |     0.41127s |   2.5%
- test.runavg                    |     68 |     0.44216s |   2.7%
-----------------------------------------------------------------

[Iteration 9600] [Rank 2] a = 0.9599827527999878, b = 1.0000392700256409, delta = 0.000750953215174377, c = 0.0010785400513221054, d = 0.0010775728437687948, m = 0.0005499201293343005
[Iteration 9610] [Rank 2] a = 0.8968555927276611, b = 1.0014633093878262, delta = 0.0006770102772861719, c = 0.00392662086455298, d = 0.003684715346844601, m = 0.0005511897927383926
[Iteration 9670] [Rank 3] a = 1.0010141134262085, b = 0.9998373827219043, delta = 0.0007169662276282907, c = 0.0006747654409418059, d = 0.0006758017347489245, m = 0.0005903110353409682
[Iteration 9680] [Rank 3] a = 0.963324785232544, b = 1.0004547201815939, delta = 0.0006743015837855637, c = 0.0019094404258697762, d = 0.0018801133111283205, m = 0.0005907354043997843
[Iteration 9690] [Rank 3] a = 0.984783411026001, b = 0.9998930835130109, delta = 0.0007530625443905592, c = 0.0007861670252070523, d = 0.0007870306033796511, m = 0.0005907811546107187
[Iteration 9700] [Rank 3] a = 1.015793800354004, b = 0.9998186948908024, delta = 0.0007422123453579843, c = 0.0006373897776317294, d = 0.0006382878989312322, m = 0.0005909622946197511
[Iteration 9710] [Rank 3] a = 0.9585770964622498, b = 0.999964397798112, delta = 0.0007330881198868155, c = 0.0009287955961934718, d = 0.0009292101137163192, m = 0.0005912307621948054
[Iteration 9670] [Rank 1] a = 1.04379403591156, b = 0.9998002143185802, delta = 0.0007545006228610873, c = 0.0006004286318445004, d = 0.0006016376412861387, m = 0.0006861629797747012
[Iteration 9680] [Rank 1] a = 1.0790982246398926, b = 0.9997056697860854, delta = 0.0007888514082878828, c = 0.000411339555172265, d = 0.00041254856461390337, m = 0.0006864205724147081
[Iteration 9690] [Rank 1] a = 1.0538564920425415, b = 0.9998097309496803, delta = 0.0007520054350607097, c = 0.0006194618947685781, d = 0.0006203600160680809, m = 0.0006866273461209451
[Iteration 9700] [Rank 1] a = 1.0666428804397583, b = 0.9997365686106955, delta = 0.0007741062436252832, c = 0.0004731372092034358, d = 0.00047413895988365046, m = 0.0006869769259096051
[Iteration 9710] [Rank 1] a = 1.023481011390686, b = 0.9998087119274738, delta = 0.000734560249838978, c = 0.0006174238502812449, d = 0.0006185292303421715, m = 0.0006874622045824296
[Iteration 9620] [Rank 2] a = 0.9160788059234619, b = 1.000582961505527, delta = 0.0007079552160575986, c = 0.0021659231431316226, d = 0.002148237062156799, m = 0.0005513929057092122
[Iteration 9630] [Rank 2] a = 0.9522832632064819, b = 1.0004936157337379, delta = 0.0006816330133005977, c = 0.001987231547657477, d = 0.0019484396161443384, m = 0.0005519771852831906
[Iteration 9640] [Rank 2] a = 1.012405276298523, b = 0.9997925284731629, delta = 0.0007570112938992679, c = 0.0005850569403722416, d = 0.0005860932341793601, m = 0.000552707407723427
[Iteration 9650] [Rank 2] a = 1.018721580505371, b = 0.999770541773939, delta = 0.0007666778401471674, c = 0.0005410835398235101, d = 0.0005423616355189565, m = 0.0005529158188866634
[Iteration 9660] [Rank 2] a = 0.8977776765823364, b = 1.000904955081965, delta = 0.0006828574696555734, c = 0.0028099106580020067, d = 0.00275094554037696, m = 0.0005534862243309372
[Iteration 9720] [Rank 3] a = 0.8925381302833557, b = 1.000480852051377, delta = 0.000694865477271378, c = 0.001961704176875456, d = 0.0019476796673524514, m = 0.0005917023791781784
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9729 |     0.11077s |  93.0%
- batch.accumulate               |   9729 |     0.00082s |   0.7%
- batch.backward                 |   9729 |     0.05174s |  43.4%
- batch.evaluate                 |   9729 |     0.00277s |   2.3%
- batch.forward                  |   9729 |     0.02537s |  21.3%
- batch.mom                      |   9729 |     0.00126s |   1.1%
- batch.reduce                   |   9729 |     0.02602s |  21.8%
- batch.reporting.compr_err      |   9729 |     0.00001s |   0.0%
- batch.reporting.lr             |   9729 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9729 |     0.00001s |   0.0%
[Iteration 9720] [Rank 1] a = 0.8880247473716736, b = 1.000700926235155, delta = 0.0006920179002918303, c = 0.0024018526998856172, d = 0.002353492322220084, m = 0.0006878298284988929
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9729 |     0.11066s |  92.9%
- batch.accumulate               |   9729 |     0.00083s |   0.7%
- batch.backward                 |   9729 |     0.05177s |  43.5%
- batch.evaluate                 |   9729 |     0.00275s |   2.3%
- batch.forward                  |   9729 |     0.02542s |  21.3%
- batch.mom                      |   9729 |     0.00126s |   1.1%
- batch.reduce                   |   9729 |     0.02585s |  21.7%
- batch.reporting.compr_err      |   9729 |     0.00001s |   0.0%
- batch.reporting.lr             |   9729 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9729 |     0.00001s |   0.0%
[Iteration 9670] [Rank 2] a = 1.0880650281906128, b = 0.9997110412418622, delta = 0.0007755121914669871, c = 0.0004220824676393942, d = 0.000422980588938897, m = 0.0005538134589597187
[Iteration 9680] [Rank 2] a = 1.0046907663345337, b = 0.9997398502075264, delta = 0.0007987968274392188, c = 0.0004797004033151868, d = 0.000481013042137537, m = 0.0005539374080738255
[Iteration 9690] [Rank 2] a = 1.0891567468643188, b = 0.9996798660727252, delta = 0.0008067282033152878, c = 0.00035973212357776014, d = 0.0003601466411006076, m = 0.0005542488091148343
[Iteration 9700] [Rank 2] a = 0.9041398763656616, b = 1.000377758108224, delta = 0.0007142525864765048, c = 0.0017555162523857641, d = 0.001747847678213087, m = 0.0005547212881038663
[Iteration 9710] [Rank 2] a = 0.9494881629943848, b = 1.0001001350149312, delta = 0.0007324391626752913, c = 0.0012002700305316337, d = 0.0011978174685214529, m = 0.0005549347254456265
- batch.step                     |   9729 |     0.00047s |   0.4%
- batch.update_runavg            |   9729 |     0.00130s |   1.1%
- batch.wd                       |   9729 |     0.00001s |   0.0%
- epoch_metrics.collect          |     69 |     0.00772s |   0.0%
- reduce.combine                 |   9729 |     0.00609s |   5.1%
- batch.step                     |   9729 |     0.00048s |   0.4%
- batch.update_runavg            |   9729 |     0.00130s |   1.1%
- batch.wd                       |   9729 |     0.00001s |   0.0%
- epoch_metrics.collect          |     69 |     0.00786s |   0.0%
- reduce.combine                 |   9729 |     0.00619s |   5.2%
[Iteration 9720] [Rank 2] a = 0.978499174118042, b = 0.9998979368222879, delta = 0.00074311054777354, c = 0.000795873643867063, d = 0.0007967026789127579, m = 0.0005553611796463811
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9729 |     0.11072s |  92.9%
- batch.accumulate               |   9729 |     0.00083s |   0.7%
- batch.backward                 |   9729 |     0.05179s |  43.5%
- batch.evaluate                 |   9729 |     0.00274s |   2.3%
- batch.forward                  |   9729 |     0.02549s |  21.4%
- batch.mom                      |   9729 |     0.00126s |   1.1%
- batch.reduce                   |   9729 |     0.02586s |  21.7%
- batch.reporting.compr_err      |   9729 |     0.00001s |   0.0%
- batch.reporting.lr             |   9729 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9729 |     0.00001s |   0.0%
- reduce.flatpack                |   9729 |     0.00002s |   0.0%
- reduce.flatput                 |   9729 |     0.00019s |   0.2%
- reduce.gather.context          |   9729 |     0.00249s |   2.1%
- reduce.gather.tensors          |   9729 |     0.00335s |   2.8%
- reduce.heur_params             |   9729 |     0.01050s |   8.8%
- reduce.heur_params.alpha       |   9728 |     0.00810s |   6.8%
- reduce.heur_params.beta        |   9728 |     0.00232s |   1.9%
- reduce.memory                  |   9729 |     0.00045s |   0.4%
- reduce.pad                     |   9729 |     0.00027s |   0.2%
- reduce.threshold               |   9729 |     0.00246s |   2.1%
- test.last                      |     69 |     0.41122s |   2.5%
- test.runavg                    |     69 |     0.44210s |   2.7%
-----------------------------------------------------------------
- reduce.flatpack                |   9729 |     0.00002s |   0.0%
- reduce.flatput                 |   9729 |     0.00023s |   0.2%
- reduce.gather.context          |   9729 |     0.00129s |   1.1%
- reduce.gather.tensors          |   9729 |     0.00369s |   3.1%
- reduce.heur_params             |   9729 |     0.01091s |   9.2%
- reduce.heur_params.alpha       |   9728 |     0.00834s |   7.0%
- reduce.heur_params.beta        |   9728 |     0.00249s |   2.1%
- reduce.memory                  |   9729 |     0.00047s |   0.4%
- reduce.pad                     |   9729 |     0.00020s |   0.2%
- reduce.threshold               |   9729 |     0.00265s |   2.2%
- test.last                      |     69 |     0.41122s |   2.5%
- test.runavg                    |     69 |     0.44210s |   2.7%
-----------------------------------------------------------------
- batch.step                     |   9729 |     0.00048s |   0.4%
- batch.update_runavg            |   9729 |     0.00130s |   1.1%
- batch.wd                       |   9729 |     0.00001s |   0.0%
- epoch_metrics.collect          |     69 |     0.01282s |   0.1%
- reduce.combine                 |   9729 |     0.00611s |   5.1%
- reduce.flatpack                |   9729 |     0.00002s |   0.0%
- reduce.flatput                 |   9729 |     0.00019s |   0.2%
- reduce.gather.context          |   9729 |     0.00194s |   1.6%
- reduce.gather.tensors          |   9729 |     0.00369s |   3.1%
- reduce.heur_params             |   9729 |     0.01056s |   8.9%
- reduce.heur_params.alpha       |   9728 |     0.00821s |   6.9%
- reduce.heur_params.beta        |   9728 |     0.00228s |   1.9%
- reduce.memory                  |   9729 |     0.00045s |   0.4%
- reduce.pad                     |   9729 |     0.00027s |   0.2%
- reduce.threshold               |   9729 |     0.00241s |   2.0%
- test.last                      |     69 |     0.41122s |   2.5%
- test.runavg                    |     69 |     0.44211s |   2.7%
-----------------------------------------------------------------
grad_norm                      - epoch: 69.849, value:  0.053 (weight:rnn.weight_ih_l0)
learning_rate                  - epoch: 69.849, value:  1.000 (weight:rnn.weight_hh_l0)
effective_lr                   - epoch: 69.849, value:  0.000 (weight:rnn.weight_hh_l0)
grad_norm                      - epoch: 69.849, value:  0.044 (weight:rnn.weight_hh_l0)
learning_rate                  - epoch: 69.849, value:  1.000 (weight:rnn.bias_ih_l0)
effective_lr                   - epoch: 69.849, value:  0.001 (weight:rnn.bias_ih_l0)
grad_norm                      - epoch: 69.849, value:  0.006 (weight:rnn.bias_ih_l0)
learning_rate                  - epoch: 69.849, value:  1.000 (weight:rnn.bias_hh_l0)
effective_lr                   - epoch: 69.849, value:  0.001 (weight:rnn.bias_hh_l0)
grad_norm                      - epoch: 69.849, value:  0.006 (weight:rnn.bias_hh_l0)
learning_rate                  - epoch: 69.849, value:  1.000 (weight:rnn.weight_ih_l1)
effective_lr                   - epoch: 69.849, value:  0.000 (weight:rnn.weight_ih_l1)
grad_norm                      - epoch: 69.849, value:  0.038 (weight:rnn.weight_ih_l1)
learning_rate                  - epoch: 69.849, value:  1.000 (weight:rnn.weight_hh_l1)
effective_lr                   - epoch: 69.849, value:  0.000 (weight:rnn.weight_hh_l1)
grad_norm                      - epoch: 69.849, value:  0.018 (weight:rnn.weight_hh_l1)
learning_rate                  - epoch: 69.849, value:  1.000 (weight:rnn.bias_ih_l1)
effective_lr                   - epoch: 69.849, value:  0.000 (weight:rnn.bias_ih_l1)
grad_norm                      - epoch: 69.849, value:  0.004 (weight:rnn.bias_ih_l1)
learning_rate                  - epoch: 69.849, value:  1.000 (weight:rnn.bias_hh_l1)
effective_lr                   - epoch: 69.849, value:  0.000 (weight:rnn.bias_hh_l1)
grad_norm                      - epoch: 69.849, value:  0.004 (weight:rnn.bias_hh_l1)
learning_rate                  - epoch: 69.849, value:  1.000 (weight:rnn.weight_ih_l2)
effective_lr                   - epoch: 69.849, value:  0.000 (weight:rnn.weight_ih_l2)
grad_norm                      - epoch: 69.849, value:  0.041 (weight:rnn.weight_ih_l2)
learning_rate                  - epoch: 69.849, value:  1.000 (weight:rnn.weight_hh_l2)
effective_lr                   - epoch: 69.849, value:  0.000 (weight:rnn.weight_hh_l2)
grad_norm                      - epoch: 69.849, value:  0.029 (weight:rnn.weight_hh_l2)
learning_rate                  - epoch: 69.849, value:  1.000 (weight:rnn.bias_ih_l2)
effective_lr                   - epoch: 69.849, value:  0.000 (weight:rnn.bias_ih_l2)
grad_norm                      - epoch: 69.849, value:  0.009 (weight:rnn.bias_ih_l2)
learning_rate                  - epoch: 69.849, value:  1.000 (weight:rnn.bias_hh_l2)
effective_lr                   - epoch: 69.849, value:  0.000 (weight:rnn.bias_hh_l2)
grad_norm                      - epoch: 69.849, value:  0.009 (weight:rnn.bias_hh_l2)
learning_rate                  - epoch: 69.849, value:  1.000 (weight:decoder.bias)
effective_lr                   - epoch: 69.849, value:  0.000 (weight:decoder.bias)
grad_norm                      - epoch: 69.849, value:  0.015 (weight:decoder.bias)
grad_norm                      - epoch: 69.849, value:  0.128 (weight:entire_model)
[Iteration 9710] [Rank 0] a = 0.9913883209228516, b = 0.9997863279821585, delta = 0.0007729396456852555, c = 0.0005726559578137227, d = 0.0005734159066056096, m = 0.0005069271565020427
[Iteration 9720] [Rank 0] a = 0.9365342855453491, b = 1.0001186155876032, delta = 0.0007197583909146488, c = 0.0012372311763188626, d = 0.0012349513299432019, m = 0.0005074902121014355
cross_entropy                  - bits:23592979712.000, epoch: 70.000, ratio_transmit_grad:  0.179, value:  5.363 (split:train)
last_cross_entropy             - bits:23592979712.000, epoch: 70.000, ratio_transmit_grad:  0.179, value:  5.363 (split:train)
perplexity                     - bits:23592979712.000, epoch: 70.000, ratio_transmit_grad:  0.179, value:213.814 (split:train)
last_perplexity                - bits:23592979712.000, epoch: 70.000, ratio_transmit_grad:  0.179, value:213.814 (split:train)
last_cross_entropy             - bits:23592979712.000, epoch: 70.000, ratio_transmit_grad:  0.179, value:  5.153 (split:test)
last_perplexity                - bits:23592979712.000, epoch: 70.000, ratio_transmit_grad:  0.179, value:173.443 (split:test)
runavg_cross_entropy           - bits:23592979712.000, epoch: 70.000, ratio_transmit_grad:  0.179, value:  5.350 (split:test)
runavg_perplexity              - bits:23592979712.000, epoch: 70.000, ratio_transmit_grad:  0.179, value:211.264 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9729 |     0.11067s |  92.9%
- batch.accumulate               |   9729 |     0.00082s |   0.7%
- batch.backward                 |   9729 |     0.05165s |  43.4%
- batch.evaluate                 |   9729 |     0.00275s |   2.3%
- batch.forward                  |   9729 |     0.02541s |  21.3%
- batch.mom                      |   9729 |     0.00126s |   1.1%
- batch.reduce                   |   9729 |     0.02596s |  21.8%
- batch.reporting.compr_err      |   9729 |     0.00001s |   0.0%
- batch.reporting.lr             |   9729 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9729 |     0.00001s |   0.0%
- batch.step                     |   9729 |     0.00048s |   0.4%
- batch.update_runavg            |   9729 |     0.00130s |   1.1%
- batch.wd                       |   9729 |     0.00001s |   0.0%
- epoch_metrics.collect          |     69 |     0.00853s |   0.1%
- reduce.combine                 |   9729 |     0.00637s |   5.3%
- reduce.flatpack                |   9729 |     0.00002s |   0.0%
- reduce.flatput                 |   9729 |     0.00020s |   0.2%
- reduce.gather.context          |   9729 |     0.00115s |   1.0%
- reduce.gather.tensors          |   9729 |     0.00378s |   3.2%
- reduce.heur_params             |   9729 |     0.01107s |   9.3%
- reduce.heur_params.alpha       |   9728 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   9728 |     0.00229s |   1.9%
- reduce.memory                  |   9729 |     0.00046s |   0.4%
- reduce.pad                     |   9729 |     0.00028s |   0.2%
- reduce.threshold               |   9729 |     0.00241s |   2.0%
- test.last                      |     69 |     0.41121s |   2.5%
- test.runavg                    |     69 |     0.44211s |   2.7%
-----------------------------------------------------------------

[Iteration 9730] [Rank 0] a = 0.9808125495910645, b = 0.9999127730951598, delta = 0.0007457790779881179, c = 0.000825546189877558, d = 0.000826306138669445, m = 0.0005081221445108893
[Iteration 9740] [Rank 0] a = 0.9920361638069153, b = 0.9998044113083352, delta = 0.0007548560970462859, c = 0.0006088226116821608, d = 0.0006104115955197426, m = 0.0005083951210286003
[Iteration 9750] [Rank 0] a = 1.0462721586227417, b = 0.9997343233076037, delta = 0.0007877377211116254, c = 0.00046864660270592203, d = 0.00046957926713232876, m = 0.0005087164067356543
[Iteration 9760] [Rank 0] a = 0.9494948387145996, b = 0.9998230127815267, delta = 0.0007830196991562843, c = 0.0006460255593577175, d = 0.0006469582237841243, m = 0.0005090790726384212
[Iteration 9770] [Rank 0] a = 1.0142046213150024, b = 0.9998931353277006, delta = 0.0007021063356660306, c = 0.0007862706545877642, d = 0.000787099689633459, m = 0.0005103198891738924
learning_rate                  - epoch: 70.360, value:  1.000 (weight:encoder.weight)
effective_lr                   - epoch: 70.360, value:  0.000 (weight:encoder.weight)
grad_norm                      - epoch: 70.360, value:  0.089 (weight:encoder.weight)
learning_rate                  - epoch: 70.360, value:  1.000 (weight:rnn.weight_ih_l0)
effective_lr                   - epoch: 70.360, value:  0.000 (weight:rnn.weight_ih_l0)
grad_norm                      - epoch: 70.360, value:  0.052 (weight:rnn.weight_ih_l0)
learning_rate                  - epoch: 70.360, value:  1.000 (weight:rnn.weight_hh_l0)
effective_lr                   - epoch: 70.360, value:  0.000 (weight:rnn.weight_hh_l0)
grad_norm                      - epoch: 70.360, value:  0.041 (weight:rnn.weight_hh_l0)
learning_rate                  - epoch: 70.360, value:  1.000 (weight:rnn.bias_ih_l0)
effective_lr                   - epoch: 70.360, value:  0.001 (weight:rnn.bias_ih_l0)
grad_norm                      - epoch: 70.360, value:  0.005 (weight:rnn.bias_ih_l0)
learning_rate                  - epoch: 70.360, value:  1.000 (weight:rnn.bias_hh_l0)
effective_lr                   - epoch: 70.360, value:  0.001 (weight:rnn.bias_hh_l0)
grad_norm                      - epoch: 70.360, value:  0.005 (weight:rnn.bias_hh_l0)
learning_rate                  - epoch: 70.360, value:  1.000 (weight:rnn.weight_ih_l1)
effective_lr                   - epoch: 70.360, value:  0.000 (weight:rnn.weight_ih_l1)
grad_norm                      - epoch: 70.360, value:  0.041 (weight:rnn.weight_ih_l1)
learning_rate                  - epoch: 70.360, value:  1.000 (weight:rnn.weight_hh_l1)
effective_lr                   - epoch: 70.360, value:  0.000 (weight:rnn.weight_hh_l1)
grad_norm                      - epoch: 70.360, value:  0.019 (weight:rnn.weight_hh_l1)
learning_rate                  - epoch: 70.360, value:  1.000 (weight:rnn.bias_ih_l1)
effective_lr                   - epoch: 70.360, value:  0.000 (weight:rnn.bias_ih_l1)
grad_norm                      - epoch: 70.360, value:  0.005 (weight:rnn.bias_ih_l1)
learning_rate                  - epoch: 70.360, value:  1.000 (weight:rnn.bias_hh_l1)
effective_lr                   - epoch: 70.360, value:  0.000 (weight:rnn.bias_hh_l1)
grad_norm                      - epoch: 70.360, value:  0.005 (weight:rnn.bias_hh_l1)
learning_rate                  - epoch: 70.360, value:  1.000 (weight:rnn.weight_ih_l2)
effective_lr                   - epoch: 70.360, value:  0.000 (weight:rnn.weight_ih_l2)
grad_norm                      - epoch: 70.360, value:  0.042 (weight:rnn.weight_ih_l2)
learning_rate                  - epoch: 70.360, value:  1.000 (weight:rnn.weight_hh_l2)
effective_lr                   - epoch: 70.360, value:  0.000 (weight:rnn.weight_hh_l2)
grad_norm                      - epoch: 70.360, value:  0.030 (weight:rnn.weight_hh_l2)
learning_rate                  - epoch: 70.360, value:  1.000 (weight:rnn.bias_ih_l2)
effective_lr                   - epoch: 70.360, value:  0.000 (weight:rnn.bias_ih_l2)
grad_norm                      - epoch: 70.360, value:  0.009 (weight:rnn.bias_ih_l2)
learning_rate                  - epoch: 70.360, value:  1.000 (weight:rnn.bias_hh_l2)
effective_lr                   - epoch: 70.360, value:  0.000 (weight:rnn.bias_hh_l2)
grad_norm                      - epoch: 70.360, value:  0.009 (weight:rnn.bias_hh_l2)
learning_rate                  - epoch: 70.360, value:  1.000 (weight:decoder.bias)
effective_lr                   - epoch: 70.360, value:  0.000 (weight:decoder.bias)
grad_norm                      - epoch: 70.360, value:  0.016 (weight:decoder.bias)
grad_norm                      - epoch: 70.360, value:  0.133 (weight:entire_model)
[Iteration 9780] [Rank 0] a = 1.066521167755127, b = 0.9996700730972826, delta = 0.0008170366054400802, c = 0.00034014617062321916, d = 0.0003410788350496259, m = 0.0005105911693260535
[Iteration 9790] [Rank 0] a = 1.095607876777649, b = 0.9996670505740105, delta = 0.0008097958052530885, c = 0.0003341011234150275, d = 0.0003346883565723947, m = 0.0005108690184671002
[Iteration 9800] [Rank 0] a = 0.9781473278999329, b = 0.9999220824677969, delta = 0.0007367551443167031, c = 0.0008441649352787884, d = 0.0008451321428320991, m = 0.0005113521284619747
[Iteration 9810] [Rank 0] a = 0.9978949427604675, b = 0.9999251395345103, delta = 0.0007163475966081023, c = 0.000850279068740788, d = 0.0008512117331671948, m = 0.000511822553816079
[Iteration 9820] [Rank 0] a = 0.9958388805389404, b = 0.9997899031956327, delta = 0.000773286388721317, c = 0.0005798063850828408, d = 0.0005806008770016317, m = 0.0005120475496736282
[Iteration 9830] [Rank 0] a = 0.9196179509162903, b = 1.000729648830478, delta = 0.0007149566081352532, c = 0.0024592979199268904, d = 0.0024248238792767456, m = 0.0005124416692232345
[Iteration 9840] [Rank 0] a = 1.056885004043579, b = 0.9996660660950033, delta = 0.0008226604550145566, c = 0.0003321321651815022, d = 0.0003331339158617168, m = 0.0005130336046352266
[Iteration 9850] [Rank 0] a = 0.9937342405319214, b = 0.9997775712999049, delta = 0.0007750142249278724, c = 0.0005551425924734189, d = 0.0005561098000267295, m = 0.0005138391606822081
[Iteration 9860] [Rank 0] a = 1.051735520362854, b = 0.9997082605203808, delta = 0.0007910892018117011, c = 0.0004165210242078579, d = 0.0004172809729997448, m = 0.0005140991013455718
cross_entropy                  - bits:24077529280.000, epoch: 71.000, ratio_transmit_grad:  0.188, value:  5.361 (split:train)
last_cross_entropy             - bits:24077529280.000, epoch: 71.000, ratio_transmit_grad:  0.188, value:  5.361 (split:train)
perplexity                     - bits:24077529280.000, epoch: 71.000, ratio_transmit_grad:  0.188, value:213.373 (split:train)
last_perplexity                - bits:24077529280.000, epoch: 71.000, ratio_transmit_grad:  0.188, value:213.373 (split:train)
last_cross_entropy             - bits:24077529280.000, epoch: 71.000, ratio_transmit_grad:  0.188, value:  5.150 (split:test)
last_perplexity                - bits:24077529280.000, epoch: 71.000, ratio_transmit_grad:  0.188, value:173.063 (split:test)
runavg_cross_entropy           - bits:24077529280.000, epoch: 71.000, ratio_transmit_grad:  0.188, value:  5.351 (split:test)
runavg_perplexity              - bits:24077529280.000, epoch: 71.000, ratio_transmit_grad:  0.188, value:211.436 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9868 |     0.11069s |  92.9%
- batch.accumulate               |   9868 |     0.00082s |   0.7%
- batch.backward                 |   9868 |     0.05165s |  43.3%
- batch.evaluate                 |   9868 |     0.00275s |   2.3%
- batch.forward                  |   9868 |     0.02541s |  21.3%
- batch.mom                      |   9868 |     0.00126s |   1.1%
- batch.reduce                   |   9868 |     0.02599s |  21.8%
- batch.reporting.compr_err      |   9868 |     0.00001s |   0.0%
- batch.reporting.lr             |   9868 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9868 |     0.00001s |   0.0%
- batch.step                     |   9868 |     0.00048s |   0.4%
- batch.update_runavg            |   9868 |     0.00130s |   1.1%
- batch.wd                       |   9868 |     0.00001s |   0.0%
- epoch_metrics.collect          |     70 |     0.00843s |   0.1%
- reduce.combine                 |   9868 |     0.00637s |   5.3%
- reduce.flatpack                |   9868 |     0.00002s |   0.0%
- reduce.flatput                 |   9868 |     0.00020s |   0.2%
- reduce.gather.context          |   9868 |     0.00115s |   1.0%
- reduce.gather.tensors          |   9868 |     0.00380s |   3.2%
- reduce.heur_params             |   9868 |     0.01108s |   9.3%
- reduce.heur_params.alpha       |   9867 |     0.00871s |   7.3%
- reduce.heur_params.beta        |   9867 |     0.00229s |   1.9%
- reduce.memory                  |   9868 |     0.00046s |   0.4%
- reduce.pad                     |   9868 |     0.00028s |   0.2%
- reduce.threshold               |   9868 |     0.00241s |   2.0%
- test.last                      |     70 |     0.41118s |   2.5%
- test.runavg                    |     70 |     0.44198s |   2.7%
-----------------------------------------------------------------

[Iteration 9870] [Rank 0] a = 0.9728350043296814, b = 1.000042413450184, delta = 0.0007455447921529412, c = 0.0010848269004186247, d = 0.0010840324084998338, m = 0.0005144354333690894
[Iteration 9880] [Rank 0] a = 0.9313392043113708, b = 1.0006133421747672, delta = 0.0006991566624492407, c = 0.002226684503355675, d = 0.0021878234855887283, m = 0.0005150177738036491
[Iteration 9890] [Rank 0] a = 1.0220587253570557, b = 0.9998623574020917, delta = 0.0007267761393450201, c = 0.0007247148024449211, d = 0.000725509294363712, m = 0.0005153011380191291
[Iteration 9900] [Rank 0] a = 1.0533742904663086, b = 0.9996873792020748, delta = 0.0008237450383603573, c = 0.00037475838378097943, d = 0.000375829220715002, m = 0.000515431229750755
rel_compression_error          - epoch: 71.245, value:  0.995 (weight:encoder.weight)
rel_compression_error          - epoch: 71.245, value:  0.987 (weight:rnn.weight_ih_l0)
rel_compression_error          - epoch: 71.245, value:  0.990 (weight:rnn.weight_hh_l0)
rel_compression_error          - epoch: 71.245, value:  0.931 (weight:rnn.bias_ih_l0)
rel_compression_error          - epoch: 71.245, value:  0.931 (weight:rnn.bias_hh_l0)
rel_compression_error          - epoch: 71.245, value:  0.988 (weight:rnn.weight_ih_l1)
rel_compression_error          - epoch: 71.245, value:  0.996 (weight:rnn.weight_hh_l1)
rel_compression_error          - epoch: 71.245, value:  0.946 (weight:rnn.bias_ih_l1)
rel_compression_error          - epoch: 71.245, value:  0.946 (weight:rnn.bias_hh_l1)
rel_compression_error          - epoch: 71.245, value:  0.981 (weight:rnn.weight_ih_l2)
rel_compression_error          - epoch: 71.245, value:  0.984 (weight:rnn.weight_hh_l2)
rel_compression_error          - epoch: 71.245, value:  0.846 (weight:rnn.bias_ih_l2)
rel_compression_error          - epoch: 71.245, value:  0.846 (weight:rnn.bias_hh_l2)
rel_compression_error          - epoch: 71.245, value:  0.939 (weight:decoder.bias)
rel_compression_error          - epoch: 71.245, value:  0.993 (weight:entire_model)
[Iteration 9910] [Rank 0] a = 0.9853758811950684, b = 1.0001346608697925, delta = 0.0007325493497774005, c = 0.0012693217412126344, d = 0.0012640711859232337, m = 0.0005158078379051233
[Iteration 9920] [Rank 0] a = 0.916818380355835, b = 1.0004393139500736, delta = 0.0007398863672278821, c = 0.0018786279566714505, d = 0.0018652597665596209, m = 0.000516033585625673

[Iteration 9730] [Rank 3] a = 0.9523831605911255, b = 1.0000622930196619, delta = 0.0007236457313410938, c = 0.001124586039485074, d = 0.0011236879181855711, m = 0.0005919697154720066
[Iteration 9740] [Rank 3] a = 0.9710132479667664, b = 1.0002423836071097, delta = 0.0007146284333430231, c = 0.0014847672237125855, d = 0.0014766150457632527, m = 0.0005922378078632398
[Iteration 9750] [Rank 3] a = 1.0787404775619507, b = 0.9997319052888929, delta = 0.0007426145020872355, c = 0.0004638105649393687, d = 0.0004646050568581596, m = 0.0005936953471066417
[Iteration 9760] [Rank 3] a = 1.0082316398620605, b = 0.9998121662400401, delta = 0.0007398637244477868, c = 0.0006243324756620355, d = 0.000625437855722962, m = 0.00059395922191532
[Iteration 9770] [Rank 3] a = 1.0810829401016235, b = 0.9997511112661674, delta = 0.0007299927528947592, c = 0.0005022225220565638, d = 0.0005028097552139309, m = 0.0005943647381099002

[Iteration 9730] [Rank 1] a = 1.0440267324447632, b = 0.9998989385729579, delta = 0.000721628253813833, c = 0.0007978771452274923, d = 0.0007985680077655713, m = 0.000688165920056032
[Iteration 9740] [Rank 1] a = 1.0667330026626587, b = 0.9996978457685375, delta = 0.0007869318360462785, c = 0.0003956915186847746, d = 0.0003964860106035655, m = 0.0006884164265306104
[Iteration 9750] [Rank 1] a = 0.8730745911598206, b = 1.0002637830728551, delta = 0.0007108146091923118, c = 0.0015275661579465824, d = 0.0015187231174591707, m = 0.0006886955422674988
[Iteration 9760] [Rank 1] a = 1.043390154838562, b = 0.9997915439940888, delta = 0.0007341090240515769, c = 0.0005830879821387163, d = 0.0005838479309306032, m = 0.0006892375707854311
[Iteration 9770] [Rank 1] a = 1.0229783058166504, b = 0.9998575386359833, delta = 0.0007420972106046975, c = 0.0007150772700387183, d = 0.0007156645031960856, m = 0.0006893514079658218
[Iteration 9930] [Rank 0] a = 0.9993159174919128, b = 1.0001488926377904, delta = 0.0007002524216659367, c = 0.0012977852777814913, d = 0.0012859715283803394, m = 0.0005167473834335613
[Iteration 9940] [Rank 0] a = 1.0690456628799438, b = 0.999729504541747, delta = 0.0007707785116508603, c = 0.0004590090702997193, d = 0.0004601835366144537, m = 0.0005174344902241985
[Iteration 9950] [Rank 0] a = 0.9534668326377869, b = 1.0027576516785806, delta = 0.0006645724060945213, c = 0.006515317337862076, d = 0.005920381063195304, m = 0.0005184577951727436
[Iteration 9960] [Rank 0] a = 1.0742135047912598, b = 0.9996957213664284, delta = 0.000780501461122185, c = 0.00039144271407558846, d = 0.00039223720599437936, m = 0.000518689391212543
[Iteration 9970] [Rank 0] a = 1.0296950340270996, b = 0.9997146337267637, delta = 0.0008055640500970185, c = 0.0004292674380354163, d = 0.00043002738682730324, m = 0.0005189121736071077
[Iteration 9780] [Rank 3] a = 1.0890088081359863, b = 0.9997251348365186, delta = 0.0007616504444740713, c = 0.00045026965919301934, d = 0.00045120232361942606, m = 0.0005946205340293519
[Iteration 9790] [Rank 3] a = 0.9304885864257812, b = 1.0000474394751382, delta = 0.0006943992921151221, c = 0.0010948789503476748, d = 0.0010944298896979235, m = 0.0005950337229057878
[Iteration 9800] [Rank 3] a = 1.0674325227737427, b = 0.9997454116505897, delta = 0.0007514772587455809, c = 0.0004908232901782595, d = 0.000491928670239186, m = 0.0005952442833338854
[Iteration 9810] [Rank 3] a = 1.0519205331802368, b = 0.9997606451686247, delta = 0.00074158632196486, c = 0.0005212903281075455, d = 0.0005226375100567996, m = 0.0005954732335086698
[Iteration 9820] [Rank 3] a = 0.9627819061279297, b = 0.9999217370365302, delta = 0.0007217304082587361, c = 0.0008434740727407094, d = 0.0008439231333904608, m = 0.0005962673545454656
[Iteration 9780] [Rank 1] a = 0.9460060596466064, b = 1.0002673064715508, delta = 0.0007226112647913396, c = 0.0015346129558349887, d = 0.0015261844328704243, m = 0.0006894926652402777
[Iteration 9790] [Rank 1] a = 1.0629189014434814, b = 0.9997702999720631, delta = 0.0007424290524795651, c = 0.0005405999360468548, d = 0.0005416707729808774, m = 0.0006899638064270835
[Iteration 9800] [Rank 1] a = 0.9096493721008301, b = 1.0002582734444894, delta = 0.0007078481721691787, c = 0.0015165469004642215, d = 0.001510467310129126, m = 0.0006902084884131771
[Iteration 9810] [Rank 1] a = 0.9997472763061523, b = 0.9999114604563479, delta = 0.0007311899098567665, c = 0.0008229209122328577, d = 0.0008245789823242474, m = 0.0006903264876182256
[Iteration 9820] [Rank 1] a = 1.0319396257400513, b = 0.9998172613510834, delta = 0.0007587174186483026, c = 0.0006345226980987013, d = 0.0006355935350327239, m = 0.0006904846107353249
[Iteration 9980] [Rank 0] a = 1.0194305181503296, b = 0.9997886250999941, delta = 0.0007766791968606412, c = 0.0005772501936919483, d = 0.0005783555737528748, m = 0.0005190753906934202
[Iteration 9990] [Rank 0] a = 1.076694369316101, b = 0.9996873101158278, delta = 0.0008148199995048344, c = 0.00037462021127336365, d = 0.0003755183325728664, m = 0.0005194063187908486
[Iteration 10000] [Rank 0] a = 0.8957581520080566, b = 1.0004791767101082, delta = 0.000705646350979805, c = 0.001958353493565773, d = 0.0019422909395554347, m = 0.0005200474283388219
memory_norm                    - epoch: 71.950, value:  1.251 (weight:encoder.weight)
memory_inf_norm                - epoch: 71.950, value:  0.001 (weight:encoder.weight)
memory_norm                    - epoch: 71.950, value:  0.388 (weight:rnn.weight_ih_l0)
memory_inf_norm                - epoch: 71.950, value:  0.001 (weight:rnn.weight_ih_l0)
memory_norm                    - epoch: 71.950, value:  0.362 (weight:rnn.weight_hh_l0)
[Iteration 9830] [Rank 3] a = 1.0139341354370117, b = 0.9997541510611488, delta = 0.0007625381113030016, c = 0.0005083021123916593, d = 0.0005093729493256819, m = 0.0005966626369170972
[Iteration 9840] [Rank 3] a = 0.9283391237258911, b = 1.0035513238944778, delta = 0.0006415956886485219, c = 0.0081026776484794, d = 0.007353748114074808, m = 0.000597617752901336
[Iteration 9850] [Rank 3] a = 0.9620802402496338, b = 1.0000395636422192, delta = 0.0007035152520984411, c = 0.0010791272844794726, d = 0.0010783673356875856, m = 0.0005977489884867221
[Iteration 9860] [Rank 3] a = 0.9375307559967041, b = 1.0006141193948297, delta = 0.0006760942633263767, c = 0.0022282389440663524, d = 0.002202642487030524, m = 0.000598080347270854
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9868 |     0.11079s |  93.0%
- batch.accumulate               |   9868 |     0.00082s |   0.7%
[Iteration 9830] [Rank 1] a = 1.0285518169403076, b = 0.9998236172862288, delta = 0.0007652072818018496, c = 0.0006472345687993558, d = 0.000648547207621706, m = 0.0006905977390626979
[Iteration 9840] [Rank 1] a = 1.0098148584365845, b = 0.9998579013388081, delta = 0.0007521077059209347, c = 0.0007158026757037014, d = 0.0007170116851453397, m = 0.0006907607444930086
[Iteration 9850] [Rank 1] a = 0.9959378838539124, b = 1.0000303924420373, delta = 0.0007308097556233406, c = 0.001060784884093474, d = 0.0010600940215553948, m = 0.0006909420703764096
[Iteration 9860] [Rank 1] a = 1.0929259061813354, b = 0.9996795206414915, delta = 0.0008081538253463805, c = 0.00035904126103968113, d = 0.00035990483921227994, m = 0.0006913244302341081
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9868 |     0.11068s |  92.9%
- batch.accumulate               |   9868 |     0.00083s |   0.7%
memory_inf_norm                - epoch: 71.950, value:  0.001 (weight:rnn.weight_hh_l0)
memory_norm                    - epoch: 71.950, value:  0.016 (weight:rnn.bias_ih_l0)
memory_inf_norm                - epoch: 71.950, value:  0.001 (weight:rnn.bias_ih_l0)
- batch.backward                 |   9868 |     0.05175s |  43.4%
- batch.evaluate                 |   9868 |     0.00277s |   2.3%
- batch.forward                  |   9868 |     0.02537s |  21.3%
- batch.mom                      |   9868 |     0.00126s |   1.1%
- batch.reduce                   |   9868 |     0.02604s |  21.9%
- batch.reporting.compr_err      |   9868 |     0.00001s |   0.0%
- batch.reporting.lr             |   9868 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9868 |     0.00001s |   0.0%
- batch.step                     |   9868 |     0.00047s |   0.4%
- batch.update_runavg            |   9868 |     0.00130s |   1.1%
- batch.wd                       |   9868 |     0.00001s |   0.0%
- epoch_metrics.collect          |     70 |     0.00762s |   0.0%
- reduce.combine                 |   9868 |     0.00610s |   5.1%
- reduce.flatpack                |   9868 |     0.00002s |   0.0%
- reduce.flatput                 |   9868 |     0.00019s |   0.2%
- batch.backward                 |   9868 |     0.05177s |  43.5%
- batch.evaluate                 |   9868 |     0.00275s |   2.3%
- batch.forward                  |   9868 |     0.02542s |  21.3%
- batch.mom                      |   9868 |     0.00126s |   1.1%
- batch.reduce                   |   9868 |     0.02587s |  21.7%
- batch.reporting.compr_err      |   9868 |     0.00001s |   0.0%
- batch.reporting.lr             |   9868 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9868 |     0.00001s |   0.0%
- batch.step                     |   9868 |     0.00048s |   0.4%
- batch.update_runavg            |   9868 |     0.00130s |   1.1%
- batch.wd                       |   9868 |     0.00001s |   0.0%
- epoch_metrics.collect          |     70 |     0.00776s |   0.0%
- reduce.combine                 |   9868 |     0.00619s |   5.2%
- reduce.flatpack                |   9868 |     0.00002s |   0.0%
- reduce.flatput                 |   9868 |     0.00023s |   0.2%
memory_norm                    - epoch: 71.950, value:  0.016 (weight:rnn.bias_hh_l0)
memory_inf_norm                - epoch: 71.950, value:  0.001 (weight:rnn.bias_hh_l0)
memory_norm                    - epoch: 71.950, value:  0.304 (weight:rnn.weight_ih_l1)
memory_inf_norm                - epoch: 71.950, value:  0.001 (weight:rnn.weight_ih_l1)
memory_norm                    - epoch: 71.950, value:  0.235 (weight:rnn.weight_hh_l1)
memory_inf_norm                - epoch: 71.950, value:  0.001 (weight:rnn.weight_hh_l1)
memory_norm                    - epoch: 71.950, value:  0.016 (weight:rnn.bias_ih_l1)
memory_inf_norm                - epoch: 71.950, value:  0.001 (weight:rnn.bias_ih_l1)
memory_norm                    - epoch: 71.950, value:  0.016 (weight:rnn.bias_hh_l1)
memory_inf_norm                - epoch: 71.950, value:  0.001 (weight:rnn.bias_hh_l1)
memory_norm                    - epoch: 71.950, value:  0.272 (weight:rnn.weight_ih_l2)
- reduce.gather.context          |   9868 |     0.00249s |   2.1%
- reduce.gather.tensors          |   9868 |     0.00336s |   2.8%
- reduce.heur_params             |   9868 |     0.01050s |   8.8%
- reduce.gather.context          |   9868 |     0.00129s |   1.1%
- reduce.gather.tensors          |   9868 |     0.00370s |   3.1%
- reduce.heur_params             |   9868 |     0.01091s |   9.2%
memory_inf_norm                - epoch: 71.950, value:  0.001 (weight:rnn.weight_ih_l2)
memory_norm                    - epoch: 71.950, value:  0.215 (weight:rnn.weight_hh_l2)
memory_inf_norm                - epoch: 71.950, value:  0.001 (weight:rnn.weight_hh_l2)
memory_norm                    - epoch: 71.950, value:  0.017 (weight:rnn.bias_ih_l2)
memory_inf_norm                - epoch: 71.950, value:  0.001 (weight:rnn.bias_ih_l2)
memory_norm                    - epoch: 71.950, value:  0.017 (weight:rnn.bias_hh_l2)
memory_inf_norm                - epoch: 71.950, value:  0.001 (weight:rnn.bias_hh_l2)
memory_norm                    - epoch: 71.950, value:  0.060 (weight:decoder.bias)
memory_inf_norm                - epoch: 71.950, value:  0.001 (weight:decoder.bias)
memory_norm                    - epoch: 71.950, value:  1.456 (weight:entire_model)
memory_inf_norm                - epoch: 71.950, value:  0.001 (weight:entire_model)
- reduce.heur_params.alpha       |   9867 |     0.00810s |   6.8%
- reduce.heur_params.beta        |   9867 |     0.00232s |   2.0%
- reduce.memory                  |   9868 |     0.00045s |   0.4%
- reduce.pad                     |   9868 |     0.00027s |   0.2%
- reduce.threshold               |   9868 |     0.00246s |   2.1%
- test.last                      |     70 |     0.41120s |   2.5%
- test.runavg                    |     70 |     0.44197s |   2.7%
-----------------------------------------------------------------

[Iteration 9870] [Rank 3] a = 1.0178033113479614, b = 0.999859939383255, delta = 0.0007300723227672279, c = 0.0007198787646783677, d = 0.0007211914035007179, m = 0.0005982805294763909
[Iteration 9880] [Rank 3] a = 1.0640572309494019, b = 0.9997779340027194, delta = 0.0007315950351767242, c = 0.0005558679981384018, d = 0.0005568697488186165, m = 0.0005986453031520601
- reduce.heur_params.alpha       |   9867 |     0.00834s |   7.0%
- reduce.heur_params.beta        |   9867 |     0.00249s |   2.1%
- reduce.memory                  |   9868 |     0.00047s |   0.4%
- reduce.pad                     |   9868 |     0.00021s |   0.2%
- reduce.threshold               |   9868 |     0.00265s |   2.2%
- test.last                      |     70 |     0.41120s |   2.5%
- test.runavg                    |     70 |     0.44197s |   2.7%
-----------------------------------------------------------------

[Iteration 9870] [Rank 1] a = 0.9023324847221375, b = 1.000031014218321, delta = 0.0007567130378447473, c = 0.001062028436662016, d = 0.0010618902641544004, m = 0.0006921374387714692
[Iteration 9880] [Rank 1] a = 1.0859280824661255, b = 0.9997272074239775, delta = 0.0007615275681018829, c = 0.00045441483442149364, d = 0.0004554511282286122, m = 0.0006924406601116215
timer                          - epoch: 71.978, value:  0.001 (event:batch.accumulate)
cross_entropy                  - bits:24526545856.000, epoch: 72.000, ratio_transmit_grad:  0.174, value:  5.360 (split:train)
last_cross_entropy             - bits:24526545856.000, epoch: 72.000, ratio_transmit_grad:  0.174, value:  5.360 (split:train)
perplexity                     - bits:24526545856.000, epoch: 72.000, ratio_transmit_grad:  0.174, value:213.326 (split:train)
last_perplexity                - bits:24526545856.000, epoch: 72.000, ratio_transmit_grad:  0.174, value:213.326 (split:train)
last_cross_entropy             - bits:24526545856.000, epoch: 72.000, ratio_transmit_grad:  0.174, value:  5.149 (split:test)
last_perplexity                - bits:24526545856.000, epoch: 72.000, ratio_transmit_grad:  0.174, value:172.891 (split:test)
runavg_cross_entropy           - bits:24526545856.000, epoch: 72.000, ratio_transmit_grad:  0.174, value:  5.347 (split:test)
[Iteration 9890] [Rank 3] a = 0.9918359518051147, b = 0.9998208538361639, delta = 0.0007239345577545464, c = 0.0006417076684947235, d = 0.0006426748760480341, m = 0.0005993357440255032
[Iteration 9900] [Rank 3] a = 1.0230695009231567, b = 0.9997908876747064, delta = 0.0007389172096736729, c = 0.0005817753433163661, d = 0.0005829152665041966, m = 0.0005994655027595602
[Iteration 9910] [Rank 3] a = 1.1719826459884644, b = 0.9996476027958479, delta = 0.000784363248385489, c = 0.0002952055625211771, d = 0.0002955855369171206, m = 0.0005999029531381711
[Iteration 9920] [Rank 3] a = 1.0969479084014893, b = 0.9997067924376128, delta = 0.0007749265059828758, c = 0.0004135848584210219, d = 0.00041431026408600495, m = 0.0006000941683055017
[Iteration 9930] [Rank 3] a = 1.0829964876174927, b = 0.9997221295847076, delta = 0.0007590711466036737, c = 0.00044425915511173164, d = 0.00044529544891885024, m = 0.000600309388316504
[Iteration 9890] [Rank 1] a = 1.0644477605819702, b = 0.9997732361376972, delta = 0.0007482606451958418, c = 0.0005464722676205268, d = 0.00054702495765099, m = 0.0006927428282861896
[Iteration 9900] [Rank 1] a = 1.0906864404678345, b = 0.9996572057839668, delta = 0.0008166372426785529, c = 0.00031441154107977464, d = 0.0003150333173640458, m = 0.0006934298519311637
[Iteration 9910] [Rank 1] a = 0.9874637722969055, b = 0.9999887507025644, delta = 0.0007212344207800925, c = 0.0009775014051280446, d = 0.0009776395776356604, m = 0.0006936408078636512
[Iteration 9920] [Rank 1] a = 0.9542649984359741, b = 0.9998774872914192, delta = 0.0007555601769126952, c = 0.0007549745816127834, d = 0.0007555272716432466, m = 0.0006937983278294255
[Iteration 9930] [Rank 1] a = 0.9275080561637878, b = 1.0001342808954032, delta = 0.0007084163371473551, c = 0.0012685617924207474, d = 0.0012668691792024538, m = 0.0006943380580441121
runavg_perplexity              - bits:24526545856.000, epoch: 72.000, ratio_transmit_grad:  0.174, value:210.632 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10007 |     0.11072s |  92.9%
- batch.accumulate               |  10007 |     0.00082s |   0.7%
- batch.backward                 |  10007 |     0.05164s |  43.3%
- batch.evaluate                 |  10007 |     0.00275s |   2.3%
- batch.forward                  |  10007 |     0.02541s |  21.3%
- batch.mom                      |  10007 |     0.00126s |   1.1%
- batch.reduce                   |  10007 |     0.02602s |  21.8%
- batch.reporting.compr_err      |  10007 |     0.00001s |   0.0%
- batch.reporting.lr             |  10007 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10007 |     0.00001s |   0.0%
- batch.step                     |  10007 |     0.00048s |   0.4%

[Iteration 9730] [Rank 2] a = 1.0350421667099, b = 0.9999351570412636, delta = 0.0007361651514656842, c = 0.0008703140823450804, d = 0.0008709013155024476, m = 0.0005557918619770784
[Iteration 9740] [Rank 2] a = 0.9499921798706055, b = 1.000037784671186, delta = 0.0007347307400777936, c = 0.0010755693424083655, d = 0.0010749821092509984, m = 0.0005560556076373086
[Iteration 9750] [Rank 2] a = 0.9524985551834106, b = 0.9998602502713911, delta = 0.0007530602160841227, c = 0.0007205005409626388, d = 0.00072112231724691, m = 0.0005565379668848202
[Iteration 9760] [Rank 2] a = 1.0123682022094727, b = 0.9997781758045959, delta = 0.0007822131155990064, c = 0.0005563516019150571, d = 0.0005572497232145599, m = 0.0005567012161546935
[Iteration 9770] [Rank 2] a = 0.9310386180877686, b = 1.000546259444896, delta = 0.0006932106916792691, c = 0.0020925189984607236, d = 0.0020725876142371432, m = 0.0005576343252794332
[Iteration 9940] [Rank 3] a = 1.1035420894622803, b = 0.9997879515090494, delta = 0.0007136468193493783, c = 0.0005759030117426942, d = 0.0005766975036614851, m = 0.0006013011819870878
[Iteration 9950] [Rank 3] a = 1.1090974807739258, b = 0.9996756690832422, delta = 0.0007932647713460028, c = 0.0003513381437400997, d = 0.0003521326356588906, m = 0.0006014304311232243
[Iteration 9960] [Rank 3] a = 0.9490782022476196, b = 1.0003372562971111, delta = 0.000693898182362318, c = 0.001674512619795996, d = 0.0016640115092171944, m = 0.0006017752277292572
[Iteration 9970] [Rank 3] a = 1.0005205869674683, b = 0.9999202689536458, delta = 0.0007201184052973986, c = 0.0008405379069538735, d = 0.0008414705713802801, m = 0.0006019612748062573
[Iteration 9980] [Rank 3] a = 0.92588210105896, b = 1.0000700824947446, delta = 0.0007016253657639027, c = 0.0011401649897187563, d = 0.0011394050409268696, m = 0.0006025153571877619
[Iteration 9940] [Rank 1] a = 1.0022186040878296, b = 0.9997774676705293, delta = 0.0007929595885798335, c = 0.0005549353337119951, d = 0.0005556607393769781, m = 0.0006943585971859633
[Iteration 9950] [Rank 1] a = 0.9462805390357971, b = 0.9999350015971928, delta = 0.000746541132684797, c = 0.0008700031942029448, d = 0.0008707631429948318, m = 0.000694649531872156
[Iteration 9960] [Rank 1] a = 1.0456918478012085, b = 0.9997758096005207, delta = 0.000760186929255724, c = 0.0005516191935292157, d = 0.0005528627460977579, m = 0.0006948071925538865
[Iteration 9970] [Rank 1] a = 1.0603517293930054, b = 0.999721887782838, delta = 0.0007915262831375003, c = 0.0004437755513350763, d = 0.0004445009570000593, m = 0.0006950856440707061
[Iteration 9980] [Rank 1] a = 1.0632177591323853, b = 0.9997644103692449, delta = 0.0007497270125895739, c = 0.0005288207297726071, d = 0.000529649764818302, m = 0.0006953380827903394
- batch.update_runavg            |  10007 |     0.00130s |   1.1%
- batch.wd                       |  10007 |     0.00001s |   0.0%
- epoch_metrics.collect          |     71 |     0.00832s |   0.1%
[Iteration 9990] [Rank 3] a = 0.9347494840621948, b = 1.000209204935413, delta = 0.0006979908794164658, c = 0.0014184098769300928, d = 0.0014142992448285226, m = 0.0006027755799123785
[Iteration 10000] [Rank 3] a = 1.1397429704666138, b = 0.9996380688940388, delta = 0.0008126377942971885, c = 0.0002761377564701954, d = 0.00027675953275446653, m = 0.0006029274632005461
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10007 |     0.11081s |  93.0%
- batch.accumulate               |  10007 |     0.00082s |   0.7%
- batch.backward                 |  10007 |     0.05175s |  43.4%
- batch.evaluate                 |  10007 |     0.00277s |   2.3%
- batch.forward                  |  10007 |     0.02537s |  21.3%
- batch.mom                      |  10007 |     0.00126s |   1.1%
- batch.reduce                   |  10007 |     0.02606s |  21.9%
[Iteration 9990] [Rank 1] a = 1.0221359729766846, b = 0.9997748423930161, delta = 0.0007621417171321809, c = 0.0005496847784225943, d = 0.0005505483565951931, m = 0.0006955264099415567
[Iteration 10000] [Rank 1] a = 0.9872452020645142, b = 0.9998753110744576, delta = 0.0007668412872590125, c = 0.0007506221476228853, d = 0.0007517275276838118, m = 0.0006955740050611879
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10007 |     0.11070s |  92.9%
- batch.accumulate               |  10007 |     0.00083s |   0.7%
- batch.backward                 |  10007 |     0.05178s |  43.4%
- batch.evaluate                 |  10007 |     0.00275s |   2.3%
- batch.forward                  |  10007 |     0.02542s |  21.3%
- batch.mom                      |  10007 |     0.00126s |   1.1%
- batch.reduce                   |  10007 |     0.02589s |  21.7%
- reduce.combine                 |  10007 |     0.00638s |   5.4%
- reduce.flatpack                |  10007 |     0.00002s |   0.0%
- reduce.flatput                 |  10007 |     0.00020s |   0.2%
- reduce.gather.context          |  10007 |     0.00115s |   1.0%
- reduce.gather.tensors          |  10007 |     0.00381s |   3.2%
- reduce.heur_params             |  10007 |     0.01108s |   9.3%
- reduce.heur_params.alpha       |  10006 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  10006 |     0.00229s |   1.9%
- reduce.memory                  |  10007 |     0.00046s |   0.4%
- reduce.pad                     |  10007 |     0.00028s |   0.2%
- reduce.threshold               |  10007 |     0.00242s |   2.0%
- test.last                      |     71 |     0.41118s |   2.5%
- test.runavg                    |     71 |     0.44188s |   2.7%
-----------------------------------------------------------------
- batch.reporting.compr_err      |  10007 |     0.00001s |   0.0%
- batch.reporting.lr             |  10007 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10007 |     0.00001s |   0.0%
- batch.step                     |  10007 |     0.00047s |   0.4%
- batch.update_runavg            |  10007 |     0.00129s |   1.1%
- batch.reporting.compr_err      |  10007 |     0.00001s |   0.0%
- batch.reporting.lr             |  10007 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10007 |     0.00001s |   0.0%
- batch.step                     |  10007 |     0.00048s |   0.4%
- batch.update_runavg            |  10007 |     0.00130s |   1.1%
- batch.wd                       |  10007 |     0.00001s |   0.0%
- epoch_metrics.collect          |     71 |     0.00753s |   0.0%
- reduce.combine                 |  10007 |     0.00610s |   5.1%
- reduce.flatpack                |  10007 |     0.00002s |   0.0%
- reduce.flatput                 |  10007 |     0.00020s |   0.2%
- reduce.gather.context          |  10007 |     0.00249s |   2.1%
- reduce.gather.tensors          |  10007 |     0.00337s |   2.8%
- reduce.heur_params             |  10007 |     0.01050s |   8.8%
- reduce.heur_params.alpha       |  10006 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  10006 |     0.00233s |   2.0%
- reduce.memory                  |  10007 |     0.00045s |   0.4%
- reduce.pad                     |  10007 |     0.00027s |   0.2%
- reduce.threshold               |  10007 |     0.00246s |   2.1%
- test.last                      |     71 |     0.41119s |   2.5%
- test.runavg                    |     71 |     0.44187s |   2.7%
- batch.wd                       |  10007 |     0.00001s |   0.0%
- epoch_metrics.collect          |     71 |     0.00766s |   0.0%
- reduce.combine                 |  10007 |     0.00620s |   5.2%
- reduce.flatpack                |  10007 |     0.00002s |   0.0%
- reduce.flatput                 |  10007 |     0.00023s |   0.2%
- reduce.gather.context          |  10007 |     0.00128s |   1.1%
- reduce.gather.tensors          |  10007 |     0.00371s |   3.1%
- reduce.heur_params             |  10007 |     0.01091s |   9.2%
- reduce.heur_params.alpha       |  10006 |     0.00834s |   7.0%
- reduce.heur_params.beta        |  10006 |     0.00250s |   2.1%
- reduce.memory                  |  10007 |     0.00047s |   0.4%
- reduce.pad                     |  10007 |     0.00021s |   0.2%
- reduce.threshold               |  10007 |     0.00265s |   2.2%
- test.last                      |     71 |     0.41119s |   2.5%
- test.runavg                    |     71 |     0.44187s |   2.7%
[Iteration 9780] [Rank 2] a = 0.9884799718856812, b = 0.9997709735630025, delta = 0.0007972675957717001, c = 0.000541947117996109, d = 0.0005431215843108433, m = 0.0005577137510222517
[Iteration 9790] [Rank 2] a = 0.9758901000022888, b = 1.0001900680438713, delta = 0.0007169308373704553, c = 0.0013801360923205136, d = 0.0013748509939042089, m = 0.0005581883747399711
[Iteration 9800] [Rank 2] a = 0.9789860248565674, b = 1.0003555986952954, delta = 0.0007116653141565621, c = 0.0017111974205679934, d = 0.0016950312371769435, m = 0.0005585203047842474
[Iteration 9810] [Rank 2] a = 1.090174674987793, b = 0.9997578471755076, delta = 0.000723945559002459, c = 0.0005156943415491052, d = 0.0005167997216100317, m = 0.0005597178755790297
[Iteration 9820] [Rank 2] a = 1.0220547914505005, b = 0.9998352065049676, delta = 0.0007325529004447162, c = 0.0006704130069519079, d = 0.0006715874732666423, m = 0.0005598860275065308
-----------------------------------------------------------------
-----------------------------------------------------------------
[Iteration 9830] [Rank 2] a = 1.0530308485031128, b = 0.9997500058861751, delta = 0.0007823256310075521, c = 0.0005000117619347108, d = 0.0005009789694880215, m = 0.0005600490868344874
[Iteration 9840] [Rank 2] a = 1.0317972898483276, b = 0.9997027681636792, delta = 0.0008147293119691312, c = 0.000405536309852401, d = 0.00040636534489809587, m = 0.0005603866435036838
[Iteration 9850] [Rank 2] a = 0.9382429718971252, b = 1.000181535891821, delta = 0.0007090001599863172, c = 0.0013630717876299612, d = 0.0013605846824928766, m = 0.0005609655236235981
[Iteration 9860] [Rank 2] a = 0.9930490255355835, b = 1.0000936236355709, delta = 0.0007209470495581627, c = 0.0011872472716888435, d = 0.00118406930401368, m = 0.0005612297773221667
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |   9868 |     0.11075s |  92.9%
- batch.accumulate               |   9868 |     0.00082s |   0.7%
- batch.backward                 |   9868 |     0.05178s |  43.5%
- batch.evaluate                 |   9868 |     0.00274s |   2.3%
- batch.forward                  |   9868 |     0.02548s |  21.4%
- batch.mom                      |   9868 |     0.00126s |   1.1%
- batch.reduce                   |   9868 |     0.02589s |  21.7%
- batch.reporting.compr_err      |   9868 |     0.00001s |   0.0%
- batch.reporting.lr             |   9868 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |   9868 |     0.00001s |   0.0%
- batch.step                     |   9868 |     0.00048s |   0.4%
- batch.update_runavg            |   9868 |     0.00130s |   1.1%
- batch.wd                       |   9868 |     0.00001s |   0.0%
- epoch_metrics.collect          |     70 |     0.01270s |   0.1%
- reduce.combine                 |   9868 |     0.00611s |   5.1%
- reduce.flatpack                |   9868 |     0.00002s |   0.0%
- reduce.flatput                 |   9868 |     0.00019s |   0.2%
- reduce.gather.context          |   9868 |     0.00195s |   1.6%
- reduce.gather.tensors          |   9868 |     0.00371s |   3.1%
- reduce.heur_params             |   9868 |     0.01057s |   8.9%
- reduce.heur_params.alpha       |   9867 |     0.00820s |   6.9%
- reduce.heur_params.beta        |   9867 |     0.00229s |   1.9%
- reduce.memory                  |   9868 |     0.00045s |   0.4%
- reduce.pad                     |   9868 |     0.00027s |   0.2%
- reduce.threshold               |   9868 |     0.00241s |   2.0%
- test.last                      |     70 |     0.41119s |   2.5%
- test.runavg                    |     70 |     0.44197s |   2.7%
-----------------------------------------------------------------

[Iteration 9870] [Rank 2] a = 1.1306771039962769, b = 0.9996668778583953, delta = 0.0008004992268979549, c = 0.00033375569214598796, d = 0.0003345156409378749, m = 0.0005616179187527888
[Iteration 9880] [Rank 2] a = 0.9415850043296814, b = 1.0002239375783462, delta = 0.000702292425557971, c = 0.0014478751641791643, d = 0.0014436263595699781, m = 0.000562358980649168
[Iteration 9890] [Rank 2] a = 0.8442503213882446, b = 1.0002016745340658, delta = 0.0007186001166701317, c = 0.0014033490735999696, d = 0.001398098518310569, m = 0.0005625396620690291
[Iteration 9900] [Rank 2] a = 1.062534213066101, b = 0.9997637713214329, delta = 0.0007496196776628494, c = 0.0005275426340771609, d = 0.0005284752985035676, m = 0.000562851407068852
[Iteration 9910] [Rank 2] a = 0.9556408524513245, b = 1.0003482410101763, delta = 0.0007119711372070014, c = 0.0016964820485069097, d = 0.0016864990848316675, m = 0.0005632095575371011
[Iteration 9920] [Rank 2] a = 1.0287737846374512, b = 0.9998031850273773, delta = 0.0007532536401413381, c = 0.0006063700496719802, d = 0.000607268170971483, m = 0.0005636661899892613
[Iteration 9930] [Rank 2] a = 0.9727092981338501, b = 1.0001244015612742, delta = 0.0007295086979866028, c = 0.0012488031238316866, d = 0.0012465232774560259, m = 0.000563909318772503
[Iteration 9940] [Rank 2] a = 1.039212703704834, b = 0.9997185198282286, delta = 0.0008010788005776703, c = 0.0004370396415888056, d = 0.00043824865103044393, m = 0.0005641133671269084
[Iteration 9950] [Rank 2] a = 0.9640135765075684, b = 0.9999101823606624, delta = 0.000755967921577394, c = 0.0008203647208419652, d = 0.0008210210402531404, m = 0.0005645425927175608
[Iteration 9960] [Rank 2] a = 1.0255228281021118, b = 0.9998170886354547, delta = 0.0007366176578216255, c = 0.0006341772668296619, d = 0.0006354208193982042, m = 0.0005654540574362172
[Iteration 9970] [Rank 2] a = 1.1185976266860962, b = 0.9996665842418493, delta = 0.0008045370341278613, c = 0.00033316845898862077, d = 0.0003339974940343156, m = 0.000565768471953578
[Iteration 9980] [Rank 2] a = 0.9234321713447571, b = 0.9999245868444829, delta = 0.0007602616678923368, c = 0.0008491736886798616, d = 0.0008498300080910366, m = 0.0005659209894290901
[Iteration 9990] [Rank 2] a = 0.9579066038131714, b = 1.000009321134635, delta = 0.0007324767648242414, c = 0.001018642269270652, d = 0.001018573183016844, m = 0.0005662987605034986
[Iteration 10000] [Rank 2] a = 1.0245789289474487, b = 0.9998831869072768, delta = 0.0007087546982802451, c = 0.0007663738134910876, d = 0.0007673064779174944, m = 0.0005667845277255131
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10007 |     0.11077s |  92.9%
- batch.accumulate               |  10007 |     0.00082s |   0.7%
- batch.backward                 |  10007 |     0.05178s |  43.4%
- batch.evaluate                 |  10007 |     0.00274s |   2.3%
- batch.forward                  |  10007 |     0.02548s |  21.4%
- batch.mom                      |  10007 |     0.00126s |   1.1%
- batch.reduce                   |  10007 |     0.02592s |  21.8%
- batch.reporting.compr_err      |  10007 |     0.00001s |   0.0%
- batch.reporting.lr             |  10007 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10007 |     0.00001s |   0.0%
- batch.step                     |  10007 |     0.00048s |   0.4%
- batch.update_runavg            |  10007 |     0.00130s |   1.1%
- batch.wd                       |  10007 |     0.00001s |   0.0%
- epoch_metrics.collect          |     71 |     0.01257s |   0.1%
- reduce.combine                 |  10007 |     0.00611s |   5.1%
- reduce.flatpack                |  10007 |     0.00002s |   0.0%
- reduce.flatput                 |  10007 |     0.00019s |   0.2%
- reduce.gather.context          |  10007 |     0.00196s |   1.6%
- reduce.gather.tensors          |  10007 |     0.00372s |   3.1%
- reduce.heur_params             |  10007 |     0.01057s |   8.9%
- reduce.heur_params.alpha       |  10006 |     0.00820s |   6.9%
- reduce.heur_params.beta        |  10006 |     0.00229s |   1.9%
- reduce.memory                  |  10007 |     0.00045s |   0.4%
- reduce.pad                     |  10007 |     0.00027s |   0.2%
- reduce.threshold               |  10007 |     0.00241s |   2.0%
- test.last                      |     71 |     0.41119s |   2.5%
- test.runavg                    |     71 |     0.44187s |   2.7%
-----------------------------------------------------------------

[Iteration 10010] [Rank 0] a = 0.9748650193214417, b = 0.9999110804819549, delta = 0.0007467211689800024, c = 0.0008221609634409707, d = 0.0008233354297557051, m = 0.0005202975901780526
[Iteration 10020] [Rank 0] a = 1.0013110637664795, b = 0.9997744796902021, delta = 0.0008059635292738676, c = 0.0005489593727576114, d = 0.000549926580310922, m = 0.0005203998007117022
[Iteration 10030] [Rank 0] a = 0.8719264268875122, b = 1.0015589763592527, delta = 0.0007090838626027107, c = 0.004117955244473972, d = 0.00400955891224937, m = 0.000520981888391612
[Iteration 10040] [Rank 0] a = 0.9588986039161682, b = 0.9999014429496332, delta = 0.0007442782516591251, c = 0.0008028858986285654, d = 0.0008032658730245088, m = 0.0005215357250130645
[Iteration 10050] [Rank 0] a = 0.9990330934524536, b = 0.999815741453551, delta = 0.0007755595142953098, c = 0.0006314829029311536, d = 0.0006325537398651761, m = 0.0005217544178184803
[Iteration 10060] [Rank 0] a = 0.9738234281539917, b = 0.9999189563148321, delta = 0.0007640160038135946, c = 0.000837912629309173, d = 0.0008387416643548679, m = 0.0005221114835710673
[Iteration 10070] [Rank 0] a = 0.9367539286613464, b = 0.9999354679294041, delta = 0.0007809522794559598, c = 0.0008709358586293515, d = 0.0008714194624060068, m = 0.0005223525386922322
[Iteration 10080] [Rank 0] a = 1.0184638500213623, b = 0.999810059109374, delta = 0.0007705484167672694, c = 0.0006201182141797533, d = 0.0006214308530021035, m = 0.0005226871608760476
[Iteration 10090] [Rank 0] a = 0.9258070588111877, b = 1.000112743256108, delta = 0.0007629320025444031, c = 0.0012254865131715188, d = 0.0012242084174760727, m = 0.0005229306764896914
[Iteration 10100] [Rank 0] a = 1.0190812349319458, b = 0.999888230203739, delta = 0.0007314418908208609, c = 0.0007764604065470418, d = 0.0007772894415927366, m = 0.0005234478560431414
[Iteration 10110] [Rank 0] a = 0.8455082178115845, b = 1.0056594799773126, delta = 0.0006642623338848352, c = 0.012319080804629635, d = 0.010972106114136916, m = 0.0005250092060978564
[Iteration 10120] [Rank 0] a = 1.1163601875305176, b = 0.9996744600739282, delta = 0.0007950188009999692, c = 0.0003489201248568231, d = 0.0003499909617908456, m = 0.0005252465349230876
[Iteration 10130] [Rank 0] a = 1.1331195831298828, b = 0.9996802805902057, delta = 0.0007901198114268482, c = 0.000360561158623455, d = 0.00036177016806509334, m = 0.0005256111410374393
rel_compression_error          - epoch: 72.914, value:  0.993 (weight:encoder.weight)
rel_compression_error          - epoch: 72.914, value:  0.969 (weight:rnn.weight_ih_l0)
rel_compression_error          - epoch: 72.914, value:  0.981 (weight:rnn.weight_hh_l0)
rel_compression_error          - epoch: 72.914, value:  0.850 (weight:rnn.bias_ih_l0)
rel_compression_error          - epoch: 72.914, value:  0.850 (weight:rnn.bias_hh_l0)
rel_compression_error          - epoch: 72.914, value:  0.979 (weight:rnn.weight_ih_l1)
rel_compression_error          - epoch: 72.914, value:  0.992 (weight:rnn.weight_hh_l1)
rel_compression_error          - epoch: 72.914, value:  0.903 (weight:rnn.bias_ih_l1)
rel_compression_error          - epoch: 72.914, value:  0.903 (weight:rnn.bias_hh_l1)
rel_compression_error          - epoch: 72.914, value:  0.970 (weight:rnn.weight_ih_l2)
rel_compression_error          - epoch: 72.914, value:  0.976 (weight:rnn.weight_hh_l2)
rel_compression_error          - epoch: 72.914, value:  0.737 (weight:rnn.bias_ih_l2)
rel_compression_error          - epoch: 72.914, value:  0.737 (weight:rnn.bias_hh_l2)
rel_compression_error          - epoch: 72.914, value:  0.885 (weight:decoder.bias)
rel_compression_error          - epoch: 72.914, value:  0.988 (weight:entire_model)
[Iteration 10140] [Rank 0] a = 0.9548730850219727, b = 1.0002891549976256, delta = 0.0007041175849735737, c = 0.0015783100113684885, d = 0.0015711941272262744, m = 0.0005260335548516408
cross_entropy                  - bits:24993645312.000, epoch: 73.000, ratio_transmit_grad:  0.181, value:  5.357 (split:train)
last_cross_entropy             - bits:24993645312.000, epoch: 73.000, ratio_transmit_grad:  0.181, value:  5.357 (split:train)
perplexity                     - bits:24993645312.000, epoch: 73.000, ratio_transmit_grad:  0.181, value:212.614 (split:train)
last_perplexity                - bits:24993645312.000, epoch: 73.000, ratio_transmit_grad:  0.181, value:212.614 (split:train)
last_cross_entropy             - bits:24993645312.000, epoch: 73.000, ratio_transmit_grad:  0.181, value:  5.149 (split:test)
last_perplexity                - bits:24993645312.000, epoch: 73.000, ratio_transmit_grad:  0.181, value:172.768 (split:test)
runavg_cross_entropy           - bits:24993645312.000, epoch: 73.000, ratio_transmit_grad:  0.181, value:  5.348 (split:test)
runavg_perplexity              - bits:24993645312.000, epoch: 73.000, ratio_transmit_grad:  0.181, value:210.858 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10146 |     0.11074s |  92.9%
- batch.accumulate               |  10146 |     0.00082s |   0.7%
- batch.backward                 |  10146 |     0.05164s |  43.3%
- batch.evaluate                 |  10146 |     0.00275s |   2.3%
- batch.forward                  |  10146 |     0.02541s |  21.3%
- batch.mom                      |  10146 |     0.00126s |   1.1%
- batch.reduce                   |  10146 |     0.02604s |  21.8%
- batch.reporting.compr_err      |  10146 |     0.00001s |   0.0%
- batch.reporting.lr             |  10146 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10146 |     0.00001s |   0.0%
- batch.step                     |  10146 |     0.00048s |   0.4%
- batch.update_runavg            |  10146 |     0.00130s |   1.1%
- batch.wd                       |  10146 |     0.00001s |   0.0%
- epoch_metrics.collect          |     72 |     0.00823s |   0.1%
- reduce.combine                 |  10146 |     0.00638s |   5.4%
- reduce.flatpack                |  10146 |     0.00002s |   0.0%
- reduce.flatput                 |  10146 |     0.00020s |   0.2%
- reduce.gather.context          |  10146 |     0.00115s |   1.0%
- reduce.gather.tensors          |  10146 |     0.00383s |   3.2%
- reduce.heur_params             |  10146 |     0.01109s |   9.3%
- reduce.heur_params.alpha       |  10145 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  10145 |     0.00230s |   1.9%
- reduce.memory                  |  10146 |     0.00046s |   0.4%
- reduce.pad                     |  10146 |     0.00028s |   0.2%
- reduce.threshold               |  10146 |     0.00242s |   2.0%
- test.last                      |     72 |     0.41110s |   2.5%
- test.runavg                    |     72 |     0.44193s |   2.7%
-----------------------------------------------------------------

[Iteration 10150] [Rank 0] a = 1.0061453580856323, b = 0.9998459148740356, delta = 0.0007679691188968718, c = 0.0006918297456323584, d = 0.0006930387550739967, m = 0.0005262906524547976
[Iteration 10160] [Rank 0] a = 1.0031871795654297, b = 0.9998318730933139, delta = 0.0007663484429940581, c = 0.0006637461834594451, d = 0.0006650242791548913, m = 0.0005264835766859711
[Iteration 10170] [Rank 0] a = 0.9259416460990906, b = 1.0020927176925891, delta = 0.0006844185409136117, c = 0.005185441495186812, d = 0.004938941741600208, m = 0.0005272771230580778
[Iteration 10180] [Rank 0] a = 1.1060268878936768, b = 0.9996963085995314, delta = 0.0007871172856539488, c = 0.00039261718039032285, d = 0.00039310078416697816, m = 0.0005286116083084362
[Iteration 10190] [Rank 0] a = 1.0243840217590332, b = 0.9998006288360867, delta = 0.0007475450402125716, c = 0.0006012576668901952, d = 0.0006026739350932572, m = 0.0005288519307816496
[Iteration 10200] [Rank 0] a = 1.1067537069320679, b = 0.9997437363090439, delta = 0.0007629864267073572, c = 0.0004874726068685761, d = 0.0004883707281680788, m = 0.0005292399101604428
[Iteration 10210] [Rank 0] a = 0.936194658279419, b = 1.0002013636459361, delta = 0.0007219841354526579, c = 0.0014027272973156984, d = 0.001399480243386727, m = 0.0005294830031455245

[Iteration 10010] [Rank 3] a = 1.0644891262054443, b = 0.9997536156427144, delta = 0.0007474666927009821, c = 0.0005072312754576369, d = 0.0005080948536302357, m = 0.0006032777721390126
[Iteration 10020] [Rank 3] a = 1.0268012285232544, b = 0.9998073302024486, delta = 0.0007492986624129117, c = 0.0006146604001289287, d = 0.0006158348664436631, m = 0.0006034267725718212
[Iteration 10030] [Rank 3] a = 1.0248380899429321, b = 0.9997892641478132, delta = 0.0007526522385887802, c = 0.0005785282893873946, d = 0.0005794954969407052, m = 0.0006036802761421444
[Iteration 10040] [Rank 3] a = 1.0223129987716675, b = 0.9997942901725599, delta = 0.0007549828151240945, c = 0.0005885803393164447, d = 0.0005895130037428515, m = 0.0006041208486677415
[Iteration 10050] [Rank 3] a = 0.9785001873970032, b = 0.9999685775164624, delta = 0.0007322953315451741, c = 0.0009371550329042282, d = 0.0009376731798077876, m = 0.0006046550732931279

[Iteration 10010] [Rank 1] a = 0.8712292313575745, b = 1.0006422202174756, delta = 0.0007400831091217697, c = 0.0022844406115390833, d = 0.002262989329731729, m = 0.0006957162217901608
[Iteration 10020] [Rank 1] a = 1.0669174194335938, b = 0.99974615432777, delta = 0.0007730312645435333, c = 0.0004923086446351295, d = 0.0004931722228077283, m = 0.0006960621662996052
[Iteration 10030] [Rank 1] a = 1.0439131259918213, b = 0.9997706972180018, delta = 0.0007734693353995681, c = 0.0005413944279656457, d = 0.0005420162042499169, m = 0.0006962174528002924
[Iteration 10040] [Rank 1] a = 0.9953632950782776, b = 0.9998561914540613, delta = 0.0007495453464798629, c = 0.0007123829061402101, d = 0.0007134882862011365, m = 0.0006964456135374712
[Iteration 10050] [Rank 1] a = 1.0392056703567505, b = 0.9998115962784663, delta = 0.0007549144211225212, c = 0.000623192552474205, d = 0.000623917958139188, m = 0.0006966170119817501
[Iteration 10060] [Rank 3] a = 0.9377765655517578, b = 1.0000420680189155, delta = 0.0007068563136272132, c = 0.0010841360378805456, d = 0.0010836869772307943, m = 0.0006050025044103635
[Iteration 10070] [Rank 3] a = 0.996036171913147, b = 0.999818332187982, delta = 0.0007276895921677351, c = 0.0006366643719667465, d = 0.0006375970363931532, m = 0.0006055347549493306
[Iteration 10080] [Rank 3] a = 0.9874417781829834, b = 0.9998632382518111, delta = 0.000719326373655349, c = 0.0007264765019170227, d = 0.0007276509682317571, m = 0.0006059524448207575
[Iteration 10090] [Rank 3] a = 1.0594059228897095, b = 0.9997351868857157, delta = 0.000771637714933604, c = 0.00047037375905111965, d = 0.000471582768492758, m = 0.0006060235503764217
[Iteration 10100] [Rank 3] a = 1.022022008895874, b = 0.9997305062923543, delta = 0.0007896194001659751, c = 0.00046101257166014854, d = 0.0004617034341982276, m = 0.0006062799796911462
[Iteration 10110] [Rank 3] a = 1.066565752029419, b = 0.9997007819340592, delta = 0.0007909900741651654, c = 0.0004015638502584465, d = 0.0004022892559234295, m = 0.000606385771902225
[Iteration 10120] [Rank 3] a = 0.9730311036109924, b = 0.9998853113095529, delta = 0.0007502184016630054, c = 0.0007706226181002738, d = 0.0007715552825266805, m = 0.000606655951129789
[Iteration 10130] [Rank 3] a = 0.9475098252296448, b = 1.0012899377628854, delta = 0.000691831752192229, c = 0.0035798769566911057, d = 0.003466886388588277, m = 0.0006071461738260252
[Iteration 10140] [Rank 3] a = 0.9340313673019409, b = 1.0004775186403962, delta = 0.0006926130736246705, c = 0.001955037353382993, d = 0.0019367985823777064, m = 0.0006074747825389296
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10146 |     0.11084s |  93.0%
- batch.accumulate               |  10146 |     0.00082s |   0.7%
[Iteration 10060] [Rank 1] a = 1.0076327323913574, b = 0.9998821333419209, delta = 0.0007574778865091503, c = 0.0007642666827499465, d = 0.0007655447784453928, m = 0.0006966907268257041
[Iteration 10070] [Rank 1] a = 0.9613021016120911, b = 1.0000050032437724, delta = 0.0007787485374137759, c = 0.0010100064875446639, d = 0.0010099374012908558, m = 0.0006966872137888328
[Iteration 10080] [Rank 1] a = 1.0215569734573364, b = 0.9998631173508693, delta = 0.0007542309467680752, c = 0.0007262347000286949, d = 0.0007275127957241412, m = 0.000697100894532779
[Iteration 10090] [Rank 1] a = 1.0676441192626953, b = 0.9996907298850605, delta = 0.0008229129016399384, c = 0.0003814597504003462, d = 0.0003822542423191371, m = 0.0006976875903847977
[Iteration 10100] [Rank 1] a = 0.9503421783447266, b = 1.0003741310804117, delta = 0.000718635565135628, c = 0.0017482621957359342, d = 0.0017325796161215398, m = 0.000697992299660028
- batch.backward                 |  10146 |     0.05175s |  43.4%
- batch.evaluate                 |  10146 |     0.00277s |   2.3%
- batch.forward                  |  10146 |     0.02537s |  21.3%
- batch.mom                      |  10146 |     0.00126s |   1.1%
- batch.reduce                   |  10146 |     0.02609s |  21.9%
- batch.reporting.compr_err      |  10146 |     0.00001s |   0.0%
- batch.reporting.lr             |  10146 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10146 |     0.00001s |   0.0%
- batch.step                     |  10146 |     0.00047s |   0.4%
- batch.update_runavg            |  10146 |     0.00129s |   1.1%
- batch.wd                       |  10146 |     0.00001s |   0.0%
- epoch_metrics.collect          |     72 |     0.00743s |   0.0%
- reduce.combine                 |  10146 |     0.00611s |   5.1%
- reduce.flatpack                |  10146 |     0.00002s |   0.0%
- reduce.flatput                 |  10146 |     0.00020s |   0.2%
[Iteration 10110] [Rank 1] a = 0.9969755411148071, b = 0.9998373654503413, delta = 0.0007616911898367107, c = 0.000674730897814902, d = 0.000676147166017964, m = 0.0006980929943015558
[Iteration 10120] [Rank 1] a = 1.0055769681930542, b = 0.9999373505298129, delta = 0.0007251428905874491, c = 0.0008747010594618823, d = 0.0008754610082537693, m = 0.0006987602074844393
[Iteration 10130] [Rank 1] a = 0.9483137130737305, b = 0.9999454163499173, delta = 0.0007381982868537307, c = 0.0008908326997260281, d = 0.0008913853897564914, m = 0.000699386121983113
[Iteration 10140] [Rank 1] a = 1.1693849563598633, b = 0.9996436821514366, delta = 0.0008159377030096948, c = 0.0002873642727139799, d = 0.00028805513525205896, m = 0.0006996405015090196
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10146 |     0.11072s |  92.9%
- batch.accumulate               |  10146 |     0.00083s |   0.7%

[Iteration 10010] [Rank 2] a = 0.89988112449646, b = 1.0006945012166786, delta = 0.0006954732234589756, c = 0.002389002656677347, d = 0.002352663287174389, m = 0.0005671828096648083
[Iteration 10020] [Rank 2] a = 1.0066736936569214, b = 0.9998536352627243, delta = 0.0007441318593919277, c = 0.0007072705233584251, d = 0.0007081686446579279, m = 0.0005674527653188177
[Iteration 10030] [Rank 2] a = 1.1248313188552856, b = 0.9996753581951328, delta = 0.0008001548703759909, c = 0.00035071636745582856, d = 0.00035147631624771555, m = 0.0005677435952675149
[Iteration 10040] [Rank 2] a = 0.9634909629821777, b = 0.9999556411154558, delta = 0.0007254931842908263, c = 0.0009112822308531679, d = 0.0009116276621222075, m = 0.000568244737552283
[Iteration 10050] [Rank 2] a = 0.9418306350708008, b = 0.9997859825509054, delta = 0.0007897228933870792, c = 0.0005719650952756436, d = 0.0005728632165751463, m = 0.00056851269000097
- reduce.gather.context          |  10146 |     0.00248s |   2.1%
- reduce.gather.tensors          |  10146 |     0.00339s |   2.8%
- reduce.heur_params             |  10146 |     0.01051s |   8.8%
- batch.backward                 |  10146 |     0.05178s |  43.4%
- batch.evaluate                 |  10146 |     0.00275s |   2.3%
- batch.forward                  |  10146 |     0.02542s |  21.3%
- batch.mom                      |  10146 |     0.00126s |   1.1%
- batch.reduce                   |  10146 |     0.02591s |  21.7%
- batch.reporting.compr_err      |  10146 |     0.00001s |   0.0%
- batch.reporting.lr             |  10146 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10146 |     0.00001s |   0.0%
- batch.step                     |  10146 |     0.00048s |   0.4%
- batch.update_runavg            |  10146 |     0.00130s |   1.1%
- batch.wd                       |  10146 |     0.00001s |   0.0%
- epoch_metrics.collect          |     72 |     0.00762s |   0.0%
- reduce.combine                 |  10146 |     0.00621s |   5.2%
- reduce.flatpack                |  10146 |     0.00002s |   0.0%
- reduce.flatput                 |  10146 |     0.00023s |   0.2%
[Iteration 10060] [Rank 2] a = 1.0306123495101929, b = 0.9998117862656576, delta = 0.0007420654874294996, c = 0.0006235725268701485, d = 0.0006247124500579789, m = 0.0005697220820841008
[Iteration 10070] [Rank 2] a = 1.0309807062149048, b = 0.9998001279607664, delta = 0.0007203902932815254, c = 0.0006002559162099807, d = 0.000601395839397811, m = 0.0005702494190064796
[Iteration 10080] [Rank 2] a = 1.0371919870376587, b = 0.9997947910478788, delta = 0.0007410024991258979, c = 0.0005895820899966594, d = 0.0005906183838037779, m = 0.0005704522564004709
[Iteration 10090] [Rank 2] a = 1.0605219602584839, b = 0.9997640822095575, delta = 0.0007604941492900252, c = 0.000528164410361432, d = 0.0005290279885340308, m = 0.0005707101572705643
[Iteration 10100] [Rank 2] a = 1.0056712627410889, b = 0.9998633418811901, delta = 0.0007212235359475017, c = 0.0007266837606784463, d = 0.0007281000288815084, m = 0.0005711685138755585
- reduce.heur_params.alpha       |  10145 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  10145 |     0.00233s |   2.0%
- reduce.memory                  |  10146 |     0.00045s |   0.4%
- reduce.pad                     |  10146 |     0.00027s |   0.2%
- reduce.threshold               |  10146 |     0.00247s |   2.1%
- test.last                      |     72 |     0.41111s |   2.5%
- test.runavg                    |     72 |     0.44192s |   2.7%
-----------------------------------------------------------------

[Iteration 10150] [Rank 3] a = 1.055985689163208, b = 0.9997373112878725, delta = 0.0007975824410095811, c = 0.0004746225636603058, d = 0.0004756243143405204, m = 0.0006075989458275992
[Iteration 10160] [Rank 3] a = 1.0809602737426758, b = 0.9997720789430057, delta = 0.000728482031263411, c = 0.000544157878117962, d = 0.0005451250856712726, m = 0.0006084248914814298
- reduce.gather.context          |  10146 |     0.00128s |   1.1%
- reduce.gather.tensors          |  10146 |     0.00373s |   3.1%
- reduce.heur_params             |  10146 |     0.01092s |   9.2%
[Iteration 10110] [Rank 2] a = 1.0197288990020752, b = 0.9999246732022997, delta = 0.0007043580990284681, c = 0.0008493464043143813, d = 0.0008498990943448445, m = 0.0005715292731400588
[Iteration 10120] [Rank 2] a = 0.894396185874939, b = 1.0030547373301362, delta = 0.0006597357569262385, c = 0.00710949366373696, d = 0.006490653545252654, m = 0.0005723835514180376
[Iteration 10130] [Rank 2] a = 0.96805739402771, b = 0.999873411202508, delta = 0.000742988137062639, c = 0.0007468224036634506, d = 0.0007478586974705692, m = 0.0005725900391213476
[Iteration 10140] [Rank 2] a = 1.0273289680480957, b = 0.9997851017012099, delta = 0.0007727463380433619, c = 0.0005702033958035421, d = 0.0005710324308492369, m = 0.000572750884138596
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10146 |     0.11080s |  92.9%
- batch.accumulate               |  10146 |     0.00082s |   0.7%
[Iteration 10170] [Rank 3] a = 0.9507927298545837, b = 1.000287376026738, delta = 0.0007039494230411947, c = 0.0015747520692973814, d = 0.0015661853738252011, m = 0.0006086273789960847
[Iteration 10180] [Rank 3] a = 0.952617347240448, b = 0.9999525667771677, delta = 0.0007422252092510462, c = 0.0009051335542642644, d = 0.0009055135286602079, m = 0.0006087802479180383
[Iteration 10190] [Rank 3] a = 0.9566279053688049, b = 1.000213367382019, delta = 0.0007031519780866802, c = 0.0014267347705139454, d = 0.0014224514227778554, m = 0.0006093112862583294
[Iteration 10200] [Rank 3] a = 1.1398075819015503, b = 0.9996602283072189, delta = 0.0008066597511060536, c = 0.0003204565882879663, d = 0.0003210438214453335, m = 0.0006094682779537174
[Iteration 10210] [Rank 3] a = 0.9016337990760803, b = 1.0001094443875294, delta = 0.0007090073195286095, c = 0.001218888775932864, d = 0.0012168507314455307, m = 0.0006098252453078376
- reduce.heur_params.alpha       |  10145 |     0.00834s |   7.0%
- reduce.heur_params.beta        |  10145 |     0.00250s |   2.1%
- reduce.memory                  |  10146 |     0.00047s |   0.4%
- reduce.pad                     |  10146 |     0.00021s |   0.2%
- reduce.threshold               |  10146 |     0.00265s |   2.2%
- test.last                      |     72 |     0.41111s |   2.5%
- test.runavg                    |     72 |     0.44192s |   2.7%
-----------------------------------------------------------------

[Iteration 10150] [Rank 1] a = 0.976980984210968, b = 0.9998602848145173, delta = 0.0007638975512236357, c = 0.0007205696272164468, d = 0.0007215368347697575, m = 0.0006998338859844396
[Iteration 10160] [Rank 1] a = 0.9546071887016296, b = 0.9998765718985703, delta = 0.0007556415512226522, c = 0.0007531437958868739, d = 0.0007539728309325687, m = 0.0007001392527195702
- batch.backward                 |  10146 |     0.05177s |  43.4%
- batch.evaluate                 |  10146 |     0.00274s |   2.3%
- batch.forward                  |  10146 |     0.02548s |  21.4%
- batch.mom                      |  10146 |     0.00126s |   1.1%
- batch.reduce                   |  10146 |     0.02596s |  21.8%
- batch.reporting.compr_err      |  10146 |     0.00001s |   0.0%
- batch.reporting.lr             |  10146 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10146 |     0.00001s |   0.0%
- batch.step                     |  10146 |     0.00048s |   0.4%
- batch.update_runavg            |  10146 |     0.00130s |   1.1%
- batch.wd                       |  10146 |     0.00001s |   0.0%
- epoch_metrics.collect          |     72 |     0.01251s |   0.1%
- reduce.combine                 |  10146 |     0.00612s |   5.1%
- reduce.flatpack                |  10146 |     0.00002s |   0.0%
- reduce.flatput                 |  10146 |     0.00019s |   0.2%
[Iteration 10220] [Rank 3] a = 0.9550784230232239, b = 1.0005603875794737, delta = 0.0006993452552706003, c = 0.002120775276268157, d = 0.0020891337720241364, m = 0.0006101377446663003
[Iteration 10230] [Rank 3] a = 1.0439274311065674, b = 0.9997421473253115, delta = 0.0007600741228088737, c = 0.00048429463919341247, d = 0.00048553819176195477, m = 0.0006103144621781429
[Iteration 10240] [Rank 3] a = 0.9985712766647339, b = 1.0000697543350408, delta = 0.0007040207274258137, c = 0.0011395086703075814, d = 0.0011372288239319204, m = 0.0006107089747054038
[Iteration 10250] [Rank 3] a = 0.9641612768173218, b = 1.000196061276166, delta = 0.0007300690631382167, c = 0.001392122557356185, d = 0.0013875628646048634, m = 0.0006108176381655863
[Iteration 10260] [Rank 3] a = 1.0013281106948853, b = 0.9997744106039517, delta = 0.0007690415950492024, c = 0.0005488212002499955, d = 0.0005502374684530576, m = 0.0006110587379926135
[Iteration 10170] [Rank 1] a = 1.0491825342178345, b = 0.999784946257146, delta = 0.0007438379689119756, c = 0.0005698925076614065, d = 0.0005708251720878131, m = 0.0007004172532451018
[Iteration 10180] [Rank 1] a = 1.0258551836013794, b = 0.999724443974033, delta = 0.0008179245050996542, c = 0.00044888793411686125, d = 0.0004495097104011324, m = 0.0007004635459040581
[Iteration 10190] [Rank 1] a = 1.0677984952926636, b = 0.9997728561633208, delta = 0.0007600144017487764, c = 0.0005457123188286398, d = 0.0005468522420164702, m = 0.000700796075017315
[Iteration 10200] [Rank 1] a = 1.0013718605041504, b = 0.9998988867582679, delta = 0.0007527885609306395, c = 0.0007977735158467803, d = 0.000798706180273187, m = 0.000700872212487063
[Iteration 10210] [Rank 1] a = 1.0495675802230835, b = 0.9998458285162205, delta = 0.0007542251842096448, c = 0.0006916570299978387, d = 0.000692831496312573, m = 0.0007011392519588194
- reduce.gather.context          |  10146 |     0.00198s |   1.7%
- reduce.gather.tensors          |  10146 |     0.00373s |   3.1%
- reduce.heur_params             |  10146 |     0.01057s |   8.9%
[Iteration 10270] [Rank 3] a = 0.9590992331504822, b = 1.0000643656072679, delta = 0.0007264858577400446, c = 0.0011287312147135482, d = 0.001127418575891198, m = 0.0006113267243737926
[Iteration 10280] [Rank 3] a = 0.9910964965820312, b = 1.000121759012106, delta = 0.0007137292413972318, c = 0.001243518025415382, d = 0.001239269220806196, m = 0.000611688011265432
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10285 |     0.11086s |  93.0%
- batch.accumulate               |  10285 |     0.00082s |   0.7%
- batch.backward                 |  10285 |     0.05175s |  43.4%
- batch.evaluate                 |  10285 |     0.00277s |   2.3%
- batch.forward                  |  10285 |     0.02537s |  21.3%
- batch.mom                      |  10285 |     0.00126s |   1.1%
- batch.reduce                   |  10285 |     0.02612s |  21.9%
[Iteration 10220] [Rank 1] a = 0.9840540885925293, b = 0.9998361564409319, delta = 0.0007816360448487103, c = 0.0006723128789316253, d = 0.0006735564315001676, m = 0.0007011609523875046
[Iteration 10230] [Rank 1] a = 1.0173178911209106, b = 0.9998366227731325, delta = 0.000769714592024684, c = 0.000673245543358032, d = 0.0006741091215306308, m = 0.0007013629497596702
[Iteration 10240] [Rank 1] a = 1.0309648513793945, b = 0.9997932538787969, delta = 0.0007824864005669951, c = 0.0005865077517022075, d = 0.000587613131763134, m = 0.0007014639151347894
[Iteration 10250] [Rank 1] a = 0.9915939569473267, b = 0.9999295437831671, delta = 0.0007430572877638042, c = 0.0008590875661012959, d = 0.0008599856874007986, m = 0.0007019721751542958
[Iteration 10260] [Rank 1] a = 1.0511441230773926, b = 0.9997353941444627, delta = 0.0007869234541431069, c = 0.0004707882765739671, d = 0.00047175548412727773, m = 0.0007023518157188199
- reduce.heur_params.alpha       |  10145 |     0.00820s |   6.9%
- reduce.heur_params.beta        |  10145 |     0.00229s |   1.9%
- reduce.memory                  |  10146 |     0.00045s |   0.4%
- reduce.pad                     |  10146 |     0.00027s |   0.2%
- reduce.threshold               |  10146 |     0.00242s |   2.0%
- test.last                      |     72 |     0.41111s |   2.5%
- test.runavg                    |     72 |     0.44193s |   2.7%
-----------------------------------------------------------------

[Iteration 10150] [Rank 2] a = 0.9475440382957458, b = 1.0005639627919785, delta = 0.0006999758770689368, c = 0.002127925703537275, d = 0.0021021910739938304, m = 0.0005732181386116883
[Iteration 10160] [Rank 2] a = 1.0466076135635376, b = 0.9996662042674954, delta = 0.0008262432529591024, c = 0.00033240851019673384, d = 0.00033320300211552473, m = 0.0005734589044866315
- batch.reporting.compr_err      |  10285 |     0.00001s |   0.0%
- batch.reporting.lr             |  10285 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10285 |     0.00001s |   0.0%
- batch.step                     |  10285 |     0.00047s |   0.4%
- batch.update_runavg            |  10285 |     0.00129s |   1.1%
[Iteration 10270] [Rank 1] a = 0.9742907285690308, b = 1.0001595319206238, delta = 0.0007286843610927463, c = 0.0013190638439543258, d = 0.0013150913843603712, m = 0.0007025437516467816
[Iteration 10280] [Rank 1] a = 1.1685367822647095, b = 0.9996716102662633, delta = 0.0007651844643987715, c = 0.0003432205089176709, d = 0.00034391137145574997, m = 0.0007043433856215829
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10285 |     0.11075s |  92.9%
- batch.accumulate               |  10285 |     0.00083s |   0.7%
- batch.backward                 |  10285 |     0.05178s |  43.4%
- batch.evaluate                 |  10285 |     0.00275s |   2.3%
- batch.forward                  |  10285 |     0.02542s |  21.3%
- batch.mom                      |  10285 |     0.00126s |   1.1%
- batch.reduce                   |  10285 |     0.02594s |  21.8%
[Iteration 10170] [Rank 2] a = 0.9557412266731262, b = 0.9999725845191798, delta = 0.0007487979019060731, c = 0.0009451690383459452, d = 0.0009454453833611768, m = 0.0005737971545904404
[Iteration 10180] [Rank 2] a = 1.0964258909225464, b = 0.9996469810196409, delta = 0.0008171552326530218, c = 0.0002939620099526348, d = 0.00029503284688665735, m = 0.0005743358001519768
[Iteration 10190] [Rank 2] a = 0.9800457954406738, b = 0.9998807343453009, delta = 0.0007681355345994234, c = 0.0007614686894707265, d = 0.0007622977245164212, m = 0.0005744932210114697
[Iteration 10200] [Rank 2] a = 1.0289618968963623, b = 0.9997010928221735, delta = 0.0007814266136847436, c = 0.00040218562654271766, d = 0.0004030837478422204, m = 0.000575119924710816
[Iteration 10210] [Rank 2] a = 0.8853583335876465, b = 1.0043939555837997, delta = 0.0006535378633998334, c = 0.009787967723869428, d = 0.008755266401948868, m = 0.0005761523575711824
- batch.wd                       |  10285 |     0.00001s |   0.0%
- epoch_metrics.collect          |     73 |     0.00735s |   0.0%
- reduce.combine                 |  10285 |     0.00612s |   5.1%
- reduce.flatpack                |  10285 |     0.00002s |   0.0%
- reduce.flatput                 |  10285 |     0.00020s |   0.2%
- reduce.gather.context          |  10285 |     0.00248s |   2.1%
- reduce.gather.tensors          |  10285 |     0.00340s |   2.9%
- reduce.heur_params             |  10285 |     0.01051s |   8.8%
- reduce.heur_params.alpha       |  10284 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  10284 |     0.00233s |   2.0%
- reduce.memory                  |  10285 |     0.00045s |   0.4%
- reduce.pad                     |  10285 |     0.00027s |   0.2%
- reduce.threshold               |  10285 |     0.00247s |   2.1%
- test.last                      |     73 |     0.41105s |   2.5%
- test.runavg                    |     73 |     0.44190s |   2.7%
- batch.reporting.compr_err      |  10285 |     0.00001s |   0.0%
- batch.reporting.lr             |  10285 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10285 |     0.00001s |   0.0%
- batch.step                     |  10285 |     0.00048s |   0.4%
- batch.update_runavg            |  10285 |     0.00130s |   1.1%
[Iteration 10220] [Rank 2] a = 1.0342564582824707, b = 0.9997149446148808, delta = 0.0007790867239236832, c = 0.00042988921431968746, d = 0.0004306491631115744, m = 0.0005762544553610875
[Iteration 10230] [Rank 2] a = 0.9755612015724182, b = 0.9997410937600112, delta = 0.0008058764506131411, c = 0.00048218750845227136, d = 0.00048336197476700574, m = 0.00057642816450964
[Iteration 10240] [Rank 2] a = 1.0548292398452759, b = 0.9997387966422274, delta = 0.0007652437197975814, c = 0.0004775932725740457, d = 0.00047814596260450893, m = 0.0005766977735033107
[Iteration 10250] [Rank 2] a = 0.9889270067214966, b = 0.9998493346435198, delta = 0.0007377631263807416, c = 0.000698669284759341, d = 0.0007000164667085951, m = 0.0005771937877411862
[Iteration 10260] [Rank 2] a = 0.996825098991394, b = 0.9998342738405667, delta = 0.0007707980694249272, c = 0.0006685476780990945, d = 0.0006692730837640774, m = 0.000577337024495205
-----------------------------------------------------------------
- batch.wd                       |  10285 |     0.00001s |   0.0%
- epoch_metrics.collect          |     73 |     0.00753s |   0.0%
- reduce.combine                 |  10285 |     0.00622s |   5.2%
- reduce.flatpack                |  10285 |     0.00002s |   0.0%
- reduce.flatput                 |  10285 |     0.00023s |   0.2%
- reduce.gather.context          |  10285 |     0.00127s |   1.1%
- reduce.gather.tensors          |  10285 |     0.00374s |   3.1%
- reduce.heur_params             |  10285 |     0.01092s |   9.2%
- reduce.heur_params.alpha       |  10284 |     0.00835s |   7.0%
- reduce.heur_params.beta        |  10284 |     0.00250s |   2.1%
- reduce.memory                  |  10285 |     0.00047s |   0.4%
- reduce.pad                     |  10285 |     0.00021s |   0.2%
- reduce.threshold               |  10285 |     0.00265s |   2.2%
- test.last                      |     73 |     0.41105s |   2.5%
- test.runavg                    |     73 |     0.44191s |   2.7%
[Iteration 10270] [Rank 2] a = 0.9711287617683411, b = 1.0000274390046897, delta = 0.0007423014612868428, c = 0.001054878009392898, d = 0.0010544980349969544, m = 0.0005775518499303385
[Iteration 10280] [Rank 2] a = 0.9497107863426208, b = 1.0000354702816867, delta = 0.0007312148227356374, c = 0.0010709405634032358, d = 0.0010704224164996765, m = 0.0005779047760350729
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10285 |     0.11082s |  92.9%
- batch.accumulate               |  10285 |     0.00082s |   0.7%
- batch.backward                 |  10285 |     0.05177s |  43.4%
- batch.evaluate                 |  10285 |     0.00274s |   2.3%
- batch.forward                  |  10285 |     0.02547s |  21.4%
- batch.mom                      |  10285 |     0.00126s |   1.1%
- batch.reduce                   |  10285 |     0.02600s |  21.8%
-----------------------------------------------------------------
- batch.reporting.compr_err      |  10285 |     0.00001s |   0.0%
- batch.reporting.lr             |  10285 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10285 |     0.00001s |   0.0%
- batch.step                     |  10285 |     0.00048s |   0.4%
- batch.update_runavg            |  10285 |     0.00130s |   1.1%
- batch.wd                       |  10285 |     0.00001s |   0.0%
- epoch_metrics.collect          |     73 |     0.01238s |   0.1%
- reduce.combine                 |  10285 |     0.00612s |   5.1%
- reduce.flatpack                |  10285 |     0.00002s |   0.0%
- reduce.flatput                 |  10285 |     0.00019s |   0.2%
- reduce.gather.context          |  10285 |     0.00199s |   1.7%
- reduce.gather.tensors          |  10285 |     0.00375s |   3.1%
- reduce.heur_params             |  10285 |     0.01057s |   8.9%
- reduce.heur_params.alpha       |  10284 |     0.00820s |   6.9%
- reduce.heur_params.beta        |  10284 |     0.00230s |   1.9%
- reduce.memory                  |  10285 |     0.00045s |   0.4%
- reduce.pad                     |  10285 |     0.00027s |   0.2%
- reduce.threshold               |  10285 |     0.00242s |   2.0%
- test.last                      |     73 |     0.41105s |   2.5%
- test.runavg                    |     73 |     0.44191s |   2.7%
-----------------------------------------------------------------
[Iteration 10220] [Rank 0] a = 0.9853559732437134, b = 0.9998946897683938, delta = 0.0007764477049931884, c = 0.0007893795360091199, d = 0.0007907958042121819, m = 0.0005295804656482435
[Iteration 10230] [Rank 0] a = 1.0633617639541626, b = 0.9997057734154571, delta = 0.0007982311653904617, c = 0.0004115468139336887, d = 0.0004123758489793836, m = 0.0005299575670042267
[Iteration 10240] [Rank 0] a = 1.0179016590118408, b = 0.9998041004202048, delta = 0.0007442216738127172, c = 0.0006082008353978897, d = 0.0006096171036009517, m = 0.0005303769514393443
[Iteration 10250] [Rank 0] a = 0.9657345414161682, b = 0.9999175227750752, delta = 0.0007468083640560508, c = 0.000835045549776145, d = 0.0008361163867101675, m = 0.0005306537125640456
[Iteration 10260] [Rank 0] a = 0.926984965801239, b = 0.9999945366763205, delta = 0.0007577753276564181, c = 0.0009890733526408686, d = 0.0009891769820215806, m = 0.0005308617703990047
[Iteration 10270] [Rank 0] a = 1.0136215686798096, b = 0.9998376763384752, delta = 0.0007538726786151528, c = 0.0006753526740991731, d = 0.0006766653129215233, m = 0.0005311385766147156
[Iteration 10280] [Rank 0] a = 1.0376335382461548, b = 0.9997746351342653, delta = 0.000792923616245389, c = 0.0005492702608997469, d = 0.0005504101840875773, m = 0.0005313375901797876
cross_entropy                  - bits:25452009344.000, epoch: 74.000, ratio_transmit_grad:  0.178, value:  5.356 (split:train)
last_cross_entropy             - bits:25452009344.000, epoch: 74.000, ratio_transmit_grad:  0.178, value:  5.356 (split:train)
perplexity                     - bits:25452009344.000, epoch: 74.000, ratio_transmit_grad:  0.178, value:212.376 (split:train)
last_perplexity                - bits:25452009344.000, epoch: 74.000, ratio_transmit_grad:  0.178, value:212.376 (split:train)
last_cross_entropy             - bits:25452009344.000, epoch: 74.000, ratio_transmit_grad:  0.178, value:  5.147 (split:test)
last_perplexity                - bits:25452009344.000, epoch: 74.000, ratio_transmit_grad:  0.178, value:172.496 (split:test)
runavg_cross_entropy           - bits:25452009344.000, epoch: 74.000, ratio_transmit_grad:  0.178, value:  5.349 (split:test)
runavg_perplexity              - bits:25452009344.000, epoch: 74.000, ratio_transmit_grad:  0.178, value:210.977 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10285 |     0.11077s |  92.9%
- batch.accumulate               |  10285 |     0.00082s |   0.7%
- batch.backward                 |  10285 |     0.05164s |  43.3%
- batch.evaluate                 |  10285 |     0.00275s |   2.3%
- batch.forward                  |  10285 |     0.02541s |  21.3%
- batch.mom                      |  10285 |     0.00126s |   1.1%
- batch.reduce                   |  10285 |     0.02607s |  21.9%
- batch.reporting.compr_err      |  10285 |     0.00001s |   0.0%
- batch.reporting.lr             |  10285 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10285 |     0.00001s |   0.0%
- batch.step                     |  10285 |     0.00048s |   0.4%
- batch.update_runavg            |  10285 |     0.00130s |   1.1%
- batch.wd                       |  10285 |     0.00001s |   0.0%
- epoch_metrics.collect          |     73 |     0.00812s |   0.0%
- reduce.combine                 |  10285 |     0.00639s |   5.4%
- reduce.flatpack                |  10285 |     0.00002s |   0.0%
- reduce.flatput                 |  10285 |     0.00020s |   0.2%
- reduce.gather.context          |  10285 |     0.00114s |   1.0%
- reduce.gather.tensors          |  10285 |     0.00384s |   3.2%
- reduce.heur_params             |  10285 |     0.01109s |   9.3%
- reduce.heur_params.alpha       |  10284 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  10284 |     0.00230s |   1.9%
- reduce.memory                  |  10285 |     0.00046s |   0.4%
- reduce.pad                     |  10285 |     0.00028s |   0.2%
- reduce.threshold               |  10285 |     0.00243s |   2.0%
- test.last                      |     73 |     0.41103s |   2.5%
- test.runavg                    |     73 |     0.44191s |   2.7%
-----------------------------------------------------------------

[Iteration 10290] [Rank 0] a = 0.9397144913673401, b = 1.000345373930988, delta = 0.0007408253150060773, c = 0.0016907478894408535, d = 0.0016800395201006283, m = 0.0005317187709033961
[Iteration 10300] [Rank 0] a = 0.9628214836120605, b = 0.9997587452967547, delta = 0.0008232766413129866, c = 0.0005174905841481107, d = 0.0005185268779552293, m = 0.0005320317818560833
[Iteration 10310] [Rank 0] a = 1.031014323234558, b = 0.9997384512109818, delta = 0.0008006396819837391, c = 0.00047690241003596663, d = 0.0004775241863202378, m = 0.0005324749410023512
[Iteration 10320] [Rank 0] a = 0.9979164600372314, b = 0.9998810970481281, delta = 0.0007549605797976255, c = 0.0007621940951357094, d = 0.0007636449064656754, m = 0.0005327319983977418
[Iteration 10330] [Rank 0] a = 0.9920520186424255, b = 0.9999372123573058, delta = 0.0007428488461300731, c = 0.0008744247144466508, d = 0.0008753919219999614, m = 0.0005332355928325292
[Iteration 10340] [Rank 0] a = 1.0318001508712769, b = 0.999826259835356, delta = 0.0007330946391448379, c = 0.0006525196672156606, d = 0.0006539359354187226, m = 0.0005338469267679836
[Iteration 10350] [Rank 0] a = 1.0679528713226318, b = 0.9996832685703805, delta = 0.0008215566631406546, c = 0.0003665371195778388, d = 0.0003672279821159178, m = 0.0005345543548902227
[Iteration 10360] [Rank 0] a = 0.9727240204811096, b = 0.9998303359242106, delta = 0.0007859105244278908, c = 0.0006606718451649934, d = 0.000661673595845208, m = 0.0005347422005362638
[Iteration 10370] [Rank 0] a = 0.9173362851142883, b = 1.000169773957473, delta = 0.0007432232378050685, c = 0.0013395479182083695, d = 0.0013366808386753414, m = 0.0005350743413931472
[Iteration 10380] [Rank 0] a = 1.039596676826477, b = 0.9997087786672403, delta = 0.0008194198599085212, c = 0.0004175573180149764, d = 0.0004182481805530555, m = 0.0005351519814782586
learning_rate                  - epoch: 74.727, value:  1.000 (weight:encoder.weight)
effective_lr                   - epoch: 74.727, value:  0.000 (weight:encoder.weight)
grad_norm                      - epoch: 74.727, value:  0.087 (weight:encoder.weight)
learning_rate                  - epoch: 74.727, value:  1.000 (weight:rnn.weight_ih_l0)
effective_lr                   - epoch: 74.727, value:  0.000 (weight:rnn.weight_ih_l0)
grad_norm                      - epoch: 74.727, value:  0.052 (weight:rnn.weight_ih_l0)
learning_rate                  - epoch: 74.727, value:  1.000 (weight:rnn.weight_hh_l0)
effective_lr                   - epoch: 74.727, value:  0.000 (weight:rnn.weight_hh_l0)
grad_norm                      - epoch: 74.727, value:  0.043 (weight:rnn.weight_hh_l0)
learning_rate                  - epoch: 74.727, value:  1.000 (weight:rnn.bias_ih_l0)
effective_lr                   - epoch: 74.727, value:  0.001 (weight:rnn.bias_ih_l0)
grad_norm                      - epoch: 74.727, value:  0.006 (weight:rnn.bias_ih_l0)
learning_rate                  - epoch: 74.727, value:  1.000 (weight:rnn.bias_hh_l0)
effective_lr                   - epoch: 74.727, value:  0.001 (weight:rnn.bias_hh_l0)
grad_norm                      - epoch: 74.727, value:  0.006 (weight:rnn.bias_hh_l0)
learning_rate                  - epoch: 74.727, value:  1.000 (weight:rnn.weight_ih_l1)
effective_lr                   - epoch: 74.727, value:  0.000 (weight:rnn.weight_ih_l1)
grad_norm                      - epoch: 74.727, value:  0.039 (weight:rnn.weight_ih_l1)
learning_rate                  - epoch: 74.727, value:  1.000 (weight:rnn.weight_hh_l1)
effective_lr                   - epoch: 74.727, value:  0.000 (weight:rnn.weight_hh_l1)
grad_norm                      - epoch: 74.727, value:  0.018 (weight:rnn.weight_hh_l1)
learning_rate                  - epoch: 74.727, value:  1.000 (weight:rnn.bias_ih_l1)
effective_lr                   - epoch: 74.727, value:  0.000 (weight:rnn.bias_ih_l1)
grad_norm                      - epoch: 74.727, value:  0.004 (weight:rnn.bias_ih_l1)
learning_rate                  - epoch: 74.727, value:  1.000 (weight:rnn.bias_hh_l1)
effective_lr                   - epoch: 74.727, value:  0.000 (weight:rnn.bias_hh_l1)
grad_norm                      - epoch: 74.727, value:  0.004 (weight:rnn.bias_hh_l1)
learning_rate                  - epoch: 74.727, value:  1.000 (weight:rnn.weight_ih_l2)
effective_lr                   - epoch: 74.727, value:  0.000 (weight:rnn.weight_ih_l2)
grad_norm                      - epoch: 74.727, value:  0.041 (weight:rnn.weight_ih_l2)
learning_rate                  - epoch: 74.727, value:  1.000 (weight:rnn.weight_hh_l2)
effective_lr                   - epoch: 74.727, value:  0.000 (weight:rnn.weight_hh_l2)
grad_norm                      - epoch: 74.727, value:  0.029 (weight:rnn.weight_hh_l2)
learning_rate                  - epoch: 74.727, value:  1.000 (weight:rnn.bias_ih_l2)
effective_lr                   - epoch: 74.727, value:  0.000 (weight:rnn.bias_ih_l2)
grad_norm                      - epoch: 74.727, value:  0.009 (weight:rnn.bias_ih_l2)
learning_rate                  - epoch: 74.727, value:  1.000 (weight:rnn.bias_hh_l2)
effective_lr                   - epoch: 74.727, value:  0.000 (weight:rnn.bias_hh_l2)
grad_norm                      - epoch: 74.727, value:  0.009 (weight:rnn.bias_hh_l2)
learning_rate                  - epoch: 74.727, value:  1.000 (weight:decoder.bias)
effective_lr                   - epoch: 74.727, value:  0.000 (weight:decoder.bias)
grad_norm                      - epoch: 74.727, value:  0.017 (weight:decoder.bias)
grad_norm                      - epoch: 74.727, value:  0.131 (weight:entire_model)
[Iteration 10390] [Rank 0] a = 1.0804822444915771, b = 0.9997240639996658, delta = 0.0007800763705745339, c = 0.0004481279853249743, d = 0.0004487497616092455, m = 0.0005356186482712725
[Iteration 10400] [Rank 0] a = 0.9809401631355286, b = 0.9999203207683359, delta = 0.0007456656312569976, c = 0.0008406415363345853, d = 0.000841539657634088, m = 0.0005359673045249273
[Iteration 10410] [Rank 0] a = 0.9276217818260193, b = 1.0001642125141967, delta = 0.0007486261310987175, c = 0.0013284250313452968, d = 0.0013253852361777491, m = 0.0005364760620262103
[Iteration 10420] [Rank 0] a = 1.0264201164245605, b = 0.9997537710867761, delta = 0.0007947278791107237, c = 0.0005075421635997724, d = 0.0005084057417723713, m = 0.0005367487569372259
cross_entropy                  - bits:25923896896.000, epoch: 75.000, ratio_transmit_grad:  0.183, value:  5.354 (split:train)
last_cross_entropy             - bits:25923896896.000, epoch: 75.000, ratio_transmit_grad:  0.183, value:  5.354 (split:train)
perplexity                     - bits:25923896896.000, epoch: 75.000, ratio_transmit_grad:  0.183, value:212.110 (split:train)
last_perplexity                - bits:25923896896.000, epoch: 75.000, ratio_transmit_grad:  0.183, value:212.110 (split:train)
last_cross_entropy             - bits:25923896896.000, epoch: 75.000, ratio_transmit_grad:  0.183, value:  5.146 (split:test)
last_perplexity                - bits:25923896896.000, epoch: 75.000, ratio_transmit_grad:  0.183, value:172.298 (split:test)
runavg_cross_entropy           - bits:25923896896.000, epoch: 75.000, ratio_transmit_grad:  0.183, value:  5.347 (split:test)
runavg_perplexity              - bits:25923896896.000, epoch: 75.000, ratio_transmit_grad:  0.183, value:210.617 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10424 |     0.11079s |  92.9%
- batch.accumulate               |  10424 |     0.00082s |   0.7%
- batch.backward                 |  10424 |     0.05164s |  43.3%
- batch.evaluate                 |  10424 |     0.00275s |   2.3%
- batch.forward                  |  10424 |     0.02541s |  21.3%
- batch.mom                      |  10424 |     0.00126s |   1.1%
- batch.reduce                   |  10424 |     0.02609s |  21.9%
- batch.reporting.compr_err      |  10424 |     0.00001s |   0.0%
- batch.reporting.lr             |  10424 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10424 |     0.00001s |   0.0%
- batch.step                     |  10424 |     0.00048s |   0.4%
- batch.update_runavg            |  10424 |     0.00130s |   1.1%
- batch.wd                       |  10424 |     0.00001s |   0.0%
- epoch_metrics.collect          |     74 |     0.00836s |   0.1%
- reduce.combine                 |  10424 |     0.00639s |   5.4%
- reduce.flatpack                |  10424 |     0.00002s |   0.0%
- reduce.flatput                 |  10424 |     0.00020s |   0.2%
- reduce.gather.context          |  10424 |     0.00114s |   1.0%
- reduce.gather.tensors          |  10424 |     0.00386s |   3.2%
- reduce.heur_params             |  10424 |     0.01109s |   9.3%
- reduce.heur_params.alpha       |  10423 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  10423 |     0.00231s |   1.9%
- reduce.memory                  |  10424 |     0.00046s |   0.4%
- reduce.pad                     |  10424 |     0.00028s |   0.2%
- reduce.threshold               |  10424 |     0.00243s |   2.0%
- test.last                      |     74 |     0.41097s |   2.5%
- test.runavg                    |     74 |     0.44180s |   2.7%
-----------------------------------------------------------------

[Iteration 10430] [Rank 0] a = 0.9173458218574524, b = 0.9999850718595499, delta = 0.0007614264613948762, c = 0.0009701437190975028, d = 0.0009701782622244067, m = 0.0005371995955434286
[Iteration 10440] [Rank 0] a = 1.0507025718688965, b = 0.999700954649678, delta = 0.0008180674631148577, c = 0.000401909281527486, d = 0.0004025656009386611, m = 0.0005374452331229968
[Iteration 10450] [Rank 0] a = 1.003696322441101, b = 0.999749055950245, delta = 0.0008098423131741583, c = 0.0004981118899549935, d = 0.0004988027524930724, m = 0.0005376266060729638
[Iteration 10460] [Rank 0] a = 0.9863596558570862, b = 0.9999591645143935, delta = 0.0007613931084051728, c = 0.0009183290287415742, d = 0.0009188817187720374, m = 0.0005379173011596034
[Iteration 10470] [Rank 0] a = 0.9755581021308899, b = 1.000025297330823, delta = 0.0007533811149187386, c = 0.0010505946616568079, d = 0.0010502492303877684, m = 0.0005384454326285724
[Iteration 10480] [Rank 0] a = 0.9135319590568542, b = 1.000459659847709, delta = 0.0007373292464762926, c = 0.0019193197601643066, d = 0.001905744311291053, m = 0.0005387297557979143
[Iteration 10490] [Rank 0] a = 1.008731484413147, b = 0.9998728930556126, delta = 0.0007449281984008849, c = 0.0007457861098563321, d = 0.0007468224036634506, m = 0.0005391710339692398
[Iteration 10500] [Rank 0] a = 0.97527015209198, b = 1.000067077242718, delta = 0.0007512284792028368, c = 0.0011341544856374687, d = 0.0011321855274039434, m = 0.000539349041295734
[Iteration 10510] [Rank 0] a = 1.0822792053222656, b = 0.9996999701706497, delta = 0.0008217495633289218, c = 0.0003999403232939607, d = 0.0004008384445934635, m = 0.0005395117996151604
[Iteration 10520] [Rank 0] a = 0.9746608734130859, b = 0.9998374690797194, delta = 0.0007938542985357344, c = 0.0006749381565763257, d = 0.0006759744503834443, m = 0.0005399413676059359
[Iteration 10530] [Rank 0] a = 0.8806537985801697, b = 1.001521048095869, delta = 0.0007021237979643047, c = 0.004042098537792893, d = 0.0038148047627648857, m = 0.0005407650876845418
[Iteration 10540] [Rank 0] a = 0.9299010634422302, b = 1.0003028858893663, delta = 0.0007085893885232508, c = 0.0016057717972571307, d = 0.0015950288847900015, m = 0.0005411251482176181
[Iteration 10550] [Rank 0] a = 0.9901847243309021, b = 1.0000705142838286, delta = 0.0007290406501851976, c = 0.0011410285678913551, d = 0.0011393704977999655, m = 0.000541380189688808
[Iteration 10560] [Rank 0] a = 0.8789680004119873, b = 1.0005010597757444, delta = 0.0007404789212159812, c = 0.00200211963535308, d = 0.0019891314196371942, m = 0.000541638339532682
cross_entropy                  - bits:26377432640.000, epoch: 76.000, ratio_transmit_grad:  0.176, value:  5.353 (split:train)
last_cross_entropy             - bits:26377432640.000, epoch: 76.000, ratio_transmit_grad:  0.176, value:  5.353 (split:train)
perplexity                     - bits:26377432640.000, epoch: 76.000, ratio_transmit_grad:  0.176, value:211.834 (split:train)

[Iteration 10290] [Rank 3] a = 0.9594851732254028, b = 1.0004759469284794, delta = 0.0007173295016400516, c = 0.0019518939288347336, d = 0.0019328606659106558, m = 0.0006119596720511757
[Iteration 10300] [Rank 3] a = 1.0397831201553345, b = 0.9997876751640467, delta = 0.0007635111105628312, c = 0.0005753503217122309, d = 0.0005761102705041179, m = 0.0006125609955662547
[Iteration 10310] [Rank 3] a = 0.9832839369773865, b = 1.0001299111899262, delta = 0.0007057652692310512, c = 0.0012598223813140475, d = 0.001255919007973901, m = 0.0006130076299334523
[Iteration 10320] [Rank 3] a = 0.9027392268180847, b = 1.0000715333060672, delta = 0.0007071363506838679, c = 0.0011430666123786884, d = 0.0011423757498406095, m = 0.0006137996835369425
[Iteration 10330] [Rank 3] a = 0.9148038625717163, b = 1.0001170956900405, delta = 0.0007038272451609373, c = 0.0012341913811513149, d = 0.0012323605954254054, m = 0.0006140613438666602

[Iteration 10290] [Rank 1] a = 0.985754668712616, b = 0.9998849486067252, delta = 0.0007383035845123231, c = 0.0007698972124352908, d = 0.0007710371356231213, m = 0.000704459288155617
[Iteration 10300] [Rank 1] a = 1.0236566066741943, b = 0.9998172786226464, delta = 0.0007515624165534973, c = 0.0006345572412256054, d = 0.0006356626212865318, m = 0.0007046685852111758
[Iteration 10310] [Rank 1] a = 1.000075101852417, b = 0.9998176067823409, delta = 0.0007691284990869462, c = 0.0006352135606367804, d = 0.0006363880269515148, m = 0.0007047527712884606
[Iteration 10320] [Rank 1] a = 0.9052910804748535, b = 1.0024470419874854, delta = 0.0006738041993230581, c = 0.005894093743621396, d = 0.0056385436907859555, m = 0.000705377127587462
[Iteration 10330] [Rank 1] a = 0.9986615777015686, b = 0.9997966045619656, delta = 0.0007752440869808197, c = 0.0005932091183215744, d = 0.0005945908433977324, m = 0.0007053928531367791
[Iteration 10340] [Rank 3] a = 0.9269880056381226, b = 1.000682342041771, delta = 0.0006787459715269506, c = 0.0023646842953369647, d = 0.002317291125224742, m = 0.0006145045936239309
[Iteration 10350] [Rank 3] a = 0.967119574546814, b = 0.9998862094308408, delta = 0.0007689161575399339, c = 0.0007724188606992793, d = 0.0007734896976333019, m = 0.0006145010832630803
[Iteration 10360] [Rank 3] a = 1.0426998138427734, b = 0.999731594400773, delta = 0.0007781290914863348, c = 0.00046318878865509756, d = 0.0004641214530815043, m = 0.0006146828809999556
[Iteration 10370] [Rank 3] a = 1.0215709209442139, b = 0.999777104967715, delta = 0.0007647579768672585, c = 0.0005542099280470121, d = 0.0005552116787272267, m = 0.0006150419266507168
[Iteration 10380] [Rank 3] a = 0.911716103553772, b = 1.000129133969584, delta = 0.0007108486024662852, c = 0.0012582679406033697, d = 0.001256471698004364, m = 0.0006155770857387093
[Iteration 10340] [Rank 1] a = 0.9222736954689026, b = 1.0008598245218119, delta = 0.000705002574250102, c = 0.0027196494674019793, d = 0.002677610481959869, m = 0.0007056238473880935
[Iteration 10350] [Rank 1] a = 0.9984710812568665, b = 0.999917419145695, delta = 0.0007423160714097321, c = 0.0008348382910147213, d = 0.0008354600672989924, m = 0.0007057025670778541
[Iteration 10360] [Rank 1] a = 1.010543704032898, b = 0.9997818201043079, delta = 0.0007902776706032455, c = 0.0005636402016917911, d = 0.0005647801248796215, m = 0.0007057997349590245
[Iteration 10370] [Rank 1] a = 1.0224906206130981, b = 0.999778814852412, delta = 0.0007890603737905622, c = 0.0005576296976105034, d = 0.0005587350776714298, m = 0.0007059375503552098
[Iteration 10380] [Rank 1] a = 0.8906891345977783, b = 1.0000948153734386, delta = 0.00073531165253371, c = 0.0011896307474452163, d = 0.0011886635398919057, m = 0.0007062056859675876
[Iteration 10390] [Rank 3] a = 1.084779977798462, b = 0.9996995038384784, delta = 0.0008015042403712869, c = 0.000399007658867554, d = 0.0003998366939132489, m = 0.0006157516152140357
[Iteration 10400] [Rank 3] a = 1.0868114233016968, b = 0.9996715411800169, delta = 0.000797971326392144, c = 0.0003430823364100551, d = 0.00034391137145574997, m = 0.0006161983978993797
[Iteration 10410] [Rank 3] a = 1.053748369216919, b = 0.9997409901306374, delta = 0.0007513018208555877, c = 0.00048198024969084766, d = 0.0004828783709903504, m = 0.0006165747449853683
[Iteration 10420] [Rank 3] a = 1.0277948379516602, b = 0.999856105096246, delta = 0.0007253411458805203, c = 0.0007122101905056903, d = 0.0007132464843128089, m = 0.0006167536851123615
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10424 |     0.11088s |  93.0%
- batch.accumulate               |  10424 |     0.00082s |   0.7%
[Iteration 10390] [Rank 1] a = 1.013810396194458, b = 0.9998639982005889, delta = 0.0007496030302718282, c = 0.0007279963995007966, d = 0.000729101779561723, m = 0.0007064133511723087
[Iteration 10400] [Rank 1] a = 1.0138391256332397, b = 0.9998352755912198, delta = 0.0007649102481082082, c = 0.0006705511794595238, d = 0.0006719329045356818, m = 0.0007064781470027369
[Iteration 10410] [Rank 1] a = 1.0614056587219238, b = 0.9997473978802589, delta = 0.0008022791589610279, c = 0.000494795749772214, d = 0.0004958665867062365, m = 0.0007065101067362721
[Iteration 10420] [Rank 1] a = 0.9622666835784912, b = 0.9998856567408175, delta = 0.0007533062598668039, c = 0.0007713134806383528, d = 0.0007723152313185675, m = 0.0007070335278738982
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10424 |     0.11076s |  92.9%
- batch.accumulate               |  10424 |     0.00083s |   0.7%

[Iteration 10290] [Rank 2] a = 0.9489933252334595, b = 1.00005856236197, delta = 0.000733697961550206, c = 0.0011171247240738202, d = 0.0011160884302667017, m = 0.0005782114398621669
[Iteration 10300] [Rank 2] a = 1.0293657779693604, b = 0.9997559473036401, delta = 0.000800674082711339, c = 0.0005118945975896704, d = 0.0005130690639044048, m = 0.0005783283040986665
[Iteration 10310] [Rank 2] a = 1.0397080183029175, b = 0.999753304754591, delta = 0.0008053882629610598, c = 0.0005066094991733657, d = 0.0005076803361073883, m = 0.0005785136828474549
[Iteration 10320] [Rank 2] a = 1.0741811990737915, b = 0.9996954968361242, delta = 0.0007935944013297558, c = 0.00039099365342583705, d = 0.0003916154297101082, m = 0.0005792982085285725
[Iteration 10330] [Rank 2] a = 0.9370539784431458, b = 0.9999855554633265, delta = 0.0007582062389701605, c = 0.0009711109266508134, d = 0.0009712836422853332, m = 0.0005794437875749533
- batch.backward                 |  10424 |     0.05175s |  43.4%
- batch.evaluate                 |  10424 |     0.00277s |   2.3%
- batch.forward                  |  10424 |     0.02537s |  21.3%
- batch.mom                      |  10424 |     0.00126s |   1.1%
- batch.reduce                   |  10424 |     0.02614s |  21.9%
- batch.reporting.compr_err      |  10424 |     0.00001s |   0.0%
- batch.reporting.lr             |  10424 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10424 |     0.00001s |   0.0%
- batch.step                     |  10424 |     0.00047s |   0.4%
- batch.update_runavg            |  10424 |     0.00129s |   1.1%
- batch.wd                       |  10424 |     0.00001s |   0.0%
- epoch_metrics.collect          |     74 |     0.00756s |   0.0%
- reduce.combine                 |  10424 |     0.00612s |   5.1%
- reduce.flatpack                |  10424 |     0.00002s |   0.0%
- reduce.flatput                 |  10424 |     0.00020s |   0.2%
- batch.backward                 |  10424 |     0.05178s |  43.4%
- batch.evaluate                 |  10424 |     0.00275s |   2.3%
- batch.forward                  |  10424 |     0.02542s |  21.3%
- batch.mom                      |  10424 |     0.00126s |   1.1%
- batch.reduce                   |  10424 |     0.02595s |  21.8%
- batch.reporting.compr_err      |  10424 |     0.00001s |   0.0%
- batch.reporting.lr             |  10424 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10424 |     0.00001s |   0.0%
- batch.step                     |  10424 |     0.00048s |   0.4%
- batch.update_runavg            |  10424 |     0.00130s |   1.1%
- batch.wd                       |  10424 |     0.00001s |   0.0%
- epoch_metrics.collect          |     74 |     0.00744s |   0.0%
- reduce.combine                 |  10424 |     0.00622s |   5.2%
- reduce.flatpack                |  10424 |     0.00002s |   0.0%
- reduce.flatput                 |  10424 |     0.00023s |   0.2%
[Iteration 10340] [Rank 2] a = 1.0538058280944824, b = 0.9997665693145577, delta = 0.0007686775643378496, c = 0.0005331386206356011, d = 0.0005341403713158158, m = 0.0005798582381878516
[Iteration 10350] [Rank 2] a = 0.9591614603996277, b = 1.000395167841583, delta = 0.000712559325620532, c = 0.0017903357243049482, d = 0.0017761384991474237, m = 0.0005801276184760041
[Iteration 10360] [Rank 2] a = 1.0547791719436646, b = 0.9997745487764523, delta = 0.000746876816265285, c = 0.0005490975452652271, d = 0.0005497884078033062, m = 0.0005804137053302169
[Iteration 10370] [Rank 2] a = 1.016151785850525, b = 0.9997729425211336, delta = 0.0007758691208437085, c = 0.0005458850344631596, d = 0.0005468522420164702, m = 0.0005806804484317465
[Iteration 10380] [Rank 2] a = 0.9601459503173828, b = 0.9998861058014615, delta = 0.0007498463965021074, c = 0.0007722116019378556, d = 0.0007727988350952228, m = 0.0005812431176178981
- reduce.gather.context          |  10424 |     0.00248s |   2.1%
- reduce.gather.tensors          |  10424 |     0.00341s |   2.9%
- reduce.heur_params             |  10424 |     0.01051s |   8.8%
- reduce.gather.context          |  10424 |     0.00126s |   1.1%
- reduce.gather.tensors          |  10424 |     0.00375s |   3.1%
- reduce.heur_params             |  10424 |     0.01092s |   9.2%
[Iteration 10390] [Rank 2] a = 0.971713125705719, b = 0.999935277942207, delta = 0.0007357592694461346, c = 0.000870555884233408, d = 0.0008711085742638713, m = 0.0005815941173936268
[Iteration 10400] [Rank 2] a = 0.9951704740524292, b = 0.9998224773630767, delta = 0.0007395680295303464, c = 0.000644954722423695, d = 0.0006464400768805649, m = 0.0005822821518644531
[Iteration 10410] [Rank 2] a = 0.9178300499916077, b = 1.0000185096063898, delta = 0.0007233783835545182, c = 0.0010370192127835546, d = 0.0010368464971490347, m = 0.0005830107304219052
[Iteration 10420] [Rank 2] a = 0.9726705551147461, b = 0.999867918845422, delta = 0.0007367701618932188, c = 0.0007358376893079937, d = 0.0007365630949729767, m = 0.000583294316081752
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10424 |     0.11084s |  93.0%
- batch.accumulate               |  10424 |     0.00082s |   0.7%
- reduce.heur_params.alpha       |  10423 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  10423 |     0.00234s |   2.0%
- reduce.memory                  |  10424 |     0.00045s |   0.4%
- reduce.pad                     |  10424 |     0.00027s |   0.2%
- reduce.threshold               |  10424 |     0.00247s |   2.1%
- test.last                      |     74 |     0.41098s |   2.5%
- test.runavg                    |     74 |     0.44179s |   2.7%
-----------------------------------------------------------------

[Iteration 10430] [Rank 3] a = 1.082782506942749, b = 0.999814964233222, delta = 0.0006895469850860536, c = 0.0006299284622204757, d = 0.0006305156953778429, m = 0.0006188010451112519
[Iteration 10440] [Rank 3] a = 1.0783344507217407, b = 0.9997297463436177, delta = 0.0008147423504851758, c = 0.00045949267407637467, d = 0.0004603907953758774, m = 0.0006188862377438647
- reduce.heur_params.alpha       |  10423 |     0.00835s |   7.0%
- reduce.heur_params.beta        |  10423 |     0.00250s |   2.1%
- reduce.memory                  |  10424 |     0.00047s |   0.4%
- reduce.pad                     |  10424 |     0.00021s |   0.2%
- reduce.threshold               |  10424 |     0.00266s |   2.2%
- test.last                      |     74 |     0.41098s |   2.5%
- test.runavg                    |     74 |     0.44179s |   2.7%
-----------------------------------------------------------------

[Iteration 10430] [Rank 1] a = 1.004926085472107, b = 0.9999997699600464, delta = 0.0007287616026587784, c = 0.0009995399200927663, d = 0.0009995399200927663, m = 0.0007072632875485998
[Iteration 10440] [Rank 1] a = 0.9619361758232117, b = 1.000036886549888, delta = 0.0007643376011401415, c = 0.0010737730998093599, d = 0.0010731858666519927, m = 0.0007072652960678867
- batch.backward                 |  10424 |     0.05177s |  43.4%
- batch.evaluate                 |  10424 |     0.00274s |   2.3%
- batch.forward                  |  10424 |     0.02547s |  21.4%
- batch.mom                      |  10424 |     0.00126s |   1.1%
- batch.reduce                   |  10424 |     0.02602s |  21.8%
- batch.reporting.compr_err      |  10424 |     0.00001s |   0.0%
- batch.reporting.lr             |  10424 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10424 |     0.00001s |   0.0%
- batch.step                     |  10424 |     0.00048s |   0.4%
- batch.update_runavg            |  10424 |     0.00129s |   1.1%
- batch.wd                       |  10424 |     0.00001s |   0.0%
- epoch_metrics.collect          |     74 |     0.01257s |   0.1%
- reduce.combine                 |  10424 |     0.00612s |   5.1%
- reduce.flatpack                |  10424 |     0.00002s |   0.0%
- reduce.flatput                 |  10424 |     0.00019s |   0.2%
[Iteration 10450] [Rank 3] a = 1.0136643648147583, b = 0.9999644150696754, delta = 0.0006795047083869576, c = 0.0009288301393203757, d = 0.0009290719412087034, m = 0.000619361963958243
[Iteration 10460] [Rank 3] a = 1.0021867752075195, b = 0.9999009593458614, delta = 0.0007112153107300401, c = 0.0008019186910752546, d = 0.0008031967867707009, m = 0.0006195258594862207
[Iteration 10470] [Rank 3] a = 0.987474262714386, b = 0.9998130989044338, delta = 0.000763627584092319, c = 0.0006261978045148488, d = 0.0006273031845757753, m = 0.0006195962240193092
[Iteration 10480] [Rank 3] a = 0.9228317737579346, b = 1.0002164589917342, delta = 0.0007209841278381646, c = 0.001432917990229753, d = 0.0014283237543515272, m = 0.0006199008439486856
[Iteration 10490] [Rank 3] a = 1.023255705833435, b = 0.9999105968781821, delta = 0.0007014109287410975, c = 0.0008211937558876601, d = 0.000822022790933355, m = 0.0006203117985911599
[Iteration 10450] [Rank 1] a = 0.8227007985115051, b = 1.0034914095838288, delta = 0.0006877841660752892, c = 0.007982847541249588, d = 0.007396028901405245, m = 0.000708052078544013
[Iteration 10460] [Rank 1] a = 0.9786846041679382, b = 1.0000494602480574, delta = 0.000736451125703752, c = 0.0010989204961954374, d = 0.0010980914611497423, m = 0.0007080872185068592
[Iteration 10470] [Rank 1] a = 1.0000920295715332, b = 0.9998032541136285, delta = 0.0008016870706342161, c = 0.000606508222179596, d = 0.0006076826884943304, m = 0.0007081249271984938
[Iteration 10480] [Rank 1] a = 1.0116106271743774, b = 0.9998447749508751, delta = 0.0007545615080744028, c = 0.0006895498992566976, d = 0.0006905171068100082, m = 0.0007085267679965892
[Iteration 10490] [Rank 1] a = 1.0009466409683228, b = 0.9998431686955132, delta = 0.0007775771082378924, c = 0.00068633738845463, d = 0.0006875809410231723, m = 0.0007087902530173616
- reduce.gather.context          |  10424 |     0.00199s |   1.7%
- reduce.gather.tensors          |  10424 |     0.00376s |   3.2%
- reduce.heur_params             |  10424 |     0.01057s |   8.9%
[Iteration 10500] [Rank 3] a = 0.9828737378120422, b = 0.9998324085117658, delta = 0.0007481791544705629, c = 0.0006648170203934677, d = 0.0006657842279467783, m = 0.0006204027698077605
[Iteration 10510] [Rank 3] a = 0.9840517640113831, b = 0.9999487843047811, delta = 0.0007465981761924922, c = 0.0008975686094722989, d = 0.0008985358170256095, m = 0.0006205002852853311
[Iteration 10520] [Rank 3] a = 1.0112110376358032, b = 0.9998547751858881, delta = 0.0007232468924485147, c = 0.000709550369734086, d = 0.0007104830341604927, m = 0.0006211273095016261
[Iteration 10530] [Rank 3] a = 0.9497788548469543, b = 0.9999521522596458, delta = 0.0007029668777249753, c = 0.0009043045192185695, d = 0.0009047881229952249, m = 0.00062208666727212
[Iteration 10540] [Rank 3] a = 0.9400272965431213, b = 1.0001933323692438, delta = 0.0007134840125218034, c = 0.0013866647433053607, d = 0.0013825195680768863, m = 0.0006221778477117735
[Iteration 10500] [Rank 1] a = 1.0077852010726929, b = 0.9998016133151645, delta = 0.0007820597966201603, c = 0.0006032266251237205, d = 0.0006046774364536865, m = 0.0007089273697527187
[Iteration 10510] [Rank 1] a = 1.0404008626937866, b = 0.9997427691015544, delta = 0.000777861219830811, c = 0.00048553819176195477, d = 0.00048674720120359306, m = 0.0007092255013368037
[Iteration 10520] [Rank 1] a = 1.0874193906784058, b = 0.9997366722400689, delta = 0.0007697296096011996, c = 0.00047334446796485957, d = 0.0004742080461374584, m = 0.0007094957593520129
[Iteration 10530] [Rank 1] a = 1.0188835859298706, b = 0.9998533071030258, delta = 0.0007548157009296119, c = 0.00070661420394725, d = 0.0007079613858965042, m = 0.0007095422940358205
[Iteration 10540] [Rank 1] a = 0.968459963798523, b = 0.9998630828077429, delta = 0.0007942757220007479, c = 0.0007261656137748871, d = 0.0007273400800896215, m = 0.0007095137719121278
- reduce.heur_params.alpha       |  10423 |     0.00820s |   6.9%
- reduce.heur_params.beta        |  10423 |     0.00230s |   1.9%
- reduce.memory                  |  10424 |     0.00045s |   0.4%
- reduce.pad                     |  10424 |     0.00027s |   0.2%
- reduce.threshold               |  10424 |     0.00243s |   2.0%
- test.last                      |     74 |     0.41098s |   2.5%
- test.runavg                    |     74 |     0.44180s |   2.7%
-----------------------------------------------------------------

[Iteration 10430] [Rank 2] a = 0.9790573716163635, b = 0.9998239972606131, delta = 0.0007483058725483716, c = 0.0006479945175912428, d = 0.0006490308113983614, m = 0.0005836875542559942
[Iteration 10440] [Rank 2] a = 1.0829002857208252, b = 0.9997087613956783, delta = 0.0007825999055057764, c = 0.0004175227748880725, d = 0.0004185245255682871, m = 0.0005838511566320415
[Iteration 10550] [Rank 3] a = 1.06278395652771, b = 0.9997153764039319, delta = 0.0007698757108300924, c = 0.00043075279249228627, d = 0.00043154728441107716, m = 0.0006223675378019195
[Iteration 10560] [Rank 3] a = 0.9795675873756409, b = 0.9999519450008848, delta = 0.0007084238459356129, c = 0.0009038900016957221, d = 0.0009042699760916656, m = 0.0006226683872623889
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10563 |     0.11090s |  93.0%
- batch.accumulate               |  10563 |     0.00082s |   0.7%
- batch.backward                 |  10563 |     0.05175s |  43.4%
- batch.evaluate                 |  10563 |     0.00277s |   2.3%
- batch.forward                  |  10563 |     0.02537s |  21.3%
- batch.mom                      |  10563 |     0.00126s |   1.1%
- batch.reduce                   |  10563 |     0.02615s |  21.9%
[Iteration 10550] [Rank 1] a = 1.0027363300323486, b = 1.0000102537990614, delta = 0.0007109327125363052, c = 0.0010205075981234654, d = 0.0010203694256158496, m = 0.0007101783108091791
[Iteration 10560] [Rank 1] a = 1.082245111465454, b = 0.9996903153675776, delta = 0.0008215160924009979, c = 0.00038063071535465135, d = 0.0003813561210196343, m = 0.0007102255617749588
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10563 |     0.11078s |  92.9%
- batch.accumulate               |  10563 |     0.00083s |   0.7%
- batch.backward                 |  10563 |     0.05178s |  43.4%
- batch.evaluate                 |  10563 |     0.00275s |   2.3%
- batch.forward                  |  10563 |     0.02542s |  21.3%
- batch.mom                      |  10563 |     0.00126s |   1.1%
- batch.reduce                   |  10563 |     0.02597s |  21.8%
[Iteration 10450] [Rank 2] a = 1.0487163066864014, b = 0.9997797475167931, delta = 0.0007583525730296969, c = 0.0005594950264633168, d = 0.0005604967771435314, m = 0.0005840671612933694
[Iteration 10460] [Rank 2] a = 0.9401814341545105, b = 1.0000887357831547, delta = 0.0007431061821989715, c = 0.001177471566775025, d = 0.0011758480398105392, m = 0.0005842384290762291
[Iteration 10470] [Rank 2] a = 0.9820465445518494, b = 1.0000892712016174, delta = 0.0007360134040936828, c = 0.0011785424037090476, d = 0.0011759171260643472, m = 0.0005845061835164846
[Iteration 10480] [Rank 2] a = 0.9740553498268127, b = 1.0000344858025711, delta = 0.0007421922055073082, c = 0.0010689716051697105, d = 0.0010684880013930552, m = 0.0005848934067958783
[Iteration 10490] [Rank 2] a = 1.0337114334106445, b = 0.9998414415392108, delta = 0.0007061343058012426, c = 0.0006828830757642347, d = 0.0006837466539368336, m = 0.0005861757247863859
- batch.reporting.compr_err      |  10563 |     0.00001s |   0.0%
- batch.reporting.lr             |  10563 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10563 |     0.00001s |   0.0%
- batch.step                     |  10563 |     0.00047s |   0.4%
- batch.update_runavg            |  10563 |     0.00129s |   1.1%
- batch.reporting.compr_err      |  10563 |     0.00001s |   0.0%
- batch.reporting.lr             |  10563 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10563 |     0.00001s |   0.0%
- batch.step                     |  10563 |     0.00048s |   0.4%
- batch.update_runavg            |  10563 |     0.00130s |   1.1%
[Iteration 10500] [Rank 2] a = 1.0315730571746826, b = 0.9997217841534652, delta = 0.0007781895692460239, c = 0.0004435682925736526, d = 0.00044412098260411585, m = 0.0005862491568738875
[Iteration 10510] [Rank 2] a = 0.8371624946594238, b = 1.0028265128652094, delta = 0.0006522829644382, c = 0.006653040784828134, d = 0.006010055020637964, m = 0.0005872218325060617
[Iteration 10520] [Rank 2] a = 0.9946054220199585, b = 0.9997974681401027, delta = 0.0007437723106704652, c = 0.000594936274666772, d = 0.0005963870859967379, m = 0.0005873947755994719
[Iteration 10530] [Rank 2] a = 0.9755315780639648, b = 1.0001111542722905, delta = 0.0006946024368517101, c = 0.0012223085454963552, d = 0.001219579638470943, m = 0.0005877667602781524
[Iteration 10540] [Rank 2] a = 1.0142412185668945, b = 0.9998347056296414, delta = 0.0007367492071352899, c = 0.0006694112562716933, d = 0.0006705511794595238, m = 0.0005879909203829975
- batch.wd                       |  10563 |     0.00001s |   0.0%
- epoch_metrics.collect          |     75 |     0.00750s |   0.0%
- reduce.combine                 |  10563 |     0.00613s |   5.1%
- reduce.flatpack                |  10563 |     0.00002s |   0.0%
- reduce.flatput                 |  10563 |     0.00020s |   0.2%
- reduce.gather.context          |  10563 |     0.00248s |   2.1%
- reduce.gather.tensors          |  10563 |     0.00342s |   2.9%
- reduce.heur_params             |  10563 |     0.01052s |   8.8%
- reduce.heur_params.alpha       |  10562 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  10562 |     0.00234s |   2.0%
- reduce.memory                  |  10563 |     0.00045s |   0.4%
- reduce.pad                     |  10563 |     0.00026s |   0.2%
- reduce.threshold               |  10563 |     0.00248s |   2.1%
- test.last                      |     75 |     0.41086s |   2.5%
- test.runavg                    |     75 |     0.44165s |   2.7%
- batch.wd                       |  10563 |     0.00001s |   0.0%
- epoch_metrics.collect          |     75 |     0.00736s |   0.0%
- reduce.combine                 |  10563 |     0.00623s |   5.2%
- reduce.flatpack                |  10563 |     0.00002s |   0.0%
- reduce.flatput                 |  10563 |     0.00023s |   0.2%
- reduce.gather.context          |  10563 |     0.00126s |   1.1%
- reduce.gather.tensors          |  10563 |     0.00376s |   3.2%
- reduce.heur_params             |  10563 |     0.01093s |   9.2%
- reduce.heur_params.alpha       |  10562 |     0.00835s |   7.0%
- reduce.heur_params.beta        |  10562 |     0.00250s |   2.1%
- reduce.memory                  |  10563 |     0.00047s |   0.4%
- reduce.pad                     |  10563 |     0.00021s |   0.2%
- reduce.threshold               |  10563 |     0.00266s |   2.2%
- test.last                      |     75 |     0.41086s |   2.5%
- test.runavg                    |     75 |     0.44165s |   2.7%
[Iteration 10550] [Rank 2] a = 0.9734609723091125, b = 1.0001092544003336, delta = 0.0007218526443466544, c = 0.0012185088015369205, d = 0.0012158144376384122, m = 0.0005881893841937785
[Iteration 10560] [Rank 2] a = 0.91712886095047, b = 1.0001074581577558, delta = 0.0007219608523882926, c = 0.0012149163163389094, d = 0.0012135000481358473, m = 0.0005885574304952297
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10563 |     0.11086s |  93.0%
- batch.accumulate               |  10563 |     0.00082s |   0.7%
- batch.backward                 |  10563 |     0.05176s |  43.4%
- batch.evaluate                 |  10563 |     0.00274s |   2.3%
- batch.forward                  |  10563 |     0.02547s |  21.4%
- batch.mom                      |  10563 |     0.00126s |   1.1%
- batch.reduce                   |  10563 |     0.02605s |  21.8%
-----------------------------------------------------------------
-----------------------------------------------------------------
- batch.reporting.compr_err      |  10563 |     0.00001s |   0.0%
- batch.reporting.lr             |  10563 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10563 |     0.00001s |   0.0%
- batch.step                     |  10563 |     0.00048s |   0.4%
- batch.update_runavg            |  10563 |     0.00129s |   1.1%
- batch.wd                       |  10563 |     0.00001s |   0.0%
- epoch_metrics.collect          |     75 |     0.01246s |   0.1%
- reduce.combine                 |  10563 |     0.00613s |   5.1%
- reduce.flatpack                |  10563 |     0.00002s |   0.0%
- reduce.flatput                 |  10563 |     0.00019s |   0.2%
- reduce.gather.context          |  10563 |     0.00201s |   1.7%
- reduce.gather.tensors          |  10563 |     0.00377s |   3.2%
- reduce.heur_params             |  10563 |     0.01057s |   8.9%
- reduce.heur_params.alpha       |  10562 |     0.00819s |   6.9%
- reduce.heur_params.beta        |  10562 |     0.00230s |   1.9%
- reduce.memory                  |  10563 |     0.00045s |   0.4%
- reduce.pad                     |  10563 |     0.00027s |   0.2%
- reduce.threshold               |  10563 |     0.00243s |   2.0%
- test.last                      |     75 |     0.41085s |   2.5%
- test.runavg                    |     75 |     0.44166s |   2.7%
-----------------------------------------------------------------
last_perplexity                - bits:26377432640.000, epoch: 76.000, ratio_transmit_grad:  0.176, value:211.834 (split:train)
last_cross_entropy             - bits:26377432640.000, epoch: 76.000, ratio_transmit_grad:  0.176, value:  5.144 (split:test)
last_perplexity                - bits:26377432640.000, epoch: 76.000, ratio_transmit_grad:  0.176, value:171.959 (split:test)
runavg_cross_entropy           - bits:26377432640.000, epoch: 76.000, ratio_transmit_grad:  0.176, value:  5.345 (split:test)
runavg_perplexity              - bits:26377432640.000, epoch: 76.000, ratio_transmit_grad:  0.176, value:210.267 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10563 |     0.11081s |  92.9%
- batch.accumulate               |  10563 |     0.00082s |   0.7%
- batch.backward                 |  10563 |     0.05164s |  43.3%
- batch.evaluate                 |  10563 |     0.00275s |   2.3%
- batch.forward                  |  10563 |     0.02541s |  21.3%
- batch.mom                      |  10563 |     0.00126s |   1.1%
- batch.reduce                   |  10563 |     0.02612s |  21.9%
- batch.reporting.compr_err      |  10563 |     0.00001s |   0.0%
- batch.reporting.lr             |  10563 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10563 |     0.00001s |   0.0%
- batch.step                     |  10563 |     0.00048s |   0.4%
- batch.update_runavg            |  10563 |     0.00130s |   1.1%
- batch.wd                       |  10563 |     0.00001s |   0.0%
- epoch_metrics.collect          |     75 |     0.00826s |   0.1%
- reduce.combine                 |  10563 |     0.00640s |   5.4%
- reduce.flatpack                |  10563 |     0.00002s |   0.0%
- reduce.flatput                 |  10563 |     0.00020s |   0.2%
- reduce.gather.context          |  10563 |     0.00114s |   1.0%
- reduce.gather.tensors          |  10563 |     0.00386s |   3.2%
- reduce.heur_params             |  10563 |     0.01109s |   9.3%
- reduce.heur_params.alpha       |  10562 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  10562 |     0.00231s |   1.9%
- reduce.memory                  |  10563 |     0.00046s |   0.4%
- reduce.pad                     |  10563 |     0.00028s |   0.2%
- reduce.threshold               |  10563 |     0.00243s |   2.0%
- test.last                      |     75 |     0.41084s |   2.5%
- test.runavg                    |     75 |     0.44166s |   2.7%
-----------------------------------------------------------------

[Iteration 10570] [Rank 0] a = 0.8963114023208618, b = 0.9999938803569093, delta = 0.0007602472323924303, c = 0.0009877607138185185, d = 0.0009878298000723265, m = 0.0005419433797180663
[Iteration 10580] [Rank 0] a = 0.9567813873291016, b = 0.9999758661162336, delta = 0.0007630079053342342, c = 0.0009517322324576962, d = 0.0009520085774729277, m = 0.0005422448986196236
[Iteration 10590] [Rank 0] a = 1.0174418687820435, b = 0.9998568650450222, delta = 0.0007449979311786592, c = 0.0007137300880894642, d = 0.0007149045544041986, m = 0.0005429356006713899
[Iteration 10600] [Rank 0] a = 0.9758726358413696, b = 0.9999381450217287, delta = 0.0007566703134216368, c = 0.0008762900432994641, d = 0.0008769118195837353, m = 0.0005431931372326128
[Iteration 10610] [Rank 0] a = 1.0346771478652954, b = 0.9998296623332554, delta = 0.0007349039078690112, c = 0.0006593246632157392, d = 0.0006604300432766657, m = 0.0005436880675020534
[Iteration 10620] [Rank 0] a = 1.0061641931533813, b = 0.999816933191389, delta = 0.0007590449531562626, c = 0.0006338663786875263, d = 0.0006350063018753568, m = 0.000543921410070903
[Iteration 10630] [Rank 0] a = 1.028281569480896, b = 0.9997347032819731, delta = 0.000819209439214319, c = 0.00046940655149780897, d = 0.00047047738843183153, m = 0.0005441126870908724
[Iteration 10640] [Rank 0] a = 1.0843816995620728, b = 0.9996926124852977, delta = 0.0008078606333583593, c = 0.000385224951232877, d = 0.00038605398627857186, m = 0.0005443615919968947
[Iteration 10650] [Rank 0] a = 1.0245652198791504, b = 0.9998487992250649, delta = 0.0007582959369756281, c = 0.0006975984478253184, d = 0.0006990492591552845, m = 0.0005446861534775643
[Iteration 10660] [Rank 0] a = 1.041309118270874, b = 0.9997552909842683, delta = 0.0007567443535663188, c = 0.0005105819587673203, d = 0.0005117909682089586, m = 0.0005454399818659336
[Iteration 10670] [Rank 0] a = 1.0086359977722168, b = 0.9998092991606098, delta = 0.0007764208130538464, c = 0.0006185983165959793, d = 0.0006198764122914256, m = 0.0005455888654287015
[Iteration 10680] [Rank 0] a = 1.0002634525299072, b = 0.9999242759563425, delta = 0.0007330648950301111, c = 0.0008485519123955904, d = 0.0008493464043143813, m = 0.0005460304157180707
[Iteration 10690] [Rank 0] a = 0.9494335651397705, b = 0.9998677288582273, delta = 0.0007983021787367761, c = 0.0007354577149120503, d = 0.0007363558362115531, m = 0.0005461185487151093
[Iteration 10700] [Rank 0] a = 0.9410051107406616, b = 0.9999899942551329, delta = 0.000774744781665504, c = 0.0009799885102651292, d = 0.0009801957690265528, m = 0.0005464123844743534
cross_entropy                  - bits:26812870592.000, epoch: 77.000, ratio_transmit_grad:  0.169, value:  5.351 (split:train)
last_cross_entropy             - bits:26812870592.000, epoch: 77.000, ratio_transmit_grad:  0.169, value:  5.351 (split:train)
perplexity                     - bits:26812870592.000, epoch: 77.000, ratio_transmit_grad:  0.169, value:211.417 (split:train)
last_perplexity                - bits:26812870592.000, epoch: 77.000, ratio_transmit_grad:  0.169, value:211.417 (split:train)
last_cross_entropy             - bits:26812870592.000, epoch: 77.000, ratio_transmit_grad:  0.169, value:  5.143 (split:test)
last_perplexity                - bits:26812870592.000, epoch: 77.000, ratio_transmit_grad:  0.169, value:171.863 (split:test)
runavg_cross_entropy           - bits:26812870592.000, epoch: 77.000, ratio_transmit_grad:  0.169, value:  5.347 (split:test)
runavg_perplexity              - bits:26812870592.000, epoch: 77.000, ratio_transmit_grad:  0.169, value:210.684 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10702 |     0.11083s |  92.9%
- batch.accumulate               |  10702 |     0.00082s |   0.7%
- batch.backward                 |  10702 |     0.05164s |  43.3%
- batch.evaluate                 |  10702 |     0.00275s |   2.3%
- batch.forward                  |  10702 |     0.02540s |  21.3%
- batch.mom                      |  10702 |     0.00126s |   1.1%
- batch.reduce                   |  10702 |     0.02614s |  21.9%
- batch.reporting.compr_err      |  10702 |     0.00001s |   0.0%
- batch.reporting.lr             |  10702 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10702 |     0.00001s |   0.0%
- batch.step                     |  10702 |     0.00048s |   0.4%
- batch.update_runavg            |  10702 |     0.00130s |   1.1%
- batch.wd                       |  10702 |     0.00001s |   0.0%
- epoch_metrics.collect          |     76 |     0.00817s |   0.0%
- reduce.combine                 |  10702 |     0.00640s |   5.4%
- reduce.flatpack                |  10702 |     0.00002s |   0.0%
- reduce.flatput                 |  10702 |     0.00020s |   0.2%
- reduce.gather.context          |  10702 |     0.00114s |   1.0%
- reduce.gather.tensors          |  10702 |     0.00388s |   3.3%
- reduce.heur_params             |  10702 |     0.01110s |   9.3%
- reduce.heur_params.alpha       |  10701 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  10701 |     0.00231s |   1.9%
- reduce.memory                  |  10702 |     0.00046s |   0.4%
- reduce.pad                     |  10702 |     0.00028s |   0.2%
- reduce.threshold               |  10702 |     0.00244s |   2.0%
- test.last                      |     76 |     0.41071s |   2.5%
- test.runavg                    |     76 |     0.44166s |   2.7%
-----------------------------------------------------------------


[Iteration 10570] [Rank 2] a = 1.0355148315429688, b = 0.9998533071030258, delta = 0.0007413090788759291, c = 0.00070661420394725, d = 0.0007075468683736567, m = 0.0005888891230433175
[Iteration 10580] [Rank 2] a = 1.0401443243026733, b = 0.9997996961716974, delta = 0.000745051889680326, c = 0.0005993923380373819, d = 0.0006001522868292687, m = 0.0005892176879204695
[Iteration 10590] [Rank 2] a = 0.9417017102241516, b = 1.0006904251296584, delta = 0.0007057743496261537, c = 0.002380850478728014, d = 0.002351316105225135, m = 0.000589484015043773
[Iteration 10600] [Rank 2] a = 0.9545395970344543, b = 0.999917885477905, delta = 0.0007591316243633628, c = 0.000835770955441128, d = 0.0008361509298370715, m = 0.0005897840830573854
[Iteration 10610] [Rank 2] a = 1.0275907516479492, b = 0.9997758614152084, delta = 0.0007756238337606192, c = 0.0005517228229099275, d = 0.0005530009186053737, m = 0.0005901230898594918

[Iteration 10570] [Rank 3] a = 1.0161925554275513, b = 0.9998204565902172, delta = 0.0007410521502606571, c = 0.0006409131765759326, d = 0.0006420185566368591, m = 0.0006229041136066727
[Iteration 10580] [Rank 3] a = 0.9412496089935303, b = 0.9999660731397647, delta = 0.000728483428247273, c = 0.0009321462795031551, d = 0.0009323189951376749, m = 0.0006231397926713608
[Iteration 10590] [Rank 3] a = 1.0641443729400635, b = 0.9997168617582691, delta = 0.000790663412772119, c = 0.0004337235014060262, d = 0.0004348634245938566, m = 0.0006232524965899041
[Iteration 10600] [Rank 3] a = 0.9724633693695068, b = 0.9998906654941558, delta = 0.0007430763216689229, c = 0.000781330987440499, d = 0.0007821600224861938, m = 0.0006234829219794092
[Iteration 10610] [Rank 3] a = 0.989213228225708, b = 0.9998850004214149, delta = 0.0007308326894417405, c = 0.0007700008418160026, d = 0.0007711062218769291, m = 0.0006237498847154843

[Iteration 10570] [Rank 1] a = 0.9605658650398254, b = 0.9998657599000288, delta = 0.0008052193443290889, c = 0.0007315197984449997, d = 0.0007324524628714064, m = 0.000710367141005751
[Iteration 10580] [Rank 1] a = 1.0206457376480103, b = 0.9997247721337136, delta = 0.0008333696168847382, c = 0.00044954425352803636, d = 0.0004505805473351549, m = 0.0007104126355225045
[Iteration 10590] [Rank 1] a = 1.0350831747055054, b = 0.9997749632939543, delta = 0.0008151957299560308, c = 0.000549926580310922, d = 0.0005511355897525603, m = 0.0007103973759467379
[Iteration 10600] [Rank 1] a = 0.9529750347137451, b = 0.9999122376766971, delta = 0.0007625789730809629, c = 0.0008244753529435356, d = 0.0008252353017354225, m = 0.0007107303461353781
[Iteration 10610] [Rank 1] a = 1.0262149572372437, b = 0.9998207329352234, delta = 0.0007574472110718489, c = 0.0006414658666063958, d = 0.0006423639879058985, m = 0.0007119900403313426
[Iteration 10620] [Rank 2] a = 1.035992980003357, b = 0.9998417524273451, delta = 0.0007300086435861886, c = 0.0006835048520485059, d = 0.0006845066027287205, m = 0.0005904851841274415
[Iteration 10630] [Rank 2] a = 0.9357704520225525, b = 0.9999485943175836, delta = 0.0007544818799942732, c = 0.0008971886350763554, d = 0.0008978104113606265, m = 0.0005905813094854641
[Iteration 10640] [Rank 2] a = 1.016853928565979, b = 0.9997738924570747, delta = 0.0007665621233172715, c = 0.000547784906442877, d = 0.0005489248296307073, m = 0.0005909061977474309
[Iteration 10650] [Rank 2] a = 0.9884167313575745, b = 0.9999715827685005, delta = 0.0007441646885126829, c = 0.000943165536985516, d = 0.0009438563995235951, m = 0.0005910679049853103
[Iteration 10660] [Rank 2] a = 1.0295608043670654, b = 0.9998553451474701, delta = 0.0007228974718600512, c = 0.0007106902929219164, d = 0.0007114847848407073, m = 0.0005917480843515744
[Iteration 10620] [Rank 3] a = 0.932525634765625, b = 0.9999334471564891, delta = 0.0007756747072562575, c = 0.0008668943127815891, d = 0.00086768880470038, m = 0.0006238024739710213
[Iteration 10630] [Rank 3] a = 1.0546332597732544, b = 0.9997800411333576, delta = 0.0007448742398992181, c = 0.000560082259620684, d = 0.0005612221828085144, m = 0.0006241934453437248
[Iteration 10640] [Rank 3] a = 0.8929558992385864, b = 1.0001922615323497, delta = 0.0007326853810809553, c = 0.0013845230694373156, d = 0.001379790661051474, m = 0.0006242997828858826
[Iteration 10650] [Rank 3] a = 1.0044420957565308, b = 0.9998724785380966, delta = 0.0007397361914627254, c = 0.0007449570748106372, d = 0.0007460279117446597, m = 0.0006247227114844676
[Iteration 10660] [Rank 3] a = 1.0328059196472168, b = 0.9997397293065905, delta = 0.0007889409316703677, c = 0.00047945860142685915, d = 0.0004807712402492093, m = 0.0006248039256755343
[Iteration 10620] [Rank 1] a = 0.926003634929657, b = 1.0004268956982811, delta = 0.0007231407216750085, c = 0.0018537914484275087, d = 0.001841425008995894, m = 0.0007121190403621437
[Iteration 10630] [Rank 1] a = 1.0046557188034058, b = 0.9998408543060685, delta = 0.0007721461006440222, c = 0.0006817086094495004, d = 0.0006828830757642347, m = 0.0007121784612578099
[Iteration 10640] [Rank 1] a = 1.0114827156066895, b = 0.999926624888959, delta = 0.0007514515891671181, c = 0.000853249777654528, d = 0.0008541133558271268, m = 0.000712273206310545
[Iteration 10650] [Rank 1] a = 1.0076807737350464, b = 0.9999045000163357, delta = 0.0007380515453405678, c = 0.000809000032090565, d = 0.0008100363258976835, m = 0.0007126926851142485
[Iteration 10660] [Rank 1] a = 1.0077319145202637, b = 0.9998089710009161, delta = 0.0007837661541998386, c = 0.0006179419971848042, d = 0.0006189782909919228, m = 0.0007127237785330133
[Iteration 10670] [Rank 2] a = 1.1325466632843018, b = 0.9997233385940563, delta = 0.0007626407314091921, c = 0.0004466771739950083, d = 0.00044760983842141505, m = 0.0005923490394573967
[Iteration 10680] [Rank 2] a = 1.005463719367981, b = 0.9997785039642855, delta = 0.0007929785642772913, c = 0.0005570079213262322, d = 0.0005581478445140627, m = 0.0005924076052316826
[Iteration 10690] [Rank 2] a = 0.8849201202392578, b = 1.000352109839915, delta = 0.0007070175488479435, c = 0.001704219708933395, d = 0.0016966893072683333, m = 0.0005928023326949631
[Iteration 10700] [Rank 2] a = 0.9440085887908936, b = 0.9998663816763022, delta = 0.0007623605197295547, c = 0.000732763351013542, d = 0.0007337996448206606, m = 0.0005929875335721851
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10702 |     0.11089s |  93.0%
- batch.accumulate               |  10702 |     0.00082s |   0.7%
[Iteration 10670] [Rank 3] a = 0.9281814098358154, b = 1.001576126979617, delta = 0.0006962039042264223, c = 0.004152256569489597, d = 0.003981268091315032, m = 0.0006253003889038169
[Iteration 10680] [Rank 3] a = 1.0528494119644165, b = 0.9997149446148808, delta = 0.000820451881736517, c = 0.00042988921431968746, d = 0.0004305800768577665, m = 0.0006252468126003644
[Iteration 10690] [Rank 3] a = 1.0297346115112305, b = 0.9998032886567539, delta = 0.0007630805484950542, c = 0.0006065773084334039, d = 0.0006075099728598106, m = 0.0006254705022250894
[Iteration 10700] [Rank 3] a = 1.0148524045944214, b = 0.9997292281967521, delta = 0.0008104054722934961, c = 0.00045845638026925607, d = 0.0004593890446956628, m = 0.000625550710807505
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10702 |     0.11092s |  93.0%
- batch.accumulate               |  10702 |     0.00082s |   0.7%
[Iteration 10670] [Rank 1] a = 0.925793468952179, b = 1.0000092347768177, delta = 0.0007774824625812471, c = 0.001018469553636132, d = 0.0010182968380016125, m = 0.0007128428984870428
[Iteration 10680] [Rank 1] a = 0.9973170757293701, b = 0.9997918203390921, delta = 0.0007815613062120974, c = 0.0005836406721691795, d = 0.0005851260266260495, m = 0.0007131370756447853
[Iteration 10690] [Rank 1] a = 0.9404630064964294, b = 1.0007554698035999, delta = 0.0007278081029653549, c = 0.002510939894648299, d = 0.002475567732698652, m = 0.0007132962424415456
[Iteration 10700] [Rank 1] a = 0.9628360867500305, b = 0.9999032564637788, delta = 0.0007749319192953408, c = 0.0008065129269534803, d = 0.0008076873932682147, m = 0.0007133692752673274
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10702 |     0.11080s |  92.9%
- batch.accumulate               |  10702 |     0.00083s |   0.7%
- batch.backward                 |  10702 |     0.05176s |  43.4%
- batch.evaluate                 |  10702 |     0.00274s |   2.3%
- batch.forward                  |  10702 |     0.02546s |  21.3%
- batch.mom                      |  10702 |     0.00126s |   1.1%
- batch.reduce                   |  10702 |     0.02608s |  21.9%
- batch.reporting.compr_err      |  10702 |     0.00001s |   0.0%
- batch.reporting.lr             |  10702 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10702 |     0.00001s |   0.0%
- batch.step                     |  10702 |     0.00048s |   0.4%
- batch.update_runavg            |  10702 |     0.00129s |   1.1%
- batch.wd                       |  10702 |     0.00001s |   0.0%
- epoch_metrics.collect          |     76 |     0.01234s |   0.1%
- reduce.combine                 |  10702 |     0.00613s |   5.1%
- reduce.flatpack                |  10702 |     0.00002s |   0.0%
- reduce.flatput                 |  10702 |     0.00019s |   0.2%
- batch.backward                 |  10702 |     0.05175s |  43.4%
- batch.evaluate                 |  10702 |     0.00277s |   2.3%
- batch.forward                  |  10702 |     0.02537s |  21.3%
- batch.mom                      |  10702 |     0.00126s |   1.1%
- batch.reduce                   |  10702 |     0.02618s |  21.9%
- batch.reporting.compr_err      |  10702 |     0.00001s |   0.0%
- batch.reporting.lr             |  10702 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10702 |     0.00001s |   0.0%
- batch.step                     |  10702 |     0.00047s |   0.4%
- batch.update_runavg            |  10702 |     0.00129s |   1.1%
- batch.wd                       |  10702 |     0.00001s |   0.0%
- epoch_metrics.collect          |     76 |     0.00743s |   0.0%
- reduce.combine                 |  10702 |     0.00613s |   5.1%
- reduce.flatpack                |  10702 |     0.00002s |   0.0%
- reduce.flatput                 |  10702 |     0.00020s |   0.2%
- batch.backward                 |  10702 |     0.05178s |  43.4%
- batch.evaluate                 |  10702 |     0.00275s |   2.3%
- batch.forward                  |  10702 |     0.02542s |  21.3%
- batch.mom                      |  10702 |     0.00126s |   1.1%
- batch.reduce                   |  10702 |     0.02599s |  21.8%
- batch.reporting.compr_err      |  10702 |     0.00001s |   0.0%
- batch.reporting.lr             |  10702 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10702 |     0.00001s |   0.0%
- batch.step                     |  10702 |     0.00048s |   0.4%
- batch.update_runavg            |  10702 |     0.00130s |   1.1%
- batch.wd                       |  10702 |     0.00001s |   0.0%
- epoch_metrics.collect          |     76 |     0.00728s |   0.0%
- reduce.combine                 |  10702 |     0.00624s |   5.2%
- reduce.flatpack                |  10702 |     0.00002s |   0.0%
- reduce.flatput                 |  10702 |     0.00023s |   0.2%
- reduce.gather.context          |  10702 |     0.00202s |   1.7%
- reduce.gather.tensors          |  10702 |     0.00379s |   3.2%
- reduce.heur_params             |  10702 |     0.01057s |   8.9%
- reduce.gather.context          |  10702 |     0.00248s |   2.1%
- reduce.gather.tensors          |  10702 |     0.00343s |   2.9%
- reduce.heur_params             |  10702 |     0.01052s |   8.8%
- reduce.gather.context          |  10702 |     0.00125s |   1.1%
- reduce.gather.tensors          |  10702 |     0.00378s |   3.2%
- reduce.heur_params             |  10702 |     0.01093s |   9.2%
- reduce.heur_params.alpha       |  10701 |     0.00819s |   6.9%
- reduce.heur_params.beta        |  10701 |     0.00231s |   1.9%
- reduce.memory                  |  10702 |     0.00045s |   0.4%
- reduce.pad                     |  10702 |     0.00027s |   0.2%
- reduce.threshold               |  10702 |     0.00243s |   2.0%
- test.last                      |     76 |     0.41073s |   2.5%
- test.runavg                    |     76 |     0.44165s |   2.7%
-----------------------------------------------------------------

[Iteration 10710] [Rank 2] a = 1.0155190229415894, b = 0.9998166913895086, delta = 0.0007489888812415302, c = 0.000633382774910871, d = 0.0006344190687179895, m = 0.0005935690686044596
[Iteration 10720] [Rank 2] a = 1.1277531385421753, b = 0.9996931824468378, delta = 0.0007608497980982065, c = 0.00038636487442070743, d = 0.00038729753884711416, m = 0.0005941247898880511
- reduce.heur_params.alpha       |  10701 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  10701 |     0.00234s |   2.0%
- reduce.memory                  |  10702 |     0.00045s |   0.4%
- reduce.pad                     |  10702 |     0.00026s |   0.2%
- reduce.threshold               |  10702 |     0.00248s |   2.1%
- test.last                      |     76 |     0.41073s |   2.5%
- test.runavg                    |     76 |     0.44164s |   2.7%
-----------------------------------------------------------------

[Iteration 10710] [Rank 3] a = 0.9874817728996277, b = 0.9998600084695074, delta = 0.0007737318519502878, c = 0.0007200169371859835, d = 0.0007209496016123902, m = 0.0006264919483833517
[Iteration 10720] [Rank 3] a = 0.9809492230415344, b = 0.9999190599442119, delta = 0.0007624723366461694, c = 0.0008381198880705968, d = 0.0008392252681315233, m = 0.000626676526952333
- reduce.heur_params.alpha       |  10701 |     0.00835s |   7.0%
- reduce.heur_params.beta        |  10701 |     0.00250s |   2.1%
- reduce.memory                  |  10702 |     0.00047s |   0.4%
- reduce.pad                     |  10702 |     0.00021s |   0.2%
- reduce.threshold               |  10702 |     0.00266s |   2.2%
- test.last                      |     76 |     0.41073s |   2.5%
- test.runavg                    |     76 |     0.44165s |   2.7%
-----------------------------------------------------------------

[Iteration 10710] [Rank 1] a = 1.0893217325210571, b = 0.9997033035820991, delta = 0.0007991056190803647, c = 0.00040660714678642353, d = 0.00040726346619759864, m = 0.0007136059734186683
[Iteration 10720] [Rank 1] a = 0.9401901960372925, b = 1.0017806217141247, delta = 0.0007086042314767838, c = 0.004561247192032393, d = 0.004359549874040215, m = 0.0007140315615299105
[Iteration 10730] [Rank 2] a = 1.151526927947998, b = 0.9996431640045988, delta = 0.0008199829608201981, c = 0.00028632797890686134, d = 0.00028698429831803645, m = 0.0005943413287769401
[Iteration 10740] [Rank 2] a = 1.0768009424209595, b = 0.9997935647669257, delta = 0.0007263100706040859, c = 0.0005871295279864787, d = 0.0005880967355397894, m = 0.0005947936158299462
[Iteration 10750] [Rank 2] a = 0.9557963609695435, b = 0.9999237750810054, delta = 0.0007441520574502647, c = 0.0008475501617153758, d = 0.0008482064811265508, m = 0.0005949489725030207
[Iteration 10760] [Rank 2] a = 1.0231809616088867, b = 0.99975308022428, delta = 0.0007740134024061263, c = 0.0005061604385236143, d = 0.0005067822148078855, m = 0.0005952396930703778
[Iteration 10770] [Rank 2] a = 0.9587565064430237, b = 1.0001029502797447, delta = 0.0007439696928486228, c = 0.0012059005602169778, d = 0.0012038970588565485, m = 0.0005953960051692015
[Iteration 10730] [Rank 3] a = 1.0022059679031372, b = 0.9997628732001835, delta = 0.0008019508677534759, c = 0.0005257463914781553, d = 0.0005266445127776581, m = 0.0006268342272651922
[Iteration 10740] [Rank 3] a = 0.9327184557914734, b = 1.000120895433946, delta = 0.0007726157200522721, c = 0.0012417908690701843, d = 0.001239890997090467, m = 0.0006268841099715746
[Iteration 10750] [Rank 3] a = 1.1012376546859741, b = 0.9996457029241054, delta = 0.0008369147544726729, c = 0.0002914058185617423, d = 0.0002922003104805332, m = 0.0006273498054269877
[Iteration 10760] [Rank 3] a = 0.9945637583732605, b = 0.999856657786265, delta = 0.0007460429915226996, c = 0.0007133155705666168, d = 0.0007145591231351591, m = 0.0006277437418575163
[Iteration 10770] [Rank 3] a = 0.9598296880722046, b = 0.9999609953001166, delta = 0.0007218173705041409, c = 0.0009219906001933932, d = 0.0009223705745893367, m = 0.0006283161118224431
[Iteration 10730] [Rank 1] a = 1.0568941831588745, b = 0.9997890741606239, delta = 0.0007584653794765472, c = 0.0005781483149914511, d = 0.0005790809794178578, m = 0.0007141546199323005
[Iteration 10740] [Rank 1] a = 0.9676886200904846, b = 0.9999683011714475, delta = 0.0007645496516488492, c = 0.000936602342873765, d = 0.0009369132310159006, m = 0.0007141920899497792
[Iteration 10750] [Rank 1] a = 1.0560152530670166, b = 0.9996718866112487, delta = 0.0008479922544211149, c = 0.00034377319894813413, d = 0.000344602233993829, m = 0.0007143700082708268
[Iteration 10760] [Rank 1] a = 1.0780688524246216, b = 0.9997403165397082, delta = 0.0008052829653024673, c = 0.0004806330677415935, d = 0.0004814621027872884, m = 0.0007146691115842102
[Iteration 10770] [Rank 1] a = 0.9763563871383667, b = 1.0005628228691523, delta = 0.0007265690946951509, c = 0.002125645857161614, d = 0.0020935898353947463, m = 0.0007149411115579986
[Iteration 10780] [Rank 2] a = 1.0052686929702759, b = 0.9999183518101152, delta = 0.0007416909793391824, c = 0.0008367036198675347, d = 0.0008374290255325177, m = 0.0005956120748507477
[Iteration 10790] [Rank 2] a = 1.1711002588272095, b = 0.9996406768997809, delta = 0.000806272029876709, c = 0.0002813537686326922, d = 0.00028204463117077126, m = 0.0005961330718918268
[Iteration 10800] [Rank 2] a = 0.9338273406028748, b = 1.000257910741681, delta = 0.0007234613876789808, c = 0.0015158214947992386, d = 0.0015096037319565273, m = 0.0005963496805331435
[Iteration 10810] [Rank 2] a = 0.997767448425293, b = 0.9997748251214537, delta = 0.0007853479473851621, c = 0.0005496502352956904, d = 0.0005508247016104247, m = 0.0005964731067221558
[Iteration 10820] [Rank 2] a = 1.0717531442642212, b = 0.9997191243329016, delta = 0.0007896029273979366, c = 0.00043824865103044393, d = 0.0004392158585837546, m = 0.0005969274572094636
[Iteration 10780] [Rank 3] a = 1.0146844387054443, b = 0.9997635640626829, delta = 0.000769307604059577, c = 0.0005271281165543134, d = 0.0005285098416304715, m = 0.0006285386692847926
[Iteration 10790] [Rank 3] a = 0.9071953892707825, b = 1.001099449962032, delta = 0.0007035636226646602, c = 0.003198900810067415, d = 0.003147949697884085, m = 0.000628792671659542
[Iteration 10800] [Rank 3] a = 1.0068999528884888, b = 0.9997892468762507, delta = 0.0007782907341606915, c = 0.0005784937462604906, d = 0.0005794609538138013, m = 0.0006290940862783898
[Iteration 10810] [Rank 3] a = 1.0500378608703613, b = 0.9997226131884468, delta = 0.0007842208142392337, c = 0.0004452263626650423, d = 0.00044591722520312134, m = 0.000629257425794916
[Iteration 10820] [Rank 3] a = 0.9764422178268433, b = 0.9997365340675709, delta = 0.0008236494613811374, c = 0.00047306812294962795, d = 0.0004740007873760346, m = 0.0006293905426408207
[Iteration 10780] [Rank 1] a = 1.0022047758102417, b = 1.0000058150072544, delta = 0.0007426224765367806, c = 0.0010116300145091496, d = 0.0010115263851284378, m = 0.0007150207854098167
[Iteration 10790] [Rank 1] a = 1.0212072134017944, b = 0.9997427000153052, delta = 0.0008151931106112897, c = 0.00048540001925433894, d = 0.00048674720120359306, m = 0.000715000571556593
[Iteration 10800] [Rank 1] a = 0.8889338970184326, b = 1.0000066440423, delta = 0.0007954349275678396, c = 0.0010132880846005392, d = 0.0010132880846005392, m = 0.0007150795439173622
[Iteration 10810] [Rank 1] a = 0.9769312143325806, b = 0.999856657786265, delta = 0.0007653296925127506, c = 0.0007133155705666168, d = 0.0007144900368813512, m = 0.000715890782883831
[Iteration 10820] [Rank 1] a = 0.9508469104766846, b = 1.000210759376055, delta = 0.0007467132527381182, c = 0.0014215187583514486, d = 0.0014159573149199122, m = 0.0007159411418965288
[Iteration 10830] [Rank 2] a = 0.9307515621185303, b = 1.0000380610162012, delta = 0.0007272306247614324, c = 0.0010761220324388286, d = 0.0010756729717890773, m = 0.0005971769789690779
[Iteration 10840] [Rank 2] a = 1.0020776987075806, b = 0.9998075374612022, delta = 0.0007827921072021127, c = 0.0006150749176517762, d = 0.0006162839270934145, m = 0.0005972718374078076
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10841 |     0.11091s |  93.0%
- batch.accumulate               |  10841 |     0.00082s |   0.7%
- batch.backward                 |  10841 |     0.05175s |  43.4%
- batch.evaluate                 |  10841 |     0.00274s |   2.3%
- batch.forward                  |  10841 |     0.02546s |  21.3%
- batch.mom                      |  10841 |     0.00126s |   1.1%
- batch.reduce                   |  10841 |     0.02612s |  21.9%
[Iteration 10830] [Rank 3] a = 1.0214062929153442, b = 0.9998137552238221, delta = 0.0007523875683546066, c = 0.000627510443337199, d = 0.0006284431077636058, m = 0.0006296080030393016
[Iteration 10840] [Rank 3] a = 0.9844653606414795, b = 0.9998966241834795, delta = 0.0007668057223781943, c = 0.0007932483662223626, d = 0.0007941810306487694, m = 0.0006298724877614489
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10841 |     0.11095s |  93.0%
- batch.accumulate               |  10841 |     0.00082s |   0.7%
- batch.backward                 |  10841 |     0.05175s |  43.4%
- batch.evaluate                 |  10841 |     0.00277s |   2.3%
- batch.forward                  |  10841 |     0.02537s |  21.3%
- batch.mom                      |  10841 |     0.00126s |   1.1%
- batch.reduce                   |  10841 |     0.02620s |  22.0%
[Iteration 10830] [Rank 1] a = 1.0615017414093018, b = 0.9997790566542888, delta = 0.0007724885363131762, c = 0.0005581133013871587, d = 0.0005589768795597575, m = 0.0007161629116255972
[Iteration 10840] [Rank 1] a = 1.0874146223068237, b = 0.99969648131515, delta = 0.0008176176925189793, c = 0.00039296261165936233, d = 0.000393929819212673, m = 0.00071620323067862
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10841 |     0.11082s |  92.9%
- batch.accumulate               |  10841 |     0.00083s |   0.7%
- batch.backward                 |  10841 |     0.05178s |  43.4%
- batch.evaluate                 |  10841 |     0.00275s |   2.3%
- batch.forward                  |  10841 |     0.02542s |  21.3%
- batch.mom                      |  10841 |     0.00126s |   1.1%
- batch.reduce                   |  10841 |     0.02601s |  21.8%
- batch.reporting.compr_err      |  10841 |     0.00001s |   0.0%
- batch.reporting.lr             |  10841 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10841 |     0.00001s |   0.0%
- batch.step                     |  10841 |     0.00048s |   0.4%
- batch.update_runavg            |  10841 |     0.00129s |   1.1%
- batch.reporting.compr_err      |  10841 |     0.00001s |   0.0%
- batch.reporting.lr             |  10841 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10841 |     0.00001s |   0.0%
- batch.step                     |  10841 |     0.00047s |   0.4%
- batch.update_runavg            |  10841 |     0.00129s |   1.1%
- batch.reporting.compr_err      |  10841 |     0.00001s |   0.0%
- batch.reporting.lr             |  10841 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10841 |     0.00001s |   0.0%
- batch.step                     |  10841 |     0.00048s |   0.4%
- batch.update_runavg            |  10841 |     0.00130s |   1.1%
- batch.wd                       |  10841 |     0.00001s |   0.0%
- epoch_metrics.collect          |     77 |     0.01224s |   0.1%
- reduce.combine                 |  10841 |     0.00613s |   5.1%
- reduce.flatpack                |  10841 |     0.00002s |   0.0%
- reduce.flatput                 |  10841 |     0.00019s |   0.2%
- reduce.gather.context          |  10841 |     0.00203s |   1.7%
- reduce.gather.tensors          |  10841 |     0.00380s |   3.2%
- reduce.heur_params             |  10841 |     0.01057s |   8.9%
- reduce.heur_params.alpha       |  10840 |     0.00819s |   6.9%
- reduce.heur_params.beta        |  10840 |     0.00231s |   1.9%
- reduce.memory                  |  10841 |     0.00045s |   0.4%
- reduce.pad                     |  10841 |     0.00027s |   0.2%
- reduce.threshold               |  10841 |     0.00244s |   2.0%
- test.last                      |     77 |     0.41062s |   2.5%
- test.runavg                    |     77 |     0.44156s |   2.7%
- batch.wd                       |  10841 |     0.00001s |   0.0%
- epoch_metrics.collect          |     77 |     0.00738s |   0.0%
- reduce.combine                 |  10841 |     0.00614s |   5.1%
- reduce.flatpack                |  10841 |     0.00002s |   0.0%
- reduce.flatput                 |  10841 |     0.00020s |   0.2%
- reduce.gather.context          |  10841 |     0.00248s |   2.1%
- reduce.gather.tensors          |  10841 |     0.00345s |   2.9%
- reduce.heur_params             |  10841 |     0.01052s |   8.8%
- reduce.heur_params.alpha       |  10840 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  10840 |     0.00234s |   2.0%
- reduce.memory                  |  10841 |     0.00045s |   0.4%
- reduce.pad                     |  10841 |     0.00026s |   0.2%
- reduce.threshold               |  10841 |     0.00248s |   2.1%
- test.last                      |     77 |     0.41063s |   2.5%
- test.runavg                    |     77 |     0.44155s |   2.7%
- batch.wd                       |  10841 |     0.00001s |   0.0%
- epoch_metrics.collect          |     77 |     0.00720s |   0.0%
- reduce.combine                 |  10841 |     0.00624s |   5.2%
- reduce.flatpack                |  10841 |     0.00002s |   0.0%
- reduce.flatput                 |  10841 |     0.00023s |   0.2%
- reduce.gather.context          |  10841 |     0.00125s |   1.0%
- reduce.gather.tensors          |  10841 |     0.00379s |   3.2%
- reduce.heur_params             |  10841 |     0.01093s |   9.2%
- reduce.heur_params.alpha       |  10840 |     0.00835s |   7.0%
- reduce.heur_params.beta        |  10840 |     0.00250s |   2.1%
- reduce.memory                  |  10841 |     0.00047s |   0.4%
- reduce.pad                     |  10841 |     0.00021s |   0.2%
- reduce.threshold               |  10841 |     0.00266s |   2.2%
- test.last                      |     77 |     0.41062s |   2.5%
- test.runavg                    |     77 |     0.44156s |   2.7%
-----------------------------------------------------------------
-----------------------------------------------------------------
-----------------------------------------------------------------
[Iteration 10710] [Rank 0] a = 0.9772566556930542, b = 0.9998850695076679, delta = 0.0007744439644739032, c = 0.0007701390143236184, d = 0.0007711062218769291, m = 0.0005469409202314337
[Iteration 10720] [Rank 0] a = 0.8938660025596619, b = 1.0025508261640732, delta = 0.0007024560472927988, c = 0.006101663393187246, d = 0.0056789246061366766, m = 0.0005475553320675236
[Iteration 10730] [Rank 0] a = 1.1534658670425415, b = 0.9996557031581239, delta = 0.000806822266895324, c = 0.00031140628903913076, d = 0.0003120971515772098, m = 0.0005479312391244466
[Iteration 10740] [Rank 0] a = 1.0327212810516357, b = 0.9997737542845742, delta = 0.0007673531072214246, c = 0.0005475085614276453, d = 0.0005488902865038034, m = 0.0005481377956312245
[Iteration 10750] [Rank 0] a = 1.0255550146102905, b = 0.9997520266589738, delta = 0.0007815606077201664, c = 0.0005040533077824732, d = 0.000504916885955072, m = 0.0005484647740427856
[Iteration 10760] [Rank 0] a = 0.955803394317627, b = 1.0000882521793817, delta = 0.0007506705587729812, c = 0.0011765043592217143, d = 0.001174569944115093, m = 0.0005486975338654607
[Iteration 10770] [Rank 0] a = 1.0745351314544678, b = 0.9997257393411939, delta = 0.0007998516084626317, c = 0.0004514786686346577, d = 0.0004525149624417763, m = 0.0005490434231029733
[Iteration 10780] [Rank 0] a = 1.10565185546875, b = 0.9997165335985899, delta = 0.0007660308619961143, c = 0.0004330671819948511, d = 0.00043389621704054593, m = 0.0005499091821865279
[Iteration 10790] [Rank 0] a = 1.02259361743927, b = 0.9999562628917388, delta = 0.0007004993967711926, c = 0.0009125257834217102, d = 0.0009128021284369418, m = 0.0005516943010620248
[Iteration 10800] [Rank 0] a = 1.0113282203674316, b = 0.9999364178653902, delta = 0.0007140865782275796, c = 0.0008728357306090689, d = 0.0008731811618781085, m = 0.0005519168125820514
[Iteration 10810] [Rank 0] a = 1.0360122919082642, b = 0.9997937720256782, delta = 0.000742909440305084, c = 0.0005875440455093262, d = 0.0005888221412047724, m = 0.0005522487404993281
[Iteration 10820] [Rank 0] a = 1.0212841033935547, b = 0.999795032849757, delta = 0.0007655990775674582, c = 0.0005900656937733147, d = 0.0005910674444535292, m = 0.0005523726333629881
[Iteration 10830] [Rank 0] a = 0.9994648098945618, b = 0.9998525816973767, delta = 0.000779811292886734, c = 0.000705163392617284, d = 0.0007062687726782105, m = 0.00055259895729069
[Iteration 10840] [Rank 0] a = 1.0102671384811401, b = 0.9998885583634405, delta = 0.000716600043233484, c = 0.0007771167259582168, d = 0.0007779457610039117, m = 0.0005532779136342471
cross_entropy                  - bits:27274255488.000, epoch: 78.000, ratio_transmit_grad:  0.179, value:  5.350 (split:train)
last_cross_entropy             - bits:27274255488.000, epoch: 78.000, ratio_transmit_grad:  0.179, value:  5.350 (split:train)
perplexity                     - bits:27274255488.000, epoch: 78.000, ratio_transmit_grad:  0.179, value:211.211 (split:train)
last_perplexity                - bits:27274255488.000, epoch: 78.000, ratio_transmit_grad:  0.179, value:211.211 (split:train)
last_cross_entropy             - bits:27274255488.000, epoch: 78.000, ratio_transmit_grad:  0.179, value:  5.142 (split:test)
last_perplexity                - bits:27274255488.000, epoch: 78.000, ratio_transmit_grad:  0.179, value:171.677 (split:test)
runavg_cross_entropy           - bits:27274255488.000, epoch: 78.000, ratio_transmit_grad:  0.179, value:  5.343 (split:test)
runavg_perplexity              - bits:27274255488.000, epoch: 78.000, ratio_transmit_grad:  0.179, value:209.724 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10841 |     0.11085s |  92.9%
- batch.accumulate               |  10841 |     0.00082s |   0.7%
- batch.backward                 |  10841 |     0.05164s |  43.3%
- batch.evaluate                 |  10841 |     0.00275s |   2.3%
- batch.forward                  |  10841 |     0.02540s |  21.3%
- batch.mom                      |  10841 |     0.00126s |   1.1%
- batch.reduce                   |  10841 |     0.02617s |  21.9%
- batch.reporting.compr_err      |  10841 |     0.00001s |   0.0%
- batch.reporting.lr             |  10841 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10841 |     0.00001s |   0.0%
- batch.step                     |  10841 |     0.00048s |   0.4%
- batch.update_runavg            |  10841 |     0.00130s |   1.1%
- batch.wd                       |  10841 |     0.00001s |   0.0%
- epoch_metrics.collect          |     77 |     0.00807s |   0.0%
- reduce.combine                 |  10841 |     0.00641s |   5.4%
- reduce.flatpack                |  10841 |     0.00002s |   0.0%
- reduce.flatput                 |  10841 |     0.00020s |   0.2%
- reduce.gather.context          |  10841 |     0.00113s |   1.0%
- reduce.gather.tensors          |  10841 |     0.00390s |   3.3%
- reduce.heur_params             |  10841 |     0.01110s |   9.3%
- reduce.heur_params.alpha       |  10840 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  10840 |     0.00232s |   1.9%
- reduce.memory                  |  10841 |     0.00046s |   0.4%
- reduce.pad                     |  10841 |     0.00028s |   0.2%
- reduce.threshold               |  10841 |     0.00244s |   2.0%
- test.last                      |     77 |     0.41061s |   2.5%
- test.runavg                    |     77 |     0.44157s |   2.7%
-----------------------------------------------------------------

[Iteration 10850] [Rank 0] a = 1.0326968431472778, b = 0.9998193512101922, delta = 0.0007367423386313021, c = 0.0006387024164540797, d = 0.0006395314514997745, m = 0.0005541427518361626
[Iteration 10860] [Rank 0] a = 1.182085633277893, b = 0.9996367907985114, delta = 0.0008192657260224223, c = 0.0002735815650793029, d = 0.0002741687982366701, m = 0.0005544992175909703
[Iteration 10870] [Rank 0] a = 1.0185803174972534, b = 0.9997602651942505, delta = 0.0007743361638858914, c = 0.0005205303793156585, d = 0.000521601216249681, m = 0.0005546698368464507
memory_norm                    - epoch: 78.237, value:  1.240 (weight:encoder.weight)
memory_inf_norm                - epoch: 78.237, value:  0.001 (weight:encoder.weight)
memory_norm                    - epoch: 78.237, value:  0.387 (weight:rnn.weight_ih_l0)
memory_inf_norm                - epoch: 78.237, value:  0.001 (weight:rnn.weight_ih_l0)
memory_norm                    - epoch: 78.237, value:  0.364 (weight:rnn.weight_hh_l0)
memory_inf_norm                - epoch: 78.237, value:  0.001 (weight:rnn.weight_hh_l0)
memory_norm                    - epoch: 78.237, value:  0.017 (weight:rnn.bias_ih_l0)
memory_inf_norm                - epoch: 78.237, value:  0.001 (weight:rnn.bias_ih_l0)
memory_norm                    - epoch: 78.237, value:  0.017 (weight:rnn.bias_hh_l0)
memory_inf_norm                - epoch: 78.237, value:  0.001 (weight:rnn.bias_hh_l0)
memory_norm                    - epoch: 78.237, value:  0.306 (weight:rnn.weight_ih_l1)
memory_inf_norm                - epoch: 78.237, value:  0.001 (weight:rnn.weight_ih_l1)
memory_norm                    - epoch: 78.237, value:  0.237 (weight:rnn.weight_hh_l1)
memory_inf_norm                - epoch: 78.237, value:  0.001 (weight:rnn.weight_hh_l1)
memory_norm                    - epoch: 78.237, value:  0.015 (weight:rnn.bias_ih_l1)
memory_inf_norm                - epoch: 78.237, value:  0.001 (weight:rnn.bias_ih_l1)
memory_norm                    - epoch: 78.237, value:  0.015 (weight:rnn.bias_hh_l1)
memory_inf_norm                - epoch: 78.237, value:  0.001 (weight:rnn.bias_hh_l1)
memory_norm                    - epoch: 78.237, value:  0.275 (weight:rnn.weight_ih_l2)
memory_inf_norm                - epoch: 78.237, value:  0.001 (weight:rnn.weight_ih_l2)
memory_norm                    - epoch: 78.237, value:  0.219 (weight:rnn.weight_hh_l2)
memory_inf_norm                - epoch: 78.237, value:  0.001 (weight:rnn.weight_hh_l2)
memory_norm                    - epoch: 78.237, value:  0.017 (weight:rnn.bias_ih_l2)
memory_inf_norm                - epoch: 78.237, value:  0.001 (weight:rnn.bias_ih_l2)
memory_norm                    - epoch: 78.237, value:  0.017 (weight:rnn.bias_hh_l2)
memory_inf_norm                - epoch: 78.237, value:  0.001 (weight:rnn.bias_hh_l2)
memory_norm                    - epoch: 78.237, value:  0.060 (weight:decoder.bias)
memory_inf_norm                - epoch: 78.237, value:  0.001 (weight:decoder.bias)
memory_norm                    - epoch: 78.237, value:  1.449 (weight:entire_model)
memory_inf_norm                - epoch: 78.237, value:  0.001 (weight:entire_model)
[Iteration 10880] [Rank 0] a = 1.021841049194336, b = 0.9998645336190459, delta = 0.0007256324170157313, c = 0.0007290672364348191, d = 0.0007303107890033613, m = 0.0005550638426520807
[Iteration 10890] [Rank 0] a = 0.974937915802002, b = 0.99978724337498, delta = 0.0008043796988204122, c = 0.0005744867435396321, d = 0.0005754884942198468, m = 0.0005552309722577525
[Iteration 10900] [Rank 0] a = 0.9122784733772278, b = 1.0002122274588827, delta = 0.0007275814423337579, c = 0.0014244549241382845, d = 0.001419860688260059, m = 0.0005555790666356861
[Iteration 10910] [Rank 0] a = 0.8819708228111267, b = 1.0000674744886757, delta = 0.0007553072646260262, c = 0.0011349489775562597, d = 0.0011342235718912767, m = 0.0005557634126561108
[Iteration 10920] [Rank 0] a = 1.005786418914795, b = 0.9999108214085053, delta = 0.0007497442420572042, c = 0.0008216428165374115, d = 0.000822748196598338, m = 0.0005559634733041917
[Iteration 10930] [Rank 0] a = 0.9299361705780029, b = 1.0001523814935287, delta = 0.0007711371290497482, c = 0.0013047629894160895, d = 0.0013017231942485418, m = 0.0005560519321518901
[Iteration 10940] [Rank 0] a = 0.9799224138259888, b = 0.9998392135075825, delta = 0.0007681187125854194, c = 0.0006784270123936249, d = 0.000679774194342879, m = 0.0005564090632905846
[Iteration 10950] [Rank 0] a = 1.0191363096237183, b = 0.9997599888492513, delta = 0.0007741849403828382, c = 0.0005199776892851952, d = 0.0005207376380770822, m = 0.0005567917831106726
[Iteration 10960] [Rank 0] a = 1.0124480724334717, b = 0.9998574004634782, delta = 0.0007641457486897707, c = 0.0007148009250234868, d = 0.0007157681325767974, m = 0.0005569798386874359
[Iteration 10970] [Rank 0] a = 0.961663544178009, b = 0.9999175400466382, delta = 0.0008056203369051218, c = 0.000835080092903049, d = 0.0008359091279487439, m = 0.0005570288877542741
[Iteration 10980] [Rank 0] a = 0.8984857201576233, b = 1.0004360668967667, delta = 0.0007415311993099749, c = 0.0018721338488135075, d = 0.0018625308595342088, m = 0.000557490735527725
cross_entropy                  - bits:27745774144.000, epoch: 79.000, ratio_transmit_grad:  0.183, value:  5.348 (split:train)
last_cross_entropy             - bits:27745774144.000, epoch: 79.000, ratio_transmit_grad:  0.183, value:  5.348 (split:train)
perplexity                     - bits:27745774144.000, epoch: 79.000, ratio_transmit_grad:  0.183, value:210.722 (split:train)
last_perplexity                - bits:27745774144.000, epoch: 79.000, ratio_transmit_grad:  0.183, value:210.722 (split:train)
last_cross_entropy             - bits:27745774144.000, epoch: 79.000, ratio_transmit_grad:  0.183, value:  5.141 (split:test)
last_perplexity                - bits:27745774144.000, epoch: 79.000, ratio_transmit_grad:  0.183, value:171.455 (split:test)
runavg_cross_entropy           - bits:27745774144.000, epoch: 79.000, ratio_transmit_grad:  0.183, value:  5.342 (split:test)
runavg_perplexity              - bits:27745774144.000, epoch: 79.000, ratio_transmit_grad:  0.183, value:209.498 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10980 |     0.11087s |  92.9%
- batch.accumulate               |  10980 |     0.00082s |   0.7%
- batch.backward                 |  10980 |     0.05164s |  43.3%
- batch.evaluate                 |  10980 |     0.00275s |   2.3%
- batch.forward                  |  10980 |     0.02540s |  21.3%
- batch.mom                      |  10980 |     0.00126s |   1.1%
- batch.reduce                   |  10980 |     0.02619s |  22.0%
- batch.reporting.compr_err      |  10980 |     0.00001s |   0.0%
- batch.reporting.lr             |  10980 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10980 |     0.00001s |   0.0%
- batch.step                     |  10980 |     0.00048s |   0.4%
- batch.update_runavg            |  10980 |     0.00130s |   1.1%
- batch.wd                       |  10980 |     0.00001s |   0.0%
- epoch_metrics.collect          |     78 |     0.00798s |   0.0%
- reduce.combine                 |  10980 |     0.00641s |   5.4%
- reduce.flatpack                |  10980 |     0.00002s |   0.0%
- reduce.flatput                 |  10980 |     0.00020s |   0.2%
- reduce.gather.context          |  10980 |     0.00113s |   0.9%
- reduce.gather.tensors          |  10980 |     0.00391s |   3.3%
- reduce.heur_params             |  10980 |     0.01111s |   9.3%
- reduce.heur_params.alpha       |  10979 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  10979 |     0.00232s |   1.9%
- reduce.memory                  |  10980 |     0.00046s |   0.4%
- reduce.pad                     |  10980 |     0.00028s |   0.2%
- reduce.threshold               |  10980 |     0.00245s |   2.0%
- test.last                      |     78 |     0.41056s |   2.5%
- test.runavg                    |     78 |     0.44144s |   2.7%
-----------------------------------------------------------------

[Iteration 10990] [Rank 0] a = 1.1060993671417236, b = 0.9997069651532328, delta = 0.0007816029246896505, c = 0.00041393028969006145, d = 0.00041517384225860375, m = 0.0005580820425444514
rel_compression_error          - epoch: 79.101, value:  0.911 (weight:encoder.weight)
rel_compression_error          - epoch: 79.101, value:  0.907 (weight:rnn.weight_ih_l0)
rel_compression_error          - epoch: 79.101, value:  0.914 (weight:rnn.weight_hh_l0)
rel_compression_error          - epoch: 79.101, value:  0.814 (weight:rnn.bias_ih_l0)
rel_compression_error          - epoch: 79.101, value:  0.814 (weight:rnn.bias_hh_l0)
rel_compression_error          - epoch: 79.101, value:  0.920 (weight:rnn.weight_ih_l1)
rel_compression_error          - epoch: 79.101, value:  0.944 (weight:rnn.weight_hh_l1)
rel_compression_error          - epoch: 79.101, value:  0.802 (weight:rnn.bias_ih_l1)
rel_compression_error          - epoch: 79.101, value:  0.802 (weight:rnn.bias_hh_l1)
rel_compression_error          - epoch: 79.101, value:  0.919 (weight:rnn.weight_ih_l2)
rel_compression_error          - epoch: 79.101, value:  0.920 (weight:rnn.weight_hh_l2)
rel_compression_error          - epoch: 79.101, value:  0.712 (weight:rnn.bias_ih_l2)
rel_compression_error          - epoch: 79.101, value:  0.712 (weight:rnn.bias_hh_l2)
rel_compression_error          - epoch: 79.101, value:  0.784 (weight:decoder.bias)
rel_compression_error          - epoch: 79.101, value:  0.913 (weight:entire_model)
[Iteration 11000] [Rank 0] a = 0.947117805480957, b = 0.9999322208754895, delta = 0.0007392451516352594, c = 0.0008644417507714084, d = 0.0008647180957866401, m = 0.0005595752126129153
[Iteration 11010] [Rank 0] a = 1.088228464126587, b = 0.9997426482006182, delta = 0.0007379196467809379, c = 0.00048529638987362706, d = 0.000486090881792418, m = 0.000559985764112515
[Iteration 11020] [Rank 0] a = 1.0706323385238647, b = 0.9997210242047323, delta = 0.0007818126468919218, c = 0.0004420483949898787, d = 0.0004427738006548617, m = 0.000560120447939184
[Iteration 11030] [Rank 0] a = 0.9839175939559937, b = 1.0000004953657113, delta = 0.0007043745717965066, c = 0.0010009907314227323, d = 0.0010009907314227323, m = 0.000560628771282061
[Iteration 11040] [Rank 0] a = 1.0575528144836426, b = 0.9998740329787822, delta = 0.0006920411251485348, c = 0.0007480659562319929, d = 0.0007488259050238798, m = 0.0005614426193301512
[Iteration 11050] [Rank 0] a = 1.0437265634536743, b = 0.9998261389344155, delta = 0.0007305465405806899, c = 0.0006522778653273329, d = 0.0006530378141192198, m = 0.0005616967155369133
[Iteration 11060] [Rank 0] a = 0.9259094595909119, b = 1.0003672051844192, delta = 0.0006606471142731607, c = 0.0017344104018474492, d = 0.0017240820069031675, m = 0.0005624134756640457

[Iteration 10850] [Rank 3] a = 0.9853041768074036, b = 0.9997972090666615, delta = 0.0007822181796655059, c = 0.0005944181277632126, d = 0.0005960416547276984, m = 0.0006301970556447017
[Iteration 10860] [Rank 3] a = 0.9448177814483643, b = 0.9999807712402516, delta = 0.0007378082955256104, c = 0.0009615424804984186, d = 0.0009616806530060345, m = 0.000630960535538745
[Iteration 10870] [Rank 3] a = 1.0275901556015015, b = 0.9997596952326895, delta = 0.0007796442368999124, c = 0.0005193904561278281, d = 0.0005202540343004269, m = 0.000631056701563433
[Iteration 10880] [Rank 3] a = 1.0538277626037598, b = 0.9997725107320695, delta = 0.0007712903316132724, c = 0.0005450214562905608, d = 0.0005458850344631596, m = 0.0006312114944624108
[Iteration 10890] [Rank 3] a = 1.1022446155548096, b = 0.999696982190444, delta = 0.0007918350747786462, c = 0.000393964362339577, d = 0.00039486248363907974, m = 0.0006314343059436948

[Iteration 10850] [Rank 1] a = 0.9585906267166138, b = 1.0000826734644275, delta = 0.0007678837282583117, c = 0.0011653469292317376, d = 0.0011634470572520204, m = 0.0007163757045082673
[Iteration 10860] [Rank 1] a = 0.8902564644813538, b = 1.0000833470553976, delta = 0.0007524065440520644, c = 0.001166694111180992, d = 0.0011655541879931615, m = 0.0007166512484004935
[Iteration 10870] [Rank 1] a = 0.9631971120834351, b = 1.0001903443888767, delta = 0.0007372326799668372, c = 0.001380688782350977, d = 0.0013753691408077682, m = 0.0007168849105032561
[Iteration 10880] [Rank 1] a = 1.009578824043274, b = 0.999730212675797, delta = 0.0007903651567175984, c = 0.00046042533850278134, d = 0.0004619797792134592, m = 0.000717636175736522
[Iteration 10890] [Rank 1] a = 1.0846881866455078, b = 0.9997058943163907, delta = 0.0007889832486398518, c = 0.0004117886158220164, d = 0.000412790366502231, m = 0.0007177709964229019
[Iteration 10900] [Rank 3] a = 1.0239253044128418, b = 0.9998016824014154, delta = 0.0007496362086385489, c = 0.0006033647976313363, d = 0.0006044701776922628, m = 0.0006317812489490552
[Iteration 10910] [Rank 3] a = 0.9690593481063843, b = 0.9999370569132353, delta = 0.0007486395188607275, c = 0.0008741138263045152, d = 0.0008748046888425942, m = 0.0006318914717292791
[Iteration 10920] [Rank 3] a = 0.9369586706161499, b = 0.9998186603476769, delta = 0.0007923753000795841, c = 0.0006373206913779215, d = 0.0006381842695505203, m = 0.0006319582955588822
[Iteration 10930] [Rank 3] a = 1.0055413246154785, b = 0.9998450512958837, delta = 0.0007724505849182606, c = 0.0006901025892871608, d = 0.0006913115987287991, m = 0.0006323070176906374
[Iteration 10940] [Rank 3] a = 1.0892513990402222, b = 0.9996792270249432, delta = 0.0008214861736632884, c = 0.00035845402788231394, d = 0.00035921397667420087, m = 0.0006326529775550457
[Iteration 10900] [Rank 1] a = 1.120769739151001, b = 0.9996905226263191, delta = 0.0008108613546937704, c = 0.0003810452328774988, d = 0.0003817706385424818, m = 0.0007179845807009242
[Iteration 10910] [Rank 1] a = 0.9764097929000854, b = 0.9997907667737673, delta = 0.0008012583130039275, c = 0.0005815335414280384, d = 0.0005824316627275411, m = 0.0007181370483624399
[Iteration 10920] [Rank 1] a = 0.9522519707679749, b = 0.9999617897920341, delta = 0.0007516121258959174, c = 0.000923579584030975, d = 0.0009238559290462066, m = 0.0007184026366935396
[Iteration 10930] [Rank 1] a = 1.0813590288162231, b = 0.9997712499080031, delta = 0.0007442893111146986, c = 0.0005424998080265722, d = 0.0005435015587067868, m = 0.0007191522055744195
[Iteration 10940] [Rank 1] a = 1.0266287326812744, b = 0.9999216852218401, delta = 0.000712492095772177, c = 0.0008433704433599976, d = 0.0008438885902635568, m = 0.0007193959281057914

[Iteration 10850] [Rank 2] a = 1.0160797834396362, b = 0.9999500451289097, delta = 0.0007322521996684372, c = 0.0009000902577362874, d = 0.0009005738615129427, m = 0.0005976441839532597
[Iteration 10860] [Rank 2] a = 0.9458956718444824, b = 1.0009799654153753, delta = 0.0006978422752581537, c = 0.002959931458145872, d = 0.002858340121921348, m = 0.0005981889198688384
[Iteration 10870] [Rank 2] a = 1.004584789276123, b = 0.9998684197207535, delta = 0.0007576346979476511, c = 0.0007368394399882084, d = 0.0007380139063029428, m = 0.0005982517952276436
[Iteration 10880] [Rank 2] a = 0.9758384823799133, b = 1.0001491517112364, delta = 0.0007287082844413817, c = 0.0012983034246850504, d = 0.0012949181982484632, m = 0.0005985670712750818
[Iteration 10890] [Rank 2] a = 0.9299335479736328, b = 1.0000737613377408, delta = 0.000745234137866646, c = 0.0011475226757492983, d = 0.0011464172956883718, m = 0.0005987810886687455
[Iteration 10950] [Rank 3] a = 0.9704108238220215, b = 0.9998024596217405, delta = 0.0007826019427739084, c = 0.0006049192383420142, d = 0.0006059900752760368, m = 0.0006328511085258129
[Iteration 10960] [Rank 3] a = 1.0361223220825195, b = 0.9997817337464947, delta = 0.0007637632661499083, c = 0.0005634674860572714, d = 0.0005645728661181978, m = 0.0006332251642126954
[Iteration 10970] [Rank 3] a = 1.0483710765838623, b = 0.9998331339174104, delta = 0.0007211031625047326, c = 0.0006662678317234336, d = 0.0006674077549112641, m = 0.0006338345779782278
[Iteration 10980] [Rank 3] a = 0.9673550724983215, b = 1.000060773122084, delta = 0.0007657946553081274, c = 0.001121546244317526, d = 0.0011209590111601589, m = 0.0006340716619381878
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10980 |     0.11097s |  93.0%
- batch.accumulate               |  10980 |     0.00082s |   0.7%
[Iteration 10950] [Rank 1] a = 0.9614699482917786, b = 0.9998896464719245, delta = 0.0007615437498316169, c = 0.0007792929429531659, d = 0.000779914719237437, m = 0.0007195198738601992
[Iteration 10960] [Rank 1] a = 0.8919712901115417, b = 1.0066679972513122, delta = 0.0006676867487840354, c = 0.014336192157059032, d = 0.01250388653356578, m = 0.0007206644577275
[Iteration 10970] [Rank 1] a = 1.0137289762496948, b = 0.9998616147248773, delta = 0.0007301367004401982, c = 0.0007232294479880511, d = 0.0007242311986682657, m = 0.0007211610133575323
[Iteration 10980] [Rank 1] a = 0.9844450950622559, b = 1.000002550681762, delta = 0.0007481272332370281, c = 0.0010051013635243027, d = 0.0010050668203973987, m = 0.0007216379758877069
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10980 |     0.11084s |  92.9%
- batch.accumulate               |  10980 |     0.00083s |   0.7%
[Iteration 10900] [Rank 2] a = 1.0267775058746338, b = 0.999774116987388, delta = 0.0007845210493542254, c = 0.0005482339670926283, d = 0.0005494084334073627, m = 0.0005989382611716956
[Iteration 10910] [Rank 2] a = 1.0875424146652222, b = 0.9996485181885976, delta = 0.0008668352966196835, c = 0.0002970363482470866, d = 0.0002977272107851656, m = 0.0005990331825950177
[Iteration 10920] [Rank 2] a = 0.9676885008811951, b = 1.0000113246359952, delta = 0.0007581700338050723, c = 0.0010226492719915103, d = 0.0010225456426107985, m = 0.000599335714004981
[Iteration 10930] [Rank 2] a = 0.9761461615562439, b = 1.0005121999313114, delta = 0.0007319367141462862, c = 0.0020243999522061296, d = 0.0019875078926727087, m = 0.0005995975648501625
[Iteration 10940] [Rank 2] a = 1.09401273727417, b = 0.9997057734154571, delta = 0.0008159060380421579, c = 0.0004115468139336887, d = 0.00041241039210628753, m = 0.000599881959472374
- batch.backward                 |  10980 |     0.05175s |  43.4%
- batch.evaluate                 |  10980 |     0.00277s |   2.3%
- batch.forward                  |  10980 |     0.02537s |  21.3%
- batch.mom                      |  10980 |     0.00126s |   1.1%
- batch.reduce                   |  10980 |     0.02623s |  22.0%
- batch.reporting.compr_err      |  10980 |     0.00001s |   0.0%
- batch.reporting.lr             |  10980 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10980 |     0.00001s |   0.0%
- batch.step                     |  10980 |     0.00047s |   0.4%
- batch.update_runavg            |  10980 |     0.00129s |   1.1%
- batch.wd                       |  10980 |     0.00001s |   0.0%
- epoch_metrics.collect          |     78 |     0.00734s |   0.0%
- reduce.combine                 |  10980 |     0.00614s |   5.1%
- reduce.flatpack                |  10980 |     0.00002s |   0.0%
- reduce.flatput                 |  10980 |     0.00020s |   0.2%
- batch.backward                 |  10980 |     0.05178s |  43.4%
- batch.evaluate                 |  10980 |     0.00275s |   2.3%
- batch.forward                  |  10980 |     0.02542s |  21.3%
- batch.mom                      |  10980 |     0.00126s |   1.1%
- batch.reduce                   |  10980 |     0.02603s |  21.8%
- batch.reporting.compr_err      |  10980 |     0.00001s |   0.0%
- batch.reporting.lr             |  10980 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10980 |     0.00001s |   0.0%
- batch.step                     |  10980 |     0.00048s |   0.4%
- batch.update_runavg            |  10980 |     0.00130s |   1.1%
- batch.wd                       |  10980 |     0.00001s |   0.0%
- epoch_metrics.collect          |     78 |     0.00714s |   0.0%
- reduce.combine                 |  10980 |     0.00625s |   5.2%
- reduce.flatpack                |  10980 |     0.00002s |   0.0%
- reduce.flatput                 |  10980 |     0.00023s |   0.2%
[Iteration 10950] [Rank 2] a = 0.9632859230041504, b = 0.9998887138075095, delta = 0.0007750173681415617, c = 0.0007774276141003524, d = 0.000778498451034375, m = 0.0006002086895004546
[Iteration 10960] [Rank 2] a = 1.0031028985977173, b = 0.9998986622279454, delta = 0.0007462247158400714, c = 0.000797324455197029, d = 0.000798049860862012, m = 0.0006004928837623279
[Iteration 10970] [Rank 2] a = 0.9850053787231445, b = 0.9999985091359145, delta = 0.0007551401504315436, c = 0.0009970182718287777, d = 0.0009970528149556817, m = 0.0006006367690611602
[Iteration 10980] [Rank 2] a = 1.09719979763031, b = 0.9998635664115108, delta = 0.000783172610681504, c = 0.0007271328213281977, d = 0.0007275818819779492, m = 0.0006011036965879048
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  10980 |     0.11094s |  93.0%
- batch.accumulate               |  10980 |     0.00082s |   0.7%
- reduce.gather.context          |  10980 |     0.00248s |   2.1%
- reduce.gather.tensors          |  10980 |     0.00346s |   2.9%
- reduce.heur_params             |  10980 |     0.01052s |   8.8%
- reduce.gather.context          |  10980 |     0.00124s |   1.0%
- reduce.gather.tensors          |  10980 |     0.00381s |   3.2%
- reduce.heur_params             |  10980 |     0.01093s |   9.2%
- batch.backward                 |  10980 |     0.05175s |  43.4%
- batch.evaluate                 |  10980 |     0.00274s |   2.3%
- batch.forward                  |  10980 |     0.02546s |  21.3%
- batch.mom                      |  10980 |     0.00126s |   1.1%
- batch.reduce                   |  10980 |     0.02615s |  21.9%
- batch.reporting.compr_err      |  10980 |     0.00001s |   0.0%
- batch.reporting.lr             |  10980 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  10980 |     0.00001s |   0.0%
- batch.step                     |  10980 |     0.00048s |   0.4%
- batch.update_runavg            |  10980 |     0.00129s |   1.1%
- batch.wd                       |  10980 |     0.00001s |   0.0%
- epoch_metrics.collect          |     78 |     0.01216s |   0.1%
- reduce.combine                 |  10980 |     0.00614s |   5.1%
- reduce.flatpack                |  10980 |     0.00002s |   0.0%
- reduce.flatput                 |  10980 |     0.00019s |   0.2%
- reduce.heur_params.alpha       |  10979 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  10979 |     0.00235s |   2.0%
- reduce.memory                  |  10980 |     0.00045s |   0.4%
- reduce.pad                     |  10980 |     0.00026s |   0.2%
- reduce.threshold               |  10980 |     0.00249s |   2.1%
- test.last                      |     78 |     0.41058s |   2.5%
- test.runavg                    |     78 |     0.44142s |   2.7%
-----------------------------------------------------------------

[Iteration 10990] [Rank 3] a = 0.9461299777030945, b = 1.0000437433605673, delta = 0.0007581606623716652, c = 0.001087486721190229, d = 0.0010866576861445342, m = 0.0006342228979514466
[Iteration 11000] [Rank 3] a = 0.9863754510879517, b = 0.9997659820814323, delta = 0.0008028717711567879, c = 0.0005319641543208667, d = 0.000533173163762505, m = 0.0006345674242417464
- reduce.heur_params.alpha       |  10979 |     0.00835s |   7.0%
- reduce.heur_params.beta        |  10979 |     0.00250s |   2.1%
- reduce.memory                  |  10980 |     0.00047s |   0.4%
- reduce.pad                     |  10980 |     0.00021s |   0.2%
- reduce.threshold               |  10980 |     0.00266s |   2.2%
- test.last                      |     78 |     0.41058s |   2.5%
- test.runavg                    |     78 |     0.44143s |   2.7%
-----------------------------------------------------------------

[Iteration 10990] [Rank 1] a = 1.0921998023986816, b = 0.9997426309290559, delta = 0.0007650051265954971, c = 0.0004852618467467231, d = 0.0004861945111731298, m = 0.0007217849852265804
[Iteration 11000] [Rank 1] a = 1.1494357585906982, b = 0.9996935451496364, delta = 0.0007819108432158828, c = 0.00038709028008569046, d = 0.0003878502288775774, m = 0.0007220672559286619
- reduce.gather.context          |  10980 |     0.00203s |   1.7%
- reduce.gather.tensors          |  10980 |     0.00382s |   3.2%
- reduce.heur_params             |  10980 |     0.01058s |   8.9%
[Iteration 11010] [Rank 3] a = 1.0114699602127075, b = 0.9999002339402036, delta = 0.0007241976563818753, c = 0.0008004678797452887, d = 0.0008015732598062151, m = 0.0006348622189825742
[Iteration 11020] [Rank 3] a = 0.9965330362319946, b = 0.9997184852851042, delta = 0.0007994770421646535, c = 0.00043697055533499767, d = 0.0004380759353959242, m = 0.0006349919405100125
[Iteration 11030] [Rank 3] a = 0.9772486686706543, b = 0.999825499886587, delta = 0.0007862357888370752, c = 0.0006509997696318866, d = 0.0006516215459161578, m = 0.0006351709821854617
[Iteration 11040] [Rank 3] a = 0.9951155781745911, b = 0.9998948452124632, delta = 0.0007530540460720658, c = 0.0007896904241512555, d = 0.0007912794079888374, m = 0.0006353267479608586
[Iteration 11050] [Rank 3] a = 1.0099053382873535, b = 0.9998647581493669, delta = 0.0007126823766157031, c = 0.0007295162970845704, d = 0.0007304489615109771, m = 0.0006363190250940912
[Iteration 11010] [Rank 1] a = 1.0414632558822632, b = 0.9997927357319155, delta = 0.0007632456836290658, c = 0.000585471457895089, d = 0.0005865422948291115, m = 0.0007221675236889864
[Iteration 11020] [Rank 1] a = 1.0544512271881104, b = 0.9997755677986446, delta = 0.0007528509595431387, c = 0.0005511355897525603, d = 0.0005521718835596789, m = 0.0007223060987030241
[Iteration 11030] [Rank 1] a = 0.8454509377479553, b = 1.00032014017958, delta = 0.000723137694876641, c = 0.001640280381034179, d = 0.00163233546184627, m = 0.0007224790783299857
[Iteration 11040] [Rank 1] a = 1.1291290521621704, b = 0.9996941841974242, delta = 0.0007764240144751966, c = 0.00038836837578113667, d = 0.0003888174364308881, m = 0.0007228218071786282
[Iteration 11050] [Rank 1] a = 1.1732933521270752, b = 0.9997207305881767, delta = 0.0008245534845627844, c = 0.0004414611618325115, d = 0.0004421174812436866, m = 0.00072301951042292
- reduce.heur_params.alpha       |  10979 |     0.00819s |   6.9%
- reduce.heur_params.beta        |  10979 |     0.00231s |   1.9%
- reduce.memory                  |  10980 |     0.00045s |   0.4%
- reduce.pad                     |  10980 |     0.00027s |   0.2%
- reduce.threshold               |  10980 |     0.00244s |   2.0%
- test.last                      |     78 |     0.41057s |   2.5%
- test.runavg                    |     78 |     0.44143s |   2.7%
-----------------------------------------------------------------

[Iteration 10990] [Rank 2] a = 1.001254677772522, b = 0.9999852273036208, delta = 0.0007281028665602207, c = 0.0009704546072396384, d = 0.000970661866001062, m = 0.0006013849116885712
[Iteration 11000] [Rank 2] a = 0.9736238121986389, b = 1.0001512588419301, delta = 0.0007429253309965134, c = 0.0013025176861673326, d = 0.0012990288303500336, m = 0.0006015628182545049
[Iteration 11060] [Rank 3] a = 0.9076590538024902, b = 1.0004147019766434, delta = 0.0007168370066210628, c = 0.0018294040008333184, d = 0.0018208027622342343, m = 0.0006364462046850932
[Iteration 11070] [Rank 3] a = 1.0396170616149902, b = 0.9997637885929952, delta = 0.0007448692922480404, c = 0.0005275771772040648, d = 0.0005284752985035676, m = 0.0006366922754247826
[Iteration 11080] [Rank 3] a = 1.103068470954895, b = 0.9996625254248948, delta = 0.0008281058399006724, c = 0.00032505082416619196, d = 0.0003259489454656947, m = 0.00063677503404255
[Iteration 11090] [Rank 3] a = 1.0528734922409058, b = 0.9997402992681458, delta = 0.0007590336608700454, c = 0.0004805985246146896, d = 0.00048111667151824885, m = 0.0006372384089083825
[Iteration 11100] [Rank 3] a = 0.948298454284668, b = 1.0002020890515717, delta = 0.0007224241853691638, c = 0.0014041781086456646, d = 0.001398651208341032, m = 0.0006373904466500433
[Iteration 11060] [Rank 1] a = 0.9472823739051819, b = 0.9998691969410956, delta = 0.000770849350374192, c = 0.0007383938806988862, d = 0.0007390156569831573, m = 0.0007230638402241415
[Iteration 11070] [Rank 1] a = 1.0462541580200195, b = 0.9998723749087175, delta = 0.0007063951343297958, c = 0.0007447498160492135, d = 0.0007459242823639478, m = 0.0007237588430148579
[Iteration 11080] [Rank 1] a = 0.9058171510696411, b = 1.0001223462452546, delta = 0.000741819734685123, c = 0.0012446924917301164, d = 0.0012431035078925346, m = 0.0007237710839685172
[Iteration 11090] [Rank 1] a = 1.0547797679901123, b = 0.9997202987991238, delta = 0.0008040112443268299, c = 0.0004405975836599127, d = 0.0004417375068477431, m = 0.0007237467695441532
[Iteration 11100] [Rank 1] a = 0.9732308983802795, b = 1.0002359067711855, delta = 0.0007322988240048289, c = 0.0014718135511236033, d = 0.0014630741400169034, m = 0.0007239310957236647
[Iteration 11010] [Rank 2] a = 1.1674723625183105, b = 0.9996462901571891, delta = 0.0008316005696542561, c = 0.0002925802848764767, d = 0.00029340931992217155, m = 0.0006019805597003369
[Iteration 11020] [Rank 2] a = 0.9871751666069031, b = 0.9997553427989555, delta = 0.0007990801823325455, c = 0.0005106855881480321, d = 0.0005119291407165744, m = 0.0006027264314939926
[Iteration 11030] [Rank 2] a = 1.0356347560882568, b = 0.9997455152799635, delta = 0.0007947104750201106, c = 0.0004910305489396831, d = 0.0004919977564929939, m = 0.0006028915558533132
[Iteration 11040] [Rank 2] a = 0.9490202069282532, b = 1.0002110011779326, delta = 0.0007241503917612135, c = 0.0014220023621281039, d = 0.0014173044968691663, m = 0.0006033158565812344
[Iteration 11050] [Rank 2] a = 0.9420179128646851, b = 0.9998572795625367, delta = 0.0007684036972932518, c = 0.0007145591231351591, d = 0.0007152499856732381, m = 0.0006034837527700062
[Iteration 11110] [Rank 3] a = 1.077781081199646, b = 0.9996799178874102, delta = 0.0007776765851303935, c = 0.000359835752958472, d = 0.00036080296051178265, m = 0.000639223227695662
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11119 |     0.11099s |  93.0%
- batch.accumulate               |  11119 |     0.00082s |   0.7%
- batch.backward                 |  11119 |     0.05174s |  43.4%
- batch.evaluate                 |  11119 |     0.00277s |   2.3%
- batch.forward                  |  11119 |     0.02537s |  21.3%
- batch.mom                      |  11119 |     0.00126s |   1.1%
- batch.reduce                   |  11119 |     0.02625s |  22.0%
- batch.reporting.compr_err      |  11119 |     0.00001s |   0.0%
- batch.reporting.lr             |  11119 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11119 |     0.00001s |   0.0%
[Iteration 11110] [Rank 1] a = 0.9603779315948486, b = 1.0003648735236657, delta = 0.0007125131669454277, c = 0.0017297470797154157, d = 0.0017170006658878574, m = 0.0007242204946824905
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11119 |     0.11087s |  92.9%
- batch.accumulate               |  11119 |     0.00083s |   0.7%
- batch.backward                 |  11119 |     0.05178s |  43.4%
- batch.evaluate                 |  11119 |     0.00275s |   2.3%
- batch.forward                  |  11119 |     0.02542s |  21.3%
- batch.mom                      |  11119 |     0.00126s |   1.1%
- batch.reduce                   |  11119 |     0.02605s |  21.8%
- batch.reporting.compr_err      |  11119 |     0.00001s |   0.0%
- batch.reporting.lr             |  11119 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11119 |     0.00001s |   0.0%
[Iteration 11060] [Rank 2] a = 0.9556453824043274, b = 1.0000084230133357, delta = 0.0007357338909059763, c = 0.0010168460266716463, d = 0.0010166733110371267, m = 0.0006039181466076234
[Iteration 11070] [Rank 2] a = 1.1304621696472168, b = 0.9996515234402701, delta = 0.0008280017063952982, c = 0.0003030468523283743, d = 0.00030349591297812564, m = 0.0006042142571471507
[Iteration 11080] [Rank 2] a = 0.9036410450935364, b = 1.0001423294438179, delta = 0.0007306921179406345, c = 0.0012846588895579893, d = 0.0012823099569285205, m = 0.0006045459007403272
[Iteration 11090] [Rank 2] a = 0.9238503575325012, b = 0.9999311327669971, delta = 0.0007407225202769041, c = 0.0008622655337764595, d = 0.0008627836806800187, m = 0.0006055083433251183
[Iteration 11100] [Rank 2] a = 1.0113893747329712, b = 0.9997808183536756, delta = 0.0007735489634796977, c = 0.0005616367003313618, d = 0.0005626384510115765, m = 0.0006059362893154426
- batch.step                     |  11119 |     0.00047s |   0.4%
- batch.update_runavg            |  11119 |     0.00129s |   1.1%
- batch.wd                       |  11119 |     0.00001s |   0.0%
- epoch_metrics.collect          |     79 |     0.00727s |   0.0%
- reduce.combine                 |  11119 |     0.00615s |   5.1%
- batch.step                     |  11119 |     0.00048s |   0.4%
- batch.update_runavg            |  11119 |     0.00130s |   1.1%
- batch.wd                       |  11119 |     0.00001s |   0.0%
- epoch_metrics.collect          |     79 |     0.00706s |   0.0%
- reduce.combine                 |  11119 |     0.00626s |   5.2%
[Iteration 11110] [Rank 2] a = 0.9217541217803955, b = 1.0003130070245891, delta = 0.0007183219422586262, c = 0.0016260140696228468, d = 0.0016182418660694576, m = 0.0006061955650662405
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11119 |     0.11096s |  93.0%
- batch.accumulate               |  11119 |     0.00082s |   0.7%
- batch.backward                 |  11119 |     0.05175s |  43.4%
- batch.evaluate                 |  11119 |     0.00274s |   2.3%
- batch.forward                  |  11119 |     0.02545s |  21.3%
- batch.mom                      |  11119 |     0.00126s |   1.1%
- batch.reduce                   |  11119 |     0.02618s |  21.9%
- batch.reporting.compr_err      |  11119 |     0.00001s |   0.0%
- batch.reporting.lr             |  11119 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11119 |     0.00001s |   0.0%
- reduce.flatpack                |  11119 |     0.00002s |   0.0%
- reduce.flatput                 |  11119 |     0.00020s |   0.2%
- reduce.gather.context          |  11119 |     0.00248s |   2.1%
- reduce.gather.tensors          |  11119 |     0.00347s |   2.9%
- reduce.heur_params             |  11119 |     0.01052s |   8.8%
- reduce.heur_params.alpha       |  11118 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  11118 |     0.00235s |   2.0%
- reduce.memory                  |  11119 |     0.00045s |   0.4%
- reduce.pad                     |  11119 |     0.00026s |   0.2%
- reduce.threshold               |  11119 |     0.00249s |   2.1%
- test.last                      |     79 |     0.41057s |   2.5%
- test.runavg                    |     79 |     0.44138s |   2.7%
-----------------------------------------------------------------
- reduce.flatpack                |  11119 |     0.00002s |   0.0%
- reduce.flatput                 |  11119 |     0.00023s |   0.2%
- reduce.gather.context          |  11119 |     0.00124s |   1.0%
- reduce.gather.tensors          |  11119 |     0.00382s |   3.2%
- reduce.heur_params             |  11119 |     0.01094s |   9.2%
- reduce.heur_params.alpha       |  11118 |     0.00836s |   7.0%
- reduce.heur_params.beta        |  11118 |     0.00250s |   2.1%
- reduce.memory                  |  11119 |     0.00047s |   0.4%
- reduce.pad                     |  11119 |     0.00021s |   0.2%
- reduce.threshold               |  11119 |     0.00266s |   2.2%
- test.last                      |     79 |     0.41056s |   2.5%
- test.runavg                    |     79 |     0.44138s |   2.7%
-----------------------------------------------------------------
- batch.step                     |  11119 |     0.00048s |   0.4%
- batch.update_runavg            |  11119 |     0.00129s |   1.1%
- batch.wd                       |  11119 |     0.00001s |   0.0%
- epoch_metrics.collect          |     79 |     0.01202s |   0.1%
- reduce.combine                 |  11119 |     0.00614s |   5.1%
- reduce.flatpack                |  11119 |     0.00002s |   0.0%
- reduce.flatput                 |  11119 |     0.00020s |   0.2%
- reduce.gather.context          |  11119 |     0.00204s |   1.7%
- reduce.gather.tensors          |  11119 |     0.00383s |   3.2%
- reduce.heur_params             |  11119 |     0.01058s |   8.9%
- reduce.heur_params.alpha       |  11118 |     0.00819s |   6.9%
- reduce.heur_params.beta        |  11118 |     0.00231s |   1.9%
- reduce.memory                  |  11119 |     0.00045s |   0.4%
- reduce.pad                     |  11119 |     0.00027s |   0.2%
- reduce.threshold               |  11119 |     0.00244s |   2.0%
- test.last                      |     79 |     0.41056s |   2.5%
- test.runavg                    |     79 |     0.44139s |   2.7%
-----------------------------------------------------------------
[Iteration 11070] [Rank 0] a = 1.116976022720337, b = 0.999643025832109, delta = 0.0008388828136958182, c = 0.00028605163389162973, d = 0.000286569780795189, m = 0.0005625730402887492
[Iteration 11080] [Rank 0] a = 1.0601190328598022, b = 0.9997194524925812, delta = 0.0007666565361432731, c = 0.00043890497044161904, d = 0.0004399412642487376, m = 0.0005628751467143726
rel_compression_error          - epoch: 79.770, value:  0.992 (weight:encoder.weight)
rel_compression_error          - epoch: 79.770, value:  0.969 (weight:rnn.weight_ih_l0)
rel_compression_error          - epoch: 79.770, value:  0.979 (weight:rnn.weight_hh_l0)
rel_compression_error          - epoch: 79.770, value:  0.882 (weight:rnn.bias_ih_l0)
rel_compression_error          - epoch: 79.770, value:  0.882 (weight:rnn.bias_hh_l0)
rel_compression_error          - epoch: 79.770, value:  0.978 (weight:rnn.weight_ih_l1)
rel_compression_error          - epoch: 79.770, value:  0.991 (weight:rnn.weight_hh_l1)
rel_compression_error          - epoch: 79.770, value:  0.896 (weight:rnn.bias_ih_l1)
rel_compression_error          - epoch: 79.770, value:  0.896 (weight:rnn.bias_hh_l1)
rel_compression_error          - epoch: 79.770, value:  0.973 (weight:rnn.weight_ih_l2)
rel_compression_error          - epoch: 79.770, value:  0.979 (weight:rnn.weight_hh_l2)
rel_compression_error          - epoch: 79.770, value:  0.784 (weight:rnn.bias_ih_l2)
rel_compression_error          - epoch: 79.770, value:  0.784 (weight:rnn.bias_hh_l2)
rel_compression_error          - epoch: 79.770, value:  0.886 (weight:decoder.bias)
rel_compression_error          - epoch: 79.770, value:  0.988 (weight:entire_model)
[Iteration 11090] [Rank 0] a = 1.0689891576766968, b = 0.9997506794771079, delta = 0.000751680985558778, c = 0.0005013589438839649, d = 0.0005022570651834677, m = 0.0005631973358197339
[Iteration 11100] [Rank 0] a = 1.0308750867843628, b = 0.9998059657489867, delta = 0.0007459348416887224, c = 0.0006119314931035165, d = 0.0006127605281492114, m = 0.0005635357352602601
[Iteration 11110] [Rank 0] a = 1.1127538681030273, b = 0.9996644425682206, delta = 0.0008378616767004132, c = 0.0003288851112525307, d = 0.0003297486894251295, m = 0.000563743591686239
cross_entropy                  - bits:28257654400.000, epoch: 80.000, ratio_transmit_grad:  0.199, value:  5.347 (split:train)
last_cross_entropy             - bits:28257654400.000, epoch: 80.000, ratio_transmit_grad:  0.199, value:  5.347 (split:train)
perplexity                     - bits:28257654400.000, epoch: 80.000, ratio_transmit_grad:  0.199, value:210.509 (split:train)
last_perplexity                - bits:28257654400.000, epoch: 80.000, ratio_transmit_grad:  0.199, value:210.509 (split:train)
last_cross_entropy             - bits:28257654400.000, epoch: 80.000, ratio_transmit_grad:  0.199, value:  5.139 (split:test)
last_perplexity                - bits:28257654400.000, epoch: 80.000, ratio_transmit_grad:  0.199, value:171.151 (split:test)
runavg_cross_entropy           - bits:28257654400.000, epoch: 80.000, ratio_transmit_grad:  0.199, value:  5.339 (split:test)
runavg_perplexity              - bits:28257654400.000, epoch: 80.000, ratio_transmit_grad:  0.199, value:208.953 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11119 |     0.11090s |  92.9%
- batch.accumulate               |  11119 |     0.00082s |   0.7%
- batch.backward                 |  11119 |     0.05163s |  43.3%
- batch.evaluate                 |  11119 |     0.00275s |   2.3%
- batch.forward                  |  11119 |     0.02540s |  21.3%
- batch.mom                      |  11119 |     0.00126s |   1.1%
- batch.reduce                   |  11119 |     0.02622s |  22.0%
- batch.reporting.compr_err      |  11119 |     0.00001s |   0.0%
- batch.reporting.lr             |  11119 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11119 |     0.00001s |   0.0%
- batch.step                     |  11119 |     0.00048s |   0.4%
- batch.update_runavg            |  11119 |     0.00130s |   1.1%
- batch.wd                       |  11119 |     0.00001s |   0.0%
- epoch_metrics.collect          |     79 |     0.00788s |   0.0%
- reduce.combine                 |  11119 |     0.00642s |   5.4%
- reduce.flatpack                |  11119 |     0.00002s |   0.0%
- reduce.flatput                 |  11119 |     0.00020s |   0.2%
- reduce.gather.context          |  11119 |     0.00113s |   0.9%
- reduce.gather.tensors          |  11119 |     0.00393s |   3.3%
- reduce.heur_params             |  11119 |     0.01111s |   9.3%
- reduce.heur_params.alpha       |  11118 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  11118 |     0.00232s |   1.9%
- reduce.memory                  |  11119 |     0.00046s |   0.4%
- reduce.pad                     |  11119 |     0.00028s |   0.2%
- reduce.threshold               |  11119 |     0.00245s |   2.1%
- test.last                      |     79 |     0.41055s |   2.5%
- test.runavg                    |     79 |     0.44139s |   2.7%
-----------------------------------------------------------------

[Iteration 11120] [Rank 0] a = 1.151055932044983, b = 0.9996368598847558, delta = 0.0008776811300776899, c = 0.0002737197375869187, d = 0.00027454877263261354, m = 0.0005641669463271428
[Iteration 11130] [Rank 0] a = 1.0083329677581787, b = 0.9998340493102481, delta = 0.0007515602628700435, c = 0.0006680986174493431, d = 0.000668927652495038, m = 0.0005645724906156947
[Iteration 11140] [Rank 0] a = 1.0572305917739868, b = 0.9997607315264371, delta = 0.0007839535246603191, c = 0.0005214630437420652, d = 0.0005225338806760878, m = 0.0005647619526090181
[Iteration 11150] [Rank 0] a = 0.9900712370872498, b = 0.9999427219860271, delta = 0.0007593898917548358, c = 0.0008854439719290115, d = 0.0008862730069747064, m = 0.000564952536933615
[Iteration 11160] [Rank 0] a = 1.0237553119659424, b = 0.9998309577004769, delta = 0.0007391877006739378, c = 0.0006619153977335357, d = 0.0006627789759061345, m = 0.0005655311601148831
[Iteration 11170] [Rank 0] a = 1.0230560302734375, b = 0.999896589640353, delta = 0.0007219082908704877, c = 0.0007931792799685547, d = 0.0007937665131259219, m = 0.0005658053300059516
[Iteration 11180] [Rank 0] a = 1.0299181938171387, b = 0.9997740651727003, delta = 0.0007719223503954709, c = 0.0005481303377119165, d = 0.0005489248296307073, m = 0.0005659924276736674
[Iteration 11190] [Rank 0] a = 0.9975035190582275, b = 0.9999388704273908, delta = 0.0007410220568999648, c = 0.0008777408546294302, d = 0.000878604432802029, m = 0.0005663550519394416
[Iteration 11200] [Rank 0] a = 1.0547099113464355, b = 0.9998267261675552, delta = 0.0007409086101688445, c = 0.0006534523316420673, d = 0.000654419539195378, m = 0.0005668334440841713
[Iteration 11210] [Rank 0] a = 0.9415084719657898, b = 1.0001724855928555, delta = 0.0007366035133600235, c = 0.00134497118913229, d = 0.0013412750745535672, m = 0.0005669867284874967
[Iteration 11220] [Rank 0] a = 0.9862357378005981, b = 0.9999682320851939, delta = 0.0007390344399027526, c = 0.0009364641703661492, d = 0.0009367059722544768, m = 0.0005674144993017918
[Iteration 11230] [Rank 0] a = 0.9453908801078796, b = 0.9999383695520526, delta = 0.0007665865705348551, c = 0.0008767391039492155, d = 0.0008774299664872946, m = 0.0005675906516146444
[Iteration 11240] [Rank 0] a = 0.9688812494277954, b = 1.0004151683087765, delta = 0.000720249314326793, c = 0.001830336665259725, d = 0.0018135832487113082, m = 0.0005679250674693969
[Iteration 11250] [Rank 0] a = 1.0729410648345947, b = 0.9997320952760772, delta = 0.0007889569969847798, c = 0.00046419053933531215, d = 0.0004650886606348149, m = 0.0005680958444412652
cross_entropy                  - bits:28713653376.000, epoch: 81.000, ratio_transmit_grad:  0.177, value:  5.345 (split:train)
last_cross_entropy             - bits:28713653376.000, epoch: 81.000, ratio_transmit_grad:  0.177, value:  5.345 (split:train)
perplexity                     - bits:28713653376.000, epoch: 81.000, ratio_transmit_grad:  0.177, value:210.169 (split:train)
last_perplexity                - bits:28713653376.000, epoch: 81.000, ratio_transmit_grad:  0.177, value:210.169 (split:train)

[Iteration 11120] [Rank 3] a = 1.0560247898101807, b = 0.9997375185466196, delta = 0.0008076292579062283, c = 0.00047503708118315323, d = 0.00047590065935575204, m = 0.0006393346945198523
[Iteration 11130] [Rank 3] a = 1.0180079936981201, b = 0.9997829082127537, delta = 0.0007410667021758854, c = 0.0005658164186867401, d = 0.0005667145399862428, m = 0.0006399906352004625
[Iteration 11140] [Rank 3] a = 0.9847432374954224, b = 0.9999444145992402, delta = 0.000704801466781646, c = 0.0008888291983655988, d = 0.0008893128021422542, m = 0.0006403376045531406
[Iteration 11150] [Rank 3] a = 1.0372756719589233, b = 0.9998021141904848, delta = 0.0007445475202985108, c = 0.0006042283758039351, d = 0.0006052646696110537, m = 0.0006405909475327497
[Iteration 11160] [Rank 3] a = 1.1044765710830688, b = 0.9997180016813659, delta = 0.0007619760581292212, c = 0.00043600334778168704, d = 0.0004369014690811898, m = 0.0006408046509290485

[Iteration 11120] [Rank 1] a = 0.9763012528419495, b = 1.0001440047854384, delta = 0.0007240912527777255, c = 0.0012880095728676727, d = 0.0012857988127458198, m = 0.0007246223706159105
[Iteration 11130] [Rank 1] a = 1.0597660541534424, b = 0.9996984157300796, delta = 0.0008248597732745111, c = 0.000396831441872605, d = 0.0003974877612837801, m = 0.0007245418757841997
[Iteration 11140] [Rank 1] a = 1.0512877702713013, b = 0.999759332529878, delta = 0.0007834725547581911, c = 0.0005186650504628451, d = 0.0005197013442699637, m = 0.0007247214655074555
[Iteration 11150] [Rank 1] a = 0.9686768651008606, b = 0.9998320285373804, delta = 0.0007806353969499469, c = 0.0006640570716015807, d = 0.0006651624516625072, m = 0.0007250742355912437
[Iteration 11160] [Rank 1] a = 1.0166479349136353, b = 0.999749902256801, delta = 0.0007946941768750548, c = 0.0004998045031732871, d = 0.0005007026244727899, m = 0.000725138341848864
[Iteration 11170] [Rank 3] a = 1.1372171640396118, b = 0.9996464110581181, delta = 0.0008312633144669235, c = 0.00029282208676480436, d = 0.00029372020806430713, m = 0.0006409599215808043
[Iteration 11180] [Rank 3] a = 0.9662410616874695, b = 1.0001933150976812, delta = 0.0006944342167116702, c = 0.0013866302001784567, d = 0.0013831413443611575, m = 0.0006415967078520378
[Iteration 11190] [Rank 3] a = 0.891366720199585, b = 1.00088436739481, delta = 0.0006726327701471746, c = 0.0027687352507324956, d = 0.0027268689809249055, m = 0.0006419331695830183
[Iteration 11200] [Rank 3] a = 1.0050612688064575, b = 0.9998000934176411, delta = 0.0007727235788479447, c = 0.0006001868299561727, d = 0.0006009467787480596, m = 0.000641956054578744
[Iteration 11210] [Rank 3] a = 0.9430500268936157, b = 1.0000345030741347, delta = 0.0007034605368971825, c = 0.0010690061482966145, d = 0.0010683843720123434, m = 0.0006425040152848386
[Iteration 11170] [Rank 1] a = 1.0342482328414917, b = 0.9998214065261766, delta = 0.0007646286976523697, c = 0.00064281304855565, d = 0.0006437457129820567, m = 0.0007253610938048413
[Iteration 11180] [Rank 1] a = 0.9527963399887085, b = 1.0011812825232036, delta = 0.0007089640712365508, c = 0.003362566145338341, d = 0.0032599730584336024, m = 0.0007256788371343242
[Iteration 11190] [Rank 1] a = 0.9592773914337158, b = 0.9999418065931672, delta = 0.0007689162739552557, c = 0.0008836131862031021, d = 0.0008837859018376218, m = 0.0007257661994170758
[Iteration 11200] [Rank 1] a = 0.9829579591751099, b = 0.9998002834048314, delta = 0.0008066572481766343, c = 0.0006005668043521162, d = 0.0006019830725551783, m = 0.0007257721286710615
[Iteration 11210] [Rank 1] a = 0.9770804643630981, b = 0.9999058817413993, delta = 0.0007602504338137805, c = 0.0008117634822428811, d = 0.0008126270604154799, m = 0.0007260878355077871
[Iteration 11220] [Rank 3] a = 1.0024584531784058, b = 0.99974784694088, delta = 0.000767610443290323, c = 0.0004956938710717168, d = 0.0004967301648788353, m = 0.0006426179896348767
[Iteration 11230] [Rank 3] a = 1.059342384338379, b = 0.9997451007624676, delta = 0.0007659179391339421, c = 0.0004902015138939883, d = 0.0004913068939549148, m = 0.000642829411251327
[Iteration 11240] [Rank 3] a = 1.0021218061447144, b = 0.9998083837677803, delta = 0.0007684141164645553, c = 0.0006167675308700699, d = 0.0006181837990731319, m = 0.0006429901831045464
[Iteration 11250] [Rank 3] a = 0.9798879027366638, b = 0.9998251199122027, delta = 0.0007750796503387392, c = 0.0006502398208399998, d = 0.000651517916535446, m = 0.0006431479397345072
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11258 |     0.11101s |  93.0%
- batch.accumulate               |  11258 |     0.00082s |   0.7%
[Iteration 11220] [Rank 1] a = 0.9726335406303406, b = 0.999983189259134, delta = 0.0007626038859598339, c = 0.000966378518264972, d = 0.0009665857770263956, m = 0.0007261290912138314
[Iteration 11230] [Rank 1] a = 0.9668293595314026, b = 1.000085108754857, delta = 0.0007537148194387555, c = 0.001170217510125195, d = 0.0011684903537799974, m = 0.0007262701258799694
[Iteration 11240] [Rank 1] a = 0.9971211552619934, b = 0.9997703690583134, delta = 0.0008210203377529979, c = 0.0005407381085544707, d = 0.0005420162042499169, m = 0.0007262048677472254
[Iteration 11250] [Rank 1] a = 0.9900345802307129, b = 1.0002161999182946, delta = 0.0007381250616163015, c = 0.0014323998433261936, d = 0.001419100739468172, m = 0.0007264513536855334
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11258 |     0.11088s |  92.9%
- batch.accumulate               |  11258 |     0.00083s |   0.7%
- batch.backward                 |  11258 |     0.05175s |  43.4%
- batch.evaluate                 |  11258 |     0.00277s |   2.3%
- batch.forward                  |  11258 |     0.02537s |  21.3%
- batch.mom                      |  11258 |     0.00126s |   1.1%
- batch.reduce                   |  11258 |     0.02627s |  22.0%
- batch.reporting.compr_err      |  11258 |     0.00001s |   0.0%
- batch.reporting.lr             |  11258 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11258 |     0.00001s |   0.0%
- batch.step                     |  11258 |     0.00047s |   0.4%
- batch.update_runavg            |  11258 |     0.00129s |   1.1%
- batch.wd                       |  11258 |     0.00001s |   0.0%
- epoch_metrics.collect          |     80 |     0.00734s |   0.0%
- reduce.combine                 |  11258 |     0.00615s |   5.2%
- reduce.flatpack                |  11258 |     0.00002s |   0.0%
- reduce.flatput                 |  11258 |     0.00020s |   0.2%
- batch.backward                 |  11258 |     0.05178s |  43.4%
- batch.evaluate                 |  11258 |     0.00275s |   2.3%
- batch.forward                  |  11258 |     0.02542s |  21.3%
- batch.mom                      |  11258 |     0.00126s |   1.1%
- batch.reduce                   |  11258 |     0.02607s |  21.8%
- batch.reporting.compr_err      |  11258 |     0.00001s |   0.0%
- batch.reporting.lr             |  11258 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11258 |     0.00001s |   0.0%
- batch.step                     |  11258 |     0.00048s |   0.4%
- batch.update_runavg            |  11258 |     0.00130s |   1.1%
- batch.wd                       |  11258 |     0.00001s |   0.0%
- epoch_metrics.collect          |     80 |     0.00698s |   0.0%
- reduce.combine                 |  11258 |     0.00626s |   5.2%
- reduce.flatpack                |  11258 |     0.00002s |   0.0%
- reduce.flatput                 |  11258 |     0.00023s |   0.2%
- reduce.gather.context          |  11258 |     0.00248s |   2.1%
- reduce.gather.tensors          |  11258 |     0.00349s |   2.9%
- reduce.heur_params             |  11258 |     0.01052s |   8.8%
- reduce.gather.context          |  11258 |     0.00123s |   1.0%
- reduce.gather.tensors          |  11258 |     0.00383s |   3.2%
- reduce.heur_params             |  11258 |     0.01094s |   9.2%
- reduce.heur_params.alpha       |  11257 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  11257 |     0.00235s |   2.0%
- reduce.memory                  |  11258 |     0.00045s |   0.4%
- reduce.pad                     |  11258 |     0.00026s |   0.2%
- reduce.threshold               |  11258 |     0.00249s |   2.1%
- test.last                      |     80 |     0.41044s |   2.5%
- test.runavg                    |     80 |     0.44123s |   2.7%
-----------------------------------------------------------------

[Iteration 11260] [Rank 3] a = 0.9252994060516357, b = 1.0002665810659377, delta = 0.0007253807852976024, c = 0.0015331621445050228, d = 0.001527911589215622, m = 0.0006434835367531841
[Iteration 11270] [Rank 3] a = 0.9789567589759827, b = 0.9998676252288484, delta = 0.0007895702729001641, c = 0.0007352504561506265, d = 0.0007363212930846491, m = 0.0006434846520209365
- reduce.heur_params.alpha       |  11257 |     0.00836s |   7.0%
- reduce.heur_params.beta        |  11257 |     0.00250s |   2.1%
- reduce.memory                  |  11258 |     0.00047s |   0.4%
- reduce.pad                     |  11258 |     0.00021s |   0.2%
- reduce.threshold               |  11258 |     0.00266s |   2.2%
- test.last                      |     80 |     0.41044s |   2.5%
- test.runavg                    |     80 |     0.44124s |   2.7%
-----------------------------------------------------------------

[Iteration 11260] [Rank 1] a = 1.0295802354812622, b = 0.9997649630592447, delta = 0.0008315681479871273, c = 0.0005299261098335336, d = 0.0005309969467675561, m = 0.0007264696061751439
[Iteration 11270] [Rank 1] a = 1.0683447122573853, b = 0.9997433563346731, delta = 0.000801165821030736, c = 0.0004867126580766891, d = 0.0004872653481071524, m = 0.0007266910456587173
[Iteration 11280] [Rank 3] a = 0.9300293922424316, b = 1.0015414630360004, delta = 0.0006787379388697445, c = 0.004082928513793364, d = 0.0038889688562276717, m = 0.0006443170203524364
[Iteration 11290] [Rank 3] a = 1.0230215787887573, b = 0.999757588102071, delta = 0.0007836977601982653, c = 0.0005151761946455459, d = 0.0005162470315795684, m = 0.00064427573934375
[Iteration 11300] [Rank 3] a = 0.9786231517791748, b = 0.9997869843015398, delta = 0.0008049801690503955, c = 0.0005739685966360729, d = 0.000575315778585327, m = 0.0006444535062678521
[Iteration 11310] [Rank 3] a = 0.9474636316299438, b = 0.9998795771505661, delta = 0.0007677632384002209, c = 0.0007591542999681616, d = 0.0007600178781407604, m = 0.0006446602858618488
[Iteration 11320] [Rank 3] a = 0.8462862968444824, b = 1.0030014895882844, delta = 0.0006757618975825608, c = 0.007002997203492075, d = 0.006525473017171837, m = 0.000645365331303707
[Iteration 11280] [Rank 1] a = 1.014353632926941, b = 0.9999033082784683, delta = 0.0007650326006114483, c = 0.0008066165563341922, d = 0.0008071347032377515, m = 0.0007267862570960368
[Iteration 11290] [Rank 1] a = 1.0679353475570679, b = 0.9997559473036401, delta = 0.0007938651251606643, c = 0.0005118945975896704, d = 0.0005126545463815574, m = 0.0007269428937875601
[Iteration 11300] [Rank 1] a = 0.9409239888191223, b = 1.0002592579235403, delta = 0.0007505167741328478, c = 0.0015185158586977468, d = 0.0015127126133778828, m = 0.000727218373719924
[Iteration 11310] [Rank 1] a = 0.961144745349884, b = 0.9997478123977552, delta = 0.000817079737316817, c = 0.0004956247848179089, d = 0.0004965229061174116, m = 0.0007277877328725603
[Iteration 11320] [Rank 1] a = 0.9670510292053223, b = 0.9998688515098324, delta = 0.0007874081493355334, c = 0.0007377030181608072, d = 0.0007388083982217337, m = 0.0007278386532665575

[Iteration 11120] [Rank 2] a = 1.0054161548614502, b = 0.9999352433990802, delta = 0.0007462109788320959, c = 0.0008704867979796001, d = 0.0008714194624060068, m = 0.0006063823001973368
[Iteration 11130] [Rank 2] a = 1.0530660152435303, b = 0.999851044528263, delta = 0.000714044610504061, c = 0.0007020890543228323, d = 0.0007032289775106627, m = 0.000607037302102297
[Iteration 11140] [Rank 2] a = 0.9872696995735168, b = 1.0000022225220566, delta = 0.0007268016343005002, c = 0.0010044450441131275, d = 0.0010044105009862235, m = 0.0006074253125887281
[Iteration 11150] [Rank 2] a = 1.12175714969635, b = 0.9996865156239868, delta = 0.0007966296398080885, c = 0.0003730312274357818, d = 0.00037396389186218854, m = 0.0006077063646775344
[Iteration 11160] [Rank 2] a = 1.0151571035385132, b = 0.9998306640839068, delta = 0.0007512154406867921, c = 0.0006613281645761684, d = 0.0006624335446370949, m = 0.0006078857287912806
[Iteration 11330] [Rank 3] a = 0.9724529981613159, b = 1.000041601686703, delta = 0.0007320085423998535, c = 0.001083203373454139, d = 0.0010827197696774836, m = 0.0006454184405047568
[Iteration 11340] [Rank 3] a = 0.9617548584938049, b = 1.0000926218848993, delta = 0.0007467257091775537, c = 0.0011852437703284142, d = 0.0011835511571101206, m = 0.0006455066113923162
[Iteration 11350] [Rank 3] a = 1.027154803276062, b = 0.9997493841099301, delta = 0.0007788626244291663, c = 0.0004987682093661685, d = 0.0005004262794575582, m = 0.0006457112050344949
[Iteration 11360] [Rank 3] a = 1.109347939491272, b = 0.999714668269888, delta = 0.0007626357837580144, c = 0.00042933652428922423, d = 0.00043009647308111116, m = 0.0006461893298395815
[Iteration 11370] [Rank 3] a = 1.0710538625717163, b = 0.9997286927783244, delta = 0.0008086002781055868, c = 0.00045738554333523356, d = 0.0004582145783809284, m = 0.0006462400208061447
[Iteration 11330] [Rank 1] a = 0.941965639591217, b = 0.9999875935078134, delta = 0.000773416890297085, c = 0.0009751870156254798, d = 0.0009754979037676154, m = 0.000727873271590415
[Iteration 11340] [Rank 1] a = 1.029377818107605, b = 0.9998014924142251, delta = 0.0008034014026634395, c = 0.0006029848232353928, d = 0.0006039520307887036, m = 0.0007279723554620177
[Iteration 11350] [Rank 1] a = 1.009562373161316, b = 0.9997373285594348, delta = 0.0008389473659917712, c = 0.00047465710678720974, d = 0.0004758315731019441, m = 0.0007279376661425675
[Iteration 11360] [Rank 1] a = 0.9565925598144531, b = 1.0003447003400936, delta = 0.0007734554237686098, c = 0.0016894007074915993, d = 0.0016771724405676002, m = 0.0007280164029540042
[Iteration 11370] [Rank 1] a = 0.9634747505187988, b = 0.9999611507441872, delta = 0.0007616432849317789, c = 0.0009223014883355287, d = 0.0009226469196045682, m = 0.0007286037066167051
[Iteration 11380] [Rank 3] a = 0.9302626848220825, b = 1.0000550216914739, delta = 0.0007698308327235281, c = 0.0011100433830585098, d = 0.001109421606774239, m = 0.0006462779326994355
[Iteration 11390] [Rank 3] a = 0.9257488250732422, b = 1.0007953152765219, delta = 0.000717503426130861, c = 0.0025906308884157173, d = 0.002550146343684285, m = 0.0006466056904166578
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11397 |     0.11103s |  93.0%
- batch.accumulate               |  11397 |     0.00082s |   0.7%
- batch.backward                 |  11397 |     0.05174s |  43.3%
- batch.evaluate                 |  11397 |     0.00277s |   2.3%
- batch.forward                  |  11397 |     0.02537s |  21.3%
- batch.mom                      |  11397 |     0.00126s |   1.1%
- batch.reduce                   |  11397 |     0.02628s |  22.0%
[Iteration 11380] [Rank 1] a = 0.9804182052612305, b = 0.9998555005915378, delta = 0.000791115511674434, c = 0.0007110011810640519, d = 0.0007122101905056903, m = 0.0007286874714647389
[Iteration 11390] [Rank 1] a = 0.9862951636314392, b = 0.999929111994083, delta = 0.0007809348753653467, c = 0.000858223987928697, d = 0.0008590184798474879, m = 0.0007287545045369848
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11397 |     0.11090s |  92.9%
- batch.accumulate               |  11397 |     0.00083s |   0.7%
- batch.backward                 |  11397 |     0.05178s |  43.4%
- batch.evaluate                 |  11397 |     0.00275s |   2.3%
- batch.forward                  |  11397 |     0.02542s |  21.3%
- batch.mom                      |  11397 |     0.00126s |   1.1%
- batch.reduce                   |  11397 |     0.02608s |  21.9%
[Iteration 11170] [Rank 2] a = 1.0893027782440186, b = 0.9997204369716206, delta = 0.0007860093610361218, c = 0.0004408739286751443, d = 0.00044170296372083917, m = 0.0006081174105459733
[Iteration 11180] [Rank 2] a = 0.9516023993492126, b = 0.9999091460668639, delta = 0.0007807942456565797, c = 0.0008182921332277281, d = 0.000819121168273423, m = 0.0006082252018804828
[Iteration 11190] [Rank 2] a = 1.039039134979248, b = 0.9997849808002711, delta = 0.0007637366070412099, c = 0.0005699615939152143, d = 0.0005711360602299487, m = 0.0006087044717805309
[Iteration 11200] [Rank 2] a = 0.9315833449363708, b = 0.9999795276876834, delta = 0.0007502608932554722, c = 0.000959055375361334, d = 0.0009592280909958539, m = 0.0006089176183878576
[Iteration 11210] [Rank 2] a = 0.9433580636978149, b = 1.0000761620850471, delta = 0.0007462492794729769, c = 0.0011523241703889477, d = 0.0011511497040742132, m = 0.0006090335401308668
- batch.reporting.compr_err      |  11397 |     0.00001s |   0.0%
- batch.reporting.lr             |  11397 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11397 |     0.00001s |   0.0%
- batch.step                     |  11397 |     0.00047s |   0.4%
- batch.update_runavg            |  11397 |     0.00129s |   1.1%
- batch.reporting.compr_err      |  11397 |     0.00001s |   0.0%
- batch.reporting.lr             |  11397 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11397 |     0.00001s |   0.0%
- batch.step                     |  11397 |     0.00048s |   0.4%
- batch.update_runavg            |  11397 |     0.00130s |   1.1%
[Iteration 11220] [Rank 2] a = 0.9431933760643005, b = 1.0001496353150023, delta = 0.0007228947943076491, c = 0.0012992706322383612, d = 0.001294987284502271, m = 0.0006093548732133676
[Iteration 11230] [Rank 2] a = 0.9668676853179932, b = 0.9999681284558132, delta = 0.0007280110730789602, c = 0.0009362569116047255, d = 0.0009365677997468611, m = 0.0006103969213804425
[Iteration 11240] [Rank 2] a = 1.0899055004119873, b = 0.9997228031756302, delta = 0.0007561173406429589, c = 0.0004456063370609858, d = 0.00044626265647216087, m = 0.000610892814680572
[Iteration 11250] [Rank 2] a = 0.8148651719093323, b = 1.0058404108934291, delta = 0.0006476581911556423, c = 0.012680954602075441, d = 0.011104786264574997, m = 0.0006119315330164691
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11258 |     0.11098s |  93.0%
- batch.accumulate               |  11258 |     0.00082s |   0.7%
- batch.wd                       |  11397 |     0.00001s |   0.0%
- epoch_metrics.collect          |     81 |     0.00727s |   0.0%
- reduce.combine                 |  11397 |     0.00615s |   5.2%
- reduce.flatpack                |  11397 |     0.00002s |   0.0%
- reduce.flatput                 |  11397 |     0.00020s |   0.2%
- reduce.gather.context          |  11397 |     0.00248s |   2.1%
- reduce.gather.tensors          |  11397 |     0.00349s |   2.9%
- reduce.heur_params             |  11397 |     0.01052s |   8.8%
- reduce.heur_params.alpha       |  11396 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  11396 |     0.00235s |   2.0%
- reduce.memory                  |  11397 |     0.00045s |   0.4%
- reduce.pad                     |  11397 |     0.00026s |   0.2%
- reduce.threshold               |  11397 |     0.00249s |   2.1%
- test.last                      |     81 |     0.41037s |   2.5%
- test.runavg                    |     81 |     0.44110s |   2.7%
- batch.wd                       |  11397 |     0.00001s |   0.0%
- epoch_metrics.collect          |     81 |     0.00690s |   0.0%
- reduce.combine                 |  11397 |     0.00627s |   5.3%
- reduce.flatpack                |  11397 |     0.00002s |   0.0%
- reduce.flatput                 |  11397 |     0.00023s |   0.2%
- reduce.gather.context          |  11397 |     0.00123s |   1.0%
- reduce.gather.tensors          |  11397 |     0.00384s |   3.2%
- reduce.heur_params             |  11397 |     0.01094s |   9.2%
- reduce.heur_params.alpha       |  11396 |     0.00836s |   7.0%
- reduce.heur_params.beta        |  11396 |     0.00250s |   2.1%
- reduce.memory                  |  11397 |     0.00047s |   0.4%
- reduce.pad                     |  11397 |     0.00021s |   0.2%
- reduce.threshold               |  11397 |     0.00266s |   2.2%
- test.last                      |     81 |     0.41036s |   2.5%
- test.runavg                    |     81 |     0.44111s |   2.7%
- batch.backward                 |  11258 |     0.05174s |  43.4%
- batch.evaluate                 |  11258 |     0.00274s |   2.3%
- batch.forward                  |  11258 |     0.02545s |  21.3%
- batch.mom                      |  11258 |     0.00126s |   1.1%
- batch.reduce                   |  11258 |     0.02621s |  22.0%
- batch.reporting.compr_err      |  11258 |     0.00001s |   0.0%
- batch.reporting.lr             |  11258 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11258 |     0.00001s |   0.0%
- batch.step                     |  11258 |     0.00048s |   0.4%
- batch.update_runavg            |  11258 |     0.00129s |   1.1%
- batch.wd                       |  11258 |     0.00001s |   0.0%
- epoch_metrics.collect          |     80 |     0.01208s |   0.1%
- reduce.combine                 |  11258 |     0.00614s |   5.1%
- reduce.flatpack                |  11258 |     0.00002s |   0.0%
- reduce.flatput                 |  11258 |     0.00020s |   0.2%
-----------------------------------------------------------------
-----------------------------------------------------------------
- reduce.gather.context          |  11258 |     0.00205s |   1.7%
- reduce.gather.tensors          |  11258 |     0.00385s |   3.2%
- reduce.heur_params             |  11258 |     0.01058s |   8.9%
- reduce.heur_params.alpha       |  11257 |     0.00819s |   6.9%
- reduce.heur_params.beta        |  11257 |     0.00232s |   1.9%
- reduce.memory                  |  11258 |     0.00045s |   0.4%
- reduce.pad                     |  11258 |     0.00027s |   0.2%
- reduce.threshold               |  11258 |     0.00244s |   2.0%
- test.last                      |     80 |     0.41044s |   2.5%
- test.runavg                    |     80 |     0.44124s |   2.7%
-----------------------------------------------------------------

[Iteration 11260] [Rank 2] a = 1.0183144807815552, b = 0.9999309600513635, delta = 0.0007074151653796434, c = 0.0008619201025074199, d = 0.0008623691631571713, m = 0.0006121095339194839
[Iteration 11270] [Rank 2] a = 1.0746806859970093, b = 0.9997681928414344, delta = 0.000758134585339576, c = 0.0005363856745645726, d = 0.0005374565114985952, m = 0.0006122767772631499
[Iteration 11280] [Rank 2] a = 0.967624843120575, b = 0.999894378880255, delta = 0.0007362218457274139, c = 0.0007887577597248487, d = 0.0007897940535319674, m = 0.0006125708762470797
[Iteration 11290] [Rank 2] a = 1.023905634880066, b = 0.9997131311008665, delta = 0.0007960951770655811, c = 0.00042626218599477243, d = 0.00042719485042117916, m = 0.0006129310379919925
[Iteration 11300] [Rank 2] a = 0.9932677745819092, b = 0.9998570032175269, delta = 0.000757091969717294, c = 0.0007140064331046959, d = 0.0007155263306884697, m = 0.0006130853606984714
[Iteration 11310] [Rank 2] a = 1.0050235986709595, b = 0.9998406815904382, delta = 0.0007300711586140096, c = 0.0006813631781804608, d = 0.0006825031013682913, m = 0.0006140021597888487
[Iteration 11320] [Rank 2] a = 1.0536977052688599, b = 0.9997281055452104, delta = 0.0007738094427622855, c = 0.0004562110770204992, d = 0.00045710919832000194, m = 0.0006141265698341226
[Iteration 11330] [Rank 2] a = 1.018429160118103, b = 0.9997774676705293, delta = 0.0007787914364598691, c = 0.0005549353337119951, d = 0.0005556952825038821, m = 0.0006142750999150769
[Iteration 11340] [Rank 2] a = 0.8871503472328186, b = 1.000347705591774, delta = 0.000724206620361656, c = 0.001695411211572887, d = 0.0016859118516743, m = 0.0006144752573753023
[Iteration 11350] [Rank 2] a = 0.987988293170929, b = 0.999807485646514, delta = 0.0007600230164825916, c = 0.0006149712882710643, d = 0.0006166984446162619, m = 0.0006146673994410472
[Iteration 11360] [Rank 2] a = 0.9537044763565063, b = 1.0000296152216828, delta = 0.0007339928415603936, c = 0.001059230443382796, d = 0.0010586777533523328, m = 0.0006148606262125468
[Iteration 11370] [Rank 2] a = 0.9499521851539612, b = 1.0046870306997342, delta = 0.0006406671600416303, c = 0.010374130044302597, d = 0.009135413513526864, m = 0.0006163957100008688
[Iteration 11380] [Rank 2] a = 0.9187387228012085, b = 1.000092380083013, delta = 0.0007272576913237572, c = 0.001184760166551759, d = 0.0011834475277294088, m = 0.0006164467997123318
[Iteration 11390] [Rank 2] a = 1.0210975408554077, b = 0.9998939989058636, delta = 0.0006993431015871465, c = 0.0007879978109329619, d = 0.0007887923028517528, m = 0.0006168123511154933
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11397 |     0.11099s |  93.0%
- batch.accumulate               |  11397 |     0.00082s |   0.7%
- batch.backward                 |  11397 |     0.05174s |  43.3%
- batch.evaluate                 |  11397 |     0.00274s |   2.3%
- batch.forward                  |  11397 |     0.02545s |  21.3%
- batch.mom                      |  11397 |     0.00126s |   1.1%
- batch.reduce                   |  11397 |     0.02623s |  22.0%
- batch.reporting.compr_err      |  11397 |     0.00001s |   0.0%
- batch.reporting.lr             |  11397 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11397 |     0.00001s |   0.0%
- batch.step                     |  11397 |     0.00048s |   0.4%
- batch.update_runavg            |  11397 |     0.00129s |   1.1%
- batch.wd                       |  11397 |     0.00001s |   0.0%
- epoch_metrics.collect          |     81 |     0.01198s |   0.1%
- reduce.combine                 |  11397 |     0.00614s |   5.1%
- reduce.flatpack                |  11397 |     0.00002s |   0.0%
- reduce.flatput                 |  11397 |     0.00020s |   0.2%
- reduce.gather.context          |  11397 |     0.00206s |   1.7%
- reduce.gather.tensors          |  11397 |     0.00385s |   3.2%
- reduce.heur_params             |  11397 |     0.01058s |   8.9%
- reduce.heur_params.alpha       |  11396 |     0.00818s |   6.9%
- reduce.heur_params.beta        |  11396 |     0.00232s |   1.9%
- reduce.memory                  |  11397 |     0.00045s |   0.4%
- reduce.pad                     |  11397 |     0.00027s |   0.2%
- reduce.threshold               |  11397 |     0.00245s |   2.1%
- test.last                      |     81 |     0.41036s |   2.5%
- test.runavg                    |     81 |     0.44111s |   2.7%
-----------------------------------------------------------------
last_cross_entropy             - bits:28713653376.000, epoch: 81.000, ratio_transmit_grad:  0.177, value:  5.140 (split:test)
last_perplexity                - bits:28713653376.000, epoch: 81.000, ratio_transmit_grad:  0.177, value:171.249 (split:test)
runavg_cross_entropy           - bits:28713653376.000, epoch: 81.000, ratio_transmit_grad:  0.177, value:  5.340 (split:test)
runavg_perplexity              - bits:28713653376.000, epoch: 81.000, ratio_transmit_grad:  0.177, value:209.259 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11258 |     0.11092s |  92.9%
- batch.accumulate               |  11258 |     0.00082s |   0.7%
- batch.backward                 |  11258 |     0.05163s |  43.3%
- batch.evaluate                 |  11258 |     0.00275s |   2.3%
- batch.forward                  |  11258 |     0.02540s |  21.3%
- batch.mom                      |  11258 |     0.00126s |   1.1%
- batch.reduce                   |  11258 |     0.02624s |  22.0%
- batch.reporting.compr_err      |  11258 |     0.00001s |   0.0%
- batch.reporting.lr             |  11258 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11258 |     0.00001s |   0.0%
- batch.step                     |  11258 |     0.00048s |   0.4%
- batch.update_runavg            |  11258 |     0.00130s |   1.1%
- batch.wd                       |  11258 |     0.00001s |   0.0%
- epoch_metrics.collect          |     80 |     0.00796s |   0.0%
- reduce.combine                 |  11258 |     0.00642s |   5.4%
- reduce.flatpack                |  11258 |     0.00002s |   0.0%
- reduce.flatput                 |  11258 |     0.00021s |   0.2%
- reduce.gather.context          |  11258 |     0.00112s |   0.9%
- reduce.gather.tensors          |  11258 |     0.00394s |   3.3%
- reduce.heur_params             |  11258 |     0.01111s |   9.3%
- reduce.heur_params.alpha       |  11257 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  11257 |     0.00233s |   1.9%
- reduce.memory                  |  11258 |     0.00046s |   0.4%
- reduce.pad                     |  11258 |     0.00028s |   0.2%
- reduce.threshold               |  11258 |     0.00245s |   2.1%
- test.last                      |     80 |     0.41043s |   2.5%
- test.runavg                    |     80 |     0.44124s |   2.7%
-----------------------------------------------------------------

[Iteration 11260] [Rank 0] a = 1.082934856414795, b = 0.9997631840883082, delta = 0.0007607724983245134, c = 0.0005263681677624265, d = 0.0005276462634578727, m = 0.0005687242591708638
[Iteration 11270] [Rank 0] a = 1.0028164386749268, b = 0.9998937398324147, delta = 0.0007578080403618515, c = 0.0007874796640294025, d = 0.0007881359834405777, m = 0.0005689011159350488
[Iteration 11280] [Rank 0] a = 1.1918319463729858, b = 0.9996476718820931, delta = 0.0008152757654897869, c = 0.0002953437350287929, d = 0.00029603459756687194, m = 0.0005696249048345711
[Iteration 11290] [Rank 0] a = 1.0822101831436157, b = 0.9997349968985311, delta = 0.0007728029740974307, c = 0.00046999378465517616, d = 0.00047085736282777497, m = 0.000569843554993476
[Iteration 11300] [Rank 0] a = 1.0306516885757446, b = 0.9998543952115, delta = 0.0007482695509679615, c = 0.000708790420942199, d = 0.0007096539991147978, m = 0.0005701696901969247
[Iteration 11310] [Rank 0] a = 0.9611359238624573, b = 1.0002871342248694, delta = 0.0007214752840809524, c = 0.0015742684655207261, d = 0.0015669798657439921, m = 0.0005705062490268467
[Iteration 11320] [Rank 0] a = 0.967456579208374, b = 0.9999291292656464, delta = 0.0007270960486494005, c = 0.000858258531055601, d = 0.0008588803073398721, m = 0.000572190008531569
[Iteration 11330] [Rank 0] a = 0.9322912096977234, b = 1.0003321611864637, delta = 0.0007018104661256075, c = 0.0016643223973593299, d = 0.0016565501938059406, m = 0.0005724735904679865
[Iteration 11340] [Rank 0] a = 0.9522221684455872, b = 1.0000732950055302, delta = 0.0007400322938337922, c = 0.0011465900113228915, d = 0.0011457955194041007, m = 0.0005726076534799261
[Iteration 11350] [Rank 0] a = 1.004033088684082, b = 0.999783374544945, delta = 0.0007622824632562697, c = 0.0005667490831131468, d = 0.0005675090319050337, m = 0.0005730431780192989
[Iteration 11360] [Rank 0] a = 1.0654934644699097, b = 0.9997291936536278, delta = 0.0007694968953728676, c = 0.00045838729401544815, d = 0.00045935450156875884, m = 0.0005734090989248461
[Iteration 11370] [Rank 0] a = 0.9934927821159363, b = 0.999754531035522, delta = 0.0007592752226628363, c = 0.0005090620611835463, d = 0.0005104092431328004, m = 0.0005739106622439172
[Iteration 11380] [Rank 0] a = 1.0270711183547974, b = 0.9998060866499264, delta = 0.0007605066057294607, c = 0.0006121732949918442, d = 0.0006128296144030193, m = 0.0005740216785046613
[Iteration 11390] [Rank 0] a = 1.0845212936401367, b = 0.9997521648314731, delta = 0.0007488155388273299, c = 0.0005043296527977049, d = 0.0005051241447164958, m = 0.0005743867258579917
cross_entropy                  - bits:29192727616.000, epoch: 82.000, ratio_transmit_grad:  0.186, value:  5.344 (split:train)
last_cross_entropy             - bits:29192727616.000, epoch: 82.000, ratio_transmit_grad:  0.186, value:  5.344 (split:train)
perplexity                     - bits:29192727616.000, epoch: 82.000, ratio_transmit_grad:  0.186, value:209.993 (split:train)
last_perplexity                - bits:29192727616.000, epoch: 82.000, ratio_transmit_grad:  0.186, value:209.993 (split:train)
last_cross_entropy             - bits:29192727616.000, epoch: 82.000, ratio_transmit_grad:  0.186, value:  5.140 (split:test)
last_perplexity                - bits:29192727616.000, epoch: 82.000, ratio_transmit_grad:  0.186, value:171.232 (split:test)
runavg_cross_entropy           - bits:29192727616.000, epoch: 82.000, ratio_transmit_grad:  0.186, value:  5.341 (split:test)
runavg_perplexity              - bits:29192727616.000, epoch: 82.000, ratio_transmit_grad:  0.186, value:209.483 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11397 |     0.11093s |  92.9%
- batch.accumulate               |  11397 |     0.00082s |   0.7%
- batch.backward                 |  11397 |     0.05163s |  43.3%
- batch.evaluate                 |  11397 |     0.00275s |   2.3%
- batch.forward                  |  11397 |     0.02540s |  21.3%
- batch.mom                      |  11397 |     0.00126s |   1.1%
- batch.reduce                   |  11397 |     0.02626s |  22.0%
- batch.reporting.compr_err      |  11397 |     0.00001s |   0.0%
- batch.reporting.lr             |  11397 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11397 |     0.00001s |   0.0%
- batch.step                     |  11397 |     0.00048s |   0.4%
- batch.update_runavg            |  11397 |     0.00130s |   1.1%
- batch.wd                       |  11397 |     0.00001s |   0.0%
- epoch_metrics.collect          |     81 |     0.00787s |   0.0%
- reduce.combine                 |  11397 |     0.00643s |   5.4%
- reduce.flatpack                |  11397 |     0.00002s |   0.0%
- reduce.flatput                 |  11397 |     0.00021s |   0.2%
- reduce.gather.context          |  11397 |     0.00112s |   0.9%
- reduce.gather.tensors          |  11397 |     0.00395s |   3.3%
- reduce.heur_params             |  11397 |     0.01112s |   9.3%
- reduce.heur_params.alpha       |  11396 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  11396 |     0.00233s |   2.0%
- reduce.memory                  |  11397 |     0.00046s |   0.4%
- reduce.pad                     |  11397 |     0.00028s |   0.2%
- reduce.threshold               |  11397 |     0.00246s |   2.1%
- test.last                      |     81 |     0.41035s |   2.5%
- test.runavg                    |     81 |     0.44111s |   2.7%
-----------------------------------------------------------------

[Iteration 11400] [Rank 0] a = 0.9531229138374329, b = 0.9999390085998979, delta = 0.0007585791172459722, c = 0.0008780171996446617, d = 0.0008783971740406052, m = 0.0005746484669397489
[Iteration 11410] [Rank 0] a = 1.0380702018737793, b = 0.9998409924785724, delta = 0.0007321059238165617, c = 0.0006819849544647319, d = 0.0006830557913987545, m = 0.0005751321651104012
[Iteration 11420] [Rank 0] a = 0.9121947288513184, b = 1.0002129874076404, delta = 0.0007181243854574859, c = 0.0014259748217220584, d = 0.001422624138412375, m = 0.000575432020245101
[Iteration 11430] [Rank 0] a = 1.062625527381897, b = 0.999702370917755, delta = 0.0007915453752502799, c = 0.00040474181793361013, d = 0.00040588174112144056, m = 0.0005755469313634079
[Iteration 11440] [Rank 0] a = 0.8980070948600769, b = 1.0016605501606135, delta = 0.0006877682753838599, c = 0.004321103373796116, d = 0.004193639235520532, m = 0.0005760119791400432
[Iteration 11450] [Rank 0] a = 0.9625020027160645, b = 0.9998731348574972, delta = 0.0007855209405533969, c = 0.0007462697136329874, d = 0.0007471332918055862, m = 0.0005761205571221179
[Iteration 11460] [Rank 0] a = 0.9486361742019653, b = 0.9999892688494681, delta = 0.0007467448012903333, c = 0.0009785376989351632, d = 0.0009787104145696829, m = 0.0005764772908507239
[Iteration 11470] [Rank 0] a = 1.0168472528457642, b = 0.9997919239684682, delta = 0.0007943069213069975, c = 0.0005838479309306032, d = 0.0005848496816108178, m = 0.0005765862796712297
[Iteration 11480] [Rank 0] a = 1.0589498281478882, b = 0.9997228204471923, delta = 0.0008096680976450443, c = 0.0004456408801878897, d = 0.0004464699152335846, m = 0.0005767365388089837
[Iteration 11490] [Rank 0] a = 0.8917207717895508, b = 1.0002561663138878, delta = 0.0007089818245731294, c = 0.0015123326389819395, d = 0.0015081874637534651, m = 0.0005775127707565019
[Iteration 11500] [Rank 0] a = 0.9730532169342041, b = 0.9998931698708271, delta = 0.0007568420260213315, c = 0.0007863397408415722, d = 0.000787203319014171, m = 0.0005776612481919851
[Iteration 11510] [Rank 0] a = 0.9704360365867615, b = 0.9998825824025643, delta = 0.0007689803023822606, c = 0.0007651648040494493, d = 0.0007656138646992006, m = 0.0005777828408465005
[Iteration 11520] [Rank 0] a = 0.9084713459014893, b = 1.0020928731359793, delta = 0.0006789557519368827, c = 0.0051857523833289485, d = 0.004855278288238836, m = 0.0005785694077314916
[Iteration 11530] [Rank 0] a = 0.9017946124076843, b = 1.0002512439186209, delta = 0.0007108406280167401, c = 0.001502487847814313, d = 0.0014960973693370818, m = 0.0005787821219059907
cross_entropy                  - bits:29681270208.000, epoch: 83.000, ratio_transmit_grad:  0.190, value:  5.343 (split:train)
last_cross_entropy             - bits:29681270208.000, epoch: 83.000, ratio_transmit_grad:  0.190, value:  5.343 (split:train)
perplexity                     - bits:29681270208.000, epoch: 83.000, ratio_transmit_grad:  0.190, value:209.762 (split:train)
last_perplexity                - bits:29681270208.000, epoch: 83.000, ratio_transmit_grad:  0.190, value:209.762 (split:train)
last_cross_entropy             - bits:29681270208.000, epoch: 83.000, ratio_transmit_grad:  0.190, value:  5.139 (split:test)
last_perplexity                - bits:29681270208.000, epoch: 83.000, ratio_transmit_grad:  0.190, value:171.170 (split:test)
runavg_cross_entropy           - bits:29681270208.000, epoch: 83.000, ratio_transmit_grad:  0.190, value:  5.340 (split:test)
runavg_perplexity              - bits:29681270208.000, epoch: 83.000, ratio_transmit_grad:  0.190, value:209.122 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11536 |     0.11095s |  92.9%
- batch.accumulate               |  11536 |     0.00082s |   0.7%
- batch.backward                 |  11536 |     0.05163s |  43.2%
- batch.evaluate                 |  11536 |     0.00275s |   2.3%
- batch.forward                  |  11536 |     0.02540s |  21.3%
- batch.mom                      |  11536 |     0.00126s |   1.1%
- batch.reduce                   |  11536 |     0.02628s |  22.0%
- batch.reporting.compr_err      |  11536 |     0.00001s |   0.0%
- batch.reporting.lr             |  11536 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11536 |     0.00001s |   0.0%
- batch.step                     |  11536 |     0.00048s |   0.4%
- batch.update_runavg            |  11536 |     0.00130s |   1.1%
- batch.wd                       |  11536 |     0.00001s |   0.0%
- epoch_metrics.collect          |     82 |     0.00778s |   0.0%
- reduce.combine                 |  11536 |     0.00643s |   5.4%
- reduce.flatpack                |  11536 |     0.00002s |   0.0%
- reduce.flatput                 |  11536 |     0.00021s |   0.2%
- reduce.gather.context          |  11536 |     0.00111s |   0.9%
- reduce.gather.tensors          |  11536 |     0.00396s |   3.3%
- reduce.heur_params             |  11536 |     0.01112s |   9.3%
- reduce.heur_params.alpha       |  11535 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  11535 |     0.00233s |   2.0%
- reduce.memory                  |  11536 |     0.00046s |   0.4%
- reduce.pad                     |  11536 |     0.00028s |   0.2%
- reduce.threshold               |  11536 |     0.00246s |   2.1%
- test.last                      |     82 |     0.41025s |   2.5%
- test.runavg                    |     82 |     0.44101s |   2.7%
-----------------------------------------------------------------

[Iteration 11540] [Rank 0] a = 0.9320492148399353, b = 1.000804762815683, delta = 0.0006884992471896112, c = 0.002609525978832179, d = 0.0025524261900599456, m = 0.0005792453383752842
[Iteration 11550] [Rank 0] a = 1.0455955266952515, b = 0.9997082605203808, delta = 0.0008118394180200994, c = 0.0004165210242078579, d = 0.00041741914550736065, m = 0.0005794000644876036
[Iteration 11560] [Rank 0] a = 1.063038945198059, b = 0.9997583825939433, delta = 0.000773919397033751, c = 0.0005167651784831277, d = 0.0005176632997826305, m = 0.0005796102891206641
[Iteration 11570] [Rank 0] a = 0.9519639015197754, b = 1.0007052441238835, delta = 0.0007032035500742495, c = 0.0024104884816116053, d = 0.0023615754139156087, m = 0.0005799951438220155
[Iteration 11580] [Rank 0] a = 1.0912684202194214, b = 0.9996966194876449, delta = 0.0008148835622705519, c = 0.00039323895667459395, d = 0.00039406799172028885, m = 0.0005804779373537927
[Iteration 11590] [Rank 0] a = 1.0189080238342285, b = 0.9998468820815661, delta = 0.0007515241741202772, c = 0.0006937641607389798, d = 0.0006947313682922904, m = 0.0005806909406577564
[Iteration 11600] [Rank 0] a = 0.8644148707389832, b = 1.0002166317073606, delta = 0.0007203669520094991, c = 0.0014332634214987924, d = 0.0014285655562398549, m = 0.0005809713796549059
[Iteration 11610] [Rank 0] a = 0.9730578064918518, b = 0.9999377650473341, delta = 0.0007689825724810362, c = 0.0008755300945075772, d = 0.0008762900432994641, m = 0.0005811142608747716
memory_norm                    - epoch: 83.576, value:  1.275 (weight:encoder.weight)
memory_inf_norm                - epoch: 83.576, value:  0.001 (weight:encoder.weight)
memory_norm                    - epoch: 83.576, value:  0.395 (weight:rnn.weight_ih_l0)
memory_inf_norm                - epoch: 83.576, value:  0.001 (weight:rnn.weight_ih_l0)
memory_norm                    - epoch: 83.576, value:  0.374 (weight:rnn.weight_hh_l0)
memory_inf_norm                - epoch: 83.576, value:  0.001 (weight:rnn.weight_hh_l0)
memory_norm                    - epoch: 83.576, value:  0.017 (weight:rnn.bias_ih_l0)
memory_inf_norm                - epoch: 83.576, value:  0.001 (weight:rnn.bias_ih_l0)
memory_norm                    - epoch: 83.576, value:  0.017 (weight:rnn.bias_hh_l0)
memory_inf_norm                - epoch: 83.576, value:  0.001 (weight:rnn.bias_hh_l0)
memory_norm                    - epoch: 83.576, value:  0.315 (weight:rnn.weight_ih_l1)
memory_inf_norm                - epoch: 83.576, value:  0.001 (weight:rnn.weight_ih_l1)
memory_norm                    - epoch: 83.576, value:  0.244 (weight:rnn.weight_hh_l1)
memory_inf_norm                - epoch: 83.576, value:  0.001 (weight:rnn.weight_hh_l1)
memory_norm                    - epoch: 83.576, value:  0.016 (weight:rnn.bias_ih_l1)
memory_inf_norm                - epoch: 83.576, value:  0.001 (weight:rnn.bias_ih_l1)
memory_norm                    - epoch: 83.576, value:  0.016 (weight:rnn.bias_hh_l1)

[Iteration 11400] [Rank 1] a = 1.060653567314148, b = 0.9997942383578717, delta = 0.0007592986221425235, c = 0.0005884767099357328, d = 0.0005892366587276198, m = 0.0007292191613547679
[Iteration 11410] [Rank 1] a = 1.0276373624801636, b = 0.9997648767014322, delta = 0.000804007810074836, c = 0.0005297533941990138, d = 0.0005307206017523244, m = 0.0007292606973194188
[Iteration 11420] [Rank 1] a = 1.06036376953125, b = 0.9997312144264046, delta = 0.0008044203859753907, c = 0.0004624288398632106, d = 0.0004632578749089055, m = 0.0007297992143977402
[Iteration 11430] [Rank 1] a = 0.9219934344291687, b = 1.0039279941495223, delta = 0.0006620273925364017, c = 0.008856028703127697, d = 0.007739560298465052, m = 0.0007315509751959626
[Iteration 11440] [Rank 1] a = 1.0295073986053467, b = 0.9997539610739625, delta = 0.0007767954375594854, c = 0.0005079221379957159, d = 0.0005087857161683147, m = 0.0007315808172890444
[Iteration 11450] [Rank 1] a = 0.9739322662353516, b = 1.0001478908871324, delta = 0.0007184415007941425, c = 0.001295781776421062, d = 0.0012916020580656838, m = 0.0007317344629680632
[Iteration 11460] [Rank 1] a = 1.021072268486023, b = 0.9997897650231312, delta = 0.0007502390071749687, c = 0.0005795300400676091, d = 0.0005804627044940159, m = 0.0007323997816642548
[Iteration 11470] [Rank 1] a = 1.1263091564178467, b = 0.9997134074458589, delta = 0.0007632961496710777, c = 0.00042681487602523567, d = 0.0004277475404516424, m = 0.0007326731371703023
[Iteration 11480] [Rank 1] a = 1.0372886657714844, b = 0.9998331511889735, delta = 0.0007449965341947973, c = 0.0006663023748503376, d = 0.0006677531861803036, m = 0.0007326971080011689
[Iteration 11490] [Rank 1] a = 0.9701642394065857, b = 1.0001811386458745, delta = 0.0007244690787047148, c = 0.0013622772957111702, d = 0.0013584775517517355, m = 0.0007328298399945577
[Iteration 11500] [Rank 1] a = 1.082237720489502, b = 0.9997363268088237, delta = 0.0007735019898973405, c = 0.0004726536054267805, d = 0.0004733099248379556, m = 0.0007329299996002959
[Iteration 11510] [Rank 1] a = 0.970819890499115, b = 0.9998432550533283, delta = 0.000768166733905673, c = 0.0006865101040891497, d = 0.0006873391391348446, m = 0.0007330435491583832
[Iteration 11520] [Rank 1] a = 1.0115967988967896, b = 0.9998811661343809, delta = 0.0007231951458379626, c = 0.0007623322676433253, d = 0.000763230388942828, m = 0.0007337098135017492
[Iteration 11530] [Rank 1] a = 1.0124220848083496, b = 0.999814135198205, delta = 0.0007699617417529225, c = 0.000628270392129086, d = 0.0006295830309514361, m = 0.0007336929568559075
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11536 |     0.11092s |  92.9%
- batch.accumulate               |  11536 |     0.00083s |   0.7%

[Iteration 11400] [Rank 3] a = 1.017087697982788, b = 0.9997876406209215, delta = 0.0008025434799492359, c = 0.000575281235458423, d = 0.0005762829861386377, m = 0.0006467518982112906
[Iteration 11410] [Rank 3] a = 0.9925798177719116, b = 0.9999796831317543, delta = 0.0007534662145189941, c = 0.0009593662635034696, d = 0.0009596080653917973, m = 0.0006469159371361798
[Iteration 11420] [Rank 3] a = 1.007233738899231, b = 0.9999067971342542, delta = 0.0007484023808501661, c = 0.0008135942679687906, d = 0.0008148723636642368, m = 0.0006470924674307103
[Iteration 11430] [Rank 3] a = 0.9624359607696533, b = 0.999953499441592, delta = 0.0007529273862019181, c = 0.0009069988831170778, d = 0.0009073443143861173, m = 0.0006474259536175028
[Iteration 11440] [Rank 3] a = 1.0072400569915771, b = 0.9997911985628347, delta = 0.0007562490063719451, c = 0.0005823971196006372, d = 0.0005831916115194281, m = 0.0006478939165084345
- batch.backward                 |  11536 |     0.05178s |  43.4%
- batch.evaluate                 |  11536 |     0.00275s |   2.3%
- batch.forward                  |  11536 |     0.02542s |  21.3%
- batch.mom                      |  11536 |     0.00126s |   1.1%
- batch.reduce                   |  11536 |     0.02610s |  21.9%
- batch.reporting.compr_err      |  11536 |     0.00001s |   0.0%
- batch.reporting.lr             |  11536 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11536 |     0.00001s |   0.0%
- batch.step                     |  11536 |     0.00048s |   0.4%
- batch.update_runavg            |  11536 |     0.00130s |   1.1%
- batch.wd                       |  11536 |     0.00001s |   0.0%
- epoch_metrics.collect          |     82 |     0.00684s |   0.0%
- reduce.combine                 |  11536 |     0.00627s |   5.3%
- reduce.flatpack                |  11536 |     0.00002s |   0.0%
- reduce.flatput                 |  11536 |     0.00023s |   0.2%
[Iteration 11450] [Rank 3] a = 0.9676052927970886, b = 0.9998373481787783, delta = 0.0008002453832887113, c = 0.0006746963546879981, d = 0.0006759053641296364, m = 0.0006479054282394984
[Iteration 11460] [Rank 3] a = 0.8822610974311829, b = 1.0005764673998516, delta = 0.000744587741792202, c = 0.0021529349274157362, d = 0.0021332798882073875, m = 0.0006480682152213874
[Iteration 11470] [Rank 3] a = 0.9751514792442322, b = 0.9999682493567572, delta = 0.000772630563005805, c = 0.0009364987134930532, d = 0.0009370168603966124, m = 0.0006481238487929079
[Iteration 11480] [Rank 3] a = 0.9462124109268188, b = 0.9999789577260899, delta = 0.0007651488995179534, c = 0.0009579154521735037, d = 0.0009579845384273116, m = 0.0006485879968536081
[Iteration 11490] [Rank 3] a = 0.9884889125823975, b = 0.9997776403861552, delta = 0.0008138063712976873, c = 0.0005552807649810346, d = 0.0005563170587881532, m = 0.0006488758227518656
- reduce.gather.context          |  11536 |     0.00122s |   1.0%
- reduce.gather.tensors          |  11536 |     0.00385s |   3.2%
- reduce.heur_params             |  11536 |     0.01094s |   9.2%
[Iteration 11500] [Rank 3] a = 0.9633948802947998, b = 0.9999057953835829, delta = 0.0007600951357744634, c = 0.0008115907666083614, d = 0.0008123852585271523, m = 0.0006491707649749522
[Iteration 11510] [Rank 3] a = 0.9893945455551147, b = 0.9997803174783596, delta = 0.0008077944512479007, c = 0.0005606349496511473, d = 0.0005618094159658817, m = 0.0006492737056069238
[Iteration 11520] [Rank 3] a = 1.122473120689392, b = 0.9997182434832351, delta = 0.0007624881691299379, c = 0.00043648695155834236, d = 0.000437488702238557, m = 0.0006502517539747195
[Iteration 11530] [Rank 3] a = 0.9569140076637268, b = 1.0000324650296497, delta = 0.0007452127174474299, c = 0.0010649300593219481, d = 0.0010645500849260046, m = 0.000650311450421773
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11536 |     0.11105s |  93.0%
- batch.accumulate               |  11536 |     0.00082s |   0.7%
- reduce.heur_params.alpha       |  11535 |     0.00836s |   7.0%
- reduce.heur_params.beta        |  11535 |     0.00251s |   2.1%
- reduce.memory                  |  11536 |     0.00047s |   0.4%
- reduce.pad                     |  11536 |     0.00021s |   0.2%
- reduce.threshold               |  11536 |     0.00266s |   2.2%
- test.last                      |     82 |     0.41026s |   2.5%
- test.runavg                    |     82 |     0.44101s |   2.7%
-----------------------------------------------------------------

[Iteration 11540] [Rank 1] a = 0.9168885946273804, b = 0.9999338271308833, delta = 0.0007529697031714022, c = 0.000867654261573476, d = 0.0008681724084770354, m = 0.0007339155577983577
[Iteration 11550] [Rank 1] a = 1.0455211400985718, b = 0.9997234594949912, delta = 0.0008027793955989182, c = 0.000446918975883336, d = 0.0004480588990711664, m = 0.0007339334272918898

[Iteration 11400] [Rank 2] a = 0.9941121935844421, b = 0.9997730288789464, delta = 0.0007921244250610471, c = 0.0005460577500976794, d = 0.0005471285870317018, m = 0.0006169152140237106
[Iteration 11410] [Rank 2] a = 1.1289957761764526, b = 0.9997142710239609, delta = 0.0008096473757177591, c = 0.0004285420323704333, d = 0.0004289910930201847, m = 0.0006171006324435612
[Iteration 11420] [Rank 2] a = 0.9741230010986328, b = 0.9999007348155388, delta = 0.0007545323460362852, c = 0.0008014696304255033, d = 0.0008022295792173902, m = 0.0006173560948194706
[Iteration 11430] [Rank 2] a = 1.0157420635223389, b = 0.9998247226662557, delta = 0.0007483983063139021, c = 0.0006494453289212089, d = 0.0006505161658552313, m = 0.0006178582457402968
[Iteration 11440] [Rank 2] a = 0.9958526492118835, b = 0.9998286951257301, delta = 0.0007658975082449615, c = 0.0006573902481091179, d = 0.0006588065163121799, m = 0.0006180293105915793
- batch.backward                 |  11536 |     0.05175s |  43.3%
- batch.evaluate                 |  11536 |     0.00277s |   2.3%
- batch.forward                  |  11536 |     0.02537s |  21.3%
- batch.mom                      |  11536 |     0.00126s |   1.1%
- batch.reduce                   |  11536 |     0.02630s |  22.0%
- batch.reporting.compr_err      |  11536 |     0.00001s |   0.0%
- batch.reporting.lr             |  11536 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11536 |     0.00001s |   0.0%
- batch.step                     |  11536 |     0.00047s |   0.4%
- batch.update_runavg            |  11536 |     0.00129s |   1.1%
- batch.wd                       |  11536 |     0.00001s |   0.0%
- epoch_metrics.collect          |     82 |     0.00721s |   0.0%
- reduce.combine                 |  11536 |     0.00616s |   5.2%
- reduce.flatpack                |  11536 |     0.00002s |   0.0%
- reduce.flatput                 |  11536 |     0.00020s |   0.2%
[Iteration 11560] [Rank 1] a = 1.0505424737930298, b = 0.999749902256801, delta = 0.0007801419706083834, c = 0.0004998045031732871, d = 0.0005009098832342135, m = 0.000734039812326978
[Iteration 11570] [Rank 1] a = 0.9301270246505737, b = 1.0001723646919152, delta = 0.0007482940563932061, c = 0.0013447293872439624, d = 0.0013404114963809683, m = 0.0007341311943560465
[Iteration 11580] [Rank 1] a = 1.0758463144302368, b = 0.9997522684608474, delta = 0.0007878360920585692, c = 0.0005045369115591285, d = 0.0005053659466048234, m = 0.0007345649834260623
[Iteration 11590] [Rank 1] a = 1.0231419801712036, b = 0.9998350337893379, delta = 0.000761877978220582, c = 0.0006700675756828684, d = 0.000671069326363083, m = 0.0007346773102472388
[Iteration 11600] [Rank 1] a = 1.0639123916625977, b = 0.9997523893617843, delta = 0.0007765382761135697, c = 0.0005047787134474563, d = 0.0005057113778738629, m = 0.0007348007553170735
- reduce.gather.context          |  11536 |     0.00248s |   2.1%
- reduce.gather.tensors          |  11536 |     0.00350s |   2.9%
- reduce.heur_params             |  11536 |     0.01053s |   8.8%
[Iteration 11610] [Rank 1] a = 0.9880649447441101, b = 0.9997886423715566, delta = 0.00080586172407493, c = 0.0005772847368188523, d = 0.0005783555737528748, m = 0.000734767155827502
[Iteration 11620] [Rank 1] a = 1.1210622787475586, b = 0.999675254565763, delta = 0.0008048088639043272, c = 0.00035050910869440486, d = 0.0003516490318822353, m = 0.000735249270133276
[Iteration 11630] [Rank 1] a = 1.0667507648468018, b = 0.9997650148739322, delta = 0.0007763245957903564, c = 0.0005300297392142454, d = 0.0005309624036406521, m = 0.0007353474655820764
[Iteration 11640] [Rank 1] a = 1.0527534484863281, b = 0.9997865006977852, delta = 0.0007738979184068739, c = 0.0005730013890827622, d = 0.0005737958810015531, m = 0.0007354072934008099
[Iteration 11650] [Rank 1] a = 1.0058577060699463, b = 0.9999301310163217, delta = 0.0007550970767624676, c = 0.0008602620324160302, d = 0.0008610910674617251, m = 0.0007354630486246333
- reduce.heur_params.alpha       |  11535 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  11535 |     0.00236s |   2.0%
- reduce.memory                  |  11536 |     0.00045s |   0.4%
- reduce.pad                     |  11536 |     0.00026s |   0.2%
- reduce.threshold               |  11536 |     0.00250s |   2.1%
- test.last                      |     82 |     0.41027s |   2.5%
- test.runavg                    |     82 |     0.44100s |   2.7%
-----------------------------------------------------------------

[Iteration 11540] [Rank 3] a = 1.0915906429290771, b = 0.9997342024066681, delta = 0.0007728708442300558, c = 0.0004684048008175944, d = 0.00046919929273638527, m = 0.0006507070225427094
[Iteration 11550] [Rank 3] a = 1.0354396104812622, b = 0.9998440840883537, delta = 0.0007252031937241554, c = 0.0006881681741805394, d = 0.0006893426404952738, m = 0.0006511137909584055
[Iteration 11660] [Rank 1] a = 0.939506471157074, b = 0.9997806974527371, delta = 0.000836294493637979, c = 0.0005613948984430342, d = 0.0005626729941384805, m = 0.0007353519289927585
[Iteration 11670] [Rank 1] a = 1.0802186727523804, b = 0.9997030445086701, delta = 0.0008158584823831916, c = 0.00040608899988286426, d = 0.00040705620743617494, m = 0.0007357770027966378
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11675 |     0.11093s |  92.9%
- batch.accumulate               |  11675 |     0.00083s |   0.7%
- batch.backward                 |  11675 |     0.05178s |  43.4%
- batch.evaluate                 |  11675 |     0.00275s |   2.3%
- batch.forward                  |  11675 |     0.02542s |  21.3%
- batch.mom                      |  11675 |     0.00126s |   1.1%
- batch.reduce                   |  11675 |     0.02611s |  21.9%
[Iteration 11560] [Rank 3] a = 1.0405455827713013, b = 0.9997318189310818, delta = 0.0007936411420814693, c = 0.0004636378493048489, d = 0.00046450142747744773, m = 0.0006511564999944654
[Iteration 11570] [Rank 3] a = 0.9999895691871643, b = 0.9998530998442688, delta = 0.0007555460324510932, c = 0.0007061996864244026, d = 0.0007071323508508093, m = 0.000651319470435905
[Iteration 11580] [Rank 3] a = 1.0646672248840332, b = 0.9998380217697352, delta = 0.000715902540832758, c = 0.0006760435366372522, d = 0.0006768034854291391, m = 0.0006522185863268957
[Iteration 11590] [Rank 3] a = 0.9463056325912476, b = 1.000172623765359, delta = 0.0007212533964775503, c = 0.0013452475341475217, d = 0.001341378703934279, m = 0.0006523335587063
[Iteration 11600] [Rank 3] a = 0.8650012612342834, b = 1.0004549965265521, delta = 0.0006851630751043558, c = 0.0019099931159002393, d = 0.001897177615818873, m = 0.0006527657836450547
- batch.reporting.compr_err      |  11675 |     0.00001s |   0.0%
- batch.reporting.lr             |  11675 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11675 |     0.00001s |   0.0%
- batch.step                     |  11675 |     0.00048s |   0.4%
- batch.update_runavg            |  11675 |     0.00130s |   1.1%
[Iteration 11450] [Rank 2] a = 0.962898850440979, b = 1.0003450975860058, delta = 0.0007094884058460593, c = 0.0016901951994103903, d = 0.0016788650537858938, m = 0.000618280852258169
[Iteration 11460] [Rank 2] a = 1.023188591003418, b = 0.9997464824874545, delta = 0.000793278100900352, c = 0.0004929649640463045, d = 0.0004938630853458072, m = 0.0006183971159171885
[Iteration 11470] [Rank 2] a = 1.0585503578186035, b = 0.9997874851768573, delta = 0.0007464542868547142, c = 0.0005749703473162874, d = 0.0005759375548695982, m = 0.0006187324569139914
[Iteration 11480] [Rank 2] a = 1.050224781036377, b = 0.9997020254865168, delta = 0.0008081773412413895, c = 0.00040405095539553106, d = 0.00040491453356812987, m = 0.0006188235795444402
[Iteration 11490] [Rank 2] a = 0.9958894848823547, b = 0.9998617183542563, delta = 0.0007497628685086966, c = 0.0007234367067494749, d = 0.0007243693711758816, m = 0.000619083071709993
[Iteration 11610] [Rank 3] a = 1.0442118644714355, b = 0.9996941669258625, delta = 0.0008364793611690402, c = 0.0003883338326542327, d = 0.00038940466958825527, m = 0.0006526624837523112
[Iteration 11620] [Rank 3] a = 0.9678128957748413, b = 1.0001447992773407, delta = 0.0007218719692900777, c = 0.0012895985567052545, d = 0.0012845207170503734, m = 0.0006529223483447979
[Iteration 11630] [Rank 3] a = 1.06650710105896, b = 0.9997613533026858, delta = 0.0007565135019831359, c = 0.0005227065963106075, d = 0.0005233283725948787, m = 0.0006532120503522266
[Iteration 11640] [Rank 3] a = 0.991132378578186, b = 0.9999377477757706, delta = 0.0007461778586730361, c = 0.0008754955513806732, d = 0.0008758755257766167, m = 0.0006536415131997226
[Iteration 11650] [Rank 3] a = 0.9539206027984619, b = 1.0002801219706718, delta = 0.000718266295734793, c = 0.0015602439559977213, d = 0.0015501228198148633, m = 0.0006538140664605767
- batch.wd                       |  11675 |     0.00001s |   0.0%
- epoch_metrics.collect          |     83 |     0.00683s |   0.0%
- reduce.combine                 |  11675 |     0.00628s |   5.3%
- reduce.flatpack                |  11675 |     0.00002s |   0.0%
- reduce.flatput                 |  11675 |     0.00023s |   0.2%
- reduce.gather.context          |  11675 |     0.00122s |   1.0%
- reduce.gather.tensors          |  11675 |     0.00386s |   3.2%
- reduce.heur_params             |  11675 |     0.01094s |   9.2%
- reduce.heur_params.alpha       |  11674 |     0.00836s |   7.0%
- reduce.heur_params.beta        |  11674 |     0.00251s |   2.1%
- reduce.memory                  |  11675 |     0.00047s |   0.4%
- reduce.pad                     |  11675 |     0.00021s |   0.2%
- reduce.threshold               |  11675 |     0.00266s |   2.2%
- test.last                      |     83 |     0.41025s |   2.5%
- test.runavg                    |     83 |     0.44098s |   2.7%
[Iteration 11500] [Rank 2] a = 0.9667098522186279, b = 0.9999294228822236, delta = 0.0007288433844223619, c = 0.0008588457642129682, d = 0.0008594329973703353, m = 0.000619698089142955
[Iteration 11510] [Rank 2] a = 0.9230186939239502, b = 1.000182641271845, delta = 0.0007311428780667484, c = 0.0013652825477518142, d = 0.0013623463819649783, m = 0.0006198438707513192
[Iteration 11520] [Rank 2] a = 0.8972473740577698, b = 0.9999470571484406, delta = 0.0007302165031433105, c = 0.0008941142967819035, d = 0.0008944251849240391, m = 0.0006202722625537813
[Iteration 11530] [Rank 2] a = 0.9628723859786987, b = 1.0000954716928436, delta = 0.0007179685635492206, c = 0.0011909433862675664, d = 0.0011893544024299846, m = 0.0006204476904844435
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11536 |     0.11101s |  93.0%
- batch.accumulate               |  11536 |     0.00082s |   0.7%
[Iteration 11660] [Rank 3] a = 0.8930299878120422, b = 1.0003582239726057, delta = 0.0007150745368562639, c = 0.001716447975857394, d = 0.0017072249609740389, m = 0.0006542255514406053
[Iteration 11670] [Rank 3] a = 0.9782453179359436, b = 1.0002670473981177, delta = 0.000707691942807287, c = 0.0015340948089314294, d = 0.0015236973277333397, m = 0.0006544235407640184
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11675 |     0.11106s |  93.0%
- batch.accumulate               |  11675 |     0.00082s |   0.7%
- batch.backward                 |  11675 |     0.05175s |  43.3%
- batch.evaluate                 |  11675 |     0.00277s |   2.3%
- batch.forward                  |  11675 |     0.02537s |  21.3%
- batch.mom                      |  11675 |     0.00126s |   1.1%
- batch.reduce                   |  11675 |     0.02631s |  22.0%
-----------------------------------------------------------------
- batch.backward                 |  11536 |     0.05174s |  43.3%
- batch.evaluate                 |  11536 |     0.00274s |   2.3%
- batch.forward                  |  11536 |     0.02545s |  21.3%
- batch.mom                      |  11536 |     0.00126s |   1.1%
- batch.reduce                   |  11536 |     0.02625s |  22.0%
- batch.reporting.compr_err      |  11536 |     0.00001s |   0.0%
- batch.reporting.lr             |  11536 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11536 |     0.00001s |   0.0%
- batch.step                     |  11536 |     0.00048s |   0.4%
- batch.update_runavg            |  11536 |     0.00129s |   1.1%
- batch.wd                       |  11536 |     0.00001s |   0.0%
- epoch_metrics.collect          |     82 |     0.01187s |   0.1%
- reduce.combine                 |  11536 |     0.00615s |   5.1%
- reduce.flatpack                |  11536 |     0.00002s |   0.0%
- reduce.flatput                 |  11536 |     0.00020s |   0.2%
- batch.reporting.compr_err      |  11675 |     0.00001s |   0.0%
- batch.reporting.lr             |  11675 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11675 |     0.00001s |   0.0%
- batch.step                     |  11675 |     0.00047s |   0.4%
- batch.update_runavg            |  11675 |     0.00129s |   1.1%
- reduce.gather.context          |  11536 |     0.00206s |   1.7%
- reduce.gather.tensors          |  11536 |     0.00387s |   3.2%
- reduce.heur_params             |  11536 |     0.01058s |   8.9%
- batch.wd                       |  11675 |     0.00001s |   0.0%
- epoch_metrics.collect          |     83 |     0.00713s |   0.0%
- reduce.combine                 |  11675 |     0.00616s |   5.2%
- reduce.flatpack                |  11675 |     0.00002s |   0.0%
- reduce.flatput                 |  11675 |     0.00020s |   0.2%
- reduce.gather.context          |  11675 |     0.00247s |   2.1%
- reduce.gather.tensors          |  11675 |     0.00351s |   2.9%
- reduce.heur_params             |  11675 |     0.01053s |   8.8%
- reduce.heur_params.alpha       |  11674 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  11674 |     0.00236s |   2.0%
- reduce.memory                  |  11675 |     0.00046s |   0.4%
- reduce.pad                     |  11675 |     0.00026s |   0.2%
- reduce.threshold               |  11675 |     0.00250s |   2.1%
- test.last                      |     83 |     0.41025s |   2.5%
- test.runavg                    |     83 |     0.44097s |   2.7%
- reduce.heur_params.alpha       |  11535 |     0.00818s |   6.9%
- reduce.heur_params.beta        |  11535 |     0.00232s |   1.9%
- reduce.memory                  |  11536 |     0.00046s |   0.4%
- reduce.pad                     |  11536 |     0.00027s |   0.2%
- reduce.threshold               |  11536 |     0.00245s |   2.1%
- test.last                      |     82 |     0.41026s |   2.5%
- test.runavg                    |     82 |     0.44101s |   2.7%
-----------------------------------------------------------------

[Iteration 11540] [Rank 2] a = 0.9883752465248108, b = 0.9998847758910929, delta = 0.0007295028772205114, c = 0.0007695517811662513, d = 0.0007703462730850422, m = 0.0006208401269213227
[Iteration 11550] [Rank 2] a = 1.079546570777893, b = 0.9996981048419658, delta = 0.0008018783410079777, c = 0.00039620966558833387, d = 0.0003970387006340287, m = 0.0006209352005492891
-----------------------------------------------------------------
[Iteration 11560] [Rank 2] a = 1.1355913877487183, b = 0.9996568776242999, delta = 0.0007986119017004967, c = 0.0003137552216685995, d = 0.0003143769979528707, m = 0.0006214301568210996
[Iteration 11570] [Rank 2] a = 1.1280715465545654, b = 0.9996801078745887, delta = 0.0007921846699900925, c = 0.0003602157273544155, d = 0.0003608375036386866, m = 0.0006216026521436687
[Iteration 11580] [Rank 2] a = 0.8721314072608948, b = 1.0013493863807392, delta = 0.0006871432415209711, c = 0.0036987743994945097, d = 0.0035931760605491274, m = 0.0006219966700769917
[Iteration 11590] [Rank 2] a = 1.0537201166152954, b = 0.9997179671382419, delta = 0.0007900053169578314, c = 0.0004359342615278791, d = 0.000436763296573574, m = 0.000622065566195517
[Iteration 11600] [Rank 2] a = 1.0004435777664185, b = 0.9999188872285787, delta = 0.000742507865652442, c = 0.0008377744568015572, d = 0.0008383962330858283, m = 0.0006222583277858796
[Iteration 11610] [Rank 2] a = 0.9659333229064941, b = 1.0000776474394952, delta = 0.0007248237379826605, c = 0.0011552948793026876, d = 0.0011538786110996254, m = 0.0006225291911560967
[Iteration 11620] [Rank 2] a = 0.9813385605812073, b = 0.9999433092191827, delta = 0.0007509246352128685, c = 0.0008866184382437459, d = 0.0008874820164163447, m = 0.0006226716084720798
[Iteration 11630] [Rank 2] a = 1.025833249092102, b = 0.9998135306935051, delta = 0.0007554888725280762, c = 0.0006270613826874476, d = 0.0006281322196214702, m = 0.0006229602157174591
[Iteration 11640] [Rank 2] a = 1.0078539848327637, b = 0.999844308618673, delta = 0.0007391367107629776, c = 0.0006886172348302908, d = 0.000689895330525737, m = 0.0006234521288948011
[Iteration 11650] [Rank 2] a = 0.8955621123313904, b = 1.0003729911573829, delta = 0.0007045823731459677, c = 0.0017459823493602734, d = 0.0017358957563043192, m = 0.00062375114842766
[Iteration 11660] [Rank 2] a = 1.0795601606369019, b = 0.9996688295448499, delta = 0.0008562856237404048, c = 0.00033765906548613455, d = 0.0003384535574049255, m = 0.0006238072252151839
[Iteration 11670] [Rank 2] a = 1.0620098114013672, b = 0.9997168790298312, delta = 0.0007968972786329687, c = 0.0004337580445329301, d = 0.0004345179933248171, m = 0.0006241147364608566
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11675 |     0.11103s |  93.0%
- batch.accumulate               |  11675 |     0.00082s |   0.7%
- batch.backward                 |  11675 |     0.05173s |  43.3%
- batch.evaluate                 |  11675 |     0.00274s |   2.3%
- batch.forward                  |  11675 |     0.02544s |  21.3%
- batch.mom                      |  11675 |     0.00126s |   1.1%
- batch.reduce                   |  11675 |     0.02628s |  22.0%
- batch.reporting.compr_err      |  11675 |     0.00001s |   0.0%
- batch.reporting.lr             |  11675 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11675 |     0.00001s |   0.0%
- batch.step                     |  11675 |     0.00048s |   0.4%
- batch.update_runavg            |  11675 |     0.00129s |   1.1%
- batch.wd                       |  11675 |     0.00001s |   0.0%
- epoch_metrics.collect          |     83 |     0.01183s |   0.1%
- reduce.combine                 |  11675 |     0.00615s |   5.1%
- reduce.flatpack                |  11675 |     0.00002s |   0.0%
- reduce.flatput                 |  11675 |     0.00020s |   0.2%
- reduce.gather.context          |  11675 |     0.00207s |   1.7%
- reduce.gather.tensors          |  11675 |     0.00387s |   3.2%
- reduce.heur_params             |  11675 |     0.01058s |   8.9%
- reduce.heur_params.alpha       |  11674 |     0.00818s |   6.9%
- reduce.heur_params.beta        |  11674 |     0.00232s |   1.9%
- reduce.memory                  |  11675 |     0.00046s |   0.4%
- reduce.pad                     |  11675 |     0.00027s |   0.2%
- reduce.threshold               |  11675 |     0.00245s |   2.1%
- test.last                      |     83 |     0.41025s |   2.5%
- test.runavg                    |     83 |     0.44098s |   2.7%
-----------------------------------------------------------------
memory_inf_norm                - epoch: 83.576, value:  0.001 (weight:rnn.bias_hh_l1)
memory_norm                    - epoch: 83.576, value:  0.283 (weight:rnn.weight_ih_l2)
memory_inf_norm                - epoch: 83.576, value:  0.001 (weight:rnn.weight_ih_l2)
memory_norm                    - epoch: 83.576, value:  0.227 (weight:rnn.weight_hh_l2)
memory_inf_norm                - epoch: 83.576, value:  0.001 (weight:rnn.weight_hh_l2)
memory_norm                    - epoch: 83.576, value:  0.017 (weight:rnn.bias_ih_l2)
memory_inf_norm                - epoch: 83.576, value:  0.001 (weight:rnn.bias_ih_l2)
memory_norm                    - epoch: 83.576, value:  0.017 (weight:rnn.bias_hh_l2)
memory_inf_norm                - epoch: 83.576, value:  0.001 (weight:rnn.bias_hh_l2)
memory_norm                    - epoch: 83.576, value:  0.061 (weight:decoder.bias)
memory_inf_norm                - epoch: 83.576, value:  0.001 (weight:decoder.bias)
memory_norm                    - epoch: 83.576, value:  1.489 (weight:entire_model)
memory_inf_norm                - epoch: 83.576, value:  0.001 (weight:entire_model)
[Iteration 11620] [Rank 0] a = 0.988784670829773, b = 1.000018751408278, delta = 0.0007233266369439662, c = 0.00103750281656021, d = 0.0010370192127835546, m = 0.0005816073628338238
timer                          - epoch: 83.626, value:  0.000 (event:batch.reporting.lr)
[Iteration 11630] [Rank 0] a = 1.0525206327438354, b = 0.9997250312071458, delta = 0.0008147297776304185, c = 0.00045006240043159564, d = 0.0004508914354772905, m = 0.0005816498493925971
[Iteration 11640] [Rank 0] a = 0.9811991453170776, b = 1.0000836752151008, delta = 0.0007217254606075585, c = 0.001167350430592167, d = 0.0011656923605007773, m = 0.0005823120481372545
[Iteration 11650] [Rank 0] a = 1.0477452278137207, b = 0.9998416142548411, delta = 0.0007248210022225976, c = 0.0006832285070332742, d = 0.000684092085205873, m = 0.0005826559840325493
[Iteration 11660] [Rank 0] a = 1.0128346681594849, b = 0.9997926321025391, delta = 0.0007832629489712417, c = 0.0005852641991336653, d = 0.0005865768379560155, m = 0.0005827327220303751
[Iteration 11670] [Rank 0] a = 0.950103759765625, b = 1.0001527960110417, delta = 0.0007259835838340223, c = 0.0013055920244617843, d = 0.001302897660563276, m = 0.0005831321177833362
cross_entropy                  - bits:30106461760.000, epoch: 84.000, ratio_transmit_grad:  0.165, value:  5.343 (split:train)
last_cross_entropy             - bits:30106461760.000, epoch: 84.000, ratio_transmit_grad:  0.165, value:  5.343 (split:train)
perplexity                     - bits:30106461760.000, epoch: 84.000, ratio_transmit_grad:  0.165, value:209.763 (split:train)
last_perplexity                - bits:30106461760.000, epoch: 84.000, ratio_transmit_grad:  0.165, value:209.763 (split:train)
last_cross_entropy             - bits:30106461760.000, epoch: 84.000, ratio_transmit_grad:  0.165, value:  5.139 (split:test)
last_perplexity                - bits:30106461760.000, epoch: 84.000, ratio_transmit_grad:  0.165, value:171.149 (split:test)
runavg_cross_entropy           - bits:30106461760.000, epoch: 84.000, ratio_transmit_grad:  0.165, value:  5.342 (split:test)
runavg_perplexity              - bits:30106461760.000, epoch: 84.000, ratio_transmit_grad:  0.165, value:209.580 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11675 |     0.11096s |  92.9%
- batch.accumulate               |  11675 |     0.00082s |   0.7%
- batch.backward                 |  11675 |     0.05163s |  43.2%
- batch.evaluate                 |  11675 |     0.00275s |   2.3%
- batch.forward                  |  11675 |     0.02540s |  21.3%
- batch.mom                      |  11675 |     0.00126s |   1.1%
- batch.reduce                   |  11675 |     0.02629s |  22.0%
- batch.reporting.compr_err      |  11675 |     0.00001s |   0.0%
- batch.reporting.lr             |  11675 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11675 |     0.00001s |   0.0%
- batch.step                     |  11675 |     0.00048s |   0.4%
- batch.update_runavg            |  11675 |     0.00130s |   1.1%
- batch.wd                       |  11675 |     0.00001s |   0.0%
- epoch_metrics.collect          |     83 |     0.00773s |   0.0%
- reduce.combine                 |  11675 |     0.00644s |   5.4%
- reduce.flatpack                |  11675 |     0.00002s |   0.0%
- reduce.flatput                 |  11675 |     0.00021s |   0.2%
- reduce.gather.context          |  11675 |     0.00111s |   0.9%
- reduce.gather.tensors          |  11675 |     0.00397s |   3.3%
- reduce.heur_params             |  11675 |     0.01112s |   9.3%
- reduce.heur_params.alpha       |  11674 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  11674 |     0.00234s |   2.0%
- reduce.memory                  |  11675 |     0.00046s |   0.4%
- reduce.pad                     |  11675 |     0.00028s |   0.2%
- reduce.threshold               |  11675 |     0.00246s |   2.1%
- test.last                      |     83 |     0.41024s |   2.5%
- test.runavg                    |     83 |     0.44099s |   2.7%
-----------------------------------------------------------------

[Iteration 11680] [Rank 0] a = 1.0327179431915283, b = 0.9997772604117783, delta = 0.0007847322849556804, c = 0.0005545208161891477, d = 0.0005554534806155543, m = 0.0005833040119740519
rel_compression_error          - epoch: 84.094, value:  0.996 (weight:encoder.weight)
rel_compression_error          - epoch: 84.094, value:  0.985 (weight:rnn.weight_ih_l0)
rel_compression_error          - epoch: 84.094, value:  0.988 (weight:rnn.weight_hh_l0)
rel_compression_error          - epoch: 84.094, value:  0.841 (weight:rnn.bias_ih_l0)
rel_compression_error          - epoch: 84.094, value:  0.841 (weight:rnn.bias_hh_l0)
rel_compression_error          - epoch: 84.094, value:  0.987 (weight:rnn.weight_ih_l1)
rel_compression_error          - epoch: 84.094, value:  0.995 (weight:rnn.weight_hh_l1)
rel_compression_error          - epoch: 84.094, value:  0.911 (weight:rnn.bias_ih_l1)
rel_compression_error          - epoch: 84.094, value:  0.911 (weight:rnn.bias_hh_l1)
rel_compression_error          - epoch: 84.094, value:  0.977 (weight:rnn.weight_ih_l2)
rel_compression_error          - epoch: 84.094, value:  0.983 (weight:rnn.weight_hh_l2)
rel_compression_error          - epoch: 84.094, value:  0.740 (weight:rnn.bias_ih_l2)
rel_compression_error          - epoch: 84.094, value:  0.740 (weight:rnn.bias_hh_l2)
rel_compression_error          - epoch: 84.094, value:  0.937 (weight:decoder.bias)
rel_compression_error          - epoch: 84.094, value:  0.993 (weight:entire_model)
[Iteration 11690] [Rank 0] a = 0.8583855032920837, b = 1.0022272625439475, delta = 0.0006979704485274851, c = 0.0054545324537686015, d = 0.005222989874131409, m = 0.0005837637758249228
[Iteration 11700] [Rank 0] a = 0.9896513819694519, b = 0.9998439459158496, delta = 0.0007693258230574429, c = 0.0006878918291653079, d = 0.0006891008386069461, m = 0.0005839592211449434
[Iteration 11710] [Rank 0] a = 0.9176176190376282, b = 1.0003307794615395, delta = 0.0007276521646417677, c = 0.0016615589472070138, d = 0.0016533031398769692, m = 0.000584293929863528
[Iteration 11720] [Rank 0] a = 0.988272488117218, b = 0.9997838236055739, delta = 0.0008048026938922703, c = 0.0005676472044126496, d = 0.0005687180413466721, m = 0.0005844407017157686
[Iteration 11730] [Rank 0] a = 1.0254732370376587, b = 0.9997506449339831, delta = 0.0008047205628827214, c = 0.000501289857630157, d = 0.0005024643239448914, m = 0.0005846709059852316
[Iteration 11740] [Rank 0] a = 0.9462857842445374, b = 0.9998302495663959, delta = 0.0007914473535493016, c = 0.0006604991295304736, d = 0.0006612590783223605, m = 0.0005850579259737643
[Iteration 11750] [Rank 0] a = 0.9966011643409729, b = 0.9998414933538999, delta = 0.0008056908845901489, c = 0.0006829867051449466, d = 0.0006840575420789691, m = 0.0005850957958782738
[Iteration 11760] [Rank 0] a = 0.9656871557235718, b = 1.000123831599689, delta = 0.0007492441800422966, c = 0.0012476632006438563, d = 0.0012453488111412914, m = 0.0005854135560836942
[Iteration 11770] [Rank 0] a = 0.9294817447662354, b = 1.001109916516711, delta = 0.0007144472328945994, c = 0.00321983394497121, d = 0.0031291927799752387, m = 0.0005858199117977777
[Iteration 11780] [Rank 0] a = 1.0389493703842163, b = 0.9998147051597791, delta = 0.0007470209384337068, c = 0.0006294103153169164, d = 0.0006305156953778429, m = 0.0005861010980844898
[Iteration 11790] [Rank 0] a = 1.1042784452438354, b = 0.9996936487790073, delta = 0.0007867314270697534, c = 0.00038729753884711416, d = 0.00038809203076590505, m = 0.0005863734287127607
[Iteration 11800] [Rank 0] a = 1.0187275409698486, b = 0.9997930466200443, delta = 0.0007922309450805187, c = 0.0005860932341793601, d = 0.0005870949848595748, m = 0.0005864642456861756
[Iteration 11810] [Rank 0] a = 0.8648170828819275, b = 1.0003086200478963, delta = 0.0007627891609445214, c = 0.001617240115389243, d = 0.0016086388767901586, m = 0.0005866215559655273
cross_entropy                  - bits:30570535936.000, epoch: 85.000, ratio_transmit_grad:  0.180, value:  5.344 (split:train)
last_cross_entropy             - bits:30570535936.000, epoch: 85.000, ratio_transmit_grad:  0.180, value:  5.344 (split:train)
perplexity                     - bits:30570535936.000, epoch: 85.000, ratio_transmit_grad:  0.180, value:209.818 (split:train)
last_perplexity                - bits:30570535936.000, epoch: 85.000, ratio_transmit_grad:  0.180, value:209.818 (split:train)
last_cross_entropy             - bits:30570535936.000, epoch: 85.000, ratio_transmit_grad:  0.180, value:  5.139 (split:test)
last_perplexity                - bits:30570535936.000, epoch: 85.000, ratio_transmit_grad:  0.180, value:171.132 (split:test)
runavg_cross_entropy           - bits:30570535936.000, epoch: 85.000, ratio_transmit_grad:  0.180, value:  5.342 (split:test)
runavg_perplexity              - bits:30570535936.000, epoch: 85.000, ratio_transmit_grad:  0.180, value:209.664 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11814 |     0.11098s |  92.9%
- batch.accumulate               |  11814 |     0.00082s |   0.7%
- batch.backward                 |  11814 |     0.05163s |  43.2%
- batch.evaluate                 |  11814 |     0.00275s |   2.3%
- batch.forward                  |  11814 |     0.02540s |  21.3%
- batch.mom                      |  11814 |     0.00126s |   1.1%
- batch.reduce                   |  11814 |     0.02631s |  22.0%
- batch.reporting.compr_err      |  11814 |     0.00001s |   0.0%
- batch.reporting.lr             |  11814 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11814 |     0.00001s |   0.0%
- batch.step                     |  11814 |     0.00048s |   0.4%
- batch.update_runavg            |  11814 |     0.00130s |   1.1%
- batch.wd                       |  11814 |     0.00001s |   0.0%
- epoch_metrics.collect          |     84 |     0.00765s |   0.0%
- reduce.combine                 |  11814 |     0.00644s |   5.4%
- reduce.flatpack                |  11814 |     0.00002s |   0.0%
- reduce.flatput                 |  11814 |     0.00021s |   0.2%
- reduce.gather.context          |  11814 |     0.00111s |   0.9%
- reduce.gather.tensors          |  11814 |     0.00398s |   3.3%
- reduce.heur_params             |  11814 |     0.01113s |   9.3%
- reduce.heur_params.alpha       |  11813 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  11813 |     0.00234s |   2.0%
- reduce.memory                  |  11814 |     0.00046s |   0.4%
- reduce.pad                     |  11814 |     0.00028s |   0.2%
- reduce.threshold               |  11814 |     0.00247s |   2.1%
- test.last                      |     84 |     0.41014s |   2.5%
- test.runavg                    |     84 |     0.44093s |   2.7%
-----------------------------------------------------------------

[Iteration 11820] [Rank 0] a = 1.0267356634140015, b = 0.999921184346503, delta = 0.000739573675673455, c = 0.0008423686926797829, d = 0.0008433013571061896, m = 0.0005871028133882068
[Iteration 11830] [Rank 0] a = 1.0680831670761108, b = 0.9997191761475875, delta = 0.0008014672785066068, c = 0.0004383522804111558, d = 0.0004391467723299467, m = 0.0005872726464882588
[Iteration 11840] [Rank 0] a = 0.9529988765716553, b = 1.0001078381321473, delta = 0.0007656896486878395, c = 0.0012156762651307964, d = 0.0012126019268363447, m = 0.0005874022935391032
[Iteration 11850] [Rank 0] a = 1.0123072862625122, b = 0.9998016824014154, delta = 0.0008134376257658005, c = 0.0006033647976313363, d = 0.000604332005184647, m = 0.0005874700478413882
[Iteration 11860] [Rank 0] a = 1.0424892902374268, b = 0.9997006610331257, delta = 0.0008494309731759131, c = 0.0004013220483701188, d = 0.0004022892559234295, m = 0.0005875772227542183
[Iteration 11870] [Rank 0] a = 0.9477126002311707, b = 0.9999400276221379, delta = 0.0007935003959573805, c = 0.0008800552441319949, d = 0.0008808151929238819, m = 0.0005878913099996551
[Iteration 11880] [Rank 0] a = 0.9337998032569885, b = 1.0000396845431632, delta = 0.0007938853814266622, c = 0.0010793690863678002, d = 0.001078885482591145, m = 0.0005879935364581061
timer                          - epoch: -1.000, value:  0.000 (event:reduce.memory)
[Iteration 11890] [Rank 0] a = 1.0503727197647095, b = 0.9996621281789807, delta = 0.0008971361094154418, c = 0.00032425633224740107, d = 0.0003248781085316722, m = 0.0005883080089847015
learning_rate                  - epoch: 85.612, value:  0.100 (weight:encoder.weight)
effective_lr                   - epoch: 85.612, value:  0.000 (weight:encoder.weight)
grad_norm                      - epoch: 85.612, value:  0.090 (weight:encoder.weight)
learning_rate                  - epoch: 85.612, value:  0.100 (weight:rnn.weight_ih_l0)
effective_lr                   - epoch: 85.612, value:  0.000 (weight:rnn.weight_ih_l0)
grad_norm                      - epoch: 85.612, value:  0.053 (weight:rnn.weight_ih_l0)
learning_rate                  - epoch: 85.612, value:  0.100 (weight:rnn.weight_hh_l0)
effective_lr                   - epoch: 85.612, value:  0.000 (weight:rnn.weight_hh_l0)
grad_norm                      - epoch: 85.612, value:  0.044 (weight:rnn.weight_hh_l0)
learning_rate                  - epoch: 85.612, value:  0.100 (weight:rnn.bias_ih_l0)
effective_lr                   - epoch: 85.612, value:  0.000 (weight:rnn.bias_ih_l0)
grad_norm                      - epoch: 85.612, value:  0.006 (weight:rnn.bias_ih_l0)
learning_rate                  - epoch: 85.612, value:  0.100 (weight:rnn.bias_hh_l0)
effective_lr                   - epoch: 85.612, value:  0.000 (weight:rnn.bias_hh_l0)
grad_norm                      - epoch: 85.612, value:  0.006 (weight:rnn.bias_hh_l0)
learning_rate                  - epoch: 85.612, value:  0.100 (weight:rnn.weight_ih_l1)
effective_lr                   - epoch: 85.612, value:  0.000 (weight:rnn.weight_ih_l1)
grad_norm                      - epoch: 85.612, value:  0.040 (weight:rnn.weight_ih_l1)
learning_rate                  - epoch: 85.612, value:  0.100 (weight:rnn.weight_hh_l1)
effective_lr                   - epoch: 85.612, value:  0.000 (weight:rnn.weight_hh_l1)
grad_norm                      - epoch: 85.612, value:  0.019 (weight:rnn.weight_hh_l1)
learning_rate                  - epoch: 85.612, value:  0.100 (weight:rnn.bias_ih_l1)
effective_lr                   - epoch: 85.612, value:  0.000 (weight:rnn.bias_ih_l1)
grad_norm                      - epoch: 85.612, value:  0.005 (weight:rnn.bias_ih_l1)
learning_rate                  - epoch: 85.612, value:  0.100 (weight:rnn.bias_hh_l1)
effective_lr                   - epoch: 85.612, value:  0.000 (weight:rnn.bias_hh_l1)
grad_norm                      - epoch: 85.612, value:  0.005 (weight:rnn.bias_hh_l1)
learning_rate                  - epoch: 85.612, value:  0.100 (weight:rnn.weight_ih_l2)
effective_lr                   - epoch: 85.612, value:  0.000 (weight:rnn.weight_ih_l2)
grad_norm                      - epoch: 85.612, value:  0.042 (weight:rnn.weight_ih_l2)
learning_rate                  - epoch: 85.612, value:  0.100 (weight:rnn.weight_hh_l2)
effective_lr                   - epoch: 85.612, value:  0.000 (weight:rnn.weight_hh_l2)
grad_norm                      - epoch: 85.612, value:  0.029 (weight:rnn.weight_hh_l2)

[Iteration 11680] [Rank 3] a = 1.0077890157699585, b = 0.9997756196133321, delta = 0.0008093641372397542, c = 0.0005512392191332722, d = 0.0005524827717018145, m = 0.0006544858161031939
[Iteration 11690] [Rank 3] a = 0.9878204464912415, b = 0.9997366549685067, delta = 0.0007943179225549102, c = 0.0004733099248379556, d = 0.00047444984802578604, m = 0.0006556611505412405
[Iteration 11700] [Rank 3] a = 0.9467429518699646, b = 0.9997936165816137, delta = 0.0007953159511089325, c = 0.0005872331573671906, d = 0.0005880967355397894, m = 0.0006557470657186941
[Iteration 11710] [Rank 3] a = 0.9848666191101074, b = 0.9998091609881072, delta = 0.0007326192571781576, c = 0.0006183219715807477, d = 0.000619634610403098, m = 0.0006564802633943318
[Iteration 11720] [Rank 3] a = 0.9983288645744324, b = 0.9998724612665334, delta = 0.0007345608319155872, c = 0.0007449225316837332, d = 0.0007458897392370439, m = 0.000656597002819685

[Iteration 11680] [Rank 1] a = 1.0303364992141724, b = 0.9997556191439542, delta = 0.0008281138143502176, c = 0.0005112382781784953, d = 0.0005124818307470376, m = 0.0007357577708074736
[Iteration 11690] [Rank 1] a = 0.9368211627006531, b = 1.0000903765816695, delta = 0.0007547404384240508, c = 0.0011807531638309005, d = 0.0011792332662471266, m = 0.0007359586655964171
[Iteration 11700] [Rank 1] a = 1.0076266527175903, b = 0.9999324626773767, delta = 0.0007676883251406252, c = 0.0008649253545480638, d = 0.0008655816739592389, m = 0.0007360256882318035
[Iteration 11710] [Rank 1] a = 1.1270086765289307, b = 0.9996267214783843, delta = 0.0008803180535323918, c = 0.00025344292209429864, d = 0.0002542028708861856, m = 0.0007361564942593354
[Iteration 11720] [Rank 1] a = 1.074924349784851, b = 0.9997747733067659, delta = 0.0007674851804040372, c = 0.0005495466059149785, d = 0.0005504101840875773, m = 0.0007366549712617943
[Iteration 11730] [Rank 3] a = 1.023488998413086, b = 0.9998662953184863, delta = 0.000715548696462065, c = 0.0007325906353790223, d = 0.0007337651016937565, m = 0.000656804946610712
[Iteration 11740] [Rank 3] a = 1.0534815788269043, b = 0.9997566554376999, delta = 0.0007422815542668104, c = 0.0005133108657927324, d = 0.0005140708145846194, m = 0.0006576145474796085
[Iteration 11750] [Rank 3] a = 0.9010288715362549, b = 1.0002566671891948, delta = 0.0006780052790418267, c = 0.001513334389662154, d = 0.0015080838343727533, m = 0.000657905378992919
[Iteration 11760] [Rank 3] a = 0.9787605404853821, b = 0.9997982108173007, delta = 0.0007686009630560875, c = 0.0005964216291236419, d = 0.0005973542935500487, m = 0.0006581324304377262
[Iteration 11770] [Rank 3] a = 0.9992547631263733, b = 0.999909819657833, delta = 0.0007286633481271565, c = 0.0008196393151769822, d = 0.0008207101521110048, m = 0.00065833090343983
[Iteration 11730] [Rank 1] a = 0.9868655204772949, b = 0.9998479701900382, delta = 0.0007898316835053265, c = 0.0006959403777339287, d = 0.000697183930302471, m = 0.0007366366481881275
[Iteration 11740] [Rank 1] a = 1.0318852663040161, b = 0.9997568454248864, delta = 0.0008124840096570551, c = 0.0005136908401886759, d = 0.0005146580477419866, m = 0.0007367165134122521
[Iteration 11750] [Rank 1] a = 0.9722341895103455, b = 1.0000702033956883, delta = 0.000781418289989233, c = 0.0011404067916070842, d = 0.0011387141783887904, m = 0.0007367337587733902
[Iteration 11760] [Rank 1] a = 0.9998157620429993, b = 1.0000797200270966, delta = 0.0007343487231992185, c = 0.0011594400545311618, d = 0.001154258585495569, m = 0.0007370234164295088
[Iteration 11770] [Rank 1] a = 1.0629931688308716, b = 0.999714219209275, delta = 0.0008183277677744627, c = 0.00042843840298972146, d = 0.00042982012806587954, m = 0.0007369619153430072
[Iteration 11780] [Rank 3] a = 1.0660263299942017, b = 0.9997556018723918, delta = 0.0007629665196873248, c = 0.0005112037350515913, d = 0.0005121709426049021, m = 0.0006584484945850375
[Iteration 11790] [Rank 3] a = 1.0808632373809814, b = 0.9997614051173731, delta = 0.000724251673091203, c = 0.0005228102256913193, d = 0.000523811976371534, m = 0.0006588813065324112
[Iteration 11800] [Rank 3] a = 0.9360852241516113, b = 1.000141189520653, delta = 0.0007076779147610068, c = 0.0012823790431823283, d = 0.0012803064555680912, m = 0.0006590192634528055
[Iteration 11810] [Rank 3] a = 1.0227543115615845, b = 0.9998476765734664, delta = 0.000723597127944231, c = 0.0006953531445765616, d = 0.0006962512658760643, m = 0.0006591477828692817
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11814 |     0.11107s |  93.0%
- batch.accumulate               |  11814 |     0.00082s |   0.7%
[Iteration 11780] [Rank 1] a = 0.9908984303474426, b = 0.9999094742265667, delta = 0.0007827451336197555, c = 0.0008189484526389031, d = 0.0008196393151769822, m = 0.0007370372691005259
[Iteration 11790] [Rank 1] a = 0.9849688410758972, b = 1.0000672845014786, delta = 0.0007766770431771874, c = 0.0011345690031603162, d = 0.0011328418468151186, m = 0.0007371075000434806
[Iteration 11800] [Rank 1] a = 1.0012258291244507, b = 0.9997796957021052, delta = 0.0008219045703299344, c = 0.000559391397082605, d = 0.0005605658633973394, m = 0.000737109854626768
[Iteration 11810] [Rank 1] a = 0.9601650238037109, b = 0.9998356210224795, delta = 0.0008395099430344999, c = 0.0006712420419976027, d = 0.0006721401632971055, m = 0.0007370724679047545
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11814 |     0.11095s |  92.9%
- batch.accumulate               |  11814 |     0.00083s |   0.7%
- batch.backward                 |  11814 |     0.05175s |  43.3%
- batch.evaluate                 |  11814 |     0.00277s |   2.3%
- batch.forward                  |  11814 |     0.02537s |  21.2%
- batch.mom                      |  11814 |     0.00126s |   1.1%
- batch.reduce                   |  11814 |     0.02633s |  22.0%
- batch.reporting.compr_err      |  11814 |     0.00001s |   0.0%
- batch.reporting.lr             |  11814 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11814 |     0.00001s |   0.0%
- batch.step                     |  11814 |     0.00047s |   0.4%
- batch.update_runavg            |  11814 |     0.00129s |   1.1%
- batch.wd                       |  11814 |     0.00001s |   0.0%
- epoch_metrics.collect          |     84 |     0.00705s |   0.0%
- reduce.combine                 |  11814 |     0.00617s |   5.2%
- reduce.flatpack                |  11814 |     0.00002s |   0.0%
- reduce.flatput                 |  11814 |     0.00020s |   0.2%
- batch.backward                 |  11814 |     0.05178s |  43.4%
- batch.evaluate                 |  11814 |     0.00275s |   2.3%
- batch.forward                  |  11814 |     0.02542s |  21.3%
- batch.mom                      |  11814 |     0.00126s |   1.1%
- batch.reduce                   |  11814 |     0.02613s |  21.9%
- batch.reporting.compr_err      |  11814 |     0.00001s |   0.0%
- batch.reporting.lr             |  11814 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11814 |     0.00001s |   0.0%
- batch.step                     |  11814 |     0.00048s |   0.4%
- batch.update_runavg            |  11814 |     0.00130s |   1.1%
- batch.wd                       |  11814 |     0.00001s |   0.0%
- epoch_metrics.collect          |     84 |     0.00676s |   0.0%
- reduce.combine                 |  11814 |     0.00628s |   5.3%
- reduce.flatpack                |  11814 |     0.00002s |   0.0%
- reduce.flatput                 |  11814 |     0.00023s |   0.2%

[Iteration 11680] [Rank 2] a = 0.9879473447799683, b = 0.9999198717076891, delta = 0.0007529837894253433, c = 0.0008397434150350825, d = 0.0008409178813498169, m = 0.0006243534333831511
[Iteration 11690] [Rank 2] a = 1.099509358406067, b = 0.9997491423080568, delta = 0.0007615805952809751, c = 0.0004982846055895132, d = 0.0004992863562697278, m = 0.000624852386507665
[Iteration 11700] [Rank 2] a = 0.9900000691413879, b = 1.000008820259295, delta = 0.0007288340711966157, c = 0.0010176405185904373, d = 0.0010174678029559174, m = 0.0006250274830210833
[Iteration 11710] [Rank 2] a = 1.018807291984558, b = 0.999801129711407, delta = 0.0007735709077678621, c = 0.0006022594175704098, d = 0.0006036756857734719, m = 0.0006251709347783001
[Iteration 11720] [Rank 2] a = 0.8674463629722595, b = 1.000705071408335, delta = 0.0007141629466786981, c = 0.002410143050342566, d = 0.0023806086768396865, m = 0.0006255052120206647
- reduce.gather.context          |  11814 |     0.00245s |   2.1%
- reduce.gather.tensors          |  11814 |     0.00351s |   2.9%
- reduce.heur_params             |  11814 |     0.01054s |   8.8%
- reduce.gather.context          |  11814 |     0.00122s |   1.0%
- reduce.gather.tensors          |  11814 |     0.00386s |   3.2%
- reduce.heur_params             |  11814 |     0.01095s |   9.2%
- reduce.heur_params.alpha       |  11813 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  11813 |     0.00236s |   2.0%
- reduce.memory                  |  11814 |     0.00046s |   0.4%
- reduce.pad                     |  11814 |     0.00026s |   0.2%
- reduce.threshold               |  11814 |     0.00250s |   2.1%
- test.last                      |     84 |     0.41016s |   2.5%
- test.runavg                    |     84 |     0.44091s |   2.7%
-----------------------------------------------------------------

[Iteration 11820] [Rank 3] a = 1.1167374849319458, b = 0.9996697103944897, delta = 0.0008076424128375947, c = 0.00033942076495823613, d = 0.00034014617062321916, m = 0.0006593387101500969
[Iteration 11830] [Rank 3] a = 1.074331283569336, b = 0.9997176907932487, delta = 0.0007991486927494407, c = 0.0004353815714974159, d = 0.0004361760634162068, m = 0.0006595495161689249
- reduce.heur_params.alpha       |  11813 |     0.00836s |   7.0%
- reduce.heur_params.beta        |  11813 |     0.00251s |   2.1%
- reduce.memory                  |  11814 |     0.00047s |   0.4%
- reduce.pad                     |  11814 |     0.00022s |   0.2%
- reduce.threshold               |  11814 |     0.00267s |   2.2%
- test.last                      |     84 |     0.41016s |   2.5%
- test.runavg                    |     84 |     0.44092s |   2.7%
-----------------------------------------------------------------

[Iteration 11820] [Rank 1] a = 1.0991381406784058, b = 0.9996705912441298, delta = 0.0008653763215988874, c = 0.0003411824644303377, d = 0.0003419424132222247, m = 0.0007371983425215255
[Iteration 11830] [Rank 1] a = 0.9783626198768616, b = 0.9998311649592324, delta = 0.0008253016276285052, c = 0.0006623299152563831, d = 0.0006636080109518293, m = 0.0007374295315448012
[Iteration 11730] [Rank 2] a = 0.9782223701477051, b = 0.9998474347715838, delta = 0.0007490781135857105, c = 0.0006948695407999062, d = 0.0006959749208608327, m = 0.0006264504719848201
[Iteration 11740] [Rank 2] a = 0.9357978701591492, b = 1.0000496329636914, delta = 0.0007065780810080469, c = 0.0010992659274644768, d = 0.0010986096080533017, m = 0.0006268763661574676
[Iteration 11750] [Rank 2] a = 0.9577564001083374, b = 1.0000255045895843, delta = 0.0007351225940510631, c = 0.0010510091791796554, d = 0.0010506982910375197, m = 0.0006269574593476934
[Iteration 11760] [Rank 2] a = 1.0373060703277588, b = 0.9997774158558416, delta = 0.0007699338020756841, c = 0.0005548317043312833, d = 0.0005558334550114978, m = 0.0006271822674776095
[Iteration 11770] [Rank 2] a = 1.046177864074707, b = 0.9997736679267611, delta = 0.0007568431319668889, c = 0.0005473358457931256, d = 0.0005482685102195323, m = 0.000627623489835761
[Iteration 11840] [Rank 3] a = 0.8497900366783142, b = 1.0003229554441315, delta = 0.0007185963913798332, c = 0.0016459109107195232, d = 0.0016386568540696933, m = 0.0006597643419977335
[Iteration 11850] [Rank 3] a = 0.9935635924339294, b = 0.9998324257833289, delta = 0.0007595025235787034, c = 0.0006648515635203716, d = 0.0006663369179772415, m = 0.0006598668949946355
[Iteration 11860] [Rank 3] a = 0.9526004195213318, b = 0.9999659349672569, delta = 0.0007273473311215639, c = 0.0009318699344879236, d = 0.0009321462795031551, m = 0.0006601618993781506
[Iteration 11870] [Rank 3] a = 0.9284544587135315, b = 0.9998598357538764, delta = 0.0007919313502497971, c = 0.000719671505916944, d = 0.0007208114291047744, m = 0.0006601733137292527
[Iteration 11880] [Rank 3] a = 1.0434831380844116, b = 0.9997283473470808, delta = 0.0007828086381778121, c = 0.0004566946807971545, d = 0.00045738554333523356, m = 0.0006605181121140585
[Iteration 11840] [Rank 1] a = 0.9723184108734131, b = 1.0010365988143437, delta = 0.0007363148033618927, c = 0.003073198371263932, d = 0.0029414163421253537, m = 0.0007379065020040468
[Iteration 11850] [Rank 1] a = 1.0558538436889648, b = 0.9997569317826986, delta = 0.0007936918409541249, c = 0.0005138635558231957, d = 0.0005146580477419866, m = 0.0007380013085985733
[Iteration 11860] [Rank 1] a = 1.0478100776672363, b = 0.9997718025980048, delta = 0.0007829765672795475, c = 0.0005436051880874987, d = 0.0005447451112753291, m = 0.0007381941211830383
[Iteration 11870] [Rank 1] a = 0.963628351688385, b = 1.000102829378802, delta = 0.0007481036009266973, c = 0.0012056587583286502, d = 0.0012037934294758367, m = 0.0007383528049024595
[Iteration 11880] [Rank 1] a = 1.0931810140609741, b = 0.9996804360342609, delta = 0.0008559578564018011, c = 0.00036087204676559057, d = 0.000362011969953421, m = 0.0007383555666406127
[Iteration 11780] [Rank 2] a = 1.0797638893127441, b = 0.9997459297974596, delta = 0.0007588089792989194, c = 0.000491859583985378, d = 0.0004926886190310728, m = 0.0006279603073836701
[Iteration 11790] [Rank 2] a = 0.9287773966789246, b = 1.0000899793357132, delta = 0.0007125172414816916, c = 0.0011799586719121095, d = 0.0011786805762166632, m = 0.0006282568426454165
[Iteration 11800] [Rank 2] a = 0.9399768710136414, b = 1.000201864521256, delta = 0.0007005020743235946, c = 0.001403729047995913, d = 0.0013995838727674389, m = 0.000628573731188576
[Iteration 11810] [Rank 2] a = 0.9916567802429199, b = 0.9997370522144386, delta = 0.0008163035963661969, c = 0.0004741044167567465, d = 0.0004748989086755374, m = 0.0006285934380714525
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11814 |     0.11105s |  93.0%
- batch.accumulate               |  11814 |     0.00082s |   0.7%
[Iteration 11890] [Rank 3] a = 0.8766046166419983, b = 1.0004340461242254, delta = 0.0007093598833307624, c = 0.0018680923029657452, d = 0.0018552768028843787, m = 0.0006607211194496255
[Iteration 11900] [Rank 3] a = 1.0160101652145386, b = 0.9999696656249589, delta = 0.0007050554268062115, c = 0.0009393312498991773, d = 0.0009397803105489287, m = 0.0006610642685544088
[Iteration 11910] [Rank 3] a = 0.9877774715423584, b = 0.999775256910518, delta = 0.0007769515505060554, c = 0.0005505138134682892, d = 0.0005513083053870801, m = 0.0006612106611026777
[Iteration 11920] [Rank 3] a = 1.08665132522583, b = 0.9997546692080211, delta = 0.0007826058426871896, c = 0.000509338406198778, d = 0.0005099601824830491, m = 0.0006613590508432338
[Iteration 11930] [Rank 3] a = 0.883509635925293, b = 1.0008158511521386, delta = 0.0007073243614286184, c = 0.0026317026663045164, d = 0.002602306465309253, m = 0.0006616698928312702
[Iteration 11890] [Rank 1] a = 0.9937010407447815, b = 0.9998290060138634, delta = 0.0008171205408871174, c = 0.000658012024393389, d = 0.0006589792319466997, m = 0.0007383677707312957
[Iteration 11900] [Rank 1] a = 0.9599577188491821, b = 0.9999900806129501, delta = 0.0007965035038068891, c = 0.000980161225899649, d = 0.0009804030277879767, m = 0.0007383947891938625
[Iteration 11910] [Rank 1] a = 1.0236570835113525, b = 0.9998130989044338, delta = 0.0007884266669861972, c = 0.0006261978045148488, d = 0.0006273377277026793, m = 0.0007386761332239402
[Iteration 11920] [Rank 1] a = 1.050594449043274, b = 0.999731594400773, delta = 0.0008225478231906891, c = 0.00046318878865509756, d = 0.00046419053933531215, m = 0.0007390211973286511
[Iteration 11930] [Rank 1] a = 0.9317103028297424, b = 1.0012325962634592, delta = 0.0007360412855632603, c = 0.0034651937753699836, d = 0.0033599754108205445, m = 0.0007392837360837695
- batch.backward                 |  11814 |     0.05173s |  43.3%
- batch.evaluate                 |  11814 |     0.00274s |   2.3%
- batch.forward                  |  11814 |     0.02544s |  21.3%
- batch.mom                      |  11814 |     0.00126s |   1.1%
- batch.reduce                   |  11814 |     0.02630s |  22.0%
- batch.reporting.compr_err      |  11814 |     0.00001s |   0.0%
- batch.reporting.lr             |  11814 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11814 |     0.00001s |   0.0%
- batch.step                     |  11814 |     0.00048s |   0.4%
- batch.update_runavg            |  11814 |     0.00129s |   1.1%
- batch.wd                       |  11814 |     0.00001s |   0.0%
- epoch_metrics.collect          |     84 |     0.01173s |   0.1%
- reduce.combine                 |  11814 |     0.00615s |   5.2%
- reduce.flatpack                |  11814 |     0.00002s |   0.0%
- reduce.flatput                 |  11814 |     0.00020s |   0.2%
[Iteration 11940] [Rank 3] a = 1.0460929870605469, b = 0.9997296772573688, delta = 0.000793609709944576, c = 0.00045935450156875884, d = 0.0004603217091220695, m = 0.0006617145031693491
[Iteration 11950] [Rank 3] a = 0.9821842312812805, b = 0.9998326675852103, delta = 0.0007743265014141798, c = 0.0006653351672970269, d = 0.000666682349246281, m = 0.000661861905168094
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11953 |     0.11109s |  93.0%
- batch.accumulate               |  11953 |     0.00082s |   0.7%
- batch.backward                 |  11953 |     0.05175s |  43.3%
- batch.evaluate                 |  11953 |     0.00277s |   2.3%
- batch.forward                  |  11953 |     0.02537s |  21.2%
- batch.mom                      |  11953 |     0.00126s |   1.1%
- batch.reduce                   |  11953 |     0.02634s |  22.1%
[Iteration 11940] [Rank 1] a = 0.9739199876785278, b = 0.9998387989900702, delta = 0.000801385089289397, c = 0.0006775979773479301, d = 0.0006789451592971842, m = 0.0007392349672198904
[Iteration 11950] [Rank 1] a = 1.055646300315857, b = 0.9997586934820674, delta = 0.0007955883047543466, c = 0.0005173869547673988, d = 0.0005182505329399976, m = 0.0007393432198218954
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11953 |     0.11096s |  92.9%
- batch.accumulate               |  11953 |     0.00083s |   0.7%
- batch.backward                 |  11953 |     0.05178s |  43.4%
- batch.evaluate                 |  11953 |     0.00275s |   2.3%
- batch.forward                  |  11953 |     0.02542s |  21.3%
- batch.mom                      |  11953 |     0.00126s |   1.1%
- batch.reduce                   |  11953 |     0.02614s |  21.9%
- reduce.gather.context          |  11814 |     0.00208s |   1.7%
- reduce.gather.tensors          |  11814 |     0.00388s |   3.3%
- reduce.heur_params             |  11814 |     0.01058s |   8.9%
- batch.reporting.compr_err      |  11953 |     0.00001s |   0.0%
- batch.reporting.lr             |  11953 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11953 |     0.00001s |   0.0%
- batch.step                     |  11953 |     0.00047s |   0.4%
- batch.update_runavg            |  11953 |     0.00129s |   1.1%
- batch.reporting.compr_err      |  11953 |     0.00001s |   0.0%
- batch.reporting.lr             |  11953 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11953 |     0.00001s |   0.0%
- batch.step                     |  11953 |     0.00048s |   0.4%
- batch.update_runavg            |  11953 |     0.00130s |   1.1%
- reduce.heur_params.alpha       |  11813 |     0.00818s |   6.8%
- reduce.heur_params.beta        |  11813 |     0.00233s |   1.9%
- reduce.memory                  |  11814 |     0.00046s |   0.4%
- reduce.pad                     |  11814 |     0.00027s |   0.2%
- reduce.threshold               |  11814 |     0.00246s |   2.1%
- test.last                      |     84 |     0.41015s |   2.5%
- test.runavg                    |     84 |     0.44092s |   2.7%
-----------------------------------------------------------------

[Iteration 11820] [Rank 2] a = 0.984329104423523, b = 1.0000455568747262, delta = 0.0007279276615008712, c = 0.001091113749515144, d = 0.0010899047400735058, m = 0.0006288559537976957
[Iteration 11830] [Rank 2] a = 1.1146595478057861, b = 0.9996479136839515, delta = 0.0008503950666636229, c = 0.00029582733880544824, d = 0.00029669091697804705, m = 0.0006289541218078091
- batch.wd                       |  11953 |     0.00001s |   0.0%
- epoch_metrics.collect          |     85 |     0.00698s |   0.0%
- reduce.combine                 |  11953 |     0.00617s |   5.2%
- reduce.flatpack                |  11953 |     0.00002s |   0.0%
- reduce.flatput                 |  11953 |     0.00020s |   0.2%
- reduce.gather.context          |  11953 |     0.00245s |   2.1%
- reduce.gather.tensors          |  11953 |     0.00352s |   3.0%
- reduce.heur_params             |  11953 |     0.01054s |   8.8%
- reduce.heur_params.alpha       |  11952 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  11952 |     0.00236s |   2.0%
- reduce.memory                  |  11953 |     0.00046s |   0.4%
- reduce.pad                     |  11953 |     0.00026s |   0.2%
- reduce.threshold               |  11953 |     0.00250s |   2.1%
- test.last                      |     85 |     0.41008s |   2.5%
- test.runavg                    |     85 |     0.44081s |   2.7%
- batch.wd                       |  11953 |     0.00001s |   0.0%
- epoch_metrics.collect          |     85 |     0.00669s |   0.0%
- reduce.combine                 |  11953 |     0.00629s |   5.3%
- reduce.flatpack                |  11953 |     0.00002s |   0.0%
- reduce.flatput                 |  11953 |     0.00023s |   0.2%
- reduce.gather.context          |  11953 |     0.00122s |   1.0%
- reduce.gather.tensors          |  11953 |     0.00387s |   3.2%
- reduce.heur_params             |  11953 |     0.01095s |   9.2%
- reduce.heur_params.alpha       |  11952 |     0.00836s |   7.0%
- reduce.heur_params.beta        |  11952 |     0.00251s |   2.1%
- reduce.memory                  |  11953 |     0.00047s |   0.4%
- reduce.pad                     |  11953 |     0.00022s |   0.2%
- reduce.threshold               |  11953 |     0.00267s |   2.2%
- test.last                      |     85 |     0.41008s |   2.5%
- test.runavg                    |     85 |     0.44082s |   2.7%
[Iteration 11840] [Rank 2] a = 0.9304632544517517, b = 1.000576208326486, delta = 0.0007028893451206386, c = 0.0021524167805121773, d = 0.0021266130647149247, m = 0.0006294111613186721
[Iteration 11850] [Rank 2] a = 1.0089322328567505, b = 0.9998633073380638, delta = 0.0007542978855781257, c = 0.0007266146744246384, d = 0.0007276164251048531, m = 0.0006294981261549125
[Iteration 11860] [Rank 2] a = 1.0315604209899902, b = 0.9999981464330818, delta = 0.0007852434064261615, c = 0.0009962928661637947, d = 0.0009962928661637947, m = 0.0006296240540089819
[Iteration 11870] [Rank 2] a = 0.8922265768051147, b = 1.0005640491497683, delta = 0.0007229929324239492, c = 0.0021280984191717946, d = 0.0020977350106232205, m = 0.0006299269956434411
[Iteration 11880] [Rank 2] a = 1.0036152601242065, b = 0.9997528729655312, delta = 0.0007809394737705588, c = 0.0005057459210007669, d = 0.0005069549304424052, m = 0.0006303384964926117
-----------------------------------------------------------------
-----------------------------------------------------------------
[Iteration 11890] [Rank 2] a = 1.0807886123657227, b = 0.9997302817620457, delta = 0.0007735092076472938, c = 0.0004605635110103972, d = 0.00046135800292918807, m = 0.0006305260777792841
[Iteration 11900] [Rank 2] a = 0.9122037887573242, b = 1.0005688679144251, delta = 0.0007176463259384036, c = 0.0021377359515779974, d = 0.0021152829190904283, m = 0.0006307261556407337
[Iteration 11910] [Rank 2] a = 1.0618107318878174, b = 0.9997644103692449, delta = 0.0007223370485007763, c = 0.0005288207297726071, d = 0.0005294425060568782, m = 0.000633299701460264
[Iteration 11920] [Rank 2] a = 1.090279459953308, b = 0.9997163781545315, delta = 0.0007659905240871012, c = 0.0004327562938527155, d = 0.00043365441515221827, m = 0.0006334844396711604
[Iteration 11930] [Rank 2] a = 1.0577373504638672, b = 0.999771146278628, delta = 0.0007466872339136899, c = 0.0005422925492651485, d = 0.0005430870411839394, m = 0.0006336480948462882
[Iteration 11940] [Rank 2] a = 0.9471973180770874, b = 0.999948870662598, delta = 0.0007229084149003029, c = 0.0008977413251068186, d = 0.0008981212995027621, m = 0.0006340090177044734
[Iteration 11950] [Rank 2] a = 0.9473317265510559, b = 1.000098166056717, delta = 0.0006982569466345012, c = 0.001196332114064583, d = 0.0011949849321153288, m = 0.0006342647504563028
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11953 |     0.11106s |  93.0%
- batch.accumulate               |  11953 |     0.00082s |   0.7%
- batch.backward                 |  11953 |     0.05173s |  43.3%
- batch.evaluate                 |  11953 |     0.00274s |   2.3%
- batch.forward                  |  11953 |     0.02544s |  21.3%
- batch.mom                      |  11953 |     0.00126s |   1.1%
- batch.reduce                   |  11953 |     0.02632s |  22.0%
- batch.reporting.compr_err      |  11953 |     0.00001s |   0.0%
- batch.reporting.lr             |  11953 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11953 |     0.00001s |   0.0%
- batch.step                     |  11953 |     0.00048s |   0.4%
- batch.update_runavg            |  11953 |     0.00129s |   1.1%
- batch.wd                       |  11953 |     0.00001s |   0.0%
- epoch_metrics.collect          |     85 |     0.01162s |   0.1%
- reduce.combine                 |  11953 |     0.00615s |   5.2%
- reduce.flatpack                |  11953 |     0.00002s |   0.0%
- reduce.flatput                 |  11953 |     0.00020s |   0.2%
- reduce.gather.context          |  11953 |     0.00209s |   1.7%
- reduce.gather.tensors          |  11953 |     0.00389s |   3.3%
- reduce.heur_params             |  11953 |     0.01058s |   8.9%
- reduce.heur_params.alpha       |  11952 |     0.00818s |   6.8%
- reduce.heur_params.beta        |  11952 |     0.00233s |   2.0%
- reduce.memory                  |  11953 |     0.00046s |   0.4%
- reduce.pad                     |  11953 |     0.00027s |   0.2%
- reduce.threshold               |  11953 |     0.00246s |   2.1%
- test.last                      |     85 |     0.41008s |   2.5%
- test.runavg                    |     85 |     0.44082s |   2.7%
-----------------------------------------------------------------
learning_rate                  - epoch: 85.612, value:  0.100 (weight:rnn.bias_ih_l2)
effective_lr                   - epoch: 85.612, value:  0.000 (weight:rnn.bias_ih_l2)
grad_norm                      - epoch: 85.612, value:  0.009 (weight:rnn.bias_ih_l2)
learning_rate                  - epoch: 85.612, value:  0.100 (weight:rnn.bias_hh_l2)
effective_lr                   - epoch: 85.612, value:  0.000 (weight:rnn.bias_hh_l2)
grad_norm                      - epoch: 85.612, value:  0.009 (weight:rnn.bias_hh_l2)
learning_rate                  - epoch: 85.612, value:  0.100 (weight:decoder.bias)
effective_lr                   - epoch: 85.612, value:  0.000 (weight:decoder.bias)
grad_norm                      - epoch: 85.612, value:  0.016 (weight:decoder.bias)
grad_norm                      - epoch: 85.612, value:  0.134 (weight:entire_model)
[Iteration 11900] [Rank 0] a = 1.0139150619506836, b = 0.9998013887848484, delta = 0.0008141549187712371, c = 0.0006027775644739692, d = 0.000604366548311551, m = 0.000588442991130148
[Iteration 11910] [Rank 0] a = 0.8929463028907776, b = 1.0012803520610014, delta = 0.0007471325807273388, c = 0.003560705521259412, d = 0.0034632593602633623, m = 0.0005888133364920443
[Iteration 11920] [Rank 0] a = 1.0945091247558594, b = 0.9997124747815095, delta = 0.0008095492958091199, c = 0.00042494954717242227, d = 0.0004264694447561962, m = 0.0005894864726741529
[Iteration 11930] [Rank 0] a = 0.9722383618354797, b = 1.000148547206529, delta = 0.0007433803984895349, c = 0.001297094415243412, d = 0.001292016575588531, m = 0.0005897070978409566
[Iteration 11940] [Rank 0] a = 0.9651822447776794, b = 0.9998370027475185, delta = 0.0007923705270513892, c = 0.000674005492149919, d = 0.0006748345271956138, m = 0.0005898636276182701
[Iteration 11950] [Rank 0] a = 0.9856110215187073, b = 1.0001986865537082, delta = 0.0007486796239390969, c = 0.001397373112645586, d = 0.0013896009090921967, m = 0.0005900970054370858
cross_entropy                  - bits:31051826816.000, epoch: 86.000, ratio_transmit_grad:  0.187, value:  5.343 (split:train)
last_cross_entropy             - bits:31051826816.000, epoch: 86.000, ratio_transmit_grad:  0.187, value:  5.343 (split:train)
perplexity                     - bits:31051826816.000, epoch: 86.000, ratio_transmit_grad:  0.187, value:209.776 (split:train)
last_perplexity                - bits:31051826816.000, epoch: 86.000, ratio_transmit_grad:  0.187, value:209.776 (split:train)
last_cross_entropy             - bits:31051826816.000, epoch: 86.000, ratio_transmit_grad:  0.187, value:  5.139 (split:test)
last_perplexity                - bits:31051826816.000, epoch: 86.000, ratio_transmit_grad:  0.187, value:171.088 (split:test)
runavg_cross_entropy           - bits:31051826816.000, epoch: 86.000, ratio_transmit_grad:  0.187, value:  5.342 (split:test)
runavg_perplexity              - bits:31051826816.000, epoch: 86.000, ratio_transmit_grad:  0.187, value:209.542 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  11953 |     0.11099s |  92.9%
- batch.accumulate               |  11953 |     0.00082s |   0.7%
- batch.backward                 |  11953 |     0.05163s |  43.2%
- batch.evaluate                 |  11953 |     0.00275s |   2.3%
- batch.forward                  |  11953 |     0.02539s |  21.3%
- batch.mom                      |  11953 |     0.00126s |   1.1%
- batch.reduce                   |  11953 |     0.02633s |  22.0%
- batch.reporting.compr_err      |  11953 |     0.00001s |   0.0%
- batch.reporting.lr             |  11953 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  11953 |     0.00001s |   0.0%
- batch.step                     |  11953 |     0.00048s |   0.4%
- batch.update_runavg            |  11953 |     0.00130s |   1.1%
- batch.wd                       |  11953 |     0.00001s |   0.0%
- epoch_metrics.collect          |     85 |     0.00757s |   0.0%
- reduce.combine                 |  11953 |     0.00645s |   5.4%
- reduce.flatpack                |  11953 |     0.00002s |   0.0%
- reduce.flatput                 |  11953 |     0.00021s |   0.2%
- reduce.gather.context          |  11953 |     0.00111s |   0.9%
- reduce.gather.tensors          |  11953 |     0.00399s |   3.3%
- reduce.heur_params             |  11953 |     0.01113s |   9.3%
- reduce.heur_params.alpha       |  11952 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  11952 |     0.00234s |   2.0%
- reduce.memory                  |  11953 |     0.00046s |   0.4%
- reduce.pad                     |  11953 |     0.00028s |   0.2%
- reduce.threshold               |  11953 |     0.00247s |   2.1%
- test.last                      |     85 |     0.41007s |   2.5%
- test.runavg                    |     85 |     0.44082s |   2.7%
-----------------------------------------------------------------

[Iteration 11960] [Rank 0] a = 1.03024160861969, b = 0.9997948601341298, delta = 0.0007930035935714841, c = 0.0005897202625042751, d = 0.0005908256425652016, m = 0.0005902935091752601
[Iteration 11970] [Rank 0] a = 0.947709858417511, b = 1.00006167124338, delta = 0.0007613966590724885, c = 0.0011233424869165317, d = 0.0011219262187134695, m = 0.000590479654381659
[Iteration 11980] [Rank 0] a = 1.0670033693313599, b = 0.999701127365297, delta = 0.0008457594667561352, c = 0.0004022547127965255, d = 0.0004030837478422204, m = 0.0005905700505278041
[Iteration 11990] [Rank 0] a = 1.0315515995025635, b = 0.9997743933323893, delta = 0.0008163487655110657, c = 0.0005487866571230916, d = 0.0005500302096916338, m = 0.0005906711160144319
[Iteration 12000] [Rank 0] a = 1.1382092237472534, b = 0.9996547877653699, delta = 0.0008368878625333309, c = 0.00030957550331322126, d = 0.00031033545210510825, m = 0.0005912002488308474
[Iteration 12010] [Rank 0] a = 0.9968579411506653, b = 1.0000755230372032, delta = 0.0007434962317347527, c = 0.0011510460746935014, d = 0.0011489044008254564, m = 0.0005914516436312055
[Iteration 12020] [Rank 0] a = 1.0339936017990112, b = 0.9997648421583073, delta = 0.0008048799936659634, c = 0.0005296843079452059, d = 0.00053103148989446, m = 0.0005915388384517764
[Iteration 12030] [Rank 0] a = 0.9512704610824585, b = 0.9999014256780699, delta = 0.0007466832757927477, c = 0.0008028513555016614, d = 0.0008035076749128365, m = 0.0005929232869385161
[Iteration 12040] [Rank 0] a = 1.0125685930252075, b = 0.9997397465781528, delta = 0.0007788041839376092, c = 0.00047949314455376305, d = 0.0004801149208380342, m = 0.0005936219576009808
[Iteration 12050] [Rank 0] a = 0.9997193217277527, b = 0.9998909591107311, delta = 0.0007315748953260481, c = 0.0007819182205978662, d = 0.0007828854281511769, m = 0.0005939100820943374
[Iteration 12060] [Rank 0] a = 0.9769023656845093, b = 0.9997967427344674, delta = 0.0007688674377277493, c = 0.0005934854633368059, d = 0.0005946253865246364, m = 0.0005941236362218143
[Iteration 12070] [Rank 0] a = 0.9717937111854553, b = 1.000218324320499, delta = 0.0007251002825796604, c = 0.0014366486479353798, d = 0.0014295327637931655, m = 0.0005943314480089297
[Iteration 12080] [Rank 0] a = 0.9733462929725647, b = 1.0004557564751864, delta = 0.0007158042280934751, c = 0.0019115130134840133, d = 0.0018873328246512466, m = 0.000594602160482101
[Iteration 12090] [Rank 0] a = 0.9753992557525635, b = 0.9999174709603852, delta = 0.0007691249484196305, c = 0.0008349419203954331, d = 0.0008355291535528004, m = 0.0005947217393075273
cross_entropy                  - bits:31510436992.000, epoch: 87.000, ratio_transmit_grad:  0.178, value:  5.343 (split:train)
last_cross_entropy             - bits:31510436992.000, epoch: 87.000, ratio_transmit_grad:  0.178, value:  5.343 (split:train)
perplexity                     - bits:31510436992.000, epoch: 87.000, ratio_transmit_grad:  0.178, value:209.783 (split:train)
last_perplexity                - bits:31510436992.000, epoch: 87.000, ratio_transmit_grad:  0.178, value:209.783 (split:train)
last_cross_entropy             - bits:31510436992.000, epoch: 87.000, ratio_transmit_grad:  0.178, value:  5.139 (split:test)

[Iteration 11960] [Rank 1] a = 1.0211296081542969, b = 0.9997774849420918, delta = 0.0007974817417562008, c = 0.000554969876838899, d = 0.0005562825156612492, m = 0.0007397241881819159
[Iteration 11970] [Rank 1] a = 0.9576388001441956, b = 0.9998729794134286, delta = 0.000798514112830162, c = 0.0007459588254908518, d = 0.0007467187742827388, m = 0.0007401312865793565
[Iteration 11980] [Rank 1] a = 0.9208868741989136, b = 1.0000973370216792, delta = 0.0007702153525315225, c = 0.0011946740439731933, d = 0.0011928087151203799, m = 0.0007402296254581204
[Iteration 11990] [Rank 1] a = 1.0254402160644531, b = 0.9998252062700174, delta = 0.0007744242902845144, c = 0.0006504125364745195, d = 0.0006518288046775815, m = 0.000740694811316545
[Iteration 12000] [Rank 1] a = 1.106154441833496, b = 0.9997408001434522, delta = 0.0007875752635300159, c = 0.00048160027529490417, d = 0.000482463853467503, m = 0.0007409863451074632
last_perplexity                - bits:31510436992.000, epoch: 87.000, ratio_transmit_grad:  0.178, value:171.076 (split:test)
runavg_cross_entropy           - bits:31510436992.000, epoch: 87.000, ratio_transmit_grad:  0.178, value:  5.341 (split:test)
runavg_perplexity              - bits:31510436992.000, epoch: 87.000, ratio_transmit_grad:  0.178, value:209.502 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  12092 |     0.11101s |  92.9%
- batch.accumulate               |  12092 |     0.00082s |   0.7%
- batch.backward                 |  12092 |     0.05163s |  43.2%
- batch.evaluate                 |  12092 |     0.00275s |   2.3%
- batch.forward                  |  12092 |     0.02539s |  21.3%
- batch.mom                      |  12092 |     0.00126s |   1.1%
- batch.reduce                   |  12092 |     0.02634s |  22.1%

[Iteration 11960] [Rank 2] a = 0.9203771948814392, b = 1.0005034950655767, delta = 0.00067364756250754, c = 0.0020069902162465378, d = 0.0019944510611804027, m = 0.0006349843156848095
[Iteration 11970] [Rank 2] a = 0.9605486989021301, b = 1.0000939517952736, delta = 0.0007185739232227206, c = 0.0011879035911000187, d = 0.001186314607262437, m = 0.0006350634043679042
[Iteration 11980] [Rank 2] a = 0.8736450672149658, b = 1.0001183219710286, delta = 0.0007331720553338528, c = 0.0012366439431614955, d = 0.001235469476846761, m = 0.0006352390679436583
[Iteration 11990] [Rank 2] a = 1.0566521883010864, b = 0.9997724416458194, delta = 0.0007543926476500928, c = 0.000544883283782945, d = 0.0005459886638438714, m = 0.0006354121771347796
[Iteration 12000] [Rank 2] a = 0.9276090860366821, b = 1.0000993059798937, delta = 0.0007144365226849914, c = 0.0011986119604402439, d = 0.001197161149110278, m = 0.0006358683861822049
- batch.reporting.compr_err      |  12092 |     0.00001s |   0.0%
- batch.reporting.lr             |  12092 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  12092 |     0.00001s |   0.0%
- batch.step                     |  12092 |     0.00048s |   0.4%
- batch.update_runavg            |  12092 |     0.00130s |   1.1%
- batch.wd                       |  12092 |     0.00001s |   0.0%
- epoch_metrics.collect          |     86 |     0.00753s |   0.0%
- reduce.combine                 |  12092 |     0.00645s |   5.4%
- reduce.flatpack                |  12092 |     0.00002s |   0.0%
- reduce.flatput                 |  12092 |     0.00021s |   0.2%
- reduce.gather.context          |  12092 |     0.00110s |   0.9%
- reduce.gather.tensors          |  12092 |     0.00400s |   3.3%
- reduce.heur_params             |  12092 |     0.01113s |   9.3%
- reduce.heur_params.alpha       |  12091 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  12091 |     0.00234s |   2.0%
[Iteration 12010] [Rank 2] a = 1.089091420173645, b = 0.9997395047762809, delta = 0.0007416349835693836, c = 0.00047900954077710774, d = 0.00047966586018828285, m = 0.000636089419148391
[Iteration 12020] [Rank 2] a = 0.9642603993415833, b = 1.0000787010048595, delta = 0.0007012243149802089, c = 0.0011574020100438287, d = 0.0011561584574752864, m = 0.000636364529809122
[Iteration 12030] [Rank 2] a = 0.9882846474647522, b = 0.9999084033896416, delta = 0.0007419902831315994, c = 0.0008168067787708581, d = 0.0008177739863241688, m = 0.0006364398890162855
[Iteration 12040] [Rank 2] a = 1.0296282768249512, b = 0.9997590389133162, delta = 0.0007785284542478621, c = 0.0005180778173054779, d = 0.0005191141111125964, m = 0.0006365135968549865
[Iteration 12050] [Rank 2] a = 1.0030595064163208, b = 0.9998422014879836, delta = 0.0007396209402941167, c = 0.0006844029733480086, d = 0.0006854392671551272, m = 0.000636785890622622

[Iteration 11960] [Rank 3] a = 0.9555652737617493, b = 0.9998848449773461, delta = 0.0007785566849634051, c = 0.000769689953673867, d = 0.000770449902465754, m = 0.0006619418458529408
[Iteration 11970] [Rank 3] a = 0.9357072114944458, b = 1.000099996842425, delta = 0.0007191041368059814, c = 0.001199993685516402, d = 0.0011988883054554755, m = 0.0006632246402431013
[Iteration 11980] [Rank 3] a = 0.9345672726631165, b = 1.0000016698320262, delta = 0.00072047597495839, c = 0.001003339664052201, d = 0.0010032360346714892, m = 0.000663430676496737
[Iteration 11990] [Rank 3] a = 0.9194427728652954, b = 1.0001155412493508, delta = 0.0007153397891670465, c = 0.0012310824997299591, d = 0.0012283535927045469, m = 0.000663568077933305
[Iteration 12000] [Rank 3] a = 0.9257711172103882, b = 1.0000489939158452, delta = 0.0007610503234900534, c = 0.0010979878317690305, d = 0.0010974005986116634, m = 0.0006635774169266776
[Iteration 12010] [Rank 1] a = 0.9611483216285706, b = 1.0000694952615903, delta = 0.0007448984542861581, c = 0.001138990523404022, d = 0.0011378851433430956, m = 0.0007412316887353162
[Iteration 12020] [Rank 1] a = 1.0154293775558472, b = 0.9998236172862288, delta = 0.0007762807072140276, c = 0.0006472345687993558, d = 0.0006480290607181468, m = 0.0007412691067891693
[Iteration 12030] [Rank 1] a = 1.0405733585357666, b = 0.9997532356683415, delta = 0.0008140815189108253, c = 0.0005064713266657499, d = 0.0005076803361073883, m = 0.0007412842397326148
[Iteration 12040] [Rank 1] a = 0.9652917385101318, b = 0.9998551551602759, delta = 0.000803208677098155, c = 0.0007103103185259729, d = 0.0007114502417138034, m = 0.0007413909308626237
[Iteration 12050] [Rank 1] a = 0.9559484124183655, b = 0.9999073152811534, delta = 0.0007783283363096416, c = 0.0008146305617759091, d = 0.0008155632262023158, m = 0.0007415880120693948
- reduce.memory                  |  12092 |     0.00046s |   0.4%
- reduce.pad                     |  12092 |     0.00028s |   0.2%
- reduce.threshold               |  12092 |     0.00247s |   2.1%
- test.last                      |     86 |     0.40998s |   2.5%
- test.runavg                    |     86 |     0.44073s |   2.7%
-----------------------------------------------------------------

[Iteration 12100] [Rank 0] a = 1.0176955461502075, b = 0.9998176413254668, delta = 0.0007604589918628335, c = 0.0006352826468905883, d = 0.0006366989150936504, m = 0.0005950595663116015
[Iteration 12110] [Rank 0] a = 1.1056065559387207, b = 0.9996842875925219, delta = 0.0007829343667253852, c = 0.000368575164065172, d = 0.00036940419911086683, m = 0.0005954669570374865
[Iteration 12120] [Rank 0] a = 0.9617290496826172, b = 0.999795792798517, delta = 0.00078916474012658, c = 0.0005915855913570886, d = 0.0005924837126565914, m = 0.0005956366015827426
[Iteration 12060] [Rank 2] a = 1.057893991470337, b = 0.9997804729224231, delta = 0.0007621452677994967, c = 0.0005609458377932829, d = 0.0005620166747273053, m = 0.0006369485071573508
[Iteration 12070] [Rank 2] a = 1.102959156036377, b = 0.9996860492918195, delta = 0.0008009737357497215, c = 0.0003720985630093751, d = 0.00037278942554745415, m = 0.000637110894321943
[Iteration 12080] [Rank 2] a = 1.0000815391540527, b = 0.9999175573182019, delta = 0.0007340579759329557, c = 0.0008351146360299529, d = 0.0008361854729639754, m = 0.0006373186898723478
[Iteration 12090] [Rank 2] a = 0.9224687218666077, b = 0.9999064862461149, delta = 0.000795715837739408, c = 0.0008129724916845194, d = 0.0008135597248418866, m = 0.0006373073409493364
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  12092 |     0.11108s |  93.0%
- batch.accumulate               |  12092 |     0.00082s |   0.7%
[Iteration 12010] [Rank 3] a = 0.9956117272377014, b = 0.9998812524921972, delta = 0.0007289205677807331, c = 0.000762504983277845, d = 0.0007633340183235398, m = 0.0006641011686596801
[Iteration 12020] [Rank 3] a = 0.9195089340209961, b = 1.0007156243282789, delta = 0.0006938056903891265, c = 0.0024312489008808807, d = 0.0024001600866673236, m = 0.0006643362959291133
[Iteration 12030] [Rank 3] a = 0.9536691308021545, b = 0.9997954819103879, delta = 0.0007852971320971847, c = 0.0005909638150728174, d = 0.0005921728245144558, m = 0.0006644034618436395
[Iteration 12040] [Rank 3] a = 0.9991772770881653, b = 0.9997986426063694, delta = 0.0007543076062574983, c = 0.0005972852072962407, d = 0.0005984251304840711, m = 0.0006647755864276954
[Iteration 12050] [Rank 3] a = 0.9346973299980164, b = 0.9999990963690718, delta = 0.0007526011322624981, c = 0.0009981927381435122, d = 0.0009981927381435122, m = 0.000664902304739562
[Iteration 12060] [Rank 1] a = 1.0051034688949585, b = 0.9998902164335116, delta = 0.0007729051285423338, c = 0.0007804328661409962, d = 0.000781296444313595, m = 0.0007417932955651786
[Iteration 12070] [Rank 1] a = 1.0290814638137817, b = 0.9997621996092468, delta = 0.0008048706222325563, c = 0.0005243992095289012, d = 0.0005255736758436356, m = 0.0007417626668849497
[Iteration 12080] [Rank 1] a = 0.9731539487838745, b = 0.9998791108183598, delta = 0.0007778474828228354, c = 0.0007582216355417549, d = 0.0007592924724757774, m = 0.0007419261949207711
[Iteration 12090] [Rank 1] a = 0.9808356761932373, b = 0.9997756886995827, delta = 0.00080963468644768, c = 0.000551377391640888, d = 0.0005525864010825263, m = 0.0007421521591927765
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  12092 |     0.11098s |  92.9%
- batch.accumulate               |  12092 |     0.00083s |   0.7%
[Iteration 12130] [Rank 0] a = 1.0815316438674927, b = 0.9997992298395031, delta = 0.0007392533007077873, c = 0.0005984596736109751, d = 0.0005991850792759581, m = 0.0005964897557670473
[Iteration 12140] [Rank 0] a = 1.0671203136444092, b = 0.9997258775136911, delta = 0.0007790181552991271, c = 0.0004517550136498893, d = 0.00045223861742654467, m = 0.0005976105232611672
[Iteration 12150] [Rank 0] a = 0.8192608952522278, b = 1.0074176495137737, delta = 0.0006300043314695358, c = 0.015835571123451988, d = 0.013520387128968388, m = 0.0005992152473002094
[Iteration 12160] [Rank 0] a = 1.0233908891677856, b = 0.9997734088533228, delta = 0.0007610039901919663, c = 0.0005468176988895662, d = 0.0005478194495697809, m = 0.0005993226098341694
rel_compression_error          - epoch: 87.540, value:  0.997 (weight:encoder.weight)
rel_compression_error          - epoch: 87.540, value:  0.992 (weight:rnn.weight_ih_l0)
rel_compression_error          - epoch: 87.540, value:  0.993 (weight:rnn.weight_hh_l0)
- batch.backward                 |  12092 |     0.05173s |  43.3%
- batch.evaluate                 |  12092 |     0.00274s |   2.3%
- batch.forward                  |  12092 |     0.02543s |  21.3%
- batch.mom                      |  12092 |     0.00126s |   1.1%
- batch.reduce                   |  12092 |     0.02634s |  22.1%
- batch.reporting.compr_err      |  12092 |     0.00001s |   0.0%
- batch.reporting.lr             |  12092 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  12092 |     0.00001s |   0.0%
- batch.step                     |  12092 |     0.00048s |   0.4%
- batch.update_runavg            |  12092 |     0.00129s |   1.1%
- batch.wd                       |  12092 |     0.00001s |   0.0%
- epoch_metrics.collect          |     86 |     0.01157s |   0.1%
- reduce.combine                 |  12092 |     0.00616s |   5.2%
- reduce.flatpack                |  12092 |     0.00002s |   0.0%
- reduce.flatput                 |  12092 |     0.00020s |   0.2%
[Iteration 12060] [Rank 3] a = 1.0635204315185547, b = 0.9997867252281, delta = 0.0007534769247286022, c = 0.0005734504497325136, d = 0.0005743140279051124, m = 0.0006650825508122994
[Iteration 12070] [Rank 3] a = 1.0086777210235596, b = 0.9999008557164818, delta = 0.0007278983830474317, c = 0.000801711432313831, d = 0.0008028858986285654, m = 0.0006652616912530892
[Iteration 12080] [Rank 3] a = 0.9897221326828003, b = 0.9998499046051007, delta = 0.0007740884902887046, c = 0.0006998092079471714, d = 0.0007010873036426176, m = 0.0006652794225075142
[Iteration 12090] [Rank 3] a = 1.0666698217391968, b = 0.9997397120350281, delta = 0.0007688068435527384, c = 0.0004794240582999552, d = 0.00048035672272636186, m = 0.0006660559590218944
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  12092 |     0.11110s |  93.0%
- batch.accumulate               |  12092 |     0.00082s |   0.7%
- batch.backward                 |  12092 |     0.05178s |  43.4%
- batch.evaluate                 |  12092 |     0.00275s |   2.3%
- batch.forward                  |  12092 |     0.02542s |  21.3%
- batch.mom                      |  12092 |     0.00126s |   1.1%
- batch.reduce                   |  12092 |     0.02615s |  21.9%
- batch.reporting.compr_err      |  12092 |     0.00001s |   0.0%
- batch.reporting.lr             |  12092 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  12092 |     0.00001s |   0.0%
- batch.step                     |  12092 |     0.00048s |   0.4%
- batch.update_runavg            |  12092 |     0.00130s |   1.1%
- batch.wd                       |  12092 |     0.00001s |   0.0%
- epoch_metrics.collect          |     86 |     0.00662s |   0.0%
- reduce.combine                 |  12092 |     0.00630s |   5.3%
- reduce.flatpack                |  12092 |     0.00002s |   0.0%
- reduce.flatput                 |  12092 |     0.00023s |   0.2%
rel_compression_error          - epoch: 87.540, value:  0.903 (weight:rnn.bias_ih_l0)
rel_compression_error          - epoch: 87.540, value:  0.903 (weight:rnn.bias_hh_l0)
- reduce.gather.context          |  12092 |     0.00209s |   1.8%
- reduce.gather.tensors          |  12092 |     0.00390s |   3.3%
- reduce.heur_params             |  12092 |     0.01058s |   8.9%
- batch.backward                 |  12092 |     0.05175s |  43.3%
- batch.evaluate                 |  12092 |     0.00277s |   2.3%
- batch.forward                  |  12092 |     0.02537s |  21.2%
- batch.mom                      |  12092 |     0.00126s |   1.1%
- batch.reduce                   |  12092 |     0.02636s |  22.1%
- batch.reporting.compr_err      |  12092 |     0.00001s |   0.0%
- batch.reporting.lr             |  12092 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  12092 |     0.00001s |   0.0%
- batch.step                     |  12092 |     0.00047s |   0.4%
- batch.update_runavg            |  12092 |     0.00129s |   1.1%
- batch.wd                       |  12092 |     0.00001s |   0.0%
- epoch_metrics.collect          |     86 |     0.00696s |   0.0%
- reduce.combine                 |  12092 |     0.00618s |   5.2%
- reduce.flatpack                |  12092 |     0.00002s |   0.0%
- reduce.flatput                 |  12092 |     0.00020s |   0.2%
- reduce.gather.context          |  12092 |     0.00121s |   1.0%
- reduce.gather.tensors          |  12092 |     0.00388s |   3.2%
- reduce.heur_params             |  12092 |     0.01095s |   9.2%
rel_compression_error          - epoch: 87.540, value:  0.993 (weight:rnn.weight_ih_l1)
rel_compression_error          - epoch: 87.540, value:  0.998 (weight:rnn.weight_hh_l1)
rel_compression_error          - epoch: 87.540, value:  0.968 (weight:rnn.bias_ih_l1)
rel_compression_error          - epoch: 87.540, value:  0.968 (weight:rnn.bias_hh_l1)
rel_compression_error          - epoch: 87.540, value:  0.983 (weight:rnn.weight_ih_l2)
rel_compression_error          - epoch: 87.540, value:  0.987 (weight:rnn.weight_hh_l2)
rel_compression_error          - epoch: 87.540, value:  0.774 (weight:rnn.bias_ih_l2)
rel_compression_error          - epoch: 87.540, value:  0.774 (weight:rnn.bias_hh_l2)
rel_compression_error          - epoch: 87.540, value:  0.933 (weight:decoder.bias)
rel_compression_error          - epoch: 87.540, value:  0.995 (weight:entire_model)
- reduce.heur_params.alpha       |  12091 |     0.00818s |   6.8%
- reduce.heur_params.beta        |  12091 |     0.00233s |   2.0%
- reduce.memory                  |  12092 |     0.00046s |   0.4%
- reduce.pad                     |  12092 |     0.00027s |   0.2%
- reduce.threshold               |  12092 |     0.00246s |   2.1%
- test.last                      |     86 |     0.40999s |   2.5%
- test.runavg                    |     86 |     0.44073s |   2.7%
-----------------------------------------------------------------

[Iteration 12100] [Rank 2] a = 0.9316672682762146, b = 1.0002990516026273, delta = 0.0007097892230376601, c = 0.0015981032230844533, d = 0.001591021882069143, m = 0.0006378269575696242
[Iteration 12110] [Rank 2] a = 0.8964055180549622, b = 1.001432220638778, delta = 0.0006988017121329904, c = 0.0038644432361258653, d = 0.003730277731230914, m = 0.0006380933467696227
- reduce.gather.context          |  12092 |     0.00245s |   2.1%
- reduce.gather.tensors          |  12092 |     0.00353s |   3.0%
- reduce.heur_params             |  12092 |     0.01054s |   8.8%
- reduce.heur_params.alpha       |  12091 |     0.00836s |   7.0%
- reduce.heur_params.beta        |  12091 |     0.00251s |   2.1%
- reduce.memory                  |  12092 |     0.00047s |   0.4%
- reduce.pad                     |  12092 |     0.00022s |   0.2%
- reduce.threshold               |  12092 |     0.00267s |   2.2%
- test.last                      |     86 |     0.40999s |   2.5%
- test.runavg                    |     86 |     0.44073s |   2.7%
-----------------------------------------------------------------

[Iteration 12100] [Rank 1] a = 1.0168821811676025, b = 0.9998027705098705, delta = 0.000794840045273304, c = 0.0006055410146262853, d = 0.000606439135925788, m = 0.0007422892013028118
[Iteration 12110] [Rank 1] a = 1.0158019065856934, b = 0.9997606278970622, delta = 0.0008246100042015314, c = 0.0005212557849806416, d = 0.000522326621914664, m = 0.0007422939483265322
[Iteration 12170] [Rank 0] a = 0.8904953598976135, b = 1.0001800332658495, delta = 0.0007128513534553349, c = 0.0013600665355893173, d = 0.0013583739223710237, m = 0.0005996070611340061
[Iteration 12180] [Rank 0] a = 0.9135401844978333, b = 1.0001291166980208, delta = 0.0007230817573145032, c = 0.0012582333974764657, d = 0.001255884464846997, m = 0.0005997746378059578
[Iteration 12190] [Rank 0] a = 0.9368930459022522, b = 0.9999469880621867, delta = 0.0007432645652443171, c = 0.0008939761242742878, d = 0.000894528814304751, m = 0.000599998694446611
[Iteration 12200] [Rank 0] a = 0.8815348744392395, b = 1.0016412060622686, delta = 0.0006709421868436038, c = 0.004282415071663689, d = 0.004155365450910952, m = 0.0006004693893934623
[Iteration 12210] [Rank 0] a = 0.8603694438934326, b = 1.0049181534298761, delta = 0.000629554851911962, c = 0.010836386168531288, d = 0.009495042007723912, m = 0.0006014621562042957
[Iteration 12120] [Rank 2] a = 1.0915099382400513, b = 0.9996643734819748, delta = 0.0008415429037995636, c = 0.00032874693874491485, d = 0.0003295759737906097, m = 0.0006381120741018061
[Iteration 12130] [Rank 2] a = 0.8614134788513184, b = 1.0029118855004813, delta = 0.0006732292822562158, c = 0.00682378746111437, d = 0.006381013660459509, m = 0.0006389319228002446
[Iteration 12140] [Rank 2] a = 0.9124699831008911, b = 1.0002063033128783, delta = 0.0007059959461912513, c = 0.0014126066316102288, d = 0.0014092559483005456, m = 0.0006391199953725736
[Iteration 12150] [Rank 2] a = 1.1362676620483398, b = 0.9996679141520878, delta = 0.0007882372592575848, c = 0.0003358282797602251, d = 0.000336622771679016, m = 0.0006393415083655394
[Iteration 12160] [Rank 2] a = 0.9810683727264404, b = 0.9998906654941558, delta = 0.0007766286144033074, c = 0.000781330987440499, d = 0.0007823672812476176, m = 0.0006393574888927431
- reduce.heur_params.alpha       |  12091 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  12091 |     0.00237s |   2.0%
- reduce.memory                  |  12092 |     0.00046s |   0.4%
- reduce.pad                     |  12092 |     0.00026s |   0.2%
- reduce.threshold               |  12092 |     0.00251s |   2.1%
- test.last                      |     86 |     0.40999s |   2.5%
- test.runavg                    |     86 |     0.44072s |   2.7%
-----------------------------------------------------------------

[Iteration 12100] [Rank 3] a = 0.8919816613197327, b = 1.0008337444797015, delta = 0.0007090842700563371, c = 0.002667489345777011, d = 0.002641651086852855, m = 0.0006662773517075868
[Iteration 12110] [Rank 3] a = 0.9177899360656738, b = 1.0002734033330036, delta = 0.0007370495586656034, c = 0.0015468066796320839, d = 0.0015405198305355645, m = 0.0006663510820568567
[Iteration 12120] [Rank 1] a = 0.9621627330780029, b = 1.0002583943454255, delta = 0.000749082479160279, c = 0.0015167887023525492, d = 0.0015100873357331826, m = 0.0007426248594472692
[Iteration 12130] [Rank 1] a = 0.9456654191017151, b = 1.0000702379388149, delta = 0.0007359844748862088, c = 0.001140475877860892, d = 0.0011390941527847339, m = 0.0007429547039111239
[Iteration 12140] [Rank 1] a = 0.921673595905304, b = 1.000271589818976, delta = 0.0007357590366154909, c = 0.001543179651307169, d = 0.0015331276013781188, m = 0.0007430799157690688
[Iteration 12150] [Rank 1] a = 0.966719388961792, b = 1.0001295830302261, delta = 0.0007278301636688411, c = 0.0012591660619028723, d = 0.0012568171292734035, m = 0.000743567412576194
[Iteration 12160] [Rank 1] a = 1.044051170349121, b = 0.999809679134992, delta = 0.0007679096888750792, c = 0.0006193582653878663, d = 0.0006207054473371204, m = 0.0007436159175281174
[Iteration 12220] [Rank 0] a = 0.9407150745391846, b = 1.0002782393704024, delta = 0.0006733627524226904, c = 0.0015564787551651906, d = 0.001551020941114366, m = 0.0006017093590472802
[Iteration 12230] [Rank 0] a = 1.1018959283828735, b = 0.9997161190811004, delta = 0.0007550391601398587, c = 0.00043223814694915623, d = 0.0004333435270100827, m = 0.0006019090693212408
cross_entropy                  - bits:32020339968.000, epoch: 88.000, ratio_transmit_grad:  0.198, value:  5.343 (split:train)
last_cross_entropy             - bits:32020339968.000, epoch: 88.000, ratio_transmit_grad:  0.198, value:  5.343 (split:train)
perplexity                     - bits:32020339968.000, epoch: 88.000, ratio_transmit_grad:  0.198, value:209.698 (split:train)
last_perplexity                - bits:32020339968.000, epoch: 88.000, ratio_transmit_grad:  0.198, value:209.698 (split:train)
last_cross_entropy             - bits:32020339968.000, epoch: 88.000, ratio_transmit_grad:  0.198, value:  5.139 (split:test)
[Iteration 12170] [Rank 2] a = 1.0551068782806396, b = 0.9997496259118032, delta = 0.0007725542527623475, c = 0.0004992518131428238, d = 0.0005002881069499424, m = 0.0006395428438349472
[Iteration 12180] [Rank 2] a = 1.060153603553772, b = 0.9998064838958708, delta = 0.0007330068619921803, c = 0.0006129677869106351, d = 0.0006139695375908497, m = 0.0006399155009694686
[Iteration 12190] [Rank 2] a = 1.0196194648742676, b = 0.9997655675639324, delta = 0.0007929468411020935, c = 0.000531135119275172, d = 0.0005324477580975221, m = 0.00063994686724026
[Iteration 12200] [Rank 2] a = 1.0191113948822021, b = 0.9998340493102481, delta = 0.0007469334523193538, c = 0.0006680986174493431, d = 0.0006692385406371735, m = 0.0006402556369297195
[Iteration 12210] [Rank 2] a = 1.0196157693862915, b = 0.9998808725178066, delta = 0.0007227099849842489, c = 0.000761745034485958, d = 0.0007626086126585568, m = 0.0006406761582784321
[Iteration 12120] [Rank 3] a = 0.9697544574737549, b = 1.000278170284154, delta = 0.0007298043346963823, c = 0.0015563405826575748, d = 0.0015473248265356432, m = 0.0006664796189089696
[Iteration 12130] [Rank 3] a = 0.925869345664978, b = 1.0006996135969763, delta = 0.0007262112339958549, c = 0.002399227422240917, d = 0.0023661351066669306, m = 0.000666576063140041
[Iteration 12140] [Rank 3] a = 0.9999128580093384, b = 0.9998199384433304, delta = 0.0007489843992516398, c = 0.000639876882768814, d = 0.00064132769409878, m = 0.0006669407071395073
[Iteration 12150] [Rank 3] a = 0.9471906423568726, b = 1.000076887490708, delta = 0.0007343829493038356, c = 0.0011537749817189136, d = 0.0011524277997696595, m = 0.0006671252836151948
[Iteration 12160] [Rank 3] a = 1.0667043924331665, b = 0.9997522166461602, delta = 0.0007708871271461248, c = 0.0005044332821784167, d = 0.0005054695759855352, m = 0.0006672578568853654
[Iteration 12170] [Rank 1] a = 0.9870960116386414, b = 0.9999732408385904, delta = 0.0007659416878595948, c = 0.0009464816771682954, d = 0.0009469307378180468, m = 0.0007436261724913161
[Iteration 12180] [Rank 1] a = 0.9736137390136719, b = 1.0001267850369928, delta = 0.0007598299998790026, c = 0.0012535700753444322, d = 0.001250115762654037, m = 0.0007437039768710115
[Iteration 12190] [Rank 1] a = 0.9477201700210571, b = 1.0010949593609406, delta = 0.000737804570235312, c = 0.003189919597072387, d = 0.003107223351264325, m = 0.0007438826960089549
[Iteration 12200] [Rank 1] a = 0.9284036755561829, b = 1.0001673213955324, delta = 0.0007682011346332729, c = 0.0013346427941880084, d = 0.0013323629478123474, m = 0.0007439237933702931
[Iteration 12210] [Rank 1] a = 0.9408026933670044, b = 0.9999725845191798, delta = 0.0007775735575705767, c = 0.0009451690383459452, d = 0.0009455144696149848, m = 0.0007439955475946298
last_perplexity                - bits:32020339968.000, epoch: 88.000, ratio_transmit_grad:  0.198, value:171.059 (split:test)
runavg_cross_entropy           - bits:32020339968.000, epoch: 88.000, ratio_transmit_grad:  0.198, value:  5.340 (split:test)
runavg_perplexity              - bits:32020339968.000, epoch: 88.000, ratio_transmit_grad:  0.198, value:209.168 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  12231 |     0.11103s |  92.9%
- batch.accumulate               |  12231 |     0.00082s |   0.7%
- batch.backward                 |  12231 |     0.05162s |  43.2%
- batch.evaluate                 |  12231 |     0.00275s |   2.3%
- batch.forward                  |  12231 |     0.02539s |  21.3%
- batch.mom                      |  12231 |     0.00126s |   1.1%
- batch.reduce                   |  12231 |     0.02637s |  22.1%
[Iteration 12220] [Rank 2] a = 0.8797600865364075, b = 1.000138339712739, delta = 0.000739562208764255, c = 0.0012766794272431763, d = 0.0012741232358522837, m = 0.0006407925907908103
[Iteration 12230] [Rank 2] a = 1.0302265882492065, b = 0.9998071747583832, delta = 0.0007405925425700843, c = 0.0006143495119867932, d = 0.0006153167195401039, m = 0.0006413554647280699
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  12231 |     0.11110s |  93.0%
- batch.accumulate               |  12231 |     0.00082s |   0.7%
- batch.backward                 |  12231 |     0.05172s |  43.3%
- batch.evaluate                 |  12231 |     0.00274s |   2.3%
- batch.forward                  |  12231 |     0.02543s |  21.3%
- batch.mom                      |  12231 |     0.00126s |   1.1%
- batch.reduce                   |  12231 |     0.02638s |  22.1%
[Iteration 12170] [Rank 3] a = 1.0671956539154053, b = 0.9996875173745688, delta = 0.0008060667896643281, c = 0.00037503472879621104, d = 0.00037634736761856126, m = 0.0006673316612644478
[Iteration 12180] [Rank 3] a = 1.0158668756484985, b = 0.9997900413681342, delta = 0.0007964777760207653, c = 0.0005800827300980724, d = 0.0005812226532859029, m = 0.0006674161489393125
[Iteration 12190] [Rank 3] a = 0.9672874808311462, b = 1.0000432424852281, delta = 0.000745059980545193, c = 0.0010864849705100143, d = 0.0010857250217181274, m = 0.0006676885060098655
[Iteration 12200] [Rank 3] a = 0.9594593644142151, b = 1.000036161144224, delta = 0.0007402099436149001, c = 0.001072322288479394, d = 0.0010720459434641622, m = 0.0006679057240535398
[Iteration 12210] [Rank 3] a = 1.095215916633606, b = 0.9997013346240401, delta = 0.0007799625163897872, c = 0.000402669230319373, d = 0.0004035328084919718, m = 0.0006683982241247628
[Iteration 12220] [Rank 1] a = 0.9823585748672485, b = 0.9998785408567741, delta = 0.0007928801351226866, c = 0.0007570817123539245, d = 0.0007579798336534272, m = 0.0007441341987923139
[Iteration 12230] [Rank 1] a = 0.902911365032196, b = 1.0001773734451629, delta = 0.0007459581247530878, c = 0.0013547468940461086, d = 0.001351603469497849, m = 0.0007446133437265686
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  12231 |     0.11100s |  92.9%
- batch.accumulate               |  12231 |     0.00083s |   0.7%
- batch.backward                 |  12231 |     0.05179s |  43.3%
- batch.evaluate                 |  12231 |     0.00275s |   2.3%
- batch.forward                  |  12231 |     0.02542s |  21.3%
- batch.mom                      |  12231 |     0.00126s |   1.1%
- batch.reduce                   |  12231 |     0.02617s |  21.9%
- batch.reporting.compr_err      |  12231 |     0.00001s |   0.0%
- batch.reporting.lr             |  12231 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  12231 |     0.00001s |   0.0%
- batch.step                     |  12231 |     0.00048s |   0.4%
- batch.update_runavg            |  12231 |     0.00130s |   1.1%
- batch.reporting.compr_err      |  12231 |     0.00001s |   0.0%
- batch.reporting.lr             |  12231 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  12231 |     0.00001s |   0.0%
- batch.step                     |  12231 |     0.00048s |   0.4%
- batch.update_runavg            |  12231 |     0.00129s |   1.1%
[Iteration 12220] [Rank 3] a = 0.9280310869216919, b = 1.0002181343333099, delta = 0.000720154435839504, c = 0.0014362686735394363, d = 0.001429878195062205, m = 0.0006685347664712675
[Iteration 12230] [Rank 3] a = 1.0350834131240845, b = 0.9997726316330073, delta = 0.0007534677861258388, c = 0.0005452632581788885, d = 0.0005463686382398149, m = 0.0006687425102593936
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  12231 |     0.11113s |  93.0%
- batch.accumulate               |  12231 |     0.00082s |   0.7%
- batch.backward                 |  12231 |     0.05175s |  43.3%
- batch.evaluate                 |  12231 |     0.00277s |   2.3%
- batch.forward                  |  12231 |     0.02537s |  21.2%
- batch.mom                      |  12231 |     0.00126s |   1.1%
- batch.reduce                   |  12231 |     0.02638s |  22.1%
- batch.reporting.compr_err      |  12231 |     0.00001s |   0.0%
- batch.reporting.lr             |  12231 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  12231 |     0.00001s |   0.0%
- batch.step                     |  12231 |     0.00048s |   0.4%
- batch.update_runavg            |  12231 |     0.00130s |   1.1%
- batch.wd                       |  12231 |     0.00001s |   0.0%
- epoch_metrics.collect          |     87 |     0.00745s |   0.0%
- reduce.combine                 |  12231 |     0.00646s |   5.4%
- reduce.flatpack                |  12231 |     0.00002s |   0.0%
- reduce.flatput                 |  12231 |     0.00021s |   0.2%
- reduce.gather.context          |  12231 |     0.00110s |   0.9%
- reduce.gather.tensors          |  12231 |     0.00401s |   3.4%
- reduce.heur_params             |  12231 |     0.01113s |   9.3%
- reduce.heur_params.alpha       |  12230 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  12230 |     0.00235s |   2.0%
- reduce.memory                  |  12231 |     0.00046s |   0.4%
- reduce.pad                     |  12231 |     0.00028s |   0.2%
- reduce.threshold               |  12231 |     0.00248s |   2.1%
- test.last                      |     87 |     0.40995s |   2.5%
- test.runavg                    |     87 |     0.44069s |   2.7%
- batch.wd                       |  12231 |     0.00001s |   0.0%
- epoch_metrics.collect          |     87 |     0.01147s |   0.1%
- reduce.combine                 |  12231 |     0.00616s |   5.2%
- reduce.flatpack                |  12231 |     0.00002s |   0.0%
- reduce.flatput                 |  12231 |     0.00020s |   0.2%
- reduce.gather.context          |  12231 |     0.00210s |   1.8%
- reduce.gather.tensors          |  12231 |     0.00392s |   3.3%
- reduce.heur_params             |  12231 |     0.01058s |   8.9%
- reduce.heur_params.alpha       |  12230 |     0.00818s |   6.8%
- reduce.heur_params.beta        |  12230 |     0.00233s |   2.0%
- reduce.memory                  |  12231 |     0.00046s |   0.4%
- reduce.pad                     |  12231 |     0.00027s |   0.2%
- reduce.threshold               |  12231 |     0.00246s |   2.1%
- test.last                      |     87 |     0.40996s |   2.5%
- test.runavg                    |     87 |     0.44068s |   2.7%
- batch.reporting.compr_err      |  12231 |     0.00001s |   0.0%
- batch.reporting.lr             |  12231 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  12231 |     0.00001s |   0.0%
- batch.step                     |  12231 |     0.00047s |   0.4%
- batch.update_runavg            |  12231 |     0.00129s |   1.1%
- batch.wd                       |  12231 |     0.00001s |   0.0%
- epoch_metrics.collect          |     87 |     0.00657s |   0.0%
- reduce.combine                 |  12231 |     0.00630s |   5.3%
- reduce.flatpack                |  12231 |     0.00002s |   0.0%
- reduce.flatput                 |  12231 |     0.00023s |   0.2%
- reduce.gather.context          |  12231 |     0.00121s |   1.0%
- reduce.gather.tensors          |  12231 |     0.00389s |   3.3%
- reduce.heur_params             |  12231 |     0.01095s |   9.2%
- reduce.heur_params.alpha       |  12230 |     0.00837s |   7.0%
- reduce.heur_params.beta        |  12230 |     0.00251s |   2.1%
- reduce.memory                  |  12231 |     0.00047s |   0.4%
- reduce.pad                     |  12231 |     0.00022s |   0.2%
- reduce.threshold               |  12231 |     0.00267s |   2.2%
- test.last                      |     87 |     0.40996s |   2.5%
- test.runavg                    |     87 |     0.44068s |   2.7%
-----------------------------------------------------------------
-----------------------------------------------------------------
- batch.wd                       |  12231 |     0.00001s |   0.0%
- epoch_metrics.collect          |     87 |     0.00690s |   0.0%
- reduce.combine                 |  12231 |     0.00618s |   5.2%
- reduce.flatpack                |  12231 |     0.00002s |   0.0%
- reduce.flatput                 |  12231 |     0.00020s |   0.2%
- reduce.gather.context          |  12231 |     0.00246s |   2.1%
- reduce.gather.tensors          |  12231 |     0.00354s |   3.0%
- reduce.heur_params             |  12231 |     0.01054s |   8.8%
- reduce.heur_params.alpha       |  12230 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  12230 |     0.00237s |   2.0%
- reduce.memory                  |  12231 |     0.00046s |   0.4%
- reduce.pad                     |  12231 |     0.00026s |   0.2%
- reduce.threshold               |  12231 |     0.00251s |   2.1%
- test.last                      |     87 |     0.40997s |   2.5%
- test.runavg                    |     87 |     0.44068s |   2.7%
-----------------------------------------------------------------
-----------------------------------------------------------------

[Iteration 12240] [Rank 0] a = 0.9849252104759216, b = 0.9999052945082472, delta = 0.0007095273467712104, c = 0.0008105890159281467, d = 0.0008113489647200336, m = 0.000602382269872488
[Iteration 12250] [Rank 0] a = 0.9900696873664856, b = 0.9998474175000207, delta = 0.0007204585708677769, c = 0.0006948349976730022, d = 0.0006955604033379852, m = 0.0006026550408402652
[Iteration 12260] [Rank 0] a = 1.1225531101226807, b = 0.9996759108851051, delta = 0.000758305424824357, c = 0.0003518217475167551, d = 0.00035247806692793014, m = 0.0006029440848278362
[Iteration 12270] [Rank 0] a = 0.9646803736686707, b = 0.9999095087696932, delta = 0.0007378875743597746, c = 0.0008190175388927111, d = 0.000819846573938406, m = 0.0006031203242877521
[Iteration 12280] [Rank 0] a = 1.048558235168457, b = 0.9997424063987459, delta = 0.0007738724816590548, c = 0.00048481278609697174, d = 0.0004861945111731298, m = 0.0006033426670782459
[Iteration 12290] [Rank 0] a = 0.9361836910247803, b = 1.000134850856987, delta = 0.0007008790853433311, c = 0.0012697017156085779, d = 0.0012675600417405327, m = 0.0006037781403899602
[Iteration 12300] [Rank 0] a = 1.047277569770813, b = 0.9998284187807233, delta = 0.0007357217255048454, c = 0.0006568375580786546, d = 0.0006575975068705416, m = 0.0006039761696976411
[Iteration 12310] [Rank 0] a = 0.9678940176963806, b = 0.9998142042844562, delta = 0.0007601941470056772, c = 0.0006284085646367018, d = 0.0006292721428093006, m = 0.0006043411523370865
[Iteration 12320] [Rank 0] a = 0.9557540416717529, b = 0.9998788172017853, delta = 0.0007548687281087041, c = 0.0007576344023843877, d = 0.0007586706961915063, m = 0.0006044624117267123
[Iteration 12330] [Rank 0] a = 1.0265306234359741, b = 0.9998753628891472, delta = 0.0007037962204776704, c = 0.0007507257770035973, d = 0.0007518311570645237, m = 0.0006048661336419299
[Iteration 12340] [Rank 0] a = 1.0129746198654175, b = 0.999820819293038, delta = 0.0007122487295418978, c = 0.0006416385822409156, d = 0.0006422949016520906, m = 0.0006051964734564545
[Iteration 12350] [Rank 0] a = 0.9076454043388367, b = 1.0007123772760054, delta = 0.0006822672439739108, c = 0.0024247547930229376, d = 0.0023949095313779228, m = 0.0006054873666414832
[Iteration 12360] [Rank 0] a = 0.9484943151473999, b = 1.0000449523700066, delta = 0.0007337694987654686, c = 0.0010899047400735058, d = 0.0010892484206623306, m = 0.0006056029189501391
[Iteration 12370] [Rank 0] a = 1.0302029848098755, b = 1.0000343303585004, delta = 0.0007095435285009444, c = 0.001068660717027575, d = 0.0010684189151392474, m = 0.0006060165962217414
cross_entropy                  - bits:32457133440.000, epoch: 89.000, ratio_transmit_grad:  0.170, value:  5.343 (split:train)
last_cross_entropy             - bits:32457133440.000, epoch: 89.000, ratio_transmit_grad:  0.170, value:  5.343 (split:train)
perplexity                     - bits:32457133440.000, epoch: 89.000, ratio_transmit_grad:  0.170, value:209.749 (split:train)
last_perplexity                - bits:32457133440.000, epoch: 89.000, ratio_transmit_grad:  0.170, value:209.749 (split:train)
last_cross_entropy             - bits:32457133440.000, epoch: 89.000, ratio_transmit_grad:  0.170, value:  5.139 (split:test)
last_perplexity                - bits:32457133440.000, epoch: 89.000, ratio_transmit_grad:  0.170, value:171.054 (split:test)
runavg_cross_entropy           - bits:32457133440.000, epoch: 89.000, ratio_transmit_grad:  0.170, value:  5.339 (split:test)
runavg_perplexity              - bits:32457133440.000, epoch: 89.000, ratio_transmit_grad:  0.170, value:209.025 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  12370 |     0.11104s |  92.9%
- batch.accumulate               |  12370 |     0.00082s |   0.7%
- batch.backward                 |  12370 |     0.05162s |  43.2%
- batch.evaluate                 |  12370 |     0.00275s |   2.3%
- batch.forward                  |  12370 |     0.02539s |  21.3%
- batch.mom                      |  12370 |     0.00126s |   1.1%
- batch.reduce                   |  12370 |     0.02638s |  22.1%
- batch.reporting.compr_err      |  12370 |     0.00001s |   0.0%
- batch.reporting.lr             |  12370 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  12370 |     0.00001s |   0.0%
- batch.step                     |  12370 |     0.00048s |   0.4%
- batch.update_runavg            |  12370 |     0.00130s |   1.1%
- batch.wd                       |  12370 |     0.00001s |   0.0%
- epoch_metrics.collect          |     88 |     0.00737s |   0.0%
- reduce.combine                 |  12370 |     0.00646s |   5.4%
- reduce.flatpack                |  12370 |     0.00002s |   0.0%
- reduce.flatput                 |  12370 |     0.00021s |   0.2%
- reduce.gather.context          |  12370 |     0.00110s |   0.9%
- reduce.gather.tensors          |  12370 |     0.00402s |   3.4%
- reduce.heur_params             |  12370 |     0.01114s |   9.3%
- reduce.heur_params.alpha       |  12369 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  12369 |     0.00235s |   2.0%
- reduce.memory                  |  12370 |     0.00046s |   0.4%
- reduce.pad                     |  12370 |     0.00028s |   0.2%
- reduce.threshold               |  12370 |     0.00248s |   2.1%
- test.last                      |     88 |     0.40991s |   2.5%
- test.runavg                    |     88 |     0.44067s |   2.7%
-----------------------------------------------------------------

[Iteration 12380] [Rank 0] a = 0.9631600379943848, b = 0.9998533934608413, delta = 0.0007602687692269683, c = 0.0007067869195817698, d = 0.0007076504977543686, m = 0.0006061184325247502
[Iteration 12390] [Rank 0] a = 1.074779987335205, b = 0.9997343405791661, delta = 0.0007557448698207736, c = 0.000468681145832826, d = 0.0004696483533861366, m = 0.000606408807891117
[Iteration 12400] [Rank 0] a = 0.8886779546737671, b = 1.0000551253208543, delta = 0.0007238619145937264, c = 0.0011102506418199337, d = 0.0011097324949163744, m = 0.0006065974560373775
[Iteration 12410] [Rank 0] a = 0.9531337022781372, b = 0.9999599417347477, delta = 0.0007466421811841428, c = 0.0009198834694522521, d = 0.000920608875117235, m = 0.0006067167417609753
[Iteration 12420] [Rank 0] a = 0.9805223941802979, b = 0.9999685084302088, delta = 0.000762505573220551, c = 0.0009370168603966124, d = 0.0009375695504270756, m = 0.0006068698306782613
[Iteration 12430] [Rank 0] a = 0.9132437109947205, b = 1.0000485448551966, delta = 0.0007588766166009009, c = 0.0010970897104695277, d = 0.001096295218550737, m = 0.0006069741639729338
[Iteration 12440] [Rank 0] a = 1.0023082494735718, b = 0.9997918030675291, delta = 0.0008038296364247799, c = 0.0005836061290422755, d = 0.0005848842247377218, m = 0.000607215424746757
[Iteration 12450] [Rank 0] a = 1.0406537055969238, b = 0.9998063457233685, delta = 0.0007460498600266874, c = 0.0006126914418954035, d = 0.0006139004513370419, m = 0.0006077085063675089
[Iteration 12460] [Rank 0] a = 1.0219312906265259, b = 0.9998209574655413, delta = 0.0007501477375626564, c = 0.0006419149272561472, d = 0.0006430548504439776, m = 0.0006079179981265604
[Iteration 12470] [Rank 0] a = 1.1386828422546387, b = 0.9996502626162918, delta = 0.0008229719824157655, c = 0.0003005252040643858, d = 0.00030142332536388855, m = 0.000608143748248061
[Iteration 12480] [Rank 0] a = 0.9599174857139587, b = 1.000273645134874, delta = 0.0007320189033634961, c = 0.0015472902834087392, d = 0.001539552622982254, m = 0.0006083060561813693
[Iteration 12490] [Rank 0] a = 0.9423730969429016, b = 1.0003203474383202, delta = 0.0007201175321824849, c = 0.0016406948985570266, d = 0.001630953736770112, m = 0.000608587988879368
[Iteration 12500] [Rank 0] a = 1.018491268157959, b = 0.9997454461937143, delta = 0.000806107243988663, c = 0.0004908923764320674, d = 0.000491894127112282, m = 0.0006086996645668506
cross_entropy                  - bits:32907216128.000, epoch: 90.000, ratio_transmit_grad:  0.175, value:  5.343 (split:train)

[Iteration 12240] [Rank 3] a = 0.8780825138092041, b = 1.000275372291089, delta = 0.0007272906950674951, c = 0.0015507445960991344, d = 0.001546150360220909, m = 0.0006691559232753285
[Iteration 12250] [Rank 3] a = 1.0060478448867798, b = 0.9997937374825528, delta = 0.0007630045874975622, c = 0.0005874749592555183, d = 0.0005885457961895407, m = 0.000669273921190305
[Iteration 12260] [Rank 3] a = 0.850109338760376, b = 1.0007549171138845, delta = 0.0007184600690379739, c = 0.0025098345145873726, d = 0.0024836853675210806, m = 0.0006694750431517402
[Iteration 12270] [Rank 3] a = 1.0968035459518433, b = 0.9996586738666886, delta = 0.0008543268195353448, c = 0.0003173477068666106, d = 0.00031824582816611336, m = 0.0006694571073393352
[Iteration 12280] [Rank 3] a = 1.0605344772338867, b = 0.999705807958581, delta = 0.0008214096305891871, c = 0.00041161590018749664, d = 0.000412790366502231, m = 0.0006695047260746543

[Iteration 12240] [Rank 1] a = 0.9459218382835388, b = 0.999974829822427, delta = 0.0007718095439486206, c = 0.0009496596448434591, d = 0.0009502123348739223, m = 0.0007446673651806655
[Iteration 12250] [Rank 1] a = 0.9655413627624512, b = 0.9999850373164229, delta = 0.0007809567032381892, c = 0.0009700746328436949, d = 0.0009702128053513107, m = 0.0007447801353899679
[Iteration 12260] [Rank 1] a = 0.9662767648696899, b = 0.999991876855549, delta = 0.0007324655307456851, c = 0.0009837537110976601, d = 0.0009839609698590838, m = 0.0007454934638434428
[Iteration 12270] [Rank 1] a = 0.9374016523361206, b = 0.9999803394511655, delta = 0.0007561557576991618, c = 0.0009606789023258198, d = 0.0009608516179603396, m = 0.0007457130572374503
[Iteration 12280] [Rank 1] a = 1.1019809246063232, b = 0.9996772062522283, delta = 0.0008329460979439318, c = 0.0003544124820345515, d = 0.0003555869483492859, m = 0.0007457421553376332
[Iteration 12290] [Rank 3] a = 0.9652438759803772, b = 0.9998916327016978, delta = 0.0008046617731451988, c = 0.0007832654025471203, d = 0.0007842326101004311, m = 0.0006695104226725416
[Iteration 12300] [Rank 3] a = 0.983814537525177, b = 0.9999102859900423, delta = 0.0007978334906511009, c = 0.0008205719796033889, d = 0.0008214355577759877, m = 0.0006695205749764543
[Iteration 12310] [Rank 3] a = 0.8742796182632446, b = 1.000284198059322, delta = 0.0007811461109668016, c = 0.001568396133947054, d = 0.0015623165436119586, m = 0.0006695801166339895
[Iteration 12320] [Rank 3] a = 0.8694140911102295, b = 1.0026903448952649, delta = 0.0007060174830257893, c = 0.006380702772317373, d = 0.005991747163378869, m = 0.0006703809394017489
[Iteration 12330] [Rank 3] a = 0.9250732660293579, b = 0.9998981095379206, delta = 0.0007843318744562566, c = 0.0007962190751361026, d = 0.0007969099376741815, m = 0.0006704787120075849
[Iteration 12290] [Rank 1] a = 0.9928078651428223, b = 0.9999105105203655, delta = 0.0007759029977023602, c = 0.0008210210402531404, d = 0.000821988247806451, m = 0.0007458330442163748
[Iteration 12300] [Rank 1] a = 1.014602780342102, b = 0.9997755159839568, delta = 0.0007948485435917974, c = 0.0005510319603718485, d = 0.0005522064266865828, m = 0.0007460096053757223
[Iteration 12310] [Rank 1] a = 0.9725567698478699, b = 1.0002824018168672, delta = 0.0007396260043606162, c = 0.001564803648749043, d = 0.0015514700017641174, m = 0.0007461548551405965
[Iteration 12320] [Rank 1] a = 1.0907560586929321, b = 0.9996965676729594, delta = 0.0007882447680458426, c = 0.0003931353272938821, d = 0.0003940334485933849, m = 0.0007467249478048093
[Iteration 12330] [Rank 1] a = 1.0041991472244263, b = 0.9997926666456647, delta = 0.0008003768161870539, c = 0.0005853332853874731, d = 0.0005864386654483996, m = 0.0007466820013018871
[Iteration 12340] [Rank 3] a = 1.0138773918151855, b = 0.9997847044552687, delta = 0.0007808954687789083, c = 0.0005694089038847511, d = 0.0005706869995801974, m = 0.0006706129405886995
[Iteration 12350] [Rank 3] a = 0.9156154990196228, b = 0.9999525667771677, delta = 0.000797526678070426, c = 0.0009051335542642644, d = 0.0009057207874216315, m = 0.0006706103958489626
[Iteration 12360] [Rank 3] a = 0.934511661529541, b = 1.000051049231891, delta = 0.0007718795095570385, c = 0.001102098463870601, d = 0.0011014076013325217, m = 0.0006707501887823424
[Iteration 12370] [Rank 3] a = 1.00658118724823, b = 0.9999419102225476, delta = 0.0007727266056463122, c = 0.0008838204449645257, d = 0.0008841658762335653, m = 0.0006712792824537941
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  12370 |     0.11114s |  93.0%
- batch.accumulate               |  12370 |     0.00082s |   0.7%
[Iteration 12340] [Rank 1] a = 1.001061201095581, b = 0.9997602824658128, delta = 0.0008310978882946074, c = 0.0005205649224425625, d = 0.0005219466475187205, m = 0.0007466871253777945
[Iteration 12350] [Rank 1] a = 1.0033632516860962, b = 0.9999320654314192, delta = 0.0007692800718359649, c = 0.0008641308626292729, d = 0.0008648908114211599, m = 0.0007467463058624674
[Iteration 12360] [Rank 1] a = 0.9068199992179871, b = 1.0015205472216873, delta = 0.0007217834354378283, c = 0.004041096787112678, d = 0.0038969137754155804, m = 0.0007471113883164923
[Iteration 12370] [Rank 1] a = 1.0665479898452759, b = 0.999889525570982, delta = 0.0007969462312757969, c = 0.0007790511410648382, d = 0.0007795692879683974, m = 0.0007471295892604167
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  12370 |     0.11101s |  92.9%
- batch.accumulate               |  12370 |     0.00083s |   0.7%

[Iteration 12240] [Rank 2] a = 0.9748972654342651, b = 0.9999500105857828, delta = 0.0007396776927635074, c = 0.0009000211714824795, d = 0.0009009192927819822, m = 0.0006415517066012731
[Iteration 12250] [Rank 2] a = 0.9424700736999512, b = 1.0001486162927813, delta = 0.0007153762271627784, c = 0.001297232587751028, d = 0.0012952290863905986, m = 0.000641791543639284
[Iteration 12260] [Rank 2] a = 0.9872301816940308, b = 0.9998708031964694, delta = 0.0007989470614120364, c = 0.0007416063915009537, d = 0.0007426426853080724, m = 0.0006417332581873806
[Iteration 12270] [Rank 2] a = 1.0314699411392212, b = 0.9998516144898444, delta = 0.0007550842710770667, c = 0.0007032289775106627, d = 0.0007041270988101655, m = 0.0006419365043947437
[Iteration 12280] [Rank 2] a = 0.9411038160324097, b = 1.0005486601914961, delta = 0.0007308287895284593, c = 0.002097320493100373, d = 0.002073485735536646, m = 0.0006420979374794192
- batch.backward                 |  12370 |     0.05175s |  43.3%
- batch.evaluate                 |  12370 |     0.00277s |   2.3%
- batch.forward                  |  12370 |     0.02537s |  21.2%
- batch.mom                      |  12370 |     0.00126s |   1.1%
- batch.reduce                   |  12370 |     0.02639s |  22.1%
- batch.reporting.compr_err      |  12370 |     0.00001s |   0.0%
- batch.reporting.lr             |  12370 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  12370 |     0.00001s |   0.0%
- batch.step                     |  12370 |     0.00047s |   0.4%
- batch.update_runavg            |  12370 |     0.00129s |   1.1%
- batch.wd                       |  12370 |     0.00001s |   0.0%
- epoch_metrics.collect          |     88 |     0.00685s |   0.0%
- reduce.combine                 |  12370 |     0.00618s |   5.2%
- reduce.flatpack                |  12370 |     0.00002s |   0.0%
- reduce.flatput                 |  12370 |     0.00020s |   0.2%
- batch.backward                 |  12370 |     0.05179s |  43.3%
- batch.evaluate                 |  12370 |     0.00275s |   2.3%
- batch.forward                  |  12370 |     0.02542s |  21.3%
- batch.mom                      |  12370 |     0.00126s |   1.1%
- batch.reduce                   |  12370 |     0.02619s |  21.9%
- batch.reporting.compr_err      |  12370 |     0.00001s |   0.0%
- batch.reporting.lr             |  12370 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  12370 |     0.00001s |   0.0%
- batch.step                     |  12370 |     0.00048s |   0.4%
- batch.update_runavg            |  12370 |     0.00130s |   1.1%
- batch.wd                       |  12370 |     0.00001s |   0.0%
- epoch_metrics.collect          |     88 |     0.00657s |   0.0%
- reduce.combine                 |  12370 |     0.00631s |   5.3%
- reduce.flatpack                |  12370 |     0.00002s |   0.0%
- reduce.flatput                 |  12370 |     0.00023s |   0.2%
- reduce.gather.context          |  12370 |     0.00245s |   2.1%
- reduce.gather.tensors          |  12370 |     0.00355s |   3.0%
- reduce.heur_params             |  12370 |     0.01055s |   8.8%
- reduce.gather.context          |  12370 |     0.00120s |   1.0%
- reduce.gather.tensors          |  12370 |     0.00390s |   3.3%
- reduce.heur_params             |  12370 |     0.01096s |   9.2%
[Iteration 12290] [Rank 2] a = 0.9458174705505371, b = 0.9999567292239511, delta = 0.000761625065933913, c = 0.0009134584478481169, d = 0.0009139765947516762, m = 0.0006422634724935056
[Iteration 12300] [Rank 2] a = 0.9859935641288757, b = 0.9997634431617454, delta = 0.0008045712602324784, c = 0.0005268863146659857, d = 0.0005278880653462004, m = 0.0006424506616407079
[Iteration 12310] [Rank 2] a = 0.9046977758407593, b = 1.0001269059379352, delta = 0.0007302625454030931, c = 0.0012538118772327598, d = 0.0012519465483799464, m = 0.0006428306049154123
[Iteration 12320] [Rank 2] a = 1.0597096681594849, b = 0.9997169653876415, delta = 0.00079676992027089, c = 0.0004339307601674499, d = 0.0004347943383400487, m = 0.0006432195169495838
[Iteration 12330] [Rank 2] a = 0.8665449023246765, b = 1.0001161284825004, delta = 0.0007624256541021168, c = 0.0012322569660446934, d = 0.0012307370684609196, m = 0.0006432721239388926
- reduce.heur_params.alpha       |  12369 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  12369 |     0.00237s |   2.0%
- reduce.memory                  |  12370 |     0.00046s |   0.4%
- reduce.pad                     |  12370 |     0.00026s |   0.2%
- reduce.threshold               |  12370 |     0.00251s |   2.1%
- test.last                      |     88 |     0.40992s |   2.5%
- test.runavg                    |     88 |     0.44066s |   2.7%
-----------------------------------------------------------------

[Iteration 12380] [Rank 3] a = 0.956300675868988, b = 1.000241070968364, delta = 0.0007072107400745153, c = 0.001482141946067885, d = 0.0014734370780880891, m = 0.0006716713130989247
[Iteration 12390] [Rank 3] a = 0.9511792063713074, b = 1.0000230174844487, delta = 0.0007432969869114459, c = 0.0010460349689054862, d = 0.0010456895376364467, m = 0.0006718855293521954
- reduce.heur_params.alpha       |  12369 |     0.00837s |   7.0%
- reduce.heur_params.beta        |  12369 |     0.00251s |   2.1%
- reduce.memory                  |  12370 |     0.00047s |   0.4%
- reduce.pad                     |  12370 |     0.00022s |   0.2%
- reduce.threshold               |  12370 |     0.00267s |   2.2%
- test.last                      |     88 |     0.40992s |   2.5%
- test.runavg                    |     88 |     0.44067s |   2.7%
-----------------------------------------------------------------

[Iteration 12380] [Rank 1] a = 0.9853745698928833, b = 0.9999866608433869, delta = 0.0007401681505143642, c = 0.0009733216867726664, d = 0.0009734944024071861, m = 0.0007473998271419382
[Iteration 12390] [Rank 1] a = 1.0614359378814697, b = 0.9997274319542855, delta = 0.0008267476805485785, c = 0.00045486389507124505, d = 0.00045565838699003594, m = 0.0007473788989855135
[Iteration 12340] [Rank 2] a = 1.007773756980896, b = 0.9997309898960959, delta = 0.0008193399989977479, c = 0.0004619797792134592, d = 0.0004630851592743857, m = 0.0006434090483505232
[Iteration 12350] [Rank 2] a = 1.0633872747421265, b = 0.9997019909433927, delta = 0.0008166799088940024, c = 0.00040398186914172314, d = 0.00040515633545645753, m = 0.0006437629663663874
[Iteration 12360] [Rank 2] a = 1.021237850189209, b = 0.9997742897030137, delta = 0.0007914917077869177, c = 0.0005485793983616679, d = 0.0005498574940571141, m = 0.0006438165178689076
[Iteration 12370] [Rank 2] a = 1.0392906665802002, b = 0.9998018551170432, delta = 0.0008178886491805315, c = 0.0006037102289003759, d = 0.000604332005184647, m = 0.0006444454242121701
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  12370 |     0.11112s |  93.0%
- batch.accumulate               |  12370 |     0.00082s |   0.7%
[Iteration 12400] [Rank 3] a = 0.8987852931022644, b = 1.0001175620222473, delta = 0.0007486187387257814, c = 0.0012351240455777215, d = 0.0012333968892325239, m = 0.0006719608627136321
[Iteration 12410] [Rank 3] a = 0.9278635382652283, b = 0.999963724207138, delta = 0.0007620034739375114, c = 0.0009274484142442176, d = 0.0009276211298787374, m = 0.0006721867913693842
[Iteration 12420] [Rank 3] a = 1.0442973375320435, b = 0.9997340987772949, delta = 0.0008001316455192864, c = 0.0004681975420561706, d = 0.00046906112022876943, m = 0.0006724517772870917
[Iteration 12430] [Rank 3] a = 0.9068500399589539, b = 1.0013135652216485, delta = 0.0007065375684760511, c = 0.0036271319542957123, d = 0.0035059546651166474, m = 0.0006727493377729557
[Iteration 12440] [Rank 3] a = 0.9887762665748596, b = 0.9998896637434878, delta = 0.0007451695273630321, c = 0.0007793274860800698, d = 0.0007807437542831318, m = 0.0006728419515810568
[Iteration 12400] [Rank 1] a = 1.0095194578170776, b = 0.9997867597712253, delta = 0.0008160717552527785, c = 0.0005735195359863215, d = 0.00057455582979344, m = 0.00074742644459662
[Iteration 12410] [Rank 1] a = 0.965890109539032, b = 1.00014267487508, delta = 0.0007801958126947284, c = 0.0012853497520960682, d = 0.0012821717844209047, m = 0.0007474455660146934
[Iteration 12420] [Rank 1] a = 0.9824085831642151, b = 1.0000155388974767, delta = 0.0007604817510582507, c = 0.0010310777949560747, d = 0.001030835993067747, m = 0.0007477406595929165
[Iteration 12430] [Rank 1] a = 1.0875271558761597, b = 0.9996643734819748, delta = 0.0008538748370483518, c = 0.00032874693874491485, d = 0.00032940325815608996, m = 0.0007477982087901365
[Iteration 12440] [Rank 1] a = 1.0617427825927734, b = 0.99977998931867, delta = 0.0007741913432255387, c = 0.0005599786302399721, d = 0.0005613948984430342, m = 0.0007481257215890054
- batch.backward                 |  12370 |     0.05172s |  43.3%
- batch.evaluate                 |  12370 |     0.00274s |   2.3%
- batch.forward                  |  12370 |     0.02543s |  21.3%
- batch.mom                      |  12370 |     0.00126s |   1.1%
- batch.reduce                   |  12370 |     0.02639s |  22.1%
- batch.reporting.compr_err      |  12370 |     0.00001s |   0.0%
- batch.reporting.lr             |  12370 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  12370 |     0.00001s |   0.0%
- batch.step                     |  12370 |     0.00047s |   0.4%
- batch.update_runavg            |  12370 |     0.00129s |   1.1%
- batch.wd                       |  12370 |     0.00001s |   0.0%
- epoch_metrics.collect          |     88 |     0.01144s |   0.1%
- reduce.combine                 |  12370 |     0.00616s |   5.2%
- reduce.flatpack                |  12370 |     0.00002s |   0.0%
- reduce.flatput                 |  12370 |     0.00020s |   0.2%
[Iteration 12450] [Rank 3] a = 0.9555321931838989, b = 1.0004639431945315, delta = 0.000729598046746105, c = 0.0019278864556364866, d = 0.0019081277870474258, m = 0.0006729590831519995
[Iteration 12460] [Rank 3] a = 1.0407627820968628, b = 0.9997296945289311, delta = 0.0008026197901926935, c = 0.0004593890446956628, d = 0.0004602526228682616, m = 0.0006729878434813595
[Iteration 12470] [Rank 3] a = 1.176798701286316, b = 0.9996539414588618, delta = 0.0008285533986054361, c = 0.0003078828900949276, d = 0.00030850466637919876, m = 0.0006734864948943488
[Iteration 12480] [Rank 3] a = 1.0904186964035034, b = 0.9997323198063858, delta = 0.0007936712354421616, c = 0.00046463959998506357, d = 0.00046564135066527816, m = 0.000673685113711964
[Iteration 12490] [Rank 3] a = 1.0589741468429565, b = 0.9997677265092462, delta = 0.0007849140674807131, c = 0.000535453010138166, d = 0.0005363856745645726, m = 0.0006738034019982314
[Iteration 12450] [Rank 1] a = 0.9918615221977234, b = 1.0000218084750077, delta = 0.0007544142426922917, c = 0.0010436169500222096, d = 0.001043236975626266, m = 0.0007481744462309942
[Iteration 12460] [Rank 1] a = 0.9793627262115479, b = 1.0006122367951213, delta = 0.0007336763083003461, c = 0.002224473743233822, d = 0.0021740407779540514, m = 0.0007484015604097165
[Iteration 12470] [Rank 1] a = 0.9645476937294006, b = 0.9999082997602617, delta = 0.0007820511818863451, c = 0.0008165995200094344, d = 0.0008174976413089372, m = 0.0007485416741709197
[Iteration 12480] [Rank 1] a = 1.0948750972747803, b = 0.9997025436333744, delta = 0.0008119989652186632, c = 0.0004050872492026496, d = 0.00040619262926357613, m = 0.0007486538121121818
[Iteration 12490] [Rank 1] a = 1.0857336521148682, b = 0.9997249793924592, delta = 0.0007853392162360251, c = 0.00044995877105088376, d = 0.0004510296079849063, m = 0.0007489247197713396
- reduce.gather.context          |  12370 |     0.00211s |   1.8%
- reduce.gather.tensors          |  12370 |     0.00392s |   3.3%
- reduce.heur_params             |  12370 |     0.01059s |   8.9%
[Iteration 12500] [Rank 3] a = 0.9409139156341553, b = 1.000206925089136, delta = 0.0007347814971581101, c = 0.0014138501841787711, d = 0.0014102231558538562, m = 0.0006742293219962218
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  12509 |     0.11116s |  93.0%
- batch.accumulate               |  12509 |     0.00082s |   0.7%
- batch.backward                 |  12509 |     0.05175s |  43.3%
- batch.evaluate                 |  12509 |     0.00277s |   2.3%
- batch.forward                  |  12509 |     0.02537s |  21.2%
- batch.mom                      |  12509 |     0.00126s |   1.1%
- batch.reduce                   |  12509 |     0.02641s |  22.1%
- batch.reporting.compr_err      |  12509 |     0.00001s |   0.0%
- batch.reporting.lr             |  12509 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  12509 |     0.00001s |   0.0%
[Iteration 12500] [Rank 1] a = 0.9629753828048706, b = 1.0005194885291486, delta = 0.0007274886593222618, c = 0.0020389771517595975, d = 0.0020056084911703794, m = 0.0007491115317256374
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  12509 |     0.11103s |  92.9%
- batch.accumulate               |  12509 |     0.00083s |   0.7%
- batch.backward                 |  12509 |     0.05179s |  43.3%
- batch.evaluate                 |  12509 |     0.00275s |   2.3%
- batch.forward                  |  12509 |     0.02543s |  21.3%
- batch.mom                      |  12509 |     0.00126s |   1.1%
- batch.reduce                   |  12509 |     0.02620s |  21.9%
- batch.reporting.compr_err      |  12509 |     0.00001s |   0.0%
- batch.reporting.lr             |  12509 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  12509 |     0.00001s |   0.0%
- reduce.heur_params.alpha       |  12369 |     0.00818s |   6.8%
- reduce.heur_params.beta        |  12369 |     0.00234s |   2.0%
- reduce.memory                  |  12370 |     0.00046s |   0.4%
- reduce.pad                     |  12370 |     0.00027s |   0.2%
- reduce.threshold               |  12370 |     0.00247s |   2.1%
- test.last                      |     88 |     0.40992s |   2.5%
- test.runavg                    |     88 |     0.44067s |   2.7%
-----------------------------------------------------------------

[Iteration 12380] [Rank 2] a = 1.015987753868103, b = 0.9998339629524333, delta = 0.0007613537018187344, c = 0.0006679259018148233, d = 0.0006692039975102696, m = 0.000644601328463097
[Iteration 12390] [Rank 2] a = 1.0764102935791016, b = 0.999700263787202, delta = 0.0008035105420276523, c = 0.0004005275564513279, d = 0.00040146022087773464, m = 0.0006447039383745338
- batch.step                     |  12509 |     0.00047s |   0.4%
- batch.update_runavg            |  12509 |     0.00129s |   1.1%
- batch.wd                       |  12509 |     0.00001s |   0.0%
- epoch_metrics.collect          |     89 |     0.00682s |   0.0%
- reduce.combine                 |  12509 |     0.00619s |   5.2%
- batch.step                     |  12509 |     0.00048s |   0.4%
- batch.update_runavg            |  12509 |     0.00130s |   1.1%
- batch.wd                       |  12509 |     0.00001s |   0.0%
- epoch_metrics.collect          |     89 |     0.00654s |   0.0%
- reduce.combine                 |  12509 |     0.00631s |   5.3%
[Iteration 12400] [Rank 2] a = 0.9855080842971802, b = 0.9998145842588392, delta = 0.000809722114354372, c = 0.0006291685134285888, d = 0.0006306538678854587, m = 0.0006447629483201582
[Iteration 12410] [Rank 2] a = 1.060112714767456, b = 0.9996757381694886, delta = 0.000842477020341903, c = 0.00035147631624771555, d = 0.0003521326356588906, m = 0.0006449989624528736
[Iteration 12420] [Rank 2] a = 0.8989076018333435, b = 1.001466124646629, delta = 0.0007032186258584261, c = 0.003932251394238324, d = 0.0037854776480234303, m = 0.0006454772772538414
[Iteration 12430] [Rank 2] a = 0.9195392727851868, b = 1.0002954936608706, delta = 0.0007395354914478958, c = 0.001590987338942239, d = 0.0015843205154497761, m = 0.0006455196085593774
[Iteration 12440] [Rank 2] a = 1.026882290840149, b = 0.9997039426298909, delta = 0.0008117413963191211, c = 0.0004078852424818698, d = 0.00040850701876614094, m = 0.0006462160282880677
- reduce.flatpack                |  12509 |     0.00002s |   0.0%
- reduce.flatput                 |  12509 |     0.00020s |   0.2%
- reduce.gather.context          |  12509 |     0.00245s |   2.1%
- reduce.gather.tensors          |  12509 |     0.00356s |   3.0%
- reduce.heur_params             |  12509 |     0.01055s |   8.8%
- reduce.heur_params.alpha       |  12508 |     0.00810s |   6.8%
- reduce.heur_params.beta        |  12508 |     0.00237s |   2.0%
- reduce.memory                  |  12509 |     0.00046s |   0.4%
- reduce.pad                     |  12509 |     0.00026s |   0.2%
- reduce.threshold               |  12509 |     0.00251s |   2.1%
- test.last                      |     89 |     0.40981s |   2.5%
- test.runavg                    |     89 |     0.44063s |   2.7%
-----------------------------------------------------------------
- reduce.flatpack                |  12509 |     0.00002s |   0.0%
- reduce.flatput                 |  12509 |     0.00023s |   0.2%
- reduce.gather.context          |  12509 |     0.00120s |   1.0%
- reduce.gather.tensors          |  12509 |     0.00391s |   3.3%
- reduce.heur_params             |  12509 |     0.01096s |   9.2%
- reduce.heur_params.alpha       |  12508 |     0.00837s |   7.0%
- reduce.heur_params.beta        |  12508 |     0.00251s |   2.1%
- reduce.memory                  |  12509 |     0.00047s |   0.4%
- reduce.pad                     |  12509 |     0.00022s |   0.2%
- reduce.threshold               |  12509 |     0.00267s |   2.2%
- test.last                      |     89 |     0.40981s |   2.5%
- test.runavg                    |     89 |     0.44064s |   2.7%
-----------------------------------------------------------------
[Iteration 12450] [Rank 2] a = 1.085586428642273, b = 0.9997571044983229, delta = 0.0007526948465965688, c = 0.0005142089870922353, d = 0.0005150725652648341, m = 0.0006464765870042543
[Iteration 12460] [Rank 2] a = 0.963577151298523, b = 0.9999165728390919, delta = 0.0007647236925549805, c = 0.0008331456777964276, d = 0.0008339401697152185, m = 0.0006464945486279097
[Iteration 12470] [Rank 2] a = 0.9004412889480591, b = 1.0001165257284543, delta = 0.0007486331160180271, c = 0.0012330514579634844, d = 0.0012315661035066144, m = 0.0006468615357133332
[Iteration 12480] [Rank 2] a = 1.0045808553695679, b = 0.9997619405358099, delta = 0.0007889307453297079, c = 0.0005238810626253419, d = 0.0005248482701786525, m = 0.0006478884609753502
[Iteration 12490] [Rank 2] a = 0.9289783239364624, b = 1.0002391710964937, delta = 0.0007116030319593847, c = 0.0014783422021084503, d = 0.0014740243112454563, m = 0.0006481479166184918
[Iteration 12500] [Rank 2] a = 0.9451223611831665, b = 1.0000595641126466, delta = 0.0007198524544946849, c = 0.0011191282254342494, d = 0.0011181264747540348, m = 0.0006483665449403123
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  12509 |     0.11113s |  93.0%
- batch.accumulate               |  12509 |     0.00082s |   0.7%
- batch.backward                 |  12509 |     0.05172s |  43.3%
- batch.evaluate                 |  12509 |     0.00274s |   2.3%
- batch.forward                  |  12509 |     0.02543s |  21.3%
- batch.mom                      |  12509 |     0.00126s |   1.1%
- batch.reduce                   |  12509 |     0.02641s |  22.1%
- batch.reporting.compr_err      |  12509 |     0.00001s |   0.0%
- batch.reporting.lr             |  12509 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  12509 |     0.00001s |   0.0%
- batch.step                     |  12509 |     0.00047s |   0.4%
- batch.update_runavg            |  12509 |     0.00129s |   1.1%
- batch.wd                       |  12509 |     0.00001s |   0.0%
- epoch_metrics.collect          |     89 |     0.01139s |   0.1%
- reduce.combine                 |  12509 |     0.00616s |   5.2%
- reduce.flatpack                |  12509 |     0.00002s |   0.0%
- reduce.flatput                 |  12509 |     0.00020s |   0.2%
- reduce.gather.context          |  12509 |     0.00211s |   1.8%
- reduce.gather.tensors          |  12509 |     0.00393s |   3.3%
- reduce.heur_params             |  12509 |     0.01059s |   8.9%
- reduce.heur_params.alpha       |  12508 |     0.00817s |   6.8%
- reduce.heur_params.beta        |  12508 |     0.00234s |   2.0%
- reduce.memory                  |  12509 |     0.00046s |   0.4%
- reduce.pad                     |  12509 |     0.00027s |   0.2%
- reduce.threshold               |  12509 |     0.00247s |   2.1%
- test.last                      |     89 |     0.40981s |   2.5%
- test.runavg                    |     89 |     0.44064s |   2.7%
-----------------------------------------------------------------



last_cross_entropy             - bits:32907216128.000, epoch: 90.000, ratio_transmit_grad:  0.175, value:  5.343 (split:train)
perplexity                     - bits:32907216128.000, epoch: 90.000, ratio_transmit_grad:  0.175, value:209.720 (split:train)
last_perplexity                - bits:32907216128.000, epoch: 90.000, ratio_transmit_grad:  0.175, value:209.720 (split:train)
last_cross_entropy             - bits:32907216128.000, epoch: 90.000, ratio_transmit_grad:  0.175, value:  5.138 (split:test)
last_perplexity                - bits:32907216128.000, epoch: 90.000, ratio_transmit_grad:  0.175, value:170.971 (split:test)
runavg_cross_entropy           - bits:32907216128.000, epoch: 90.000, ratio_transmit_grad:  0.175, value:  5.337 (split:test)
runavg_perplexity              - bits:32907216128.000, epoch: 90.000, ratio_transmit_grad:  0.175, value:208.598 (split:test)
--- Timer summary -----------------------------------------------
  Event                          |  Count | Average time |  Frac.
- batch                          |  12509 |     0.11106s |  92.9%
- batch.accumulate               |  12509 |     0.00082s |   0.7%
- batch.backward                 |  12509 |     0.05162s |  43.2%
- batch.evaluate                 |  12509 |     0.00275s |   2.3%
- batch.forward                  |  12509 |     0.02539s |  21.2%
- batch.mom                      |  12509 |     0.00126s |   1.1%
- batch.reduce                   |  12509 |     0.02640s |  22.1%
- batch.reporting.compr_err      |  12509 |     0.00001s |   0.0%
- batch.reporting.lr             |  12509 |     0.00001s |   0.0%
- batch.reporting.memory_norm    |  12509 |     0.00001s |   0.0%
- batch.step                     |  12509 |     0.00048s |   0.4%
- batch.update_runavg            |  12509 |     0.00130s |   1.1%
- batch.wd                       |  12509 |     0.00001s |   0.0%
- epoch_metrics.collect          |     89 |     0.00730s |   0.0%
- reduce.combine                 |  12509 |     0.00646s |   5.4%
- reduce.flatpack                |  12509 |     0.00002s |   0.0%
- reduce.flatput                 |  12509 |     0.00021s |   0.2%
- reduce.gather.context          |  12509 |     0.00110s |   0.9%
- reduce.gather.tensors          |  12509 |     0.00403s |   3.4%
- reduce.heur_params             |  12509 |     0.01114s |   9.3%
- reduce.heur_params.alpha       |  12508 |     0.00871s |   7.3%
- reduce.heur_params.beta        |  12508 |     0.00235s |   2.0%
- reduce.memory                  |  12509 |     0.00046s |   0.4%
- reduce.pad                     |  12509 |     0.00028s |   0.2%
- reduce.threshold               |  12509 |     0.00248s |   2.1%
- test.last                      |     89 |     0.40980s |   2.5%
- test.runavg                    |     89 |     0.44064s |   2.7%
-----------------------------------------------------------------

